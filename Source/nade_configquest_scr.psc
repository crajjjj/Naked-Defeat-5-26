scriptname nade_configquest_scr extends ski_configbase Conditional

; SCRIPT VERSION
String Function GetModVerStr(Int v)
;	return(Math.RightShift(Math.LogicalAnd(v, 0xFF00), 8) + "." +Math.LogicalAnd(v, 0x00FF))
	return(Math.RightShift(Math.LogicalAnd(v, 0xFF000000), 24) + "." +Math.RightShift(Math.LogicalAnd(v, 0xFF0000), 16)	+ "." +Math.RightShift(Math.LogicalAnd(v, 0xFF00), 8))
EndFunction

Int Function GetVersion()
	return 0x01000000
EndFunction

import JsonUtil

;import PO3_SKSEFunctions

Function RegisterModEvents()		;#RegisterModEvents	#Register1

	RegisterForModEvent("SSLV On Platform", "On_SSLV_On_Platform")
	RegisterForModEvent("xpoPCinPrison", "OnPOPSuspend")
	RegisterForModEvent("xpoPCisFree", "OnPOPResume")
	RegisterForModEvent("SSLV Exit", "OnSSLV_Exit")
	RegisterForModEvent("dhlp-Suspend", "OnSuspend")
	RegisterForModEvent("dhlp-Resume", "OnResume")
	RegisterForModEvent("Moan", "OnMoan")
	RegisterForModEvent("ResetPhoneme", "OnResetPhoneme")
	RegisterForModEvent("Bis_BatheEvent", "OnBis_BatheEvent")
	RegisterForModEvent("StartGetDefeatType", "OnStartGetDefeatType")
	RegisterForModEvent("StartAllegianceQuest", "OnStartAllegianceQuest")
	RegisterForModEvent("RestartAllegianceQuest", "OnRestartAllegianceQuest")
	RegisterForModEvent("StartRestartCalmQuest", "OnStartRestartCalmQuest")
	RegisterForModEvent("StartLoadGameCountdown", "OnLoadGameCountdown")
	RegisterForModEvent("StartReturnGold", "OnStartReturnGold")
	RegisterForModEvent("StartNakedSlavery", "OnStartNakedSlavery")
	RegisterForModEvent("StartNakedAfterlife", "OnStartNakedAfterlife")
	RegisterForModEvent("StartNakedDefeatExternal", "OnStartNakedDefeatExternal")
	RegisterForModEvent("StartNakedBathing", "OnStartNakedBathing")
	RegisterForModEvent("StartFallingCountdown", "OnStartFallingCountdown")
	
	
	if ModdbChests
	;dbChests
	
		
	
	RegisterForModEvent("dt_IsCommonTrap", "On_dt_IsCommonTrap")
	RegisterForModEvent("dt_IsDeviousTrap", "On_dt_IsDeviousTrap")
	RegisterForModEvent("dt_IsBodyTrap", "On_dt_IsBodyTrap")
	endif 
	;RegisterForUpdateGameTime(1)
	RegisterForSingleUpdateGameTime(1.0)
	RegisterForModEvent("StartSpawnOwners", "OnStartSpawnOwners")
	if ModPUBWHORE
	RegisterForModEvent("PW_CurrentStatusChange", "OnPW_CurrentStatusChange")
	endif
	RegisterForAnimationEvent(PlayerRef, "RemoveCharacterControllerFromWorld") 
	RegisterForAnimationEvent(PlayerRef, "getupend")

	registerForAnimationEvent(PlayerRef, "JumpUp")
	registerForAnimationEvent(PlayerRef, "JumpFall")
    registerForAnimationEvent(PlayerRef, "JumpDown")
	RegisterForAnimationEvent(PlayerRef, "tailSprint")
	
	RegisterForModEvent("NakedDefeatTransition", "OnNakedDefeatTransition")
	
	RegisterForAnimationEvent(PlayerRef,"SoundPlay.FSTSwimSwim")

	RegisterForAnimationEvent(PlayerRef, "TKDR_DodgeStart") ;#DODGE
	
	RegisterForKey(57)	;SPACE
	RegisterForKey(207)	;End

	if IsNymrasGame()
	;0x15    21  Y
	UnregisterForKey(21)	;Y (for Potion) ;nono need Z
	RegisterForKey(44)	;Z (for Potion)
	endif 
;	RegisterForAnimationEvent(PlayerRef, "MTState") ;EXITING WATER (for bathing)
;	RegisterForAnimationEvent(PlayerRef, "FootLeft")
;	RegisterForAnimationEvent(PlayerRef, "FootRight")
	
	
	;RegisterForAnimationEvent(PlayerRef, "RemoveCharacterControllerFromWorld")	
	;http://www.gamesas.com/how-detect-when-actor-the-ragdoll-state-t260359.html
	
	
	
EndFunction


;::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
;::::::::::::::::::::::::::::::::::::::::Deviously Enchanted Chests Scripts ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
;::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

;#Bane

;Bool Property DECbridge
;int Property NDTrapWeight


;if Enable Devious Chests BRIDGE - ---- StorageUtil Script ------
;	
;	StorageUtil.SetIntValue(PlayerRef, "DEC_NDTrapsOnCorpses", 0) 				<--- is 0 the correct int to enable the body traps?
;	StorageUtil.SetIntValue(PlayerRef, "DEC_NDTrapsOnCorpses",NDTrapWeight) 	 NDTrapWeight beeing the int from the slider in the MCM weighing ND vs DEC 


;ORDER OF THINGS:
; Naked Defeat enables DECests bridge and sets StorageUtil Ints (above)
; DEC triggers its trap 
; DEC rolls against the storageUtil Int for NDTrap weight
; DEC either does its own stuff OR sends out ModEvent to ND depending on the outcome
; DEC does nothing when ND trap , ND does nothing when DEC trap

; if Naked Defeat MCM is changed, it sets values back to 1 (for corpses) and 0 (for NDweight)

;What I need for modevents to distinct between: IsCommonTrap, IsDeviousTrap, is IsBodyTrap


	 ;--- Events ---; 
	;--- Naked Defeat MCM toggle on/off  ---; 
Event On_dt_IsCommonTrap(String EventName, String ArgString, Float ArgNum, Form Sender)		
Debug.trace ("NAKED DEFEAT confiquest: On_dt_IsCommonTrap()")
	if ModdbChests ;&& DECbridge
	StartDeviousTrap(1)
	endif 
EndEvent

	;--- Naked Defeat MCM toggle on/off  ---; 
Event On_dt_IsDeviousTrap(String EventName, String ArgString, Float ArgNum, Form Sender)
Debug.trace ("NAKED DEFEAT confiquest: On_dt_IsDeviousTrap()")
	if ModdbChests ;&& DECbridge	
	StartDeviousTrap(1)
	endif 
EndEvent

Event On_dt_IsBodyTrap(String EventName, String ArgString, Float ArgNum, Form Sender)
Debug.trace ("NAKED DEFEAT confiquest: On_dt_IsBodyTrap()")
	if ModdbChests  ;&& DECbridge		
	StartDeviousTrap(1)
	endif 
EndEvent


Bool StartDeviousTrapStarted = false
bool EvadeWithDefeatKey
bool EvadeWithSpace
int LootTrapIsTriggered


 ;--- TRAP SCRIPT ---; 

Function StartDeviousTrap(int traptype)	

if StartDeviousTrapStarted
Debug.MessageBox("ERROR StartDeviousTrapStarted DOUBLESTART")
endif

StartDeviousTrapStarted = true

int TrapChance = 10

if playerref.IsWeaponDrawn()
TrapChance = 75
endif

		if Nym() && D100(TrapChance)			;#mara
		;RegisterForSingleUpdate(1.0)

		;UTILITY WAIT DOES NOT WORK WHILE IN MENU
		game.disableplayercontrols()

			
			Utility.Waitmenumode(2.0)
			UI.Invoke("ContainerMenu", "_root.Menu_mc.onExitMenuRectClick")
			game.enableplayercontrols()
			
			EvadeWithDefeatKey = false
			EvadeWithSpace = false
			
			if D100(66)
			EvadeWithDefeatKey = true
			SoundLootTrap2[0].Play(PlayerRef)
			SexlabMoan(PlayerRef)	
			else
			EvadeWithSpace = true
			SoundLootTrap2[1].Play(PlayerRef)
			PlayBreathingSound()
			endif
			
			LootTrapIsTriggered = 1
		
			Utility.Wait(2.0) 	;time to evade trap
			
			if LootTrapIsTriggered > 0
			SexlabMoan(PlayerRef)
			else
			PlayBreathingSound()
			endif
			
			if LootTrapIsTriggered > 0
			   LootTrapIsTriggered = 0
			   
				;DEAD >>>> Start Afterlife
				if D100(1)
				ScreenMessage("The trap killed you")
				NymTrace("Immobilize(true) for StartDeviousTrap")
				Immobilize(true)
				PlayerRef.PlayIdle(IdlesAnimalDefeat[Utility.RandomInt(0,2)])
				Utility.Wait(2.0)
				FadeToBlack(True)
				Utility.Wait(2.0)
				DefeatTypeScenario = "Afterlife"					;AfterLife Starts here
				StartDeviousTrapStarted = false
				SendModevent("StartNakedAfterlife")
				
	
				
				;UNCONCIOUS >>>> RAPED
				elseif D100(5)
				
					;UNCONCIOUS >>>> Start Defeat
					if D100(66)
					ScreenMessage("The trap paralyzes you and sets of an alarm!")
					
					NymTrace("Immobilize(true) for StartDeviousTrap")
					Immobilize(true)
					PlayerRef.PlayIdle(IdlesAnimalDefeat[Utility.RandomInt(0,2)])
					Utility.Wait(2.0)
					StartDeviousTrapStarted = false
					
					ProximityQuestDefeatScenarioScanStart()
					
					DefeatQuestRunning = true
					DefeatEntranceVia = "Trap Trigger"
					StartDefeat() ;NOTHING can happen after this!
					
					;UNCONCIOUS >>>> SS++
					else
					ScreenMessage("The trap paralyzes you...")
					NymTrace("Immobilize(true) for StartDeviousTrap")
					Immobilize(true)
					PlayerRef.PlayIdle(IdlesAnimalDefeat[Utility.RandomInt(0,2)])
					Utility.Wait(2.0)
					FadeToBlack(True)
					SendModEvent("Moan")
					Utility.Wait(3.0)
					SendModEvent("Moan")					
					FadeToBlack(False)
					StartDeviousTrapStarted = false
					Immobilize(false)
					SendModEvent("SSLV Entry")
					endif	
					
				;NAKED
				elseif D100(20)
				PlayerRef.PushActorAway(PlayerRef, 2.0)
					if D100(50)
					ScreenMessage("A magical curse destroys your armor!")
					StripPlayer()
					else
					ApplyDurationSpell("health", Utility.RandomInt(1,3))
					NakedCurse(true)
					ScreenMessage("A magical curse forces you to be naked!")
					endif	

				;Start Estrus 
				else

			   ;WIP
			   
			   ;ESTRUS TRAP -------------------------------------------------------------------------
			   Utility.Wait(2.0)	;time to find spot
			   FadeToBlack(true)
			   Utility.Wait(1.0)
			   StripPlayer()	;stuff destroyed? --> since its gamey now... YES please
				;#ESTRUS. does this work?
				int EstrusTraptype = Utility.RandomInt(0,3)	
				int ECTrap = ModEvent.Create("ECStartAnimation"); Int 			Int does not have to be named "ECTrap" any name would do
				;if (ECTrap)
				ModEvent.PushForm(ECTrap, PlayerRef)             	; Form			Pass the calling form to the event
				ModEvent.PushForm(ECTrap, PlayerRef) 				; Form	 		The animation target
				ModEvent.PushInt(ECTrap, EstrusTraptype)    	; Int			The animation required   -1 = Impregnation only with No Amimation ,  0 = Tentacles, 1 = Machines 2 = Slime 3 = Ooze
				ModEvent.PushBool(ECTrap, false)             	; Bool			Apply the linked EC effect (Ovipostion for Tentacles, Slime & Ooze, Exhaustion for Machine) 
				ModEvent.Pushint(ECTrap, 1000)               	; Int			Alarm radius in units (0 to disable) 
				ModEvent.PushBool(ECTrap, true)             	; Bool			Use EC (basic) crowd control on hostiles if the Player is trapped
				ModEvent.Send(ECtrap)	
				
				Utility.Wait(1.0)
	
					if folqst.Actor_Follower01
					EstrusTraptype = Utility.RandomInt(0,3)
					int ECFTrap1 = ModEvent.Create("ECStartAnimation")
					ModEvent.PushForm(ECFTrap1, folqst.Actor_Follower01)             	; Form			Pass the calling form to the event
					ModEvent.PushForm(ECFTrap1, folqst.Actor_Follower01) 				; Form	 		The animation target
					ModEvent.PushInt(ECFTrap1, EstrusTraptype)    	; Int			The animation required   -1 = Impregnation only with No Amimation ,  0 = Tentacles, 1 = Machines 2 = Slime 3 = Ooze
					ModEvent.PushBool(ECFTrap1, false)             	; Bool			Apply the linked EC effect (Ovipostion for Tentacles, Slime & Ooze, Exhaustion for Machine) 
					ModEvent.Pushint(ECFTrap1, 1000)               	; Int			Alarm radius in units (0 to disable) 
					ModEvent.PushBool(ECFTrap1, true)             	; Bool			Use EC (basic) crowd control on hostiles if the Player is trapped
					ModEvent.Send(ECFTrap1)
					endif
					
				Utility.Wait(1.0)	
				
					if folqst.Actor_Follower02
					EstrusTraptype = Utility.RandomInt(0,3)	
					int ECFTrap2 = ModEvent.Create("ECStartAnimation")
					ModEvent.PushForm(ECFTrap2, folqst.Actor_Follower02)             	; Form			Pass the calling form to the event
					ModEvent.PushForm(ECFTrap2, folqst.Actor_Follower02) 				; Form	 		The animation target
					ModEvent.PushInt(ECFTrap2, EstrusTraptype)    	; Int			The animation required   -1 = Impregnation only with No Amimation ,  0 = Tentacles, 1 = Machines 2 = Slime 3 = Ooze
					ModEvent.PushBool(ECFTrap2, false)             	; Bool			Apply the linked EC effect (Ovipostion for Tentacles, Slime & Ooze, Exhaustion for Machine) 
					ModEvent.Pushint(ECFTrap2, 1000)               	; Int			Alarm radius in units (0 to disable) 
					ModEvent.PushBool(ECFTrap2, true)             	; Bool			Use EC (basic) crowd control on hostiles if the Player is trapped
					ModEvent.Send(ECFTrap2)
					endif
					
				Utility.Wait(2.0)	
				FadeToBlack(false)
				StartDeviousTrapStarted = false
				
				endif
			endif
		endif	

	StartDeviousTrapStarted = false
		
EndFunction	

;::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::


Event OnStartPlayerDestiny(String EventName, String ArgString, Float ArgNum, Form Sender)
Debug.Trace("NAKED DEFEAT configquest: OnStartPlayerDestiny")

		;/
		MCM 
		- 1s GetBackUpChance 
		- RescueWeight		DestinyRescueChance
		- SlaveryWeight		DestinySlaveryChance
		- Deathweight		DestinySlaveryChance
		
		/;
		
		Float DestinyRescueChance = DefeatRescueProb*5
		Float DestinySlaveryChance = DefeatSlaveryProb*5
		Float DestinyDeathChance = DefeatDeathChance*5

		;--- GET BACK UP ---;
		;if (D100)DestinyGetUpChance
		;do nothing
		;ScreenMessage("You quickly recover from the incident")
		
		int i = Utility.RandomInt(1,3)
		
		;--- RESCUE ---;
		if (i == 1) && D100(DestinyRescueChance)
		SendModEvent("StartPlayerRescued")
		
		;--- SLAVERY ---;
		elseif (i == 2) && D100(DestinySlaveryChance)
		SendModEvent("SSLV Entry")
		
		;--- DEATH ---;
		elseif (i == 3) && D100(DestinyDeathChance)
		SendModevent("StartNakedAfterlife")
		
		else
		ScreenMessage("You quickly recover from the incident")
		endif
		
EndEvent

;int hourspassed = 0

;/
Event OnRegisterForSingleUpdateGameTime() ; because of how we registered, this event occurs every 6 HOURS of game time		
			
	If IsNymrasGame()
	
	Debug.Trace("NAKED DEFEAT configquest: OnRegisterForSingleUpdateGameTime: ("+hourspassed+")")
	hourspassed += 1
	
	ScreenMessage("1 Hour has passed")
	
		if hourspassed == 6
		ScreenMessage("6 Hours have passed")
		hourspassed = 0
		SpawnNakedEncounters(Utility.RandomInt(1,3), false)
		endif
		
	RegisterForSingleUpdateGameTime(1.0)	
	endIf
	
endEvent
/;



;bool ProcessedFalling = true


Function WaitUntilPlayerStationary()

	;get coordinates
	;check coordinates
	;WAIT
	;repeat

Float PlayerX = PlayerRef.GetPositionX()
Float PlayerY = PlayerRef.GetPositionY()
Float PlayerZ = PlayerRef.GetPositionZ()
			
	Utility.Wait(0.5)

	While ModEnabled && ((PlayerX != PlayerRef.GetPositionX()) || (PlayerY != PlayerRef.GetPositionY()) || (PlayerZ != PlayerRef.GetPositionZ()))
	PlayerX = PlayerRef.GetPositionX()
	PlayerY = PlayerRef.GetPositionY()
	PlayerZ = PlayerRef.GetPositionZ()
	Utility.Wait(0.5)
	endwhile 

	if Nym() 
	PlayCombatBlockingSound()
	endif 


EndFunction 

;bool PlayerWasSprinting = false ;NO LONGER NEEDED

Event OnStoryJail(ObjectReference akGuard, Form akCrimeGroup, Location akLocation, int aiCrimeGold)
Debug.Trace("NAKED DEFEAT configquest: OnStoryJail()")

	Debug.Trace("NAKED DEFEAT configquest: akGuard.GetName(): "+akGuard.GetName())
	InfoMessage("NAKED DEFEAT configquest: akCrimeGroup(): "+akCrimeGroup.GetName())
	Debug.Trace("NAKED DEFEAT configquest: akProjectile(): "+akLocation.GetName())
	Debug.Trace("NAKED DEFEAT configquest: aiCrimeGold(): "+aiCrimeGold)

EndEvent


Int Property Dodged Auto

Event OnAnimationEvent(ObjectReference akSource, string asEventName)		;#ragdoll	;#OnAnimationEvent
	 Debug.Trace("NAKED DEFEAT configquest: OnAnimationEvent("+asEventName+")")

	;>>>>>>>>>>>>> EXIT WATER >>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 		
;	if IsNymrasGame() && (asEventName == "MTState")
;	Debug.Messagebox("Left Water")
				
	;>>>>>>>>>>>>> Moving >>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 		
;	elseif IsNymrasGame() && StartFalling && ((asEventName == "FootLeft") || (asEventName == "FootRight"))
;	Debug.Messagebox("Falling then walking")
;	PlayerIsMoving = true
		
		
	if (asEventName == "TKDR_DodgeStart") 	 ;#DODGE 
	NymTrace("TKDR_DodgeStart")

		if !IsDefeatRunning()
			
			if Dodged == 0
			Dodged = 2 ;we have dodged
			RegisterForSingleUpdate(1.0)
			else 
			NymTrace("#ERROR DODGE DOUBLE START")
			endif
		endif 
	
	
	elseif (asEventName == "SoundPlay.FSTSwimSwim") 	 ;#DODGE 
		
		if NakedDrowning && Nym()
		Debug.Messagebox("Start Swiimming")
			Utility.Wait(2.0)
		
			;if cfgqst.PlayerRef.IsSwimming()
		endif 	
	;PlayCombatBlockingSound()
	;>>>>>>>>>>>>> SPRINTING IN TOWN! >>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 
;	elseif (asEventName == "tailSprint") && Indecency && !PlayerWasSprinting
;	Debug.Trace("NAKED DEFEAT configquest: OnAnimationEvent("+asEventName+")")
;		PlayerWasSprinting = true
		;WIP #baustelle
		
	
	;>>>>>>>>>>>>> FALLING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>> ;#falling1 ;WORKS! ;#fall1
	
	;--- FALLING START --- ;
	
	;[09/15/2024 - 05:18:34AM] NAKED DEFEAT configquest: OnAnimationEvent(JumpUp)
	;[09/15/2024 - 05:22:45AM] NAKED DEFEAT configquest: OnAnimationEvent(JumpDown)
	
	;START falling can be triggered and then minutes later a jumpdown...
	
    elseif (FallingDamageTreshold > 0) && (((asEventName == "JumpFall") || (asEventName == "JumpUp")))		
    Debug.Trace("NAKED DEFEAT configquest: #FALLING START# OnAnimationEvent("+asEventName+")")  
		
			if Nym() && Debugpunishmenttype > 0
			;Debug.Messagebox("Jump Start")
			
			PlaySoundOnActor(PlayerRef, "Item does not fit", 1.0)
			endif 
		
			if asEventName == "JumpFall"
			PlayMoaningSound()
			endif
		
			if StartFalling ;is FALSE usually, so this case should not happen
			;seems we can jump up multiple times without falling back down lol
			;so it is correct to reset everything first to reduece bugs
			;this also ends all running "Landing Checks"
			
					
			HealthBeforeFall = 0.0	
			HealthAfterFall = 0.0
			StartFalling = false
			;FallingDamageTreshold = 0.0
			Zpos1 = 0.0
			Zpos2 = 0.0
			Zpos3 = 0.0
			UnconciousnessChance = 0.0
			
			Zpos1_abs = 0.0
			Zpos2_abs = 0.0
			Zpos3_abs = 0.0
			endif
		  
			HealthBeforeFall = PlayerRef.GetActorValue("Health")
		  
			StartFalling = true
			SendModEvent("StartFallingCountdown")
			;ProcessedFalling = false
			Zpos1 = PlayerRef.GetPositionZ()
			Zpos1_abs = math.abs (Zpos1)
			;InfoMessage("Zpos1_abs: "+Zpos1_abs)
			;ScreenMessage("WE ARE FALLING")
			
	;--- FALLING END --- ;	
	elseif (asEventName == "JumpDown") 
		
		if !StartFalling && Nym() && Debugpunishmenttype > 0
		Debug.Trace("NAKED DEFEAT configquest: #FALLING END# OnAnimationEvent("+asEventName+") Already Landed (or never started jumping...")
		PlayCombatBlockingSound()
		Utility.Wait(0.5)
		PlayCombatBlockingSound()
		elseif StartFalling ;we are still falling/jumping
		Debug.Trace("NAKED DEFEAT configquest: #FALLING END# OnAnimationEvent("+asEventName+")")	
			
			SendModEvent("Moan")
			
			bool IsDead = false
			StartFalling = false
			;if !ProcessedFalling
				;
				;if !StartFalling
				;do nothing!
				;elseif StartFalling
				float HealthDiff = 0.0
				StartFalling = false
				HealthAfterFall = PlayerRef.GetActorValue("Health")
				
				HealthDiff = HealthBeforeFall - HealthAfterFall
				
				Debug.Trace("HealthDiff: "+HealthDiff+", HealthBeforeFall: "+HealthBeforeFall+", HealthAfterFall: "+HealthAfterFall)
				
					HealthBeforeFall = 0.0
					HealthAfterFall = 0.0
					
					;---- Check if we reached a "resting" place ----;
					SendModEvent("Moan")
					WaitUntilPlayerStationary()
					
				;	if Ragdolling
				;	NymTrace("We Are Ragdolling")

						SendModEvent("Moan")
				;		endwhile 
				;	endif 
					
					;-----------------------------------------------;
					
					if DefeatStatePlayer == "Bleedout From Accident"
					NymTrace("Already in Bleedout, do nothing")
					else
					;ProcessedFalling = true
						Zpos2 = PlayerRef.GetPositionZ()
						Zpos2_abs = math.abs (Zpos2)
						;InfoMessage("Zpos2_abs: "+Zpos2_abs)
						Zpos3 = (Zpos1_abs - Zpos2_abs)
						Zpos3_abs = math.abs (Zpos3)
						;InfoMessage("Zpos3_abs: "+Zpos3_abs)
						
						if (HealthDiff > 0) && IsNymrasGame()
						ScreenMessage("Falling Damage: "+HealthDiff)
						endif
						
						if (HealthDiff > 0) && (FallingDamageTreshold > 0)
						InfoMessage("Falling Damage: "+HealthDiff)
						endif
						
						if (FallingDamageTreshold > 0) && (Zpos3_abs > 150) && (HealthDiff > FallingDamageTreshold) && (HealthDiff != 0)
						;FallingDamageTreshold = 0.0
						  ;ScreenMessage("WE HAVE FALLEN")
							HealthDiff = 0		
							  if Zpos3_abs < 200
							  UnconciousnessChance = Zpos3_abs*0.025
							  elseif Zpos3_abs < 250
							  UnconciousnessChance = Zpos3_abs*0.05
							  else
							  UnconciousnessChance = Zpos3_abs*0.1
								if Zpos3_abs > 1000
								IsDead = True
								endif
							  endif	
						
						  
						  Debug.Trace("NAKED DEFEAT configquest: Falling Zpos1_abs: "+Zpos1_abs)
						  Debug.Trace("NAKED DEFEAT configquest: Falling Zpos2_abs: "+Zpos2_abs)
						  Debug.Trace("NAKED DEFEAT configquest: Falling Zpos3_abs: "+Zpos3_abs)
						  InfoMessage("DefeatChance: "+UnconciousnessChance)  

							if !PlayerDownAlready
							ScreenMessage("You have fallen to your death.")
							FallingEventStarted = true	
							DefeatTypeScenario = "Afterlife"					;AfterLife Starts here
							SendModevent("StartNakedAfterlife")
							
						  
							elseif D100(UnconciousnessChance)
								if PartyInCombat()		;Falling in Combat
								FallingEventStarted = true
								ScreenMessage("You hurt your ankle from the fall and are defeated!")
								;allowsurrender = false	
								DefeatQuestRunning = true				;#0 -- THIS ORDER HAS TO BE KEPT!!!!!  
								DefeatViaSurrender = true
								FirstStartUp = true						;#2   
								;TempSender = "Via Falling in Combat"
								SendModEvent("StartAllegianceQuest") 	;#3
								;Debug.SetGodMode(true)
									if PlayerRef.IsWeaponDrawn() 
									PlayerRef.SheatheWeapon()
									SendModEvent("Moan")
									Utility.Wait(1.0)
									endif
								StripWeapons()
								DefeatEntranceVia = "Falling Down in Combat"
								StartDefeat()
								else				;Falling in the wild	
							
								FallingEventStarted = true
								ScreenMessage("You badly hurt yourself from the fall and slowly lose conciousness")

								
								FadeToBlack(True)
								SendModEvent("Moan")
								
									if DefeatRobberyProb > 0 
									StartRobberyAtLocation()
									endif 
								
								Utility.Wait(3.0)
								SendModEvent("Moan")					
								FadeToBlack(False)
								SendModEvent("SSLV Entry")
								endif
							endif	
						endif ;do nothing (not enough dmg)
					endif ;do nothing (already in bleedout)
			
					Zpos1 = 0.0
					Zpos2 = 0.0
					Zpos3 = 0.0
					UnconciousnessChance = 0.0
					
					Zpos1_abs = 0.0
					Zpos2_abs = 0.0
					Zpos3_abs = 0.0
		endif
					
	


	;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
	
	
	elseif asEventName == "RemoveCharacterControllerFromWorld"
	Ragdolling = true
	;RagdollGetUpScan()
	elseif asEventName == "getupend"
	Utility.Wait(1.5)
	Ragdolling = false
	endif
	
EndEvent

Function RagdollGetUpScan()
int timer = 0
while Ragdolling && ModEnabled 
 Utility.Wait(1.0)
timer +=1
	if timer > 10
	PlayerRef.PushActorAway(PlayerRef, 1.5)
	timer = 0
	endif
endwhile
	
EndFunction

Float HealthBeforeFall
Float HealthAfterFall

Float Property FallingDamageTreshold Auto
Float Property KeyDDWiggleFreeChance Auto
Float Property KeyDDWiggleFreeFailChance Auto

Event OnStartFallingCountdown(String EventName, String ArgString, Float ArgNum, Form Sender)
Debug.Trace("NAKED DEFEAT configquest: OnStartFallingCountdown()")

int i = 10
int j = 0
Bool Landed = false

Float TempZStart = PlayerRef.GetPositionZ()
;	Zpos2 = PlayerRef.GetPositionZ()
;	Utility.Wait(1.0)
;	While (Zpos2 != PlayerRef.GetPositionZ()) && ModEnabled ;&& Ragdolling ;&& !PlayerRef.IsRunning()
;	NymTrace("######## Still Falling")
;	Zpos2 = PlayerRef.GetPositionZ()
;	Utility.Wait(1.0)
;	endwhile 

while (i > 0) && StartFalling ;if we jump again this is ended.
	i -= 1
	j += 1
	Utility.Wait(1.0)
	if StartFalling && (i < 9) && (PlayerRef.GetPositionZ() > TempZStart) ;if we are higher than before after 2 seconds.
	i = 0
	endif 
endwhile

PlayerIsMoving = false
NymTrace("Landing Scan Looped for "+j+" Seconds")
;Debug.Trace("NAKED DEFEAT configquest: OnStartFallingCountdown(Still not landed...)")

StartFalling = false	;after 10 seconds we should be fallen, so disable
HealthBeforeFall = 0.0	
HealthAfterFall = 0.0
StartFalling = false
;FallingDamageTreshold = 0.0
Zpos1 = 0.0
Zpos2 = 0.0
Zpos3 = 0.0
UnconciousnessChance = 0.0

Zpos1_abs = 0.0
Zpos2_abs = 0.0
Zpos3_abs = 0.0
	

EndEvent

bool PlayerIsMoving = false

	float Zpos1
	float Zpos2
	float Zpos3
	float UnconciousnessChance
	
	float Zpos1_abs
	float Zpos2_abs
	float Zpos3_abs

bool Property Ragdolling Auto
bool StartFalling = false
bool FallingEventStarted = false

Bool Function HasFallingEventStarted()

	if FallingEventStarted
	FallingEventStarted = false
	return true
	else
	return false
	endif

EndFunction

Bool Function IsPlayerStillFalling() ;IS THIS WRONG???

	float checkZpos1
	float checkZpos2
	float checkZpos3
	
	
	float checkZpos1_abs
	float checkZpos2_abs
	float checkZpos3_abs
			
	checkZpos1 = PlayerRef.GetPositionZ()
	checkZpos1_abs = math.abs (checkZpos1)
	Utility.Wait(0.5)
	checkZpos2 = PlayerRef.GetPositionZ()
	checkZpos2_abs = math.abs (checkZpos2)
	
	checkZpos3 = checkZpos1_abs - checkZpos2_abs
	checkZpos3_abs  = math.abs (checkZpos3)
	

	if checkZpos3_abs > 10
	Debug.Trace("NAKED DEFEAT configquest: IsPlayerStillFalling(TRUE)")
	return true
	else
	Debug.Trace("NAKED DEFEAT configquest: IsPlayerStillFalling(FALSE)")
	return false
	endif
	
EndFunction


Event OnResetPhoneme(String EventName, String ArgString, Float ArgNum, Form Sender)	;SEXFINISHSCENE				#events
	;Debug.Trace("NAKED DEFEAT configquest: OnResetPhoneme()")

	if DefeatQuestRunning || CivilRapeRunning
	Utility.Wait(3.0)
	MfgConsoleFunc.SetPhoneme(PlayerRef, 1, Utility.RandomInt(0,100)) 	;reset BIG AAH to random value
	endif
EndEvent

Event OnPW_CurrentStatusChange(int newStatus)	;#PW
Debug.Trace("NAKED DEFEAT configquest: OnPW_CurrentStatusChange()")

if ModPUBWHORE
	if newStatus == 2
	ScreenMessage("You are a public whore now (Naked Defeat PublicPunishment paused)")
	PWSuspendStatus = true
	elseif PWSuspendStatus
	ScreenMessage("You are no longer a public whore (Naked Defeat PublicPunishment resumed)")
	PWSuspendStatus = false
	else
	PWSuspendStatus = false
	endif
endif

EndEvent

;#Acheron Integration			#scrab

;Event OnStartNakedDefeatExternal(actor Enemy00, actor Enemy01, actor Enemy02, actor Enemy03, actor Enemy04, actor Enemy05)

Event OnStartNakedDefeatExternal(Form Enemy00, Form Enemy01, Form Enemy02, Form Enemy03, Form Enemy04, Form Enemy05)
   
   if BleedoutCounter > 0
   Debug.Messagebox("NAKED DEFEAT: #WARNING: Defeat on Bleedout needs to be 0% when you are using Acheron. Acheron Bridge abortet. Use Debug Wheel Unstuck Player if needed or reload earlier save.")
   Debug.Trace("NAKED DEFEAT configquest: #WARNING for ACHERON, Bleedout Defeat is > 0%")
   else  
	   
	   Debug.Trace("NAKED DEFEAT configquest: OnStartNakedDefeatExternal()")
	   
	  ; IsAcheronBridge = true
	   
	   Actor[] Assailants = new Actor[6]
		Assailants[0] = Enemy00 as Actor
		Assailants[1] = Enemy01 as Actor
		Assailants[2] = Enemy02 as Actor
		Assailants[3] = Enemy03 as Actor
		Assailants[4] = Enemy04 as Actor
		Assailants[5] = Enemy05 as Actor

		InfoMessage("NAKED DEFEAT: received Acheron Event from Bridge")
			
		bool NoActor = false
		
		if Assailants[0]
		GetEnemyType(Assailants[0])	
			if !Assailants[0].IsInFaction(EnemyFaction)
			Assailants[0].AddToFaction(EnemyFaction)
			endif 
			;Assailants[0].AddToFaction(AcheronEnemyFaction)
		else
		InfoMessage("NAKED DEFEAT: #ERROR Enemy00 not found")	
		NoActor = true
		endif
		
		if Assailants[1]
		GetEnemyType(Assailants[1])
			if !Assailants[1].IsInFaction(EnemyFaction)
			Assailants[0].AddToFaction(EnemyFaction)
			endif 
		;Assailants[1].AddToFaction(AcheronEnemyFaction)
		endif

		if Assailants[2]
		GetEnemyType(Assailants[2])
				if !Assailants[2].IsInFaction(EnemyFaction)
				Assailants[2].AddToFaction(EnemyFaction)
				endif 
		;Assailants[2].AddToFaction(AcheronEnemyFaction)
		endif

		if Assailants[3]
		GetEnemyType(Assailants[3])
		
				if !Assailants[3].IsInFaction(EnemyFaction)
			Assailants[3].AddToFaction(EnemyFaction)
			endif 
		
		;Assailants[3].AddToFaction(AcheronEnemyFaction)
		endif

		if Assailants[4]
		GetEnemyType(Assailants[4])
		
				if !Assailants[4].IsInFaction(EnemyFaction)
			Assailants[4].AddToFaction(EnemyFaction)
			endif 
		;Assailants[4].AddToFaction(AcheronEnemyFaction)
		endif

		if Assailants[5]
		GetEnemyType(Assailants[5])
				if !Assailants[5].IsInFaction(EnemyFaction)
			Assailants[5].AddToFaction(EnemyFaction)
			endif 
		;Assailants[5].AddToFaction(AcheronEnemyFaction)
		endif	
		
		if folqst.Actor_Follower01			
		;folqst.Actor_Follower01.AddToFaction(AcheronVictimFaction)
		endif 
		
		if folqst.Actor_Follower02		
		;folqst.Actor_Follower02.AddToFaction(AcheronVictimFaction)
		endif 
		
		if NoActor
		NoActor = false
		ScreenMessage("NAKED DEFEAT: #ERROR Quest not started because actor missing")
		else
		
		GetDefeatType()
		
		if DefeatTypeGeneral == "Funny"
		ScreenMessage("NAKED DEFEAT: #ERROR failed to get a proper defeat type from Acheron actors")
		endif
		
		if PlayerRef.IsWeaponDrawn() 
		PlayerRef.SheatheWeapon() 
	;	Utility.Wait(1.0)
		endif			
		
		if PlayerRef.GetEquippedWeapon()
		PlayerRef.UnequipItem(PlayerRef.GetEquippedWeapon())
		endif
		
		if PlayerRef.GetEquippedWeapon(true)
		PlayerRef.UnequipItem(PlayerRef.GetEquippedWeapon(true))
		endif
		
		;TempSender = "Via Acheron Bridge"
		SendModEvent("StartAllegianceQuest") 
		(2.0)
		DisableAcheron()
		AcheronEnabled = false
		
		DefeatQuestRunning = true
		
		Utility.Wait(3.0)
		PlayerRef.RestoreActorValue("Health", 100)		
		PlayerRef.SetNoBleedoutRecovery(true)			
		SendModEvent("Moan")	
		Utility.Wait(1.0)
		Immobilize(false)
		
		;Debug.Messagebox("Should get up from Bleedout now") 
		
		if PlayerRef.IsWeaponDrawn() 
		PlayerRef.SheatheWeapon() 
	;	Utility.Wait(1.0)
		endif			
		
		if PlayerRef.GetEquippedWeapon()
		PlayerRef.UnequipItem(PlayerRef.GetEquippedWeapon())
		endif
		
		if PlayerRef.GetEquippedWeapon(true)
		PlayerRef.UnequipItem(PlayerRef.GetEquippedWeapon(true))
		endif

		SendModEvent("StartRestartCalmQuest")
		endif
	endif 
	
	
	;/
	TypeList: 
	Guards
	Humans
	Mages
	DremoraRace
	Vampires
	Necromancers
	Draugrs
	Trolls
	Wolves
	WispMothers
	Wisps
	VampireLords
	DragonPriests
	Falmers
	Chaurus
	ChaurusHunters
	ChaurusReapers
	BoarsAny
	Dogs
	Horses
	Goats
	Canines
	Skeevers
	Spiders
	LargeSpiders
	GiantSpiders
	SabreCats
	Bears
	Giants
	Mammoths
	DwarvenBallistas
	DwarvenCenturions
	DwarvenSpheres
	DwarvenSpiders
	Rieklings
	Boars
	BoarsAny
	BoarsMounted
	Werewolves
	Spriggans
	IceWraiths
/;	
	
EndEvent

;bool SSrunning = false


;EXPRESSIONS AND SOUNDS FOR SLAVERY AUCTION!!!
Event On_SSLV_On_Platform(String EventName, String ArgString, Float ArgNum, Form Sender)	;#Platform ;#SS #auction
Debug.Trace("NAKED DEFEAT configquest: On_SSLV_On_Platform()")

;if !AuctionRoom

	Location AuctionRoom = (Game.GetFormFromFile(0x030619F8, "SimpleSlavery.esp") As Location)

;endif 

if SSHandling
	;SSrunning = true
	ScreenMessage("Arrived at Auction") 
	SlaveAuction = true
	
	FollowersStripWeapons()
		
	;if (CalmQuest.GetStage() == 1000) || (CalmQuest.GetStage() == 0)
	;CalmQuest.Start()
	;endif
	;SendModEvent("StartRestartCalmQuest") 
	
	;WE DONT SEEM TO START CALMQUESTANYMORE
	calmqst.Vehicle("SetupForAuction") ;starts FollowerIdleQuest 
	
	int i = 0
	
	FollowerStripCompletely()
	FollowersStripWeapons()
	
	while SlaveAuction && ModEnabled && PlayerRef.IsInLocation(AuctionRoom)	
	SetExpression(Utility.RandomInt(1,6))
		if i == 3
		i = 0
			if D100(66)
			PlaySound()
			else
			SendModevent("Moan")
			endif
		endif 	
	if SlaveAuction
	Utility.Wait(1)	
	endif 
	if SlaveAuction
	Utility.Wait(1)	
	endif 
	if SlaveAuction
	Utility.Wait(1)	
	endif 
	if SlaveAuction
	Utility.Wait(1)	
	endif 
	
	i += 1
	
	endwhile
	
	calmqst.SS_PlatformExit()
	;CalmQuest.SetStage(1000)
	
	ScreenMessage("Leaving Auction") 
;	SSrunning = false 
	;SlaveAuction = false 
endif

EndEvent


;Event OnStartSpawnOwners(String EventName, String ArgString, Float ArgNum, Form Sender)	;
;Debug.Trace("NAKED DEFEAT configquest: OnStartSpawnOwners()")
;Utility.Wait(2.0)
;if IsNymrasGame()
;Debug.Messagebox("ERROR we are here: cfgqst OnStartSpawnOwners")
;endif
;EndEvent

Event OnStartNakedSlavery(String EventName, String ArgString, Float ArgNum, Form Sender)	;#slavery1
Debug.Trace("NAKED DEFEAT configquest: OnStartNakedSlavery() ##SLAVERY##")

;SSrunning = false

	if D100(50)
	StartSimpleSlaveryPublic()
	else
	StartSimpleSlaveryHostile()
	endif

EndEvent

Event OnStartNakedBathing(String EventName, String ArgString, Float ArgNum, Form Sender)	;
Debug.Trace("NAKED DEFEAT configquest: OnStartNakedBathing()")

NakedBathing()
EndEvent

Event OnStartNakedAfterlife(String EventName, String ArgString, Float ArgNum, Form Sender)	;
Debug.Trace("NAKED DEFEAT configquest: OnStartNakedAfterlife()")

DefeatTypeScenario = "Afterlife"
StartSimpleSlaveryHostile()



EndEvent


Event OnStartGetDefeatType(String EventName, String ArgString, Float ArgNum, Form Sender)	;SEXFINISHSCENE				#events
	Debug.Trace("NAKED DEFEAT configquest: OnStartGetDefeatType()")
		
	if DefeatViaSurrender && (Enemy[0] != "none")
	;if we surrender but got hit before that
	Debug.Trace("NAKED DEFEAT configquest: Starting GetDefeatType() A")
	GetDefeatType() ;#2
	elseif DefeatViaSurrender && (Enemy[0] == "none")
	;if we surrender but got NOT hit before that (allegiance quest handles it)
	Debug.Trace("NAKED DEFEAT configquest: DefeatViaSurrender -> AllegianceQuest handles DefeatType")
	else
	;regular start from Defeat(Bleedout) or Defeat(Critical)
	;Debug.Trace("NAKED DEFEAT configquest: Starting GetDefeatType() B")
	GetDefeatType() ;#1
	endif	
	;#todo Do we need a check for Defeat without last hitter? traps etc?

EndEvent

Event OnStartAllegianceQuest(String EventName, String ArgString, Float ArgNum, Form Sender)	;SEXFINISHSCENE				#events
	Debug.Trace("NAKED DEFEAT configquest: OnStartAllegianceQuest()")
	
	if DefeatQuestRunning || CivilRapeRunning
		
		Utility.Wait(1.0)
	
		if AllegianceQuest.GetStage() < 1000
		Utility.Wait(1.0)
		endif
		
		if (AllegianceQuest.GetStage() == 1000) || (AllegianceQuest.GetStage() == 0)
		AllegianceQuest.Start()
		else
		Debug.Trace("NAKED DEFEAT #ERROR 613: OnStartAllegianceQuest(Quest already running, abort.")
		endif
		
		;nothing should come after this or the script gets stuck somehow... at least for the duration of the allegiancequest.
		;IF we want to force Allegiance to start we need to do it outside of this function, maybe "Send Modevent", "check", "SendAgainifNotRunning"
		;Utility.Wait(1.0)
		
		;if (AllegianceQuest.GetStage() == 1000) || (AllegianceQuest.GetStage() < 10)
		;AllegianceQuest.Start()
		;endif
		
		;if AllegianceQuest.GetStage() == 1000
		;ScreenMessage("#ERROR: AllegianceQuest not started")
		;endif	
	endif
	
EndEvent


Event OnRestartAllegianceQuest(String EventName, String ArgString, Float ArgNum, Form Sender)	;SEXFINISHSCENE				#events
	Debug.Trace("NAKED DEFEAT configquest: OnStartAllegianceQuest()")
	
	if DefeatQuestRunning || CivilRapeRunning
		
		If IsNymrasGame()
		;Debug.messagebox("AllegianceQuest shut down for restart")
		endif
		
		Utility.Wait(1.0)
	
		while AllegianceQuest.GetStage() < 1000
		Utility.Wait(1.0)
		endwhile
		
		If IsNymrasGame()
		;Debug.messagebox("AllegianceQuest about to restart")
		endif
		
		if (AllegianceQuest.GetStage() == 1000) || (AllegianceQuest.GetStage() == 0)
		AllegianceQuest.Start()
		else
		Debug.Trace("NAKED DEFEAT #ERROR: 654 Allegiancequest already started")
		endif
		;nothing should come after this or the script gets stuck somehow... at least for the duration of the allegiancequest.
		;IF we want to force Allegiance to start we need to do it outside of this function, maybe "Send Modevent", "check", "SendAgainifNotRunning"
		;Utility.Wait(1.0)
		
		;if (AllegianceQuest.GetStage() == 1000) || (AllegianceQuest.GetStage() < 10)
		;AllegianceQuest.Start()
		;endif
		
		;if AllegianceQuest.GetStage() == 1000
		;ScreenMessage("#ERROR: AllegianceQuest not started")
		;endif	
	endif
	
EndEvent

Event OnLoadGameCountdown(String EventName, String ArgString, Float ArgNum, Form Sender)
Debug.Trace("NAKED DEFEAT configquest: OnLoadGameCountdown(START)")
	LoadGameCountdown = 5
	While LoadGameCountdown > 0
	Utility.Wait(1.0)
	LoadGameCountdown -= 1
	EndWhile
Debug.Trace("NAKED DEFEAT configquest: OnLoadGameCountdown(END)")
EndEvent

Event OnStartReturnGold(String EventName, String ArgString, Float ArgNum, Form Sender)
Debug.Trace("NAKED DEFEAT configquest: OnStartReturnGold()")

ScreenMessage("You got your stolen riches back [stolen gold returned]")
PlayerRef.AddItem(Gold001, RobbedGold, true)
RobbedGold = 0

EndEvent


Event OnStartRestartCalmQuest(String EventName, String ArgString, Float ArgNum, Form Sender)	;SEXFINISHSCENE				#events
		Debug.Trace("NAKED DEFEAT configquest: OnRestartCalmQuest()")
		
		bool SaveRapeAgain = false
		
		if IsFastTravelRitualStarted
		IsFastTravelRitualStarted = false
		endif
		
		;SAVE RapeAgain (still needed?)
		if RapeAgain
		CalmQuest.SetStage(1000)
		SaveRapeAgain = true
		endif

		;if CalmQuest.GetStage() < 1000
		;CalmQuest.SetStage(1000)
		Debug.Trace("NAKED DEFEAT configquest: OnRestartCalmQuest - #INFO: Calmquest Stage" +CalmQuest.GetStage())
		;Utility.Wait(0.5)
		;endif

		if SaveRapeAgain
		RapeAgain = true
		SaveRapeAgain = false
		endif
			
		;while CalmQuest.GetStage() == 1000
		;Debug.Trace("NAKED DEFEAT configquest: Restart CalmQuest (HERE)")
	;	Debug.Trace("NAKED DEFEAT configquest: OnRestartCalmQuest - this happened 2")
		
		;SAVE DefeatViaSlavery ----> when restarting because of no actors found
	;	if NoActorsRestartSlavery
	;	DefeatViaSlavery = true
	;	NoActorsRestartSlavery = false
	;	endif
		
		;if (CalmQuest.GetStage() == 1000) || (CalmQuest.GetStage() == 0)
		CalmQuest.Start()
		;elseif 
		;Debug.Trace("NAKED DEFEAT #ERROR 722: Calmquest already started 722)")
		;SAME HERE, we cannot put stuff after this: FORCE Start with Check has to be done OUTSIDE OF THIS function "SendStart", "Check" "SendStartAgain"
		;endif
	;	Debug.Trace("NAKED DEFEAT configquest: OnRestartCalmQuest - this happened 3")
	;	if CalmQuest.GetStage() == 1000
	;	Debug.Trace("NAKED DEFEAT configquest: OnRestartCalmQuest - this happened 4")
	;	CalmQuest.Start()
	;	endif
	;	Utility.Wait(1.5)
				
	;	if CalmQuest.GetStage() == 1000
	;	Debug.Trace("NAKED DEFEAT configquest: OnRestartCalmQuest - this happened 5")
	;	CalmQuest.Start()
	;	endif
	;	Utility.Wait(1.5)
		;Endwhile
		
	;	Debug.Trace("NAKED DEFEAT configquest: OnRestartCalmQuest - this happened 6")
		
EndEvent

; THIS NEEDS TO BE REPLACED 100% BY THE MODEVENT
Function RestartCalmQuest()
		Debug.Trace("NAKED DEFEAT configquest: RestartCalmQuest()")

		bool SaveRapeAgain = false
		
		if RapeAgain
		SaveRapeAgain = true
		endif
		
		if CalmQuest.GetStage() < 1000
		CalmQuest.SetStage(1000)
		;Debug.Trace("NAKED DEFEAT configquest: OnRestartCalmQuest - this happened 1")
		Utility.Wait(0.5)
		endif

		if SaveRapeAgain
		RapeAgain = true
		SaveRapeAgain = false
		endif
		
		if CalmQuest.GetStage() < 1000		;<---- replace with while?
		CalmQuest.SetStage(1000)
		;Debug.Trace("NAKED DEFEAT configquest: RestartCalmQuest - this happened 2")
		Utility.Wait(1.0)
		endif

		Debug.Trace("NAKED DEFEAT configquest: RestartCalmQuest - we are here")	
		
		if (CalmQuest.GetStage() == 1000) || (CalmQuest.GetStage() == 0)
		CalmQuest.Start()
		else
		Debug.Trace("NAKED DEFEAT #ERROR 775: CalmQuest already started")
		endif
		
	;	if CalmQuest.GetStage() == 1000
	;	Debug.Trace("NAKED DEFEAT configquest: RestartCalmQuest - this happened 3")
	;	CalmQuest.Start()
	;	endif
	;	Utility.Wait(1.5)
				
	;	if CalmQuest.GetStage() == 1000
	;	Debug.Trace("NAKED DEFEAT configquest: RestartCalmQuest - this happened 4")
	;	CalmQuest.Start()
	;	endif
	;	Utility.Wait(1.5)
		;Endwhile
		
	;	Debug.Trace("NAKED DEFEAT configquest: RestartCalmQuest - this happened 5")
		
EndFunction

Bool PlayerIsMale = false

Bool Function IsPlayerMale()
if PlayerIsMale
return true
else
return false
endIf
EndFunction

Function SetPlayerGender()

	if IsMale(PlayerRef)
	PlayerIsMale = true
	else
	PlayerIsMale = false
	endif
	
EndFunction

Function ImportOutfitsAndWeapons()

Import_JSON_Weapons()
Import_JSON_Outfits()

EndFunction


String Property LastDefeatScenario Auto

Function SaveLastDefeatScenario()

	LastDefeatScenario = DefeatTypeScenario

EndFunction

Bool Function CheckLastDefeatScenario()

	if DefeatTypeScenario == LastDefeatScenario
	return true
	else
	return false
	endif
	
EndFunction


Event OnInit()
Debug.Trace("NAKED DEFEAT OnInit")	
	Debug.Notification(ModName+" "+NakedDefeat_ModVersion+" script initialization.")
	
	
	;if NymBEta ;BETA
	;ImportOutfitsAndWeapons()
	;endif
	
	;POP compatibility
	
	;Version = "4.60" ;#MODVERSION
	
		
;	if folqst.GetStage() < 1000
;	folqst.EndFollowerQuest()
;	Utility.Wait(1.0)
;	folqst.StartFollowerQuest()
	;Debug.Notification("<font color='#ff0000'>Make sure nobody is missing! (you can check in the MCM/System) </font>")
;	endif
	
	SetPlayerGender()

	VersionCheck()

	RegisterModEvents()
	;RegisterForCrosshairRef()
	
	StripOptionsList = new string[3]
	StripOptionsList[0] = "$nade_StripOptionsListUnequip"	;"Unequip"
	StripOptionsList[1] = "$nade_StripOptionsListDrop"		;"Drop"
	StripOptionsList[2] = "$nade_StripOptionsListDestroy"	;"Destroy"
	
	WiggleOptionsList = new string[8]
	WiggleOptionsList[0] = "$nade_WiggleOptionsListHard"	;"Hard"
	WiggleOptionsList[1] = "$nade_WiggleOptionsListMedium"	;"Medium"
	WiggleOptionsList[2] = "$nade_WiggleOptionsListEasy"	;"Easy"
	WiggleOptionsList[3] = "$nade_WiggleOptionsListEasiest"	;"Easiest"
	WiggleOptionsList[4] = "$nade_WiggleOptionsListRandom_Hard"	;"Random Hard"
	WiggleOptionsList[5] = "$nade_WiggleOptionsListRandom_Medium"	;"Random Medium"
	WiggleOptionsList[6] = "$nade_WiggleOptionsListRandom_Easy"	;"Random Easy"
	WiggleOptionsList[7] = "$nade_WiggleOptionsListRandom_Easiest"	;"Random Easiest"
	
	WiggleOptionsSSList = new string[8]
	WiggleOptionsSSList[0] = "$nade_WiggleOptionsSSListHard"	;"Hard"
	WiggleOptionsSSList[1] = "$nade_WiggleOptionsSSListMedium"	;"Medium"
	WiggleOptionsSSList[2] = "$nade_WiggleOptionsSSListEasy"	;"Easy"
	WiggleOptionsSSList[3] = "$nade_WiggleOptionsSSListEasiest"	;"Easiest"
	WiggleOptionsSSList[4] = "$nade_WiggleOptionsSSListRandom_Hard"	;"Random Hard"
	WiggleOptionsSSList[5] = "$nade_WiggleOptionsSSListRandom_Medium"	;"Random Medium"
	WiggleOptionsSSList[6] = "$nade_WiggleOptionsSSListRandom_Easy"	;"Random Easy"
	WiggleOptionsSSList[7] = "$nade_WiggleOptionsSSListRandom_Easiest"	;"Random Easiest"
	
		
	DefeatFindSpotList = new string[3]
	DefeatFindSpotList[0] = "$nade_DefeatFindSpotList_OFF"	;"OFF"
	DefeatFindSpotList[1] = "$nade_DefeatFindSpotList_UNLIMITED"	;"UNLIMITED"
	DefeatFindSpotList[2] = "$nade_DefeatFindSpotList_TIMER"	;"TIMER"
	
	DefeatEscapeCrawlList = new string[3]
	DefeatEscapeCrawlList[0] = "$nade_DefeatEscapeCrawlList_OFF"	;"OFF"
	DefeatEscapeCrawlList[1] = "$nade_DefeatEscapeCrawlList_UNLIMITED"	;"UNLIMITED"
	DefeatEscapeCrawlList[2] = "$nade_DefeatEscapeCrawlList_TIMER"	;"TIMER"
	
	DisplayWeight = new int[8]		
	DisplayWeight[0]
	DisplayWeight[1]	
	DisplayWeight[2]
	DisplayWeight[3]
	DisplayWeight[4]
	DisplayWeight[5]
	DisplayWeight[6]
	DisplayWeight[7]
	
	
;HARD - Escape 1 - Lossen 1 
;MEDIUM - Escape  3 - Losen 3
;EASY - Escape  5 - Losen 5
;EASIEST - Escape  10 - Losen 10

;can have still be 1/1 at times!  
;RANDOM HARD - tends to be 1/1 
;RANDOM MEDIUM - tends to be 3/3 
;RANDOM EASY - tends to be 5/5 
;RANDOM EASIEST - tends to be 10/10 
		
	;ScreenMessage("NAKED DEFEAT: Registering Followers")	
	;folqst.StartFollowerQuest()

	parent.OnInit()

endEvent

int DisplayExposure

bool Property VersionSE Auto 

Function VersionCheck()

	Int iMajor = SKSE.GetVersion()
	;Debug.Trace("NAKED DEFEAT configquest: SE Version "+iMajor)
	;ScreenMessage("NAKED DEFEAT configquest: SE Version "+iMajor)
	if iMajor < 2
	VersionSE = false
	;ScreenMessage("SE VERSION")
	else
	VersionSE = true
	endif	

	if VersionSE
	NakedDefeat_ModVersion = "5.26 - AE/SE"
	else
	NakedDefeat_ModVersion = "#ERROR: this is SE Version" ;#MODVERSION
	Debug.Messagebox("ERROR you are using the AE/SE Version on LE. Not recommended!!!")
	endif
	
	Debug.Trace("NAKED DEFEAT configquest: #Version: "+NakedDefeat_ModVersion)

EndFunction

Bool ModRadPros = false

int LootClothingProb
int LootBreakLightProb
int LootBreakHeavyProb

bool NymraPlaying = false

Function OnPlayerLoadGameExternal()					;#load  #LoadGame #OnGameLoad #OnLoadGame  
;GUIDE: gets started from playeraliasquest where the "OnPlayerLoadGameExternal" Event is received.

	Debug.Trace("NAKED DEFEAT configquest: OnPlayerLoadGameExternal()")	
	;SendModEvent("StartLoadGameCountdown")

	Utility.Wait(1.0)
	
	
	
;	FNISstuff()
	;LOAD_CONFIG_EXTERNAL()		
	if Nym()
	;Save_JSON_Ini()
	endif 
	Load_JSON_Ini()
	
	
	;Load_JSON_OutFit_Names()
	
	if folqst.Name_Follower01 == "" || folqst.Name_Follower02 == "" || folqst.Name_Follower03 == "" || folqst.Name_Follower04 == "" || folqst.Name_Follower05 == ""
	NymTrace("#NOTE Update Follower Name Conventions")
	folqst.Name_Follower01 = "empty"
	folqst.Name_Follower02 = "empty"
	folqst.Name_Follower03 = "empty"
	folqst.Name_Follower04 = "empty"
	folqst.Name_Follower05 = "empty"
	endif 
	
	if IsNymrasGame()
;	NymMessage("Enemies: [0] "+Enemy[1]+" [1] "+Enemy[1]+" [2] "+Enemy[2]+" [3] "+Enemy[3]+" [4] "+Enemy[4]+" [5] "+Enemy[5])
	folqst.FollowerStripUpdate()
	NymraPlaying = true
	
	Debug.Trace("NAKED DEFEAT configquest: OnPlayerLoadGameExternal() Enemy[0]: "+Enemy[0])
	Debug.Trace("NAKED DEFEAT configquest: OnPlayerLoadGameExternal() Enemy[1]: "+Enemy[1])
	Debug.Trace("NAKED DEFEAT configquest: OnPlayerLoadGameExternal() Enemy[2]: "+Enemy[2])
	Debug.Trace("NAKED DEFEAT configquest: OnPlayerLoadGameExternal() Enemy[3]: "+Enemy[3])
	Debug.Trace("NAKED DEFEAT configquest: OnPlayerLoadGameExternal() Enemy[4]: "+Enemy[4])
	Debug.Trace("NAKED DEFEAT configquest: OnPlayerLoadGameExternal() Enemy[5]: "+Enemy[5])
		
	
	else
	NymraPlaying = false
	endif

	if NymBeta 
	RegisterForKey(29)		;whats that?
	endif
	
	SetPlayerGender()

	;CLEAN UP SHIT...
	LootScriptRunning = false
	
	VersionCheck()
	CheckFastTravel()
	
	;Restart FollowerQuest	
;	if (folqst.GetStage() < 1000) && !DefeatQuestRunning && !CivilRapeRunning
;	folqst.EndFollowerQuest()
;	Utility.Wait(0.5)
;	folqst.StartFollowerQuest()
	;Debug.Notification("<font color='#ff0000'>Make sure nobody is missing! (you can check in the MCM/System) </font>")
;	endif

	;TEST MCM
	Pages = new string[11]				;MCM pages
	Pages[0] = "$nade_Options"					;1
	Pages[1] = "$nade_OptionsDefeat"	
	Pages[2] = "$nade_OptionsAftermath"
	Pages[3] = "$nade_OptionsCombat"
	Pages[4] = "$nade_OptionsPublicPunish"
	Pages[5] = "$nade_OptionsExtras"
	Pages[6] = "$nade_LibraryOutfitsTags"
	Pages[7] = "$nade_LibraryCreatures"
	Pages[8] = "$nade_LibrarySlots"
	Pages[9] = "$nade_LibraryHairs"
	Pages[10] = "INFO: Shortcuts"

	StripOptionsList = new string[3]
	StripOptionsList[0] = "$nade_StripOptionsListUnequip"	;"Unequip"
	StripOptionsList[1] = "$nade_StripOptionsListDrop"		;"Drop"
	StripOptionsList[2] = "$nade_StripOptionsListDestroy"	;"Destroy"
	
	WiggleOptionsList = new string[8]
	WiggleOptionsList[0] = "$nade_WiggleOptionsListHard"	;"Hard"
	WiggleOptionsList[1] = "$nade_WiggleOptionsListMedium"	;"Medium"
	WiggleOptionsList[2] = "$nade_WiggleOptionsListEasy"	;"Easy"
	WiggleOptionsList[3] = "$nade_WiggleOptionsListEasiest"	;"Easiest"
	WiggleOptionsList[4] = "$nade_WiggleOptionsListRandom_Hard"	;"Random Hard"
	WiggleOptionsList[5] = "$nade_WiggleOptionsListRandom_Medium"	;"Random Medium"
	WiggleOptionsList[6] = "$nade_WiggleOptionsListRandom_Easy"	;"Random Easy"
	WiggleOptionsList[7] = "$nade_WiggleOptionsListRandom_Easiest"	;"Random Easiest"
	
	WiggleOptionsSSList = new string[8]
	WiggleOptionsSSList[0] = "$nade_WiggleOptionsSSListHard"	;"Hard"
	WiggleOptionsSSList[1] = "$nade_WiggleOptionsSSListMedium"	;"Medium"
	WiggleOptionsSSList[2] = "$nade_WiggleOptionsSSListEasy"	;"Easy"
	WiggleOptionsSSList[3] = "$nade_WiggleOptionsSSListEasiest"	;"Easiest"
	WiggleOptionsSSList[4] = "$nade_WiggleOptionsSSListRandom_Hard"	;"Random Hard"
	WiggleOptionsSSList[5] = "$nade_WiggleOptionsSSListRandom_Medium"	;"Random Medium"
	WiggleOptionsSSList[6] = "$nade_WiggleOptionsSSListRandom_Easy"	;"Random Easy"
	WiggleOptionsSSList[7] = "$nade_WiggleOptionsSSListRandom_Easiest"	;"Random Easiest"
	
			
	DefeatFindSpotList = new string[3]
	DefeatFindSpotList[0] = "$nade_DefeatFindSpotList_OFF"	;"OFF"
	DefeatFindSpotList[1] = "$nade_DefeatFindSpotList_UNLIMITED"	;"UNLIMITED"
	DefeatFindSpotList[2] = "$nade_DefeatFindSpotList_TIMER"	;"TIMER"
	
	DefeatEscapeCrawlList = new string[3]
	DefeatEscapeCrawlList[0] = "$nade_DefeatEscapeCrawlList_OFF"	;"OFF"
	DefeatEscapeCrawlList[1] = "$nade_DefeatEscapeCrawlList_UNLIMITED"	;"UNLIMITED"
	DefeatEscapeCrawlList[2] = "$nade_DefeatEscapeCrawlList_TIMER"	;"TIMER"
	
	
	

	;NymMessage("This happened") 
	DisplayWeight = new int[8]		
	DisplayWeight[0]
	DisplayWeight[1] 	
	DisplayWeight[2] 
	DisplayWeight[3] 
	DisplayWeight[4] 
	DisplayWeight[5] 
	DisplayWeight[6] 
	DisplayWeight[7] 
	
	SetInfoDisplayWeightAll()
	
	RegisterModEvents()
	;RegisterForCrosshairRef()

	;move to "ModEnabled"?
	;Soft Dependency check >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>	;#mods
	
	CheckSoftDependencies()
	
	if IsNymrasGame() && !DefeatQuestRunning && !CivilRapeRunning
	ScreenMessage("Hello Nymra!")
	;	if Game.GetModByName("HDTPhysicsWeaponSling.esp") != 255
		;Debug.Notification("WEAPON SLING reequiped")
		;Armor WeaponSling = (Game.GetFormFromFile(0x0000D570, "HDTPhysicsWeaponSling.esp") As Armor)
		;PlayerRef.UnequipItem(WeaponSling, false, true)
		;Utility.Wait(1.0)
		;PlayerRef.EquipItem(WeaponSling)
	;	endIf
	endif
	
	if Nym()
			NymTrace("#BUG Load Outfit Names 02")
			If JsonExists("../Naked Defeat/outfit01")

				outfit_JSON_01_name = GetStringValue("../Naked Defeat/outfit01.json", "outfit_name")
				outfit_JSON_01_type = GetStringValue("../Naked Defeat/outfit01.json", "outfit_type")
				
				outfit_JSON_02_name = GetStringValue("../Naked Defeat/outfit02.json", "outfit_name")
				outfit_JSON_02_type = GetStringValue("../Naked Defeat/outfit02.json", "outfit_type")
				
				outfit_JSON_03_name = GetStringValue("../Naked Defeat/outfit03.json", "outfit_name")
				outfit_JSON_03_type = GetStringValue("../Naked Defeat/outfit03.json", "outfit_type")
			
				outfit_JSON_04_name = GetStringValue("../Naked Defeat/outfit04.json", "outfit_name")
				outfit_JSON_04_type = GetStringValue("../Naked Defeat/outfit04.json", "outfit_type")
				
				outfit_JSON_05_name = GetStringValue("../Naked Defeat/outfit05.json", "outfit_name")
				outfit_JSON_05_type = GetStringValue("../Naked Defeat/outfit05.json", "outfit_type")
				
				outfit_JSON_06_name = GetStringValue("../Naked Defeat/outfit06.json", "outfit_name")
				outfit_JSON_06_type = GetStringValue("../Naked Defeat/outfit06.json", "outfit_type")
				
				outfit_JSON_07_name = GetStringValue("../Naked Defeat/outfit07.json", "outfit_name")
				outfit_JSON_07_type = GetStringValue("../Naked Defeat/outfit07.json", "outfit_type")
				
				outfit_JSON_08_name = GetStringValue("../Naked Defeat/outfit08.json", "outfit_name")
				outfit_JSON_08_type = GetStringValue("../Naked Defeat/outfit08.json", "outfit_type")
				
				outfit_JSON_09_name = GetStringValue("../Naked Defeat/outfit09.json", "outfit_name")
				outfit_JSON_09_type = GetStringValue("../Naked Defeat/outfit09.json", "outfit_type")
				
				outfit_JSON_10_name = GetStringValue("../Naked Defeat/outfit10.json", "outfit_name")
				outfit_JSON_10_type = GetStringValue("../Naked Defeat/outfit10.json", "outfit_type")
				
				weapon_JSON_01_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_name");
				weapon_JSON_01_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type");
				weapon_JSON_01_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_generaltype");

				weapon_JSON_02_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_name");
				weapon_JSON_02_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_type");
				weapon_JSON_02_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_generaltype");

				weapon_JSON_03_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_name");
				weapon_JSON_03_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_type");
				weapon_JSON_03_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_generaltype");

				weapon_JSON_04_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_name");
				weapon_JSON_04_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_type");
				weapon_JSON_04_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_generaltype");

				weapon_JSON_05_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_name");
				weapon_JSON_05_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_type");
				weapon_JSON_05_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_generaltype");

				weapon_JSON_06_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_name");
				weapon_JSON_06_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_type");
				weapon_JSON_06_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_generaltype");

				weapon_JSON_07_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_name");
				weapon_JSON_07_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_type");
				weapon_JSON_07_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_generaltype");

				weapon_JSON_08_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_name");
				weapon_JSON_08_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_type");
				weapon_JSON_08_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_generaltype");

				weapon_JSON_09_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_name");
				weapon_JSON_09_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_type");
				weapon_JSON_09_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_generaltype");

				weapon_JSON_10_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_name");
				weapon_JSON_10_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_type");
				weapon_JSON_10_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_generaltype");
				
				ForcePageReset()
			endif
		endif 
			
	;Utility.Wait(2.0)
	
	;/
	;Restart DefeatQuest		
	
	
	
	if DefeatQuest.IsRunning() && !DefeatQuestRunning && !CivilRapeRunning
	DefeatQuest.SetStage(1000)
	ScreenMessage("ShuttingDownDefeatQuest")
		while ModEnabled && PlayerMonitorOn
		ScreenMessage("PlayerMonitorStillLooping")
		Utility.Wait(1.0)
		endwhile
	ScreenMessage("RestartingDefeatQuest")
	DefeatQuest.Start()
	ScreenMessage("DefeatQuestRestarted")
	endif
	/;
if Nym()
	Utility.Wait(3.0)
	FixExpressions()
endif 
	
EndFunction

bool AlreadyPlaying = false



Function CheckSoftDependencies()

	
	ModBiS_R = false
	ModBiS = false
	
	if Game.IsPluginInstalled("Precision.esp")
	ModPrecision = true
	else
	ModPrecision = false
	endif 
	
	if Game.IsPluginInstalled("dD Enchanted Chests.esp")
	ModdbChests = true
	else
	ModdbChests = false
	endif 	
	
	if (Game.GetModByName("Bathing in Skyrim.esp") != 255) 
	ModBiS_R = true
	elseif (Game.GetModByName("Bathing in Skyrim - Main.esp") != 255)
	ModBiS = true
	endif
	
	if ModBiS && ModBis_R
	Debug.Messagebox("#ERROR, you have Bathing in Skyrim and Bathing in Skyrim Renewed. Remove one of them") 
	ModBiS = false
	endif 

	if (Game.GetModByName("Devious Devices - Equip.esp") != 255)
	ModDDe = true
	else
	ModDDe = false
	endif
	
	if (Game.GetModByName("SexLab UtilityPlus.esp") != 255)
	ModSLUplus = true
	else
	ModSLUplus = false
	endif
	
	if (Game.GetModByName("DemonicCreatures.esp") != 255)
	ModDEM = true
	DemonicCreature = (Game.GetFormFromFile(0x0081F780, "DemonicCreatures.esp") As Keyword)
	else
	ModDEM = false
	endif
	
	if (Game.GetModByName("SexlabAroused.esm") != 255)		;check for Sexlab Aroused?
	NuditySLA = true
	else
	NuditySLA = false
	endif
	
	if (Game.GetModByName("xazPrisonOverhaulPatched.esp") != 255)
	ModPOP = true		
	else
	ModPOP = false
	endif 
	
	if (Game.GetModByName("pchsImmersivePlugs.esp") != 255)
	ModPLUGS = true	
	else
	ModPLUGS = false
	endif 
	
	if (Game.GetModByName("Public Whore.esp") != 255)
	ModPUBWHORE = true	
	else
	ModPUBWHORE = false
	endif 
	
	if (Game.GetModByName("BaboInteractiveDia.esp") != 255)
	ModBABODia = true	
		if !BaboDialogueFaction
		BaboDialogueFaction = (Game.GetFormFromFile(0x00D58522, "BaboInteractiveDia.esp") As Faction)
		endif
	else
	ModBABODia = false
	endif  
	
	if (Game.GetModByName("MF_RadiantProstitution.esp") != 255)
		ModRadPros = true	
		if !RadiantProstituteFaction					
		RadiantProstituteFaction = (Game.GetFormFromFile(0x0000BA68, "MF_RadiantProstitution.esp") As Faction)
		endif
	else
	ModRadPros = false
	endif  

		
	if (Game.GetModByName("Devious Devices - Integration.esm") != 255)
	ModDDframework = true	
	KWD_Zaz_InventoryDevice = (Game.GetFormFromFile(0x0502B5F0, "Devious Devices - Integration.esm") As Keyword)
	;zad_InventoryDevice [KYWD:0502B5F0]
		if nade_DDint.GetDDVersion() == "5.2-NG"
		ModDDNG = true
		else
		ModDDNG = false
		endif 
	else
	ModDDframework = false
	endif
	
	if (Game.GetModByName("EstrusSpider.esp") != 255)
	ModEstrusSpider = true
	else
	ModEstrusSpider = false
	endif
	
	if (Game.GetModByName("EstrusSpider.esp") != 255)
	ModEstrusSpider = true
	else
	ModEstrusSpider = false
	endif
	
	
	;------------- CHECK SLAL PACKS ---------------------- ;
	
	if VersionSE 
	
	;SLAL_Nymra = CheckSLALpack("Nymra")
	;SLAL_Billyy = CheckSLALpack("Billyy")
	;SLAL_Anubs = CheckSLALpack("Anubs")
	;SLAL_Babo = CheckSLALpack("Babo")
	;SLAL_3jiou = CheckSLALpack("3jiou")
	;SLAL_Leito = CheckSLALpack("Leito")
	endif 
	
	
EndFunction

Bool Property ModEstrusSpider Auto

;sslBaseAnimation[] Property AnimationsSLAL Auto

Bool Function CheckSLALpack(string authorTag)

;if SexLab.CountTagUsage(authorTag, false) > 0 
;return true
;else
;return false
;endif 

;/
	AnimationsSLAL = SexLab.GetAnimationsByTags(2, authorTag, none, True)
	if AnimationsSLAL.Length > 0
	NymTrace("CheckSLALpack: "+authorTag+" FOUND")
	return true
	else
	NymTrace("CheckSLALpack: "+authorTag+" MISSING")
	return false
	endif 
	/;
	
EndFunction



Event OnMoan(string eventName, string strArg, float numArg, Form sender)		;#Moan
;Debug.Trace("NAKED DEFEAT confiquest: OnMoan()")

	if Orgasm
	NymTrace("OnMoan(Orgasm)")
	endif 	
	
if AlreadyPlaying && !Orgasm ;Orgasm always gehts played

	NymTrace("Already Playing and No Orgasm")
;do nothing: we wait for the sound effect to end first
else

	NymTrace("Not Already Playing")
	;Play Orgasm Sound
	if Orgasm && !Gagged	;#todo need gagged orgasm sound
	Orgasm = false
		if AlreadyPlaying
		Utility.Wait(1.0)
		endif 
	Debug.Trace("NAKED DEFEAT confiquest: OnMoan(orgasm)")
	AlreadyPlaying = true
	MfgConsoleFunc.SetPhoneme(PlayerRef, 1, 100)
	
	PlayOrgasm()
	
	Utility.Wait(8.0)
	AlreadyPlaying = false
	
	;Play Gagged Sound
	elseif Gagged
	;Debug.Trace("NAKED DEFEAT confiquest: OnMoan(gagged)")
	AlreadyPlaying = true
	PlayGagged()
	Utility.Wait(3.0)
	AlreadyPlaying = false
	
	;Play SexlabSounds or BreathingSounds (PlayMoan chooses)
	else
	;Debug.Trace("NAKED DEFEAT confiquest: OnMoan(regular)")
	AlreadyPlaying = true
	PlayMoan()
	Utility.Wait(3.0)
	AlreadyPlaying = false
	endif
endif

EndEvent


Event OnSuspend(string eventName, string strArg, float numArg, Form sender)		;DHLP SUSPEND EVENT

	if (sender != self); from another mod
    dhlpSuspendStatus = true
	endif
	;dhlpSuspendStatus = true
EndEvent


Event OnResume(string eventName, string strArg, float numArg, Form sender)		;DHLP RESUME EVENT
	
	If IsNymrasGame()
	;Debug.Messagebox("DHLP-resume received")
	endif 
	;if SSrunning
	;SSrunning = false
	;endif 
	
	if (sender != self); from another mod
    dhlpSuspendStatus = false
	endif
EndEvent


Event OnPOPSuspend(string eventName, string strArg, float numArg, Form sender)		;DHLP SUSPEND EVENT
;Debug.Trace("NAKED DEFEAT confiquest: OnPOPSuspend()")
;Debug.Notification("NAKED DEFEAT confiquest: OnPOPSuspend()")
;	POPSuspendStatus = true
;    dhlpSuspendStatus = true
EndEvent

Event OnPOPResume(string eventName, string strArg, float numArg, Form sender)		;DHLP SUSPEND EVENT
;Debug.Trace("NAKED DEFEAT confiquest: OnPOPResume()")
;Debug.Notification("NAKED DEFEAT confiquest: OnPOPResume()")


;	POPSuspendStatus = false
;	dhlpSuspendStatus = false
EndEvent


Event OnSSLV_Exit(Form sender, string outcome)		
Debug.Trace("NAKED DEFEAT confiquest: OnSSLV_Exit()")

;Event SSExit(Form sender, string outcome)
  
	SlaveAuction = false 
  
	;if IsNymrasGame()
		if (outcome == "NakedDefeat")
	
		;Debug.Messagebox("OnSSLV_Exit NADE")
		NymTrace("Immobilize(true) for OnSSLV_Exit")
		Immobilize(true)
		endif
	;endif
	
EndEvent




Event OnSpank (string eventName, string strArg, float numArg, Form sender)	
Debug.Trace("NAKED DEFEAT confiquest: OnSpank()")

;DISABLED FOR THE MOMENT
;Debug.Notification("NAKED DEFEAT - Spanked!")

If IsNymrasGame() && D100(5)
PublicExposure+=1
endif

EndEvent

bool BathingEventReceived

Event OnBis_BatheEvent(Form akTarget)

Debug.Trace("NAKED DEFEAT confiquest: OnBis_BatheEvent()")
	BathingEventReceived = true
	
	if NymBeta && !IsBathing
	ScreenMessage("BATHING EVENT RECEIVED")
	Actor CleanActor = akTarget as Actor
	
	;Debug.Trace("NAKED DEFEAT confiquest: Event player washing finished")
	
	;FUCKTHIS I do it myself
	;/
	;	Debug.trace("Naked Defeat calmquest start empty armor")
		PlayerRef.AddItem(ArmorEmpty[0], 1, true)			
		PlayerRef.EquipItem(ArmorEmpty[0], false, true)
		PlayerRef.RemoveItem(ArmorEmpty[0], 1, true, None)
		
		PlayerRef.AddItem(ArmorEmpty[1], 1, true)			
		PlayerRef.EquipItem(ArmorEmpty[1], false, true)
		PlayerRef.RemoveItem(ArmorEmpty[1], 1, true, None)
		
		PlayerRef.AddItem(ArmorEmpty[2], 1, true)			
		PlayerRef.EquipItem(ArmorEmpty[2], false, true)
		PlayerRef.RemoveItem(ArmorEmpty[2], 1, true, None)
		
		PlayerRef.AddItem(ArmorEmpty[3], 1, true)			
		PlayerRef.EquipItem(ArmorEmpty[3], false, true)
		PlayerRef.RemoveItem(ArmorEmpty[3], 1, true, None)
	;	Debug.trace("Naked Defeat calmquest finish empty armor")
	/;
	endif
	
	
;	WashingPlayer = false
EndEvent

Event OnConfigInit()			;WHEN MOD ENABLED ---- hmm or not?
	Debug.Trace(ModName+" "+NakedDefeat_ModVersion+" configuration initialized.")

	Int i
	Bool b = ModEnabled
	
	if b
		ModEnabled = EnableMod(false)
	endif

	Pages = new string[11]				;MCM pages
	Pages[0] = "$nade_Options"					;1
	Pages[1] = "$nade_OptionsDefeat"	
	Pages[2] = "$nade_OptionsAftermath"
	Pages[3] = "$nade_OptionsCombat"
	Pages[4] = "$nade_OptionsPublicPunish"
	Pages[5] = "$nade_OptionsExtras"
	Pages[6] = "$nade_LibraryOutfitsTags"
	Pages[7] = "$nade_LibraryCreatures"
	Pages[8] = "$nade_LibrarySlots"
	Pages[9] = "$nade_LibraryHairs"
	Pages[10] = "INFO: Shortcuts"
	
	if b
		ModEnabled = EnableMod(true)
	endif
	
;	GetDDTags()
	
	;LoadPoses(0)

	Debug.Notification(ModName+" version "+NakedDefeat_ModVersion+" installed.")
;	Debug.Notification("You may wish to check MCM settings, as some of them may have been reset.")

EndEvent


Event OnVersionUpdate(Int a_version)
	
	if CurrentVersion <= a_version
		Debug.Trace(ModName+" "+NakedDefeat_ModVersion+" version updated.")
		OnConfigInit()
		RegisterForSingleUpdateGameTime(1.0)
	else
		Debug.Trace(ModName+" "+NakedDefeat_ModVersion+": outdated version, update aborted.")
	;	Debug.Notification("It is not recommended to install Naked Dungeons v"+GetModVerStr(a_version)+" over a newer version ("+GetModVerStr(CurrentVersion)+")")
	endif
EndEvent

Event OnGameReload()			;WHAT DOES THIS DO???		;OnGameReload is said to not be reliable
	Debug.Trace(ModName+" "+NakedDefeat_ModVersion+" MCM loaded")
	CheckFastTravel()
	;if IsNymrasGame()
	CheckEssentiality()
	;endif 
	if IsNymrasGame() ;#Lydia
	folqst.FollowerStripUpdate()
	endif 
	parent.OnGameReload()
EndEvent

;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

int DefeatForeplayChanceOID_S
;int PlayerOID_S
;int DeadOID_S
;int LivingOID_S
;int FollowerOID_S
;int NuditySLAOID_B
;int NudityUnderwearOID_B
;int IndecencyRapeOID_S
;int IndecencyGenderOID_M
int GuardPunishOID_B			;STILL USED for PUBLIC PUNISHMENT ..... (fix one day...) #todo
;int IndecencyRobberyOID_S
;int IndecencyHaircutOID_B
;int IndecencyBarefootOID_B
;int IndecencyXBOID_M
;int IndecencyXCOID_M
;int[] TheftWeightOID_S
;int ThresholdOID_S
;int ExciteOID_B
;int[] ExceptOID_B
;int[] DungeonOID_B 	

;#OID
int Property BondageHaircutOID_S Auto
int Property ExposureChanceOID_S Auto
int Property PunishShortProbOID_S Auto
int Property DefeatArrestProbOID_S Auto
int Property DefeatShortProbOID_S Auto
int Property StripOptions_OID_M Auto
int Property WiggleOptions_OID_M Auto
int Property WiggleOptionsSS_OID_M Auto

int Property DefeatFindSpot_OID_M Auto
int Property DefeatEscapeCrawl_OID_M Auto

;civil rape sliders

int Property LoopTime_OID_S Auto
int Property Naked_Weight_OID_S Auto
int Property Barefoot_Weight_OID_S Auto
int Property Dirty_Weight_OID_S Auto
int Property Sneaking_Weight_OID_S Auto 
int Property Running_Weight_OID_S Auto
int Property Sprinting_Weight_OID_S Auto
int Property Cum_Weight_OID_S Auto
int Property Unarmed_Weight_OID_S Auto
int Property FallingDamageTreshold_OID_S Auto
int Property KeyDDWiggleFreeChance_OID_S Auto
int Property KeyDDWiggleFreeFailChance_OID_S Auto
;----- Save/Load Profile

int Load_Profile1_T
int Load_Profile2_T
int Load_Profile3_T
int Load_Profile4_T
int Load_Profile5_T
int Save_Profile1_T
int Save_Profile2_T
int Save_Profile3_T
int Save_Profile4_T
int Save_Profile5_T

;/
int Load_Outfit_01_T
int Load_Outfit_02_T
int Load_Outfit_03_T
int Load_Outfit_04_T
int Load_Outfit_05_T
int Load_Outfit_06_T
int Load_Outfit_07_T
int Load_Outfit_08_T
int Load_Outfit_09_T
int Load_Outfit_10_T

int Save_Outfit_01_T
int Save_Outfit_02_T
int Save_Outfit_03_T
int Save_Outfit_04_T
int Save_Outfit_05_T
int Save_Outfit_06_T
int Save_Outfit_07_T
int Save_Outfit_08_T
int Save_Outfit_09_T
int Save_Outfit_10_T

/;


int Property Load_Outfit_01_T Auto
int Property Load_Outfit_02_T Auto
int Property Load_Outfit_03_T Auto
int Property Load_Outfit_04_T Auto
int Property Load_Outfit_05_T Auto
int Property Load_Outfit_06_T Auto
int Property Load_Outfit_07_T Auto
int Property Load_Outfit_08_T Auto
int Property Load_Outfit_09_T Auto
int Property Load_Outfit_10_T Auto

int Property Save_Outfit_01_T Auto
int Property Save_Outfit_02_T Auto
int Property Save_Outfit_03_T Auto
int Property Save_Outfit_04_T Auto
int Property Save_Outfit_05_T Auto
int Property Save_Outfit_06_T Auto
int Property Save_Outfit_07_T Auto
int Property Save_Outfit_08_T Auto
int Property Save_Outfit_09_T Auto
int Property Save_Outfit_10_T Auto

int Property Load_Weapon_01_T Auto
int Property Load_Weapon_02_T Auto
int Property Load_Weapon_03_T Auto
int Property Load_Weapon_04_T Auto
int Property Load_Weapon_05_T Auto
int Property Load_Weapon_06_T Auto
int Property Load_Weapon_07_T Auto
int Property Load_Weapon_08_T Auto
int Property Load_Weapon_09_T Auto
int Property Load_Weapon_10_T Auto

int Property Save_Weapon_01_T Auto
int Property Save_Weapon_02_T Auto
int Property Save_Weapon_03_T Auto
int Property Save_Weapon_04_T Auto
int Property Save_Weapon_05_T Auto
int Property Save_Weapon_06_T Auto
int Property Save_Weapon_07_T Auto
int Property Save_Weapon_08_T Auto
int Property Save_Weapon_09_T Auto
int Property Save_Weapon_10_T Auto

int Save_PunishmentOutfit1_T
int Save_PunishmentOutfit2_T
int Save_PunishmentOutfit3_T
int Save_PunishmentOutfit4_T
int Save_PunishmentOutfit5_T

string Profile = "1"
string akOutfit = "1"

;----- Save/Load Profile

int HairRegrowthOID_S
int EnabledOID_B
int MessagesOID_B
int ShowInfoMessagesOID_B
int ShowNarrativeMessagesOID_B

int NymStrippingOID_B
int NymSpawningOID_B

int Property HeelsFixOID_B Auto
int Property NakedCummingOID_B Auto

int NymBetaOID_B
int VRfixOID_B
int SSEfixOID_B
int NoCrawlingOID_B

int Group5PchanceOID_S
int Group4PchanceOID_S
int Group3PchanceOID_S
int FindSpotTimeOID_S
int ScenarioChanceOID_S

int DebugPunishmentTypeOID_S
int RagdollOID_B
int DefeatRobberyGoldOID_B
int ToggleDeleteDeviceOID_B
int DefeatSceneProtectorsOID_B
int FemalesAllowedOID_B
int StageGoBackOID_B
int SkipSexOID_B

int AllowCreaturesOID_B
int DefeatSpotAndEscapeOID_B

int SimpleSurrenderOID_B
int WeaponOutSurrenderOID_B
int FinishQuestOID_B
int DefeatOID_B
int DefeatKeyOID_K
int EscapeKeyOID_K
int BleedoutCounterOID_S
int WhipmarksDurOID_S
int DefeatDowntimeOID_S
int PoisonDefeatChanceOID_S	
int RapeHandsProbOID_S	
int DefeatChainOID_S
int DefeatEscapeOID_S		;Difficulty Slider
int DefeatRobberyOID_S
int DefeatDDeProbOID_S
int PunishWhipChanceOID_S
int PunishSexChanceOID_S
int DefeatDeathChanceOID_S

int PunishBukkakeChanceOID_S

int NakedDeathChanceOID_S

int DefeatPeeProbOID_S
int SearchRadiusOID_S
int SearchRadiusInteriorOID_S
int DefeatIdleTimeOID_S
int DefeatSlaveryOID_S
int DefeatSDweightOID_S
int DefeatCaptivityOID_S  
int DefeatEscTimeOID_S

int DefeatSpeedMultOID_S

int DefeatThrowOutOID_S
int DefeatBreakArmorOID_B
int NakedDrowningOID_B
int NakedTravelOID_B

int NakedLootOID_B
int NakedLootHotkeysOID_B
int Property SSHandlingOID_B Auto
int Property DeviousPiercingEffectsOID_B Auto


int RemoveDDsOID_B
int GodModeOID_B
int HealthBoostOID_B
int NoEssentialPlayerOID_B
int PlayExpressionsOID_B
int NakedBlurOID_B
int LagFixOID_B
int DefeatBreakClothingOID_S
int DefeatBreakLightOID_S
int DefeatBreakHeavyOID_S
int DefeatWhipProbOID_S
int DefeatWhipTimeOID_S
int DefeatRescueProbOID_S
int FemalesAsMalesOID_S
int RemoveDDChanceOID_S
int DefeatGetUpOID_B
int HarmlessOID_B
int WhipMarksOID_B
int MaleFollowerOID_B
int FemaleFollowerOID_B
int DropItemOID_B
int SlipperyOID_B
int StripAttackOID_B
int NoExtraOID_B
int CooperativeSurrenderChanceOID_S


;CREATURE TOGGLES
int AllowArgonKajitOID_B
int AllowHumanoidBeastsOID_B
int AllowInsectsOID_B
int AllowSkeeversOID_B
int AllowSpidersOID_B

int AllowSabreCatsOID_B
int AllowBearsOID_B
int AllowCaninesOID_B
int AllowMammothsOID_B
int AllowDragonsOID_B

;int AllowNetchesOID_B
int AllowDwarvenOID_B
int AllowUndeadOID_B
int AllowRieklingsOID_B
int AllowFalmersOID_B

int AllowSpriggansOID_B
int AllowElementalsFemaleOID_B
int AllowElementalsMaleOID_B
int AllowTentacleStuffOID_B
int AllowChickenOID_B

int AllowHorsesOID_B
int AllowCowsOID_B
int AllowGoatsOID_B
int AllowDeersOID_B
int AllowFoxesOID_B

int AllowRabbitsOID_B
int AllowHorkersOID_B

;-----BODY SLOTS------------------
int Property BlockSlot30_OID_B Auto
int Property BlockSlot31_OID_B Auto
int Property BlockSlot32_OID_B Auto
int Property BlockSlot33_OID_B Auto
int Property BlockSlot34_OID_B Auto

int Property BlockSlot35_OID_B Auto
int Property BlockSlot36_OID_B Auto
int Property BlockSlot37_OID_B Auto
int Property BlockSlot38_OID_B Auto
int Property BlockSlot39_OID_B Auto

int Property BlockSlot40_OID_B Auto
int Property BlockSlot41_OID_B Auto
int Property BlockSlot42_OID_B Auto
int Property BlockSlot43_OID_B Auto
int Property BlockSlot44_OID_B Auto

int Property BlockSlot45_OID_B Auto
int Property BlockSlot46_OID_B Auto
int Property BlockSlot47_OID_B Auto
int Property BlockSlot48_OID_B Auto
int Property BlockSlot49_OID_B Auto

int Property BlockSlot50_OID_B Auto
int Property BlockSlot51_OID_B Auto
int Property BlockSlot52_OID_B Auto
int Property BlockSlot53_OID_B Auto
int Property BlockSlot54_OID_B Auto

int Property BlockSlot55_OID_B Auto
int Property BlockSlot56_OID_B Auto
int Property BlockSlot57_OID_B Auto
int Property BlockSlot58_OID_B Auto
int Property BlockSlot59_OID_B Auto

int Property BlockSlot60_OID_B Auto
int Property BlockSlot61_OID_B Auto

;---------------------------

int Property MoanOnHitOID_B Auto
int Property CriticalDefeatOID_S Auto
int Property NakedChanceOID_S Auto
int Property MoanOnHitChanceOID_S Auto
;int Property PosesDefeatOID_M 
;int Property PosesShowPussyOID_M
;int Property PosesShowAssOID_M
;int Property PosesPeeHiOID_M
;int Property PosesPeeLoOID_M
;int Property PosesDeflateOID_M
;int Property PosesShowerOID_M
;int Property PosesBathOID_M
;int Property PosesPiercingOID_M
;int Property PosesShaveOID_M
;int Property PosesLoadOID_M
;int Property PosesShowPussyOID_S
;int Property PosesShowAssOID_S
;int PosesPeeHiOID_S
;int PosesPeeLoOID_S
;int PosesDeflateOID_S
;int PosesShowerOID_S
;int PosesBathOID_S
;int PosesPiercingOID_S
;int PosesShaveOID_S
;int SlaveOID_B
;int DebugCrimeOID_B
;int DebugRapeOID_B
;int DebugCalmOID_B
;int DebugCaptiveOID_B
;int DebugCaptureOID_B
;int DebugAllegianceOID_B


Int oidSavedNames_01		;saved Follower Name


;/ NOT IN USE 	
Int oidPunishmentInput_01			
Int oidPunishmentInput_02	
Int oidPunishmentInput_03	
Int oidPunishmentInput_04	
Int oidPunishmentInput_05	
Int oidPunishmentInput_06			
Int oidPunishmentInput_07	
Int oidPunishmentInput_08	
Int oidPunishmentInput_09	
Int oidPunishmentInput_10	


Int oidTextInput_01			;TEXT
Int oidTextInput_02	
Int oidTextInput_03	
Int oidTextInput_04	
Int oidTextInput_05	

Int oidTextInput_06			;TEXT
Int oidTextInput_07	
Int oidTextInput_08	
Int oidTextInput_09	
Int oidTextInput_10	

/; 

Int oidTagInput_01			;TEXT --- Sex Tags Input
Int oidTagInput_02	
Int oidTagInput_03	
Int oidTagInput_04	
Int oidTagInput_05	

Int oidHairInput_00			;move to JSON 
Int oidHairInput_01

Int oidHairInput_02
Int oidHairInput_03
Int oidHairInput_04
Int oidHairInput_05
Int oidHairInput_06
Int oidHairInput_07
Int oidHairInput_08
Int oidHairInput_09
Int oidHairInput_10

Int oidHairInput_11
Int oidHairInput_12
Int oidHairInput_13
Int oidHairInput_14
Int oidHairInput_15
Int oidHairInput_16
Int oidHairInput_17
Int oidHairInput_18
Int oidHairInput_19
Int oidHairInput_20

;string[] ColorList
;string[] MaterialList
;int expchg = 0
;float ContaminationTime = 0.0
;float HairGrowthTime = 1.0
;float ContractionTime = 0.0

Faction BaboDialogueFaction
Faction RadiantProstituteFaction

;ImageSpaceModifier Property BlackFade auto
ImageSpaceModifier Property BlackFade8 Auto

;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;>>>>>>>>>>>>>	PROPERTIES >>>>>>>>>>>>>>>>>>>> #properties

;>>>>>>>>	BOOL	   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> #bool

Bool Property PlayerDownAlready Auto
bool Property NakedCumming Auto

bool Property NYMRAsWorld Auto

bool Property AcheronEnabled Auto
bool Property PlayerIsInCombat Auto
bool Property Allow_Whipping Auto
bool Property Allow_EscapeGameAftermath Auto

Bool Property SlaveAuction Auto 

bool Property SuspendEventsSent  Auto

bool Property AbortAll Auto
	
bool Property NoCrawling Auto
bool Property PlayerMonitorOn Auto
bool Property SkipSex Auto
;bool Property Excite Auto	
bool Property NuditySLA Auto
;bool Property NudityUnderwear Auto
bool Property SexScene Auto
bool Property SexSceneBukkake Auto
bool Property AllowCreatures Auto
bool Property DefeatSpotAndEscape Auto

bool Property ToggleDeleteDevice Auto
bool Property DefeatSceneProtectors Auto
bool Property TCAIstatus Auto
bool Property InFurniture Auto
bool Property ModBiS Auto
bool Property ModBiS_R Auto
bool Property ModDDe Auto
bool Property ModDDframework Auto
bool Property ModDDNG Auto
bool Property ModSLUplus Auto
bool Property ModDEM Auto
bool Property ModPOP Auto
bool Property ModPLUGS Auto
bool Property ModPUBWHORE Auto
bool Property ModBABOdia Auto
bool Property ModPrecision Auto
bool Property ModdbChests Auto


bool Property IndecencyHaircut Auto
bool Property IndecencyBarefoot Auto
bool Property WhipAgain Auto
bool Property RapeAgain Auto
bool Property HarderDefeat Auto
bool Property Indecency Auto
bool Property Whipper00 Auto
bool Property Whipper01 Auto
bool Property Whipper02 Auto
Bool Property OrgasmRegistered Auto
bool Property ModEnabled Auto
bool Property ShowDebugMessages Auto
bool Property ShowInfoMessages Auto
bool Property ShowNarrativeMessages Auto
bool Property NymStripping Auto
bool Property NymSpawning Auto
bool Property HeelsFix Auto



bool Property NymBeta Auto
bool Property VRfix Auto
bool Property SSEfix Auto
bool Property Ragdoll Auto					
bool Property SimpleSurrender Auto
bool Property WeaponOutSurrender Auto
bool Property FemalesAllowed Auto
bool Property DefeatRobberyGold Auto
bool Property DefeatViaSurrender Auto
bool Property DefeatQuestRunning Auto		;checks if the Defeatquest is running (calmquest etc.)
bool Property CivilRapeRunning Auto
bool Property BoolCaptiveFuckBelt Auto
bool Property BoolCaptiveNoSound Auto
bool Property DefeatEnabled Auto
bool Property AllegianceShutdown Auto
bool Property DefeatBreakArmor Auto
bool Property NakedDrowning Auto

bool Property NakedLoot Auto
bool Property NakedLootHotkeys Auto
bool Property SSHandling Auto
bool Property DeviousPiercingEffects Auto

bool Property NakedTravel Auto
bool Property RemoveDDs Auto
bool Property GodMode Auto
bool Property HealthBoost Auto
bool Property NoEssentialPlayer Auto
bool Property PlayExpressions Auto

bool Property NakedBlur Auto
bool Property LagFix Auto

Bool Property WhipMarks Auto
Bool Property MaleFollower Auto
Bool Property FemaleFollower Auto
Bool Property DropItem Auto
Bool Property Slippery Auto
Bool Property StripAttack Auto
Bool Property NoExtra Auto
Bool Property StopCombatScan Auto
Bool Property MoanOnHit Auto
Bool Property DefeatGetUp Auto
bool Property Harmlessness Auto
Bool Property StealGold Auto
Bool Property Orgasm Auto 

Bool Property dhlpSuspendStatus Auto Conditional
Bool Property POPSuspendStatus Auto Conditional
Bool Property PWSuspendStatus Auto Conditional

bool[] Property BlockSlot Auto		;slots
;bool[] Property DunAllowed Auto
;bool[] Property DevAllowed Auto
;bool[] Property ExceptionList Auto

;--------
Bool Property SexFinished Auto
Bool Property SceneProtector Auto
Bool Property InitialAllegiance Auto

;-------- TOGGLES

Bool Property AllowArgonKajit Auto	;argonian/kajit
Bool Property AllowHumanoidBeasts Auto	;Gargoyles // Werewolves // Trolls // Giants // Lurkers

;ANIMALS
Bool Property AllowInsects Auto		;charus // chaurushunter // chaurusreaper // ashhopper
Bool Property AllowSkeevers Auto
Bool Property AllowSpiders Auto		;all spider sizes
Bool Property AllowSabreCats Auto
Bool Property AllowBears Auto
Bool Property AllowCanines Auto		;canines wolves&dogs
Bool Property AllowMammoths Auto
Bool Property AllowDragons Auto
Bool Property AllowNetches Auto

Bool Property AllowDwarven Auto		;all dwarven constructs

Bool Property AllowUndead Auto		;draugr // skelettons // dragonpriests // vampirelord 
Bool Property AllowRieklings Auto	;rieklings and boars
Bool Property AllowFalmers Auto
Bool Property AllowSpriggans Auto

;MISC
Bool Property AllowElementalsFemale Auto	;Atronach Flame // WispMothers // Hagravens
Bool Property AllowElementalsMale Auto		;Atronach Storm // Atronach Frost // Wisps // IceWraiths //
Bool Property AllowTentacleStuff Auto	;Seekers // Tentacle animations

;ANIMALS FARM
Bool Property AllowChicken Auto
Bool Property AllowHorses Auto
Bool Property AllowCows Auto
Bool Property AllowGoats Auto

;ANIMALS WILD
Bool Property AllowDeers Auto
Bool Property AllowFoxes Auto
Bool Property AllowRabbits Auto		;hare and stuff
Bool Property AllowHorkers Auto

;>>>>>>>>	INT	   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> #int

;--- nadeConfig.json ------------->

Int Property Scenario_XCross_Weight_VALUE Auto
Int Property Scenario_Pillory_Weight_VALUE Auto
Int Property Scenario_Wheel_Weight_VALUE Auto
Int Property Scenario_Stockade_Weight_VALUE Auto
Int Property Scenario_Armbinder_Weight_VALUE Auto
Int Property Scenario_Cuffs_Weight_VALUE Auto
Int Property Scenario_Rodeo_Weight_VALUE Auto
Int Property Scenario_ChainRape_Weight_VALUE Auto
Int Property Scenario_ForcedMasturbation_Weight_VALUE Auto
Int Property Scenario_Bukkake_Weight_VALUE Auto
Int Property Scenario_Girlfriend_Weight_VALUE Auto


;--- nadeConfig.json -------------<

Int Property Dead Auto
Int Property BlackFadeStatus Auto
Int Property SexState Auto
Int Property LastLocationID Auto
int Property FollowerCount Auto
int Property PublicExposure Auto
int Property ShortPunishment Auto
int Property IndecencyExceptionBound Auto
int Property IndecencyExceptionCollared Auto
int Property DefeatKey Auto		
int Property EscapeKey Auto		
int Property StripOptions Auto Conditional			;simple as INT in the ESP 
int Property WiggleOptions Auto Conditional
int Property WiggleOptionsSS Auto Conditional

int Property DefeatFindSpot Auto Conditional	;ESP Default value 1 (unlimited time)
int Property DefeatEscapeCrawl Auto Conditional	;ESP Default value 1 (unlimited time)
	
int Property IndecencyGender Auto Conditional
int Property LoadGameCountdown Auto

int Property CrimeGoldToGet Auto


Int Property MiscObjectCount Auto
Int Property KeywordCount Auto

int[] Property TheftWeight Auto
int[] Property OutcomeWeights Auto
Int[] Property ExposureChange Auto

;>>>>>>>>	FLOAT	   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> #float

float Property IndecencyRapeProb Auto
float Property ValidWhipper Auto
float Property IndecencyRobberyProb Auto
float Property PoisonDefeatChance Auto
float Property FollowerProb Auto
float Property DefeatPeeProb Auto
float Property FindSpotTime Auto
float Property SearchRadius Auto
float Property SearchRadiusInterior Auto
float Property DefeatIdleTime Auto
float Property BondageHaircutProb Auto
float Property ExposureChance Auto
float Property PunishShortProb Auto
float Property DefeatArrestProb Auto
float Property DefeatShortProb Auto
float Property HairRegrowthTime Auto

float Property RemoveDDChance Auto

;int Property DebugKey Auto			
;float Property DefeatMultiProb Auto
float Property DefeatChainProb Auto
float Property DefeatForeplayChance Auto
float Property DefeatEscapeDiff Auto	;Difficulty Slider
float Property DefeatRobberyProb Auto
float Property NakedDeathChance Auto


float Property DefeatRescueProb Auto
float Property FemalesAsMales Auto
float Property BleedoutCounter Auto	;DefeatChance on Bleedout
float Property DefeatDDeProb Auto
float Property DefeatSlaveryProb Auto
float Property DefeatSDweight Auto
float Property DefeatCaptivityProb Auto
float Property CooperativeSurrenderChance Auto
float Property DefeatEscTime Auto
float Property DefeatSpeedMult Auto


float Property DefeatThrowOutProb Auto
float Property ProxGuardDetected Auto
float Property ProxActorDetected Auto
float Property DefeatBreakClothingProb Auto
float Property DefeatBreakLightProb Auto
float Property DefeatBreakHeavyProb Auto
float Property DefeatWhipProb Auto
float Property DefeatWhipTime Auto
float Property WhipmarksDur Auto
float Property RapeHandsProb Auto
float Property Group5Pchance Auto
float Property Group4Pchance Auto
float Property Group3Pchance Auto
float Property ScenarioChance Auto

float Property PunishWhipChance Auto
float Property PunishSexChance Auto
float Property PunishBukkakeChance Auto
float Property DefeatDeathChance Auto

bool Property StageGoBack Auto

float Property DebugPunishmentType Auto
;civil rape sliders
float Property LoopTime Auto
float Property Naked_Weight Auto
float Property Barefoot_Weight Auto
float Property Dirty_Weight Auto
float Property Sneaking_Weight Auto
float Property Running_Weight Auto
float Property Sprinting_Weight Auto
float Property Cum_Weight Auto
float Property Unarmed_Weight Auto

;#STRING 

string Property PlayPose Auto
string Property PlayPose02 Auto
string Property DefeatBindsEquipped Auto
string[] Property StripOptionsList Auto		;THESE DO NOT NEED TO BE IN THE ESP SOMEHOW
string[] Property WiggleOptionsList Auto	;THESE ARE NOT IN THE ESP SOMEHOW
string[] Property WiggleOptionsSSList Auto	;THESE ARE NOT IN THE ESP SOMEHOW

string[] Property DefeatFindSpotList Auto	;THESE ARE NOT IN THE ESP SOMEHOW
string[] Property DefeatEscapeCrawlList Auto	;THESE ARE NOT IN THE ESP SOMEHOW

string Property DefeatStateChapter = "none" Auto
string Property DefeatStatePlayer = "free" Auto

string Property AllegianceScanType Auto

String Property Allow_EscapeDifficulty Auto
String[] Property PosesDefeat Auto
String[] Property PosesWhip Auto

;"Free"
;"Bathing"

;"Suspended"

;"Waiting"
;"Fucked"
;"ForcedBathing"
;"Bukkake"
;"Whipped"
;"Bound"

;"Watched"


String Property DefeatTransition Auto		;No Longer in Use 
String Property DefeatEntranceVia Auto

string Property DefeatStateBindings = "Unbound" Auto
Armor[] Property DefeatClothingNew Auto
Armor[] Property DefeatGagsNew Auto
Armor[] Property DefeatCollar Auto ;CAREFULL, only use nade_Collars


Armor Property WristChains_R Auto
Armor Property WristChains_L Auto


;0 Iron Black
;1 Iron Gold
;2 Rope Extreme 01
;3 Collar Harness 
;4 Collar Leather Binds (like a belt)

;[0] = BreastRopeExtreme021
;[1] = BodyBondageShibari
;[2] = HoodLight

;test test
static[] Property Scene_Protector Auto
static Property TestFloor Auto		;hay with fur
static Property TestFloor02 Auto	;hay without fur
static Property TestFloor03 Auto	;stone
static Property TestFloor04 Auto

;bool Property Obesity Auto
Actor[] Property Followers Auto

ActorBase[] Property NakedBandits auto
ActorBase[] Property NakedUndead auto
 ; #ghosts
ActorBase[] Property GhostsHuman auto
; #animals
ActorBase Property SpawnedDog01 auto 
ActorBase Property SpawnedHorse01 auto 
ActorBase Property SpawnedSkeever01 auto  
ActorBase Property SpawnedTroll01 auto 
ActorBase Property SpawnedGoat01 auto  

ActorBase Property NakedAtronachStorm auto
ActorBase Property NakedDragonpriest auto
ActorBase Property NakedSeeker auto
ActorBase Property NakedGargoyle auto
ActorBase Property NakedVampirelord auto

Actor crosshairRef = None			

ObjectReference[] Property FollowerContainers Auto
Outfit[] Property Outfits Auto

Keyword Property KeywordVampire Auto
;Keyword[] Property Keywords Auto
;Keyword[] Property KeywordExceptionList Auto
Keyword Property KeywordArmorHelmet Auto
Keyword Property SexLabNoStrip Auto

MiscObject[] Property MiscObjects Auto
MiscObject[] Property MiscObjectExceptionList Auto

Spell[] Property SpellsNecromancers Auto
Spell Property StalkerSpell Auto
Spell Property CrimeSpell Auto
;Spell Property BarefootSpell Auto
Spell Property FrostSpell Auto			
Spell Property ShockSpell Auto			
Spell Property SoundSpell Auto			
Spell Property FireSpell Auto			
Spell Property PainSpell Auto			

Spell[] Property PotionDurationHealth Auto	
Spell[] Property PotionDurationMagicka Auto
;Spell[] Property PotionDurationStamina Auto

Int Property PotionDurationHealthStrenght Auto
Int Property PotionDurationStaminaStrenght Auto

Bool Property FirstStartUp Auto

Int Property CaptiveQuestFuckbeltNumber Auto

Idle[] Property IdlesHumanSurrender Auto		;06

Idle[] Property IdlesHumanDefeat Auto		;06	;try repair and replace
Idle[] Property IdlesAnimalDefeat Auto		;03

Idle Property IdlesHumanSurrender_01 Auto
Idle Property IdlesHumanSurrender_02 Auto
Idle Property IdlesHumanSurrender_03 Auto
Idle Property IdlesHumanSurrender_04 Auto
Idle Property IdlesHumanSurrender_05 Auto
Idle Property IdlesHumanSurrender_06 Auto

Idle Property IdleWorkbench Auto

Idle[] Property IdlesDefeatCuffs Auto	;20
Idle[] Property IdlesDefeatCuffsStruggle Auto	;10

Idle[] Property IdlesDefeatYoke Auto	;15
Idle[] Property IdlesDefeatYokeStruggle Auto	;17

;Idle[] Property IdlesDefeatSurrender Auto	;1

Idle[] Property IdlesBoundWithYoke Auto	;6 ;WHAT FOOOR

Idle[] Property IdlesDefeatUnbound Auto

Idle[] Property IdlesFixHair Auto

Idle[] Property IdlesDefeatPillory Auto				;12 of 20 	-[0] is 01
Idle[] Property IdlesDefeatPilloryStruggle Auto		;17 of 20 	-[0] is 01
Idle[] Property IdlesDefeatBigPoleStruggle Auto		;7 of 20 	-[0] is 00

Idle[] Property IdlesDefeatImpaled Auto		;1 of ???

Idle[] Property IdlesDefeatCrux Auto	

Idle[] Property IdlesBathingStanding Auto	;9
;/
[0] Wipe Head (Finish)
[1] Wipe Body (Equip Body?)
[2] Wipe Belly and Wipe Thighs (Equip Boots?)
[3] Forearmes (equip Gauntlets?
[4] Wipe Upper arms
[5] wipe hands
[6] Rub Pussy (maybe at the end of equip sequence?
[7] Wash Pussy
[8] Wash Belly and Pussy
/;

; [0] nade_Yoke_01_BOUND_01 
; [1] nade_Yoke_01_BOUNDstruggle_01 
; [2] nade_Yoke_01_BOUNDstruggle_02 

; [3] nade_Yoke_02_BOUND_01 
; [4] nade_Yoke_02_BOUND_02 
; [5] nade_Yoke_02_BOUNDstruggle_01 

;Bool Property LastLocationTrapped Auto
GlobalVariable Property TrapActive Auto
Quest Property ErrandQuest Auto
Quest Property CloakQuest Auto
Quest Property DefeatQuest Auto		;nade_defeatquest_qf_scr
Quest Property CalmQuest Auto
Quest Property CaptureQuest Auto
Quest Property CaptiveQuest Auto
Quest Property AllegianceQuest Auto
Quest Property CrimeQuest Auto	
Quest Property ProximityQuest Auto

Quest Property CityQuest Auto

Quest Property nade_CaptureQuest Auto
Quest Property robqst Auto
;Quest Property robqst_02 Auto
nade_robbedquest_02_qf_scr Property robqst_02 Auto
nade_robbedquest_03_qf_scr Property robqst_03 Auto
nade_robbedquest_04_qf_scr Property robqst_04 Auto
nade_robbedquest_05_qf_scr Property robqst_05 Auto

nade_FollowerIdleQuest_01_qf_scr Property folidle01 Auto
nade_FollowerQuest_qf_scr Property folqst Auto

Spell Property SpellLootCooldown Auto

ObjectReference[] Property LocSlaveryCivil Auto

LocationAlias[] Property LocAlias Auto
ObjectReference Property SafeCont Auto
SexLabFramework Property SexLab Auto
Keyword Property ActorTypeNPC Auto
Keyword Property ActorTypeCreature Auto

Keyword Property ArmorClothing Auto
Keyword Property ArmorLight Auto
Keyword Property ArmorHeavy Auto



Sound Property HaircutSound Auto
Sound[] Property Breathing Auto		;links to five Sound Descripts that are in the array [0] and are played random
Sound[] Property SoundCuffsRope Auto
Sound[] Property SoundCuffsMetal Auto
Sound[] Property SoundPeeLong Auto
Sound[] Property SoundPeeShort Auto
Sound[] Property SoundFuckBelt Auto
Sound[] Property SoundProximity Auto

Sound[] Property SoundGagFemale Auto
Sound[] Property SoundGagMale Auto
Sound[] Property SoundOrgasmFemale Auto
		
Sound[] Property SoundLootTrap2 Auto ;[0] Trap01 (hard trap) and [1] Trap02 (light trap)??? sounds to judge which key to press		
Sound[] Property SoundCombat2 Auto	;[0] Blocked [1] Stripped

Armor[] Property ItemsHRchains Auto

Armor[] Property ArmorEmpty Auto

Actor Property PlayerRef Auto
slaFrameworkScr Property sla Auto
slaMainScr Property slamain Auto

nade_calmquest_qf_scr Property calmqst Auto

nade_proximityquest_qf_scr Property proxqst Auto
;nade_configquest_playeralias_scr Property cfgqstP Auto

String Property DevTags Auto
String Property NullTags Auto

String Property SavedPunishment_01 = "pain" Auto		;TEXTX			;WHAT IS THIS? OLD? CAN WE RE-USE THIS? #TODO
String Property SavedPunishment_02 = "pain" Auto		;TEXTX
String Property SavedPunishment_03 = "pain" Auto		;TEXTX
String Property SavedPunishment_04 = "belt" Auto		;TEXTX
String Property SavedPunishment_05 = "belt" Auto		;TEXTX
String Property SavedPunishment_06 = "belt" Auto		;TEXTX
String Property SavedPunishment_07 = "whip" Auto		;TEXTX
String Property SavedPunishment_08 = "whip" Auto		;TEXTX
String Property SavedPunishment_09 = "rape" Auto		;TEXTX
String Property SavedPunishment_10 = "rape" Auto		;TEXTX

String Property SavedText_01 = "nade_01" Auto		;TEXTX
String Property SavedText_02 = "nade_02" Auto		;TEXTX
String Property SavedText_03 = "nade_03" Auto		;TEXTX
String Property SavedText_04 = "nade_04" Auto		;TEXTX
String Property SavedText_05 = "nade_05" Auto		;TEXTX
String Property SavedText_06 = "nade_01" Auto		;TEXTX
String Property SavedText_07 = "nade_02" Auto		;TEXTX
String Property SavedText_08 = "nade_03" Auto		;TEXTX
String Property SavedText_09 = "nade_04" Auto		;TEXTX
String Property SavedText_10 = "nade_05" Auto		;TEXTX

String Property SavedNames_01 = "enter name" Auto		;TEXTX

String Property SavedTags_01 = "aggressive" Auto		;TEXTX
String Property SavedTags_02 = "aggressive" Auto		;TEXTX
String Property SavedTags_03 = "aggressive" Auto		;TEXTX
String Property SavedTags_04 = "aggressive" Auto		;TEXTX
String Property SavedTags_05 = "empty" Auto		;TEXTX

String Property SavedHair_00 = "SavedHair_00" Auto		;TEXTX
String Property SavedHair_01 = "SavedHair_01" Auto		;TEXTX
String Property SavedHair_02 = "SavedHair_02" Auto		;TEXTX
String Property SavedHair_03 = "SavedHair_03" Auto		;TEXTX
String Property SavedHair_04 = "SavedHair_04" Auto		;TEXTX
String Property SavedHair_05 = "SavedHair_05" Auto		;TEXTX
String Property SavedHair_06 = "SavedHair_06" Auto		;TEXTX
String Property SavedHair_07 = "SavedHair_07" Auto		;TEXTX
String Property SavedHair_08 = "SavedHair_08" Auto		;TEXTX
String Property SavedHair_09 = "SavedHair_09" Auto		;TEXTX
String Property SavedHair_10 = "SavedHair_10" Auto		;TEXTX

;switch betweeen forced and original
String Property SavedHair_11 = "SavedHair_11" Auto		;TEXTX
String Property SavedHair_12 = "SavedHair_12" Auto		;TEXTX
String Property SavedHair_13 = "SavedHair_13" Auto		;TEXTX
String Property SavedHair_14 = "SavedHair_14" Auto		;TEXTX
String Property SavedHair_15 = "SavedHair_15" Auto		;TEXTX

;more original hairstyles
String Property SavedHair_16 = "SavedHair_16" Auto		;TEXTX
String Property SavedHair_17 = "SavedHair_17" Auto		;TEXTX
String Property SavedHair_18 = "SavedHair_18" Auto		;TEXTX
String Property SavedHair_19 = "SavedHair_19" Auto		;TEXTX
String Property SavedHair_20 = "SavedHair_20" Auto		;TEXTX

;GetEnemyType & GetDefeatType
String[] Property Enemy Auto	
String Property RaceKey = "none" Auto	
	
String Property DefeatType = "none" Auto		
String Property DefeatTypeGeneral = "none" Auto
String Property DefeatTypeScenario = "none" Auto	
	

HeadPart[] Property HairStages Auto
;GlobalVariable Property nade_AskedThrough Auto
;GlobalVariable Property nade_DeflationRunning Auto
;Keyword Property zbfEffectNoFighting Auto
;Keyword Property zbfWornCollar Auto

MiscObject Property Gold001 Auto

FormList Property nade_MageList Auto
FormList Property nade_HumanList Auto
FormList Property nade_HumanoidList Auto
FormList Property nade_BeastRaceList Auto
FormList Property nade_VampireList Auto

FormList Property Outfit_01 Auto
FormList Property Outfit_02 Auto
FormList Property Outfit_03 Auto
FormList Property Outfit_04 Auto
FormList Property Outfit_05 Auto

FormList [] Property Outfit_JSON_FList Auto		;20 lenghts (0 and 1 is both Formlist 01)

FormList [] Property Weapon_JSON_FList Auto		;20 lenghts (0 and 1 is both Formlist 01)

FormList Property PunishmentOutfit_01 Auto
FormList Property PunishmentOutfit_02 Auto
FormList Property PunishmentOutfit_03 Auto
FormList Property PunishmentOutfit_04 Auto
FormList Property PunishmentOutfit_05 Auto

FormList Property RobbedStuff Auto
int Property RobbedGold Auto

GlobalVariable Property nade_Stomach Auto

;::::::::::::::::::::::::::: #FACTIONs ::::::::::::::::::::::::::::::::::::::::::::::::::::::

Faction Property zbfSlaveFaction Auto
Faction Property GuardDiaogueFaction Auto
Faction Property nade_HarmlessFaction Auto
Faction Property nade_DefeatFaction Auto
Faction Property ProtectedActorFaction Auto

Faction Property RobberFaction Auto	;to prevent robbers from doing 2 robberies

Faction Property NakedGhostFaction Auto
Faction Property SexLabAnimatingFaction Auto
Faction Property BanditFaction Auto
Faction Property CrawlFaction Auto		;nade_crawlFaction "Crawl Faction" [FACT:07005AFF]
Faction Property DownedFaction Auto

Faction Property EnemyFaction Auto

Faction Property AcheronEnemyFaction Auto
Faction Property AcheronVictimFaction Auto


Faction Property PlayerFollowerFaction Auto
Faction Property CurrentFollowerFaction Auto
Faction Property NadeFollower01Faction Auto

Faction[] Property FactionsHumanoid Auto
Faction[] Property FactionsPredators Auto
Faction[] Property FactionsPrey Auto

;LeveledItem Property nade_MetabolismPotions Auto
;LeveledItem Property PotionsMerchant Auto
;LeveledItem Property PotionsApothecary Auto
GlobalVariable Property TimeScale Auto
float Property DefeatDowntime Auto


bool changehair = true

;Bool popSuspendStatus = false

Faction[] Property CrimeFactions Auto
Float[] Property TimeSpentInHold Auto
;Float[] Property HoldTaxDue Auto
;nade_inwaterutilquest_qf_scr Property InWaterUtil Auto
nade_infurnitureutilquest_qf_scr Property InFurnitureUtil Auto


ObjectReference Property LastAddedDevice Auto
ObjectReference Property CreatedCarpet Auto
String[] Property PoseLoadOptions Auto
Float Property PoseIntervalShowPussy Auto
Float Property PoseIntervalShowAss Auto
Float Property PoseIntervalPeeHi Auto
Float Property PoseIntervalPeeLo Auto
Float Property PoseIntervalDeflate Auto
Float Property PoseIntervalShower Auto
Float Property PoseIntervalBath Auto
Float Property PoseIntervalPiercing Auto
Float Property PoseIntervalShave Auto
Float Property CrimeInterval Auto
Float Property CriticalDefeat Auto
Float Property NakedChance Auto
Float Property MoanOnHitChance Auto


Float Property Leniency Auto

Bool HasKWDSexlabNoStrip = false 

Keyword Property nade_HairGrowth Auto
Keyword Property KWDLootCooldownEffect Auto
Keyword Property KWDPotionDurationHealthEffect Auto
Keyword Property KWDPotionDurationMagickaEffect Auto

Keyword Property KWD_Zaz_InventoryDevice Auto

;Keyword Property KWDPotionDurationStaminaEffect Auto

Bool Function IsRadiantProstitute()
	if ModRadPros && PlayerRef.IsInFaction(RadiantProstituteFaction)
	return true
	else
	return false
	endif
EndFunction


string Function GetDevName(FormList List, Int Index = -1)
	if !List || (Index < 0) || (Index >= List.GetSize())
		return "None"
	else
		return List.GetAt(Index).GetName()
	endif
EndFunction

;Bool Function CanUpdateNiNodes(Actor akActor)
;	return !(akActor.IsOnMount() || akActor.HasKeyword(RidingInCarriage) || akActor.IsInFaction(CarriageSystemFaction))
;EndFunction

Int Function IndexOfInt(Int Value, Int[] List)
	Int i = List.Length - 1
	while (i >= 0) && (Value != List[i])
		i -= 1
	endwhile
	return i
EndFunction

Int Function IndexOfLoc(Location Value, Location[] List)
	Int i = List.Length - 1
	while (i >= 0) && (Value != List[i])
		i -= 1
	endwhile
	return i
EndFunction

Int Function IndexOfActor(Actor value, Actor[] List)
	Int i = List.Length - 1
	while (i >= 0) && (Value != List[i])
		i -= 1
	endwhile
	return i
EndFunction

Int Function IndexOfNone(Actor[] List)
	Int i = List.Length - 1
	while (i >= 0) && List[i]
		i -= 1
	endwhile
	return i
EndFunction

String Function DecimalStr(Float value, Int divider = 1)
	int i
	string s = ""

	if value<0
		s="-"
		i = Math.Ceiling(-divider*value)
	else	
		i = Math.Ceiling(divider*value)
	endif
	
	return s+i/divider+"."+i%divider
EndFunction

Function Notify(String txt, Bool box = false)
	if box
		Debug.MessageBox(txt)
	else
		Debug.Notification(txt)
	endif
EndFunction

Function AddVictimsToCalmFactions(bool add)

	if add	
		Debug.Trace("NAKED DEFEAT configquest: AddVictimsToCalmFactions(ADD)")
		if !PlayerRef.IsInFaction(nade_DefeatFaction)
		PlayerRef.AddToFaction(nade_DefeatFaction)
		endif 
	
		if !PlayerRef.IsInFaction(ProtectedActorFaction)
		PlayerRef.AddToFaction(ProtectedActorFaction)
		endif

		if folqst.Actor_Follower01 && !folqst.Actor_Follower01.IsInFaction(nade_DefeatFaction)
		folqst.Actor_Follower01.AddToFaction(nade_DefeatFaction)
		endIf
		if folqst.Actor_Follower02 && !folqst.Actor_Follower02.IsInFaction(nade_DefeatFaction)
		folqst.Actor_Follower02.AddToFaction(nade_DefeatFaction)
		endIf
		
		if folqst.Actor_Follower01 && !folqst.Actor_Follower01.IsInFaction(ProtectedActorFaction)
		folqst.Actor_Follower01.AddToFaction(ProtectedActorFaction)
		endif
		if folqst.Actor_Follower02 && !folqst.Actor_Follower02.IsInFaction(ProtectedActorFaction)
		folqst.Actor_Follower02.AddToFaction(ProtectedActorFaction)
		endif
		
		;/if folqst.Actor_Follower03
		folqst.Actor_Follower03.AddToFaction(nade_DefeatFaction)
		endIf
		if folqst.Actor_Follower04
		folqst.Actor_Follower04.AddToFaction(nade_DefeatFaction)
		endIf
		if folqst.Actor_Follower05
		folqst.Actor_Follower05.AddToFaction(nade_DefeatFaction)
		endIf
		/;
		
	else
		Debug.Trace("NAKED DEFEAT configquest: AddVictimsToCalmFactions(REMOVE)")
		if PlayerRef.IsInFaction(nade_DefeatFaction)	
		PlayerRef.RemoveFromFaction(nade_DefeatFaction)
		endif 
		
		if !PlayerRef.IsInFaction(ProtectedActorFaction)
		PlayerRef.AddToFaction(ProtectedActorFaction)
		endif

		if folqst.Actor_Follower01 && folqst.Actor_Follower01.IsInFaction(ProtectedActorFaction)
		folqst.Actor_Follower01.RemoveFromFaction(ProtectedActorFaction)
		endIf
		if folqst.Actor_Follower02 && folqst.Actor_Follower02.IsInFaction(ProtectedActorFaction)
		folqst.Actor_Follower02.RemoveFromFaction(ProtectedActorFaction)
		endIf

		if folqst.Actor_Follower01 && folqst.Actor_Follower01.IsInFaction(nade_DefeatFaction)
		folqst.Actor_Follower01.RemoveFromFaction(nade_DefeatFaction)
		endIf
		if folqst.Actor_Follower02 && folqst.Actor_Follower02.IsInFaction(nade_DefeatFaction)
		folqst.Actor_Follower02.RemoveFromFaction(nade_DefeatFaction)
		endIf
	;/
		if folqst.Actor_Follower03
		folqst.Actor_Follower03.RemoveFromFaction(nade_DefeatFaction)
		endIf
		if folqst.Actor_Follower04
		folqst.Actor_Follower04.RemoveFromFaction(nade_DefeatFaction)
		endIf
		if folqst.Actor_Follower05
		folqst.Actor_Follower05.RemoveFromFaction(nade_DefeatFaction)
		endIf
		/;
	endIf
EndFunction
			
String Function GetBaseObjectName(ObjectReference ObjRef = None)
	String s = "None"
	if ObjRef
		Form f = ObjRef.GetBaseObject()
		if f
			s = f.GetName()
		endif
	endif
	return s
EndFunction


String Function GetActorInfo(Actor akActor = None)			
	String s = "None"
	if akActor																		;this returns (( human=true / false)))
		s = akActor.GetLeveledActorBase().GetName()+" (race="+akActor.GetRace().GetName()+", human="+IsHuman(akActor)+", humanoid="+IsHumanoid(akActor)+", sex="+akActor.GetActorBase().GetSex()+", gender="+SexLab.GetGender(akActor)+")"
	endif
	return s
EndFunction

String Function GetActorRace(Actor akActor = None)			
	String s = "None"
	if akActor																		;this returns (( human=true / false)))
		s = (akActor.GetRace().GetName())
	endif
	return s
EndFunction

String Function GetLeveledActorBaseName(Actor akActor = None)
	String s
	if akActor
		s = akActor.GetLeveledActorBase().GetName()
	elseif !s
		s = akActor.GetBaseObject().GetName()
	elseif !s
		s = akActor.GetName()
	endif 
	return s
EndFunction

String Function GetObjectDisplayName(ObjectReference ObjRef = None)
	String s = "None"
	if ObjRef
		s = ObjRef.GetDisplayName()
	endif
	return s
EndFunction


;FOLLOWER ITEMS MIGHT BE USEFULL LATER
;/
Function GiveBackFollowerItems()
	ObjectReference o
	
	Int i = Followers.Length
	while i
		i -= 1
		if FollowerContainers[i].GetNumItems()
			if Followers[i] && !Followers[i].IsDeleted() && Followers[i].IsEnabled() && !Followers[i].IsDead()
				o = Followers[i]
				if Outfits[i]
					Int j = Outfits[i].GetNumParts()
					while j
						j -= 1
						Followers[i].AddItem(Outfits[i].GetNthPart(j), 1)
					endwhile
					Followers[i].GetActorBase().SetOutfit(Outfits[i])
				endif
			else
				o = PlayerRef
			endif
			FollowerContainers[i].RemoveAllItems(o, true, true)
		endif
		Followers[i] = None
	endwhile
EndFunction
/;

;/
Int Function GetRandomIndexFromWeights(Int[] Weights)
	Int j = 0
	Int i = Weights.Length
	while i
		i -= 1
		j += Weights[i]
	endwhile
	if j
		Int k = Utility.RandomInt(1, j)
		i = Weights.Length
		while i && (k <= j)
			i -= 1
			j -= Weights[i]
		endwhile
		return i
	else
		return 0
	endif
EndFunction
/;

;---------------------------------------------------------------------------------------------------------------------------

;Bool Function IsHuman(Actor akRef)				
;	return akRef && nade_HumanList.HasForm(akRef.GetRace())
;EndFunction

;---------------------------------------------------------------------------------------------------------------------------#

Bool Function IsSuspended()

if IsDefeatRunning()
return true
endif

if dhlpSuspendStatus
	if PublicExposure > 0
	PublicExposure = 0
	endif
return true
elseif ModPOP && IsArrestedPOP()
	if PublicExposure > 0
	PublicExposure = 0
	endif
	return true
elseif ModPUBWHORE && PWSuspendStatus
	if PublicExposure > 0
	PublicExposure = 0
	endif
return true

;/ no grace period for the time beeing
elseif GracePeriod > 0
	
	if (GracePeriod == 5) || (GracePeriod == 10) || (GracePeriod == 15) || (GracePeriod == 20) || (GracePeriod == 25) || (GracePeriod == 30) || (GracePeriod == 35) || (GracePeriod == 40) || (GracePeriod == 50)
	ScreenMessage("You are still recovering from your last punishment [No Exposure]")
	endIf
	
	if GracePeriod > 0
	GracePeriod -= 1
	endif
	if GracePeriod < 0
	GracePeriod = 0
	endif
	InfoMessage("No Exposure Change (GracePeriod), remaining loopticks: "+GracePeriod)
	
	if PublicExposure > 0
	PublicExposure = 0
	endif
	
return true	
/;
else
return false
endIf

EndFunction

Bool Function IsFucking(Actor akactor)
if akactor.IsInFaction(SexLabAnimatingFaction)
return true
else
return false
endIf
EndFunction

Bool Function IsHuman(Actor akRef)				;#human (REWRITTEN)

string TempRaceKey = GetRaceKey(akRef)
bool HasRaceKey = false
int TempGender = SexLab.GetGender(akRef)

if TempRaceKey
HasRaceKey = true
endif

;if ShowDebugMessages
;Debug.Trace("NAKED DEFEAT configquest: IsHuman() Name: "+akRef.GetBaseObject().GetName())
;Debug.Trace("NAKED DEFEAT configquest: IsHuman() RaceKey: "+TempRaceKey)
;endif

;if actor is a creature by sexlab definition -> no human
if TempGender == 2 
return false
;if not actor has gender 0 or 1. Now check if it has a racekey. IF so, the actor is invalid because humans have no racekey
elseif TempRaceKey == "Humans"
;HasRaceKey = false
Debug.Trace("NAKED DEFEAT configquest: #NOTE is human with RaceKey: "+akRef.GetBaseObject().GetName())  
return true
;actor has gender 0 or 1 AND no Racekey
elseif TempGender < 2
return true

endif

;	return akRef && nade_HumanList.HasForm(akRef.GetRace())
EndFunction

;---------------------------------------------------------------------------------------------------------------------------
Bool Function IsMale(Actor akRef)				;#male
if SexLab.GetGender(akRef) == 0 
return true
else
return false
endIf
EndFunction
;---------------------------------------------------------------------------------------------------------------------------

Bool Function IsBeastRace(Actor akRef)		;#beastrace
	return akRef && nade_BeastRaceList.HasForm(akRef.GetRace())
EndFunction

;---------------------------------------------------------------------------------------------------------------------------
;/
Bool Function IsVampire(Actor akRef)
	return akRef && nade_VampireList.HasForm(akRef.GetRace())
EndFunction
/;
;---------------------------------------------------------------------------------------------------------------------------

Bool Function IsVampire(Actor akRef)		;#vampire
	
	if akRef.HasKeyword(KeywordVampire)
	return true
	;Debug.Notification("NAKED DEFEAT: this actor is a VAMPIRE: "+akRef.GetBaseObject().GetName())
	Debug.trace("NAKED DEFEAT configquest: this actor is a VAMPIRE: "+akRef.GetBaseObject().GetName())
	else
	return false
	endif
	
	;return akRef && nade_VampireList.HasForm(akRef.GetRace())
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

Bool Function IsNecromancer(Actor akRef)
	
	Faction NecromancerFaction 
	NecromancerFaction = (Game.GetFormFromFile(0x00034B74, "Skyrim.esm") As Faction)
	if akRef.IsInFaction(NecromancerFaction)
	return true
	elseif akRef.HasSpell(SpellsNecromancers[0]) || akRef.HasSpell(SpellsNecromancers[1]) || akRef.HasSpell(SpellsNecromancers[2]) || akRef.HasSpell(SpellsNecromancers[3])
	return true
	;Debug.Notification("NAKED DEFEAT: this actor is a NECROMANCER: "+akRef.GetBaseObject().GetName())
	Debug.trace("NAKED DEFEAT configquest: this actor is a NECROMANCER: "+akRef.GetBaseObject().GetName())
	else
	return false
	endif
	
	;return akRef && nade_VampireList.HasForm(akRef.GetRace())
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

Bool Function IsBaboNPC(Actor akRef)
	if akRef.IsInFaction(BaboDialogueFaction)	
		return true	
	else
		return false			
	endif
EndFunction

Bool Function IsHumanoid(Actor akRef)
	if akRef
		Race r = akRef.GetRace()
		return r && (nade_HumanList.HasForm(r) || nade_HumanoidList.HasForm(r))		
	else
		return false			
	endif
EndFunction

Bool Function IsSlave(Actor akRef)
	if akRef.IsInFaction(zbfSlaveFaction)	
		return true	
	else
		return false			
	endif
EndFunction


Bool Function IsDefeatRunning()			;#IsDefeatRunning()
	if DefeatQuestRunning || CivilRapeRunning
	return true
	else
	return false
	endif
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

Bool Function IsMage(Actor akRef)	

actorbase abActor = akRef.GetBaseObject() as ActorBase

return nade_MageList.HasForm(abActor.GetClass())

;Debug.Notification("NAKED DEFEAT: this actor is a MAGE: "+akRef.GetBaseObject().GetName())
Debug.trace("NAKED DEFEAT configquest: this actor is a MAGE: "+akRef.GetBaseObject().GetName())

EndFunction

;---------------------------------------------------------------------------------------------------------------------------

Bool Function IsDragon(Actor akRef)
	if akRef
		Race r = akRef.GetRace()
		return r && r.CanFly()
	else
		return false
	endif
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

Bool Function IsGuard(Actor akRef)
	if akRef.IsInFaction(GuardDiaogueFaction)
		return true
	else
		return false
	endif
EndFunction

Bool Function IsFollower(Actor akactor)		;#Follower

Actor aToCheck = akactor

;if !SexLab.GetGender(aToCheck) == 1 || !SexLab.GetGender(aToCheck) == 2	;is not male or female
;return false
if aToCheck.IsInFaction(CurrentFollowerFaction)	;this is the faction A the ESP scans for in followerquest
return true
elseif aToCheck.IsInFaction(PlayerFollowerFaction) ;this is the faction B the ESP scans for in followerquest
return true
elseif aToCheck.IsInFaction(NadeFollower01Faction) ;this is the faction B the ESP scans for in followerquest
return true
;elseif aToCheck.GetBaseObject().GetName() == "Sofia" ;custom name tags from MCM (5 should be enough?)
;check names for extra savety (grrrrr)
else
return false 
;RISKY: 
; String akName = aToCheck.GetActorBase().GetName()
;	if (akName == folqst.Name_Follower01) || (akName == folqst.Name_Follower02) || (akName == folqst.Name_Follower03) || (akName == folqst.Name_Follower04) ||(akName == folqst.Name_Follower05)
;	return true
;	else
;	return false
;	endif
	
endif
EndFunction
;---------------------------------------------------------------------------------------------------------------------------

;Bool Function IsPlayerHandsBound()
;	return (PlayerRef.WornHasKeyword(libs.zad_DeviousArmbinder) || PlayerRef.WornHasKeyword(zad_DeviousArmbinderQuest) || PlayerRef.WornHasKeyword(libs.zad_DeviousYoke) || PlayerRef.WornHasKeyword(zad_DeviousYokeQuest) || PlayerRef.WornHasKeyword(zbfEffectNoFighting))
;EndFunction

;Bool Function IsPlayerCollared()
;	return (PlayerRef.WornHasKeyword(libs.zad_DeviousCollar) || PlayerRef.WornHasKeyword(zbfWornCollar))
;EndFunction

Bool Function IsPlayerNaked()				;CHECKS FOR NUDITY FOR HARMLESS Quest
Form a = PlayerRef.GetWornForm(0x00000004)	;32 - BODY
if a 
return false
else
return true
endif



;	return ((NuditySLA && slamain.IsActorNakedExtended(PlayerRef)) || !PlayerRef.GetWornForm(0x00000004))	&& !(NudityUnderwear && PlayerRef.GetWornForm(0x04000000) && PlayerRef.GetWornForm(0x00080000))
EndFunction

;/
Bool Function IsPlayerNaked()				;CHECKS FOR NUDITY FOR HARMLESS Quest

if !PlayerRef.GetWornForm(0x00000004) ;check BODY (Slot 32)
return true

	return ((NuditySLA && slamain.IsActorNakedExtended(PlayerRef)) || !PlayerRef.GetWornForm(0x00000004))	&& !(NudityUnderwear && PlayerRef.GetWornForm(0x04000000) && PlayerRef.GetWornForm(0x00080000))
EndFunction
/;

;---------------------------------------------------------------------------------------------------------------------------

Bool Function IsPlayerCumsoaked()			;MY FUNCTION CHECKS FOR CUM ON PC and reports to CrimeQuest for Whipping
;	SexLab.GetSexlabInstance() 

	return ((Sexlab.CountCum(PlayerRef, True, True, True)>0))
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

Bool Function IsPlayerRunning()	;notworking		
	
	return PlayerRef.IsSprinting()
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

Bool Function IsPlayerBarefoot()
	return !PlayerRef.GetWornForm(0x00000080)
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

Bool Function IsPlayerUnarmed()

	Spell spl

	Int rhand = PlayerRef.GetEquippedItemType(1)
	if rhand && (rhand != 9)
		return false
	endif
	
	Int lhand = PlayerRef.GetEquippedItemType(0)
	if lhand && (lhand != 9)
		return false
	endif
	
	if PlayerRef.IsWeaponDrawn()
		if !(rhand || lhand)
			return false
		else
			if rhand
				spl = PlayerRef.GetEquippedSpell(1)
				if spl && spl.IsHostile()
					return false
				endif
			endif
			if lhand
				spl = PlayerRef.GetEquippedSpell(1)
				if spl && spl.IsHostile()
					return false
				endif
			endif
		endif
	endif
	
	
	return true
		
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

;/
Bool Function Disarm(Actor akActor = None)			;USE this as Sheath in Calm - Surrender?
	Armor a
	Weapon w
	SPELL s

	if akActor
		if akActor.IsWeaponDrawn()
			akActor.SheatheWeapon()
		endif
		a = akActor.GetEquippedShield()
		if a
			akActor.UnequipItem(a, false, true)
		endif
		w = akActor.GetEquippedWeapon(false)
		if w
			akActor.UnequipItem(w, false, true)
		endif
		w = akActor.GetEquippedWeapon(true)
		if w
			akActor.UnequipItem(w, false, true)
		endif
		s = akActor.GetEquippedSpell(0)
		if s && s.IsHostile()
			akActor.UnequipSpell(s, 0)
		endif
		s = akActor.GetEquippedSpell(1)
		if s && s.IsHostile()
			akActor.UnequipSpell(s, 1)
		endif
		return true
	else
		return false
	endif
	
EndFunction
/;

;---------------------------------------------------------------------------------------------------------------------------
	
;/	
Float Function GetStruggleStaminaChange()								;add pickpicket difficulty to struggle game? I say no...
	Float r = PlayerRef.GetActorValue("StaminaRate")
	if r > 0.0
		r = 1.0 - PlayerRef.GetActorValue("Pickpocket")/100.0
		r = 0.1 + 0.8*r
		if r < 0.2
			r = 0.2
		elseif r > 0.8
			r = 0.8
		endif
	else
		r = 0.0
	endif	

	return r
EndFunction
/;

;---------------------------------------------------------------------------------------------------------------------------

;/
Int Function GetPlayerLevel(Float scale_max)
	return Math.Ceiling(PlayerRef.GetLevel() / scale_max)
EndFunction
/;

;---------------------------------------------------------------------------------------------------------------------------

;/
Function FlagForm(Form frm, Bool flag)
	if frm
		mzinWaterUtil.SetDangerousWater(frm, flag)
	endif
EndFunction
/;

;---------------------------------------------------------------------------------------------------------------------------


;/ 

I WILL NEED THIS AT SOME POINT :( 

Function AddFormToLeveledList(Form src, LeveledItem dst, Int lvl = 1, Int cnt = 1)
	Int i
	Bool b = false
	i = dst.GetNumForms()
	while i && !b
		i -= 1
		b = (src == dst.GetNthForm(i))
	endwhile
	if !b
		dst.AddForm(src, lvl, cnt)
	endif
EndFunction

Function UpdatePotions()
	
	Int dur = 86400
	Int ts = TimeScale.GetValueInt()
	if ts > 0
		dur /= ts
	endif
	Int i = nade_MetabolismPotions.GetNumForms()
	while i
		i -= 1
		(nade_MetabolismPotions.GetNthForm(i) as Potion).SetNthEffectDuration(0, dur)
	endwhile
	AddFormToLeveledList(nade_MetabolismPotions, PotionsMerchant)
	AddFormToLeveledList(nade_MetabolismPotions, PotionsApothecary)
	;Debug.Notification("Naked Defeat Moon Potions added to merchants and apothecaries.")
	if ShowDebugMessages
		Debug.Notification("Naked Defeat Moon Potions added to merchants and apothecaries.")
	endif
EndFunction
/;



Function AddRapeHands()					;#hands WORKS KEEP
		Debug.trace("NAKED DEFEAT: RapeHands started")
		int i = Utility.RandomInt(1, 6)
		
		;TO DO: this needs to get to OnUpdate...
		Utility.Wait(20) ;delay to add the tattoos during the sexscene
		ScreenMessage("You can feel their hands creeping all over your body")	
		
			if i == 1 
				;Debug.trace("NAKED DEFEAT: RapeHands selected")
				SlaveTats.simple_remove_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Arms", true, true)		;sSection - ;sName
				SlaveTats.simple_add_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Arms", 0, true, true, 1.0)		;sSection - ;sName
				fadeTattoos.simple_doAlphaFadeFor("Rape Hands", "Rape Hands on Arms", WhipmarksDur)		;sSection - ;sName
			elseif i == 2 
				;Debug.trace("NAKED DEFEAT: RapeHands selected")
				SlaveTats.simple_remove_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Breasts 01", true, true)
				SlaveTats.simple_add_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Breasts 01", 0, true, true, 1.0)
				fadeTattoos.simple_doAlphaFadeFor("Rape Hands", "Rape Hands on Breasts 01", WhipmarksDur)
			elseif i == 3 
				;Debug.trace("NAKED DEFEAT: RapeHands selected")
				SlaveTats.simple_remove_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Breasts 02", true, true)
				SlaveTats.simple_add_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Breasts 02", 0, true, true, 1.0)
				fadeTattoos.simple_doAlphaFadeFor("Rape Hands", "Rape Hands on Breasts 02", WhipmarksDur)
			elseif i == 4
				;Debug.trace("NAKED DEFEAT: RapeHands selected")
				SlaveTats.simple_remove_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Breasts 03", true, true)
				SlaveTats.simple_add_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Breasts 03", 0, true, true, 1.0)
				fadeTattoos.simple_doAlphaFadeFor("Rape Hands", "Rape Hands on Breasts 03", WhipmarksDur)
			elseif i == 5
				;Debug.trace("NAKED DEFEAT: RapeHands selected")
				SlaveTats.simple_remove_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Hips", true, true)
				SlaveTats.simple_add_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Hips", 0, true, true, 1.0)
				fadeTattoos.simple_doAlphaFadeFor("Rape Hands", "Rape Hands on Hips", WhipmarksDur)
			else 
				;Debug.trace("NAKED DEFEAT: RapeHands selected")
				SlaveTats.simple_remove_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Body 01", true, true)
				SlaveTats.simple_add_tattoo(PlayerRef, "Rape Hands", "Rape Hands on Body 01", 0, true, true, 1.0)
				fadeTattoos.simple_doAlphaFadeFor("Rape Hands", "Rape Hands on Body 01", WhipmarksDur)
			endif
		;endif	
		SyncTattoos()
EndFunction

Function AddRapeTears()					;#tears
		Debug.trace("NAKED DEFEAT configquest: AddRapeTears()")
	
		;if NymBeta
				Debug.trace("NAKED DEFEAT: RapeHands selected")
				SlaveTats.simple_remove_tattoo(PlayerRef, "Rape Tears", "Black Rape Tears 01", true, true)		;sSection - ;sName
				SlaveTats.simple_add_tattoo(PlayerRef, "Rape Tears", "Black Rape Tears 01", 0, true, true, 1.0)		;sSection - ;sName
				fadeTattoos.simple_doAlphaFadeFor("Rape Tears", "Black Rape Tears 01", WhipmarksDur)		;sSection - ;sName
		;endif		
		SyncTattoos()
		
		;endif
EndFunction


float Property SexSceneCountPlayer auto

Function AddRapeCount()				;#count
		Debug.trace("NAKED DEFEAT configquest: AddRapeCount() - SexSceneCountPlayer: "+SexSceneCountPlayer)		;WHY NO WORK?
		
		if NymBeta	
			if SexSceneCountPlayer == 1
			Debug.trace("NAKED DEFEAT configquest: AddRapeCount() 1")
			;SlaveTats.simple_remove_tattoo(PlayerRef, "Rape Tears", "Black Rape Tears 01", true, true)
			;{"name": "RapeCount: 1", "section":"rapecount", "texture":"rapecount\\RapeCount_1.dds", "area":"Body"},
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 1", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 1", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 1", WhipmarksDur)		;sSection - ;sName
			elseif SexSceneCountPlayer == 2
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 2", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 2", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 2", WhipmarksDur)		;sSection - ;sName
			elseif SexSceneCountPlayer == 3
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 3", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 3", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 3", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 4
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 4", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 4", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 4", WhipmarksDur)		;sSection - ;sName
			elseif SexSceneCountPlayer == 5
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 5", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 5", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 5", WhipmarksDur)		;sSection - ;sName
			elseif SexSceneCountPlayer == 6
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 6", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 6", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 6", WhipmarksDur)		;sSection - ;sName
			elseif SexSceneCountPlayer == 7
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 7", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 7", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 7", WhipmarksDur)		;sSection - ;sName
			elseif SexSceneCountPlayer == 8
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 8", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 8", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 8", WhipmarksDur)		;sSection - ;sName
			elseif SexSceneCountPlayer == 9
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 9", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 9", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 9", WhipmarksDur)		;sSection - ;sName
			elseif SexSceneCountPlayer == 10
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 10", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 10", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 10", WhipmarksDur)		;sSection - ;sName
			elseif SexSceneCountPlayer == 11
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 11", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 11", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 11", WhipmarksDur)		;sSection - ;sName
			elseif SexSceneCountPlayer == 12
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 12", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 12", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 12", WhipmarksDur)		;sSection - ;sName
			elseif SexSceneCountPlayer == 13
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 13", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 13", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 13", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 14
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 14", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 14", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 14", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 15
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 15", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 15", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 15", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 16
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 16", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 16", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 16", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 17
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 17", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 17", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 17", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 18
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 18", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 18", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 18", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 19
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 19", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 19", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 19", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 20
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 20", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 20", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 20", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 21
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 21", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 21", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 21", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 22
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 22", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 22", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 22", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 23
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 23", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 23", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 23", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 24
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 24", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 24", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 24", WhipmarksDur)		;sSection - ;sName	
			elseif SexSceneCountPlayer == 25
			SlaveTats.simple_remove_tattoo(PlayerRef, "rapecount", "RapeCount: 25", true, true)		;sSection - ;sName
			SlaveTats.simple_add_tattoo(PlayerRef, "rapecount", "RapeCount: 25", 0, true, true, 1.0)		;sSection - ;sName
			fadeTattoos.simple_doAlphaFadeFor("rapecount", "RapeCount: 25", WhipmarksDur)		;sSection - ;sName				
			endif			
		SyncTattoos()	
		endif
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

Function SyncTattoos()		
	if SlaveTats.synchronize_tattoos(PlayerRef)
		Debug.trace("NAKED DEFEAT: Tattoo synchronization failed.")
	endif
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

;/
Event OnUpdateGameTime() ;NOT IN USE

	float t = Utility.GetCurrentGameTime()
	
	if (HairGrowthTime > 0.0) && ((t >= HairGrowthTime) || PlayerRef.HasMagicEffectWithKeyword(nade_HairGrowth))

		if RegrowHair()
			HairGrowthTime = 0.0
		else
			HairGrowthTime = t + HairRegrowthTime/24
		endif
		
	endif

	RegisterForSingleUpdateGameTime(1.0)

EndEvent
/;

;---------------------------------------------------------------------------------------------------------------------------

Function PayFine()				;#fine
Debug.trace("Naked Defeats configquest - PayFine()")	
	int Gold = PlayerRef.GetGoldAmount()
	int GoldMin = 1	
	int GoldMax = 10
	int StolenGold = Utility.RandomInt(GoldMin,GoldMax)*100
	
	if StolenGold > Gold
	ShortPunishment = 2		;not enough gold to pay fine, will be whipped instead
	else
			if Gold > 0
			;int StolenGold = Utility.RandomInt(GoldMin,GoldMax)
			PlayerRef.RemoveItem(Gold001, StolenGold, false, none)
			endif			
		;Debug.Notification("You are forced to pay a fine")
		ScreenMessage("You are forced to pay a fine. Gold: " +StolenGold)
		;Debug.trace("NAKED DEFEAT notification: You are forced to pay a fine in gold: "+StolenGold)	
	endif
EndFunction


Function AddGold(int Amount)

ScreenMessage("You receive "+Amount+" Septims")

PlayerRef.Additem(Gold001, Amount, false)

EndFunction

;>>>>>>>>>>>>>>> ROBBERY FUNCTIONS >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

;bool RobGold = true
;bool RobberyDoneOnce = false
Bool Property Robbed Auto


;/ ORIGINAL - SAVE


Function Start Robbery(Actor akRobber)				

			
Debug.trace("Naked Defeats configquest - Start Robbery() - ROBBER: "+GetLeveledActorBaseName(akRobber))
	
	bool robberyrunning = false
	
	if (akRobber != None) && akRobber.IsEnabled() && !akRobber.IsDead()

		;ROB ALL >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		
		
		
		if (robqst.GetStage() == 100) || Robbed ;make sure we have only one robbery quest active at a time
		ScreenMessage("Your Enemies dont find anything to rob. Go get your stolen stuff first!")
		else	
		
			if !DefeatRobberyGold 
						
			ScreenMessage("All your belongings have been robbed by "+GetLeveledActorBaseName(akRobber))

				if NymBETA 
				;destroy stuff in inventory?
				endif
			;RobbedGold = PlayerRef.GetGoldAmount()
			;PlayerRef.RemoveItem(Gold001, RobbedGold, True, none)
				
			Int iFormIndex = PlayerRef.GetNumItems()	
			Int iFormCount
			Form RobbedItem
			String ItemName
						
				While iFormIndex > 0
					iFormIndex -= 1
					RobbedItem = PlayerRef.GetNthForm(iFormIndex)
					ItemName = RobbedItem.GetName()
					
					if !RobbedItem.HasKeyword(SexlabNoStrip)
					DebugTrace("ItemToCheck: "+ItemName)
					
						if CheckItem(RobbedItem)
						iFormCount = PlayerRef.GetItemCount(RobbedItem)
						PlayerRef.RemoveItem(RobbedItem, iFormCount, True, akRobber)
						else
						DebugTrace("ItemBlockedFromRobbery: "+ItemName)
						endif
						
					DebugTrace("ItemRobbed: "+ItemName)	
					else
					DebugTrace("Not Robbed (SexlabNoStrip): "+ItemName)
					endif
					
				EndWhile
				
				PlayerRef.QueueNiNodeUpdate()
			
			;ROB GOLD >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  	
		
			elseif DefeatRobberyGold ;&& !robberyrunning

			int Gold = PlayerRef.GetGoldAmount()
			int GoldMin = 0
			
				if Gold > 1000
				GoldMin = 1000
				endif
				
				if Gold > 0
				RobbedGold = Utility.RandomInt(GoldMin,Gold)
				PlayerRef.RemoveItem(Gold001, RobbedGold, True, akRobber)
				endif
				
			;Debug.Notification(" ")
			ScreenMessage("Some gold has been robbed by "+GetLeveledActorBaseName(akRobber))
			Utility.Wait(2.0)
			endif

	;	(robqst as nade_robbedquest_qf_scr).Start(akRobber)	
			
		(robqst as nade_robbedquest_qf_scr).RestartQuest(akRobber)
		
		endif
	else

	ScreenMessage("Fortunatly they forget to rob you...")
	endif
	
		
		;#TODO: add follower robbery too? will be messy when returning stuff to them, tho... see if we can find some other way to make this happen? 
		;can we check for ESPs of the robbers? 
		;OBIS SE.esp (add check and prevent those NPCs from beeing robbers?)
	;endif
	;return retval
EndFunction
/;

Function OnCellLoadFunction()
		
		if IsNymrasGame()
		folqst.FollowerStripUpdate()
		;SpawnNakedEncounters(utility.randomint(4,8), false)
		endif
		
		if NakedTravel
		CheckFastTravel()
		endif
		
		if NymBeta && NakedTravel
		ScreenMessage("NymBETA message: Cell Loaded()")
		endif
		
		if DefeatTypeScenario == "FastTravel"	;this might not work
		
			if D100(1)
			DestroyAllStuff()
			elseif D100(5)
			;they want another round.
			
			;NAKED Curse?
			;TENTACLE ATTACK?
			
			endif
		endif
		
	;	SendModevent("nade_FuckStates")
	;	SendModevent("nade_FuckStates")
	;	SendModevent("nade_FuckStates")

EndFunction

Function DestroyAllStuff()
		;	Int iFormIndex = PlayerRef.GetNumItems()	
		;	Int iFormCount
		;	Form DestroyedItem
		;	String ItemName
			
			int Gold = PlayerRef.GetGoldAmount()
			PlayerRef.RemoveItem(Gold001, Gold, True, none)
			PlayerRef.RemoveAllItems()
			
			;	While iFormIndex > 0
		;			iFormIndex -= 1
		;			DestroyedItem = PlayerRef.GetNthForm(iFormIndex)
		;			ItemName = DestroyedItem.GetName()
		;			
		;			if !DestroyedItem.HasKeyword(SexlabNoStrip)
		;			DebugTrace("ItemToCheck: "+ItemName)
		;			
		;				if CheckItem(DestroyedItem)
		;				iFormCount = PlayerRef.GetItemCount(DestroyedItem)
		;				PlayerRef.RemoveItem(DestroyedItem, iFormCount, True, akRobber)
		;				else
		;				DebugTrace("ItemBlockedFromRobbery: "+ItemName)
		;				endif
		;				
				;	DebugTrace("ItemRobbed: "+ItemName)	
		;			else
				;	DebugTrace("Not Robbed (SexlabNoStrip): "+ItemName)
		;			endif
		;		EndWhile
				
				PlayerRef.QueueNiNodeUpdate()	

EndFunction

;NEW ROBBERY 


Function RobGoldFromPlayer(int Amount, actor akRobber) 

	PlayerRef.RemoveItem(Gold001, Amount, True, akRobber)
	
EndFunction 


Bool Function HasPlayerEnoughGold(int Gold)

int GoldCurrent = PlayerRef.GetGoldAmount()

if GoldCurrent >= Gold
return true
else 
return false
endif

EndFunction

Bool Property IsRobberyWorthIt Auto
	
Function StartRobbery(Actor akRobber)				;#StartRobbery #robbery2

;ROBBER IS ALREADY CHECKED IN CALMQUEST IF VALID OR NOT 
			
	Debug.trace("Naked Defeats configquest - StartRobbery() - ROBBER: "+GetLeveledActorBaseName(akRobber))
	
;	NymTrace("Robber Name B: "+GetLeveledActorBaseName(akRobber))
	
	int Gold = PlayerRef.GetGoldAmount()
	int StolenItemsCount = 0
	IsRobberyWorthIt = false
	;if Gold < 50
	;ScreenMessage("You are too poor to be robbed.")
		
	if (akRobber != None) ;&& akRobber.IsEnabled() && !akRobber.IsDead() 	<--- add these checks in fucking Calmquest if any

			int GoldMin = 0
			
			;PlayerRef.RemoveItem(Gold001, Gold, True, akRobber) double????

		
			;>>> ROB EVERYTHING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  	
			if !DefeatRobberyGold 
						
			;ScreenMessage("All your belongings have been robbed by "+GetLeveledActorBaseName(akRobber))

			;	if NymBETA 
			;	;destroy stuff in inventory?
			;	endif
			;RobbedGold = PlayerRef.GetGoldAmount()
			;PlayerRef.RemoveItem(Gold001, RobbedGold, True, none)
				
			Int iFormIndex = PlayerRef.GetNumItems()	
			Int iFormCount
			Form RobbedItem
			String ItemName
						
				;RobbedGold = Utility.RandomInt(GoldMin,Gold)
				;OLD: PlayerRef.RemoveItem(Gold001, RobbedGold, True, akRobber)			
				PlayerRef.RemoveItem(Gold001, Gold, True, akRobber)		
				RobbedGold = Gold 
				While iFormIndex > 0
					iFormIndex -= 1
					RobbedItem = PlayerRef.GetNthForm(iFormIndex)
					
					if RobbedItem
					ItemName = RobbedItem.GetName()
					
						if !ItemName
						ItemName = "NoName"
						endif 
					
						;if !ItemName
						;ItemName = RobbedItem.GetBaseObject().GetName()
						;endif 
					else
					ItemName = "NoItem > NoName"
					endif					
					
					if RobbedItem && !RobbedItem.HasKeyword(SexlabNoStrip)
					DebugTrace("ItemToCheck: "+ItemName)
					
						if CheckItem(RobbedItem)
						iFormCount = PlayerRef.GetItemCount(RobbedItem)
						PlayerRef.RemoveItem(RobbedItem, iFormCount, True, akRobber)
						StolenItemsCount+=1
						else
						DebugTrace("ItemBlockedFromRobbery: "+ItemName)
						endif
						
					DebugTrace("ItemRobbed: "+ItemName)	
					else
					DebugTrace("Not Robbed (SexlabNoStrip): "+ItemName)
					endif
					
				EndWhile
				
				PlayerRef.QueueNiNodeUpdate()
				
			;>>>> ROB GOLD ONLY >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  	
						
			else 		

				if Gold > 1000
				GoldMin = 1000
				else
				GoldMin == Gold
				endif
				
				if Gold > 0
				RobbedGold = Utility.RandomInt(GoldMin,Gold)
				PlayerRef.RemoveItem(Gold001, RobbedGold, True, akRobber)
				endif
				
			;ScreenMessage("Some gold has been robbed by "+GetLeveledActorBaseName(akRobber))
			;Utility.Wait(2.0)
			endif
		if Nym() 
			if ((StolenItemsCount > 13) || (RobbedGold > 2000))		
			IsRobberyWorthIt = true
			endif 
		elseif StolenItemsCount > 5 || RobbedGold > 1000
		IsRobberyWorthIt = true 
		endif 
				
		;ROBBERY MESSAGE 	
		if !IsRobberyWorthIt
		ScreenMessage("You don't have much on you, they take it but you just don't care [no Robbery Quest for tracking started]")
		InfoMessage("No Robbery Tracking Quest Started because item and gold count was so low")
		elseif DefeatRobberyGold && !IsRobberyOnLocation 		
		ScreenMessage("Some gold has been robbed by "+GetLeveledActorBaseName(akRobber))
		InfoMessage("Robbery Tracking Quest Started to help you get your stuff back")
		elseif !IsRobberyOnLocation 
		ScreenMessage("All your belongings have been robbed by "+GetLeveledActorBaseName(akRobber))
		InfoMessage("Robbery Tracking Quest Started to help you get your stuff back. Robbers are in a random location across skyrim")
		endif 
		
		if IsRobberyWorthIt && !IsRobberyOnLocation ;why? if we do robbery at location I guess
		StartRobberTrackingQuest(akRobber)
		endif 
	
		
	else

	ScreenMessage("Fortunatly they forget to rob you...")
	endif
		
		;#TODO: add follower robbery too? will be messy when returning stuff to them, tho... see if we can find some other way to make this happen? 
		;can we check for ESPs of the robbers? 
		;OBIS SE.esp (add check and prevent those NPCs from beeing robbers?)

EndFunction

Function StartRobberTrackingQuest(actor akRobber)

			if !Robbed
			NymTrace("#Robbery 01 started")
			(robqst as nade_robbedquest_qf_scr).RestartQuest(akRobber)
	
			elseif !RobberyRunning[2] 
			NymTrace("#Robbery02 Started")
			RobberyRunning[2] = true
		
			NymTrace("#Robbery 02 started")
			robqst_02.RestartQuest(akRobber)
			elseif !RobberyRunning[3] 
			NymTrace("#Robbery03 Started")
			RobberyRunning[3] = true
			robqst_03.RestartQuest(akRobber)
	
			elseif !RobberyRunning[4] 
			NymTrace("#Robbery04 Started")
			RobberyRunning[4] = true
			
			robqst_04.RestartQuest(akRobber)
			elseif !RobberyRunning[5] 
			NymTrace("#Robbery05 Started")
			RobberyRunning[5] = true
		
			robqst_05.RestartQuest(akRobber)
			else
			ScreenMessage("You were robbed so often you start forgetting who did this to you...")
			InfoMessage("All five robbery quests are active. Robbery Quest 1 will be overwritten now.")
			InfoMessage("The robber still has your gear, just the questmarker is gone now.")
			;Robbery01running = true
			(robqst as nade_robbedquest_qf_scr).RestartQuest(akRobber)
			endif
			
EndFunction

Function RobberyQuest02available()
RobberyRunning[2] = false
;Robbery02running = false
EndFunction

Function RobberyQuest03available()
RobberyRunning[3] = false
;Robbery03running = false
EndFunction

Function RobberyQuest04available()
RobberyRunning[4] = false
;Robbery04running = false
EndFunction

Function RobberyQuest05available()
RobberyRunning[5] = false
;Robbery05running = false
EndFunction


;0x15    21  Y
Function DrinkPotion()
	Debug.trace("Naked Defeats configquest - DrinkPotion()")
	Int iFormIndex = PlayerRef.GetNumItems()	
	Int iFormCount
	Form ItemToCheck
	String ItemName
	int WantHealth = 0 
	int WantStamina = 0 
	int WantMagicka = 0
	
	Keyword VendorItemPotion
;	MagicEffect RestoreHealth	0003EB15
;	MagicEffect FortifyHealth	0003EAF3
;	MagicEffect RegenerateHealth ???;	0003EAF3
	
;	MagicEffect FortifyMagicka	0003EAF8
;	MagicEffect RestoreStamina 0003EB16
	
	if CheckDurationSpell("magicka") ;stamina effect active
	WantHealth = 1
	elseif CheckDurationSpell("health") ;health effect active
	WantStamina = 3
	elseif IsPlayerNaked()	;no effect active, and naked drink health first
	WantHealth = 1
	else ;no active effect and not naked, drink Health
	WantStamina = 1
	endif 
	
	float PCHealthMax = playerref.GetActorValueMax("health")
	float PCHealthCurrent = playerref.GetAV("health")
	bool PotionFound = false
	if PCHealthMax != PCHealthCurrent ;I was smart
		if (PCHealthMax/PCHealthCurrent) >= 10 	;100/10 (10 % health) --- lower than 10% health
		;NymTrace("PC health lower than 10%")
		WantHealth = 3
		elseif (PCHealthMax/PCHealthCurrent) >= 3	;100/33 (33 % health) --- lower than 33% health
		;NymTrace("PC health lower than 33%")
		WantHealth = 2
		elseif (PCHealthMax/PCHealthCurrent) >= 1.5 	;100/66 (66 % health) ----- lower than 66% health
		;NymTrace("PC health lower than 66%")
		WantHealth = 1
		endif 
	endif 
	
	if !VendorItemPotion
	VendorItemPotion = (Game.GetFormFromFile(0x0008CDEC, "Skyrim.esm") As Keyword)
	endif 							

	While iFormIndex > 0 && !PotionFound
		iFormIndex -= 1
		ItemToCheck = PlayerRef.GetNthForm(iFormIndex)
		
		if PotionFound
		NymTrace("#ERROR - PotionFound TRUE but should not be")
		endif 
		if ItemToCheck && ItemToCheck.HasKeyword(VendorItemPotion)
		ItemName = ItemToCheck.GetName()
			if WantHealth > 0
				if (WantHealth > 2) && (CheckBestHealthPotions(ItemName) || CheckMediumHealthPotions(ItemName) || CheckLightHealthPotions(ItemName))
				PlayerRef.EquipItem(ItemToCheck)	
				PotionFound = true
				elseif (WantHealth > 1) && (CheckMediumHealthPotions(ItemName) || CheckBestHealthPotions(ItemName) || CheckLightHealthPotions(ItemName))
				PlayerRef.EquipItem(ItemToCheck)
				PotionFound = true				
				elseif (WantHealth > 0) && (CheckLightHealthPotions(ItemName) || CheckMediumHealthPotions(ItemName) || CheckBestHealthPotions(ItemName))
				PlayerRef.EquipItem(ItemToCheck)
				PotionFound = true
				else 
				
					if !CheckDurationSpell("magicka") ;NO stamina effect active
					WantStamina = 1
					ScreenMessage("No Health Potion left, we drink Stamina isntead!")
					else 
					ScreenMessage("No Health Potion left!")
					endif 
				endif 
			endif 
				
			if WantStamina > 0
				if (WantStamina > 2) && (CheckBestStaminaPotions(ItemName) || CheckMediumStaminaPotions(ItemName) || CheckLightStaminaPotions(ItemName))
				PlayerRef.EquipItem(ItemToCheck)
				PotionFound = true				
				elseif (WantStamina > 1) && (CheckMediumStaminaPotions(ItemName) || CheckBestStaminaPotions(ItemName) || CheckLightStaminaPotions(ItemName))
				PlayerRef.EquipItem(ItemToCheck)	
				PotionFound = true
				elseif (WantStamina > 0) && (CheckLightStaminaPotions(ItemName) || CheckMediumStaminaPotions(ItemName) || CheckBestStaminaPotions(ItemName))
				PlayerRef.EquipItem(ItemToCheck)
				PotionFound = true
				else 
				ScreenMessage("No Stamina Potion left!")
				endif 
			endif 
		endif 	

	EndWhile
	
	
EndFunction 


;HEALTH POTIONS ------------------------------------------------------------------------------------------------------
Bool Function CheckLightHealthPotions(String PotionName)

	;Fortify
	if (PotionName == "Potion of Health") || (PotionName == "Draught of Health") ;|| (PotionName == "Solution of Health")
	return true
	;Regenerate
	elseif (PotionName == "Potion of Regeneration") || (PotionName == "Draught of Regeneration"); || (PotionName == "Solution of Regeneration")
	return true
	;Restore
	elseif (PotionName == "Potion of Minor Healing") || (PotionName == "Potion of Healing") || (PotionName == "Potion of Plentiful Healing")
	return true
	else
	return false
	endif
	
EndFunction

Bool Function CheckMediumHealthPotions(String PotionName)

	;Fortify Medium
	if (PotionName == "Solution of Health") || (PotionName == "Philter of Health") 
	return true
	;Regenerate Medium
	elseif (PotionName == "Solution of Regeneration") || (PotionName == "Philter of Regeneration") 
	return true
	;Restore Medium
	elseif (PotionName == "Potion of Vigorous Healing") || (PotionName == "Potion of Extreme Healing") 
	return true
	else
	return false
	endif
	
EndFunction

Bool Function CheckBestHealthPotions(String PotionName)

	;Fortify Best
	if (PotionName == "Elixir of Health") 
	return true
	;Regenerate Best
	elseif (PotionName == "Elixir of Regeneration") 
	return true
	;Restore Best
	elseif (PotionName == "Potion of Ultimate Healing")  
	return true
	else
	return false
	endif
	
EndFunction

;STAMINA POTIONS ------------------------------------------------------------------------------------------------------

Bool Function CheckLightStaminaPotions(String PotionName)

	;Fortify
	if (PotionName == "Potion of Enhanced Stamina") || (PotionName == "Draught of Enhanced Stamina") ;|| (PotionName == "Solution of Enhanced Stamina")
	return true
	;Regenerate
	elseif (PotionName == "Potion of Vigor") || (PotionName == "Draught of Vigor"); || (PotionName == "Solution of Vigor")
	return true
	;Restore
	elseif (PotionName == "Potion of Minor Stamina") || (PotionName == "Potion of Stamina") || (PotionName == "Potion of Plentiful Stamina")
	return true
	else
	return false
	endif
	
EndFunction

Bool Function CheckMediumStaminaPotions(String PotionName)

	;Fortify Medium
	if (PotionName == "Solution of Enhanced Stamina") || (PotionName == "Philter of Enhanced Stamina") 
	return true
	;Regenerate Medium
	elseif (PotionName == "Solution of Vigor") || (PotionName == "Philter of Vigor") 
	return true
	;Restore Medium
	elseif (PotionName == "Potion of Vigorous Stamina") || (PotionName == "Potion of Extreme Stamina") 
	return true
	else
	return false
	endif
	
EndFunction

Bool Function CheckBestStaminaPotions(String PotionName)

	;Fortify Best
	if (PotionName == "Elixir of Enhanced Stamina") 
	return true
	;Regenerate Best
	elseif (PotionName == "Elixir of Vigor") 
	return true
	;Restore Best
	elseif (PotionName == "Potion of Ultimate Stamina")  
	return true
	else
	return false
	endif
	
EndFunction


;MAGICKA POTIONS ------------------------------------------------------------------------------------------------------

Bool Function CheckLightMagickaPotions(String PotionName)

	;Fortify
	if (PotionName == "Potion of Extra Magicka") || (PotionName == "Draught of Extra Magicka") ;|| (PotionName == "Solution of Extra Magicka")
	return true
	;Regenerate
	elseif (PotionName == "Potion of Lasting Potency") || (PotionName == "Draught of Lasting Potency") ;|| (PotionName == "Solution of Lasting Potency")
	return true
	;Restore
	elseif (PotionName == "Potion of Minor Magicka") || (PotionName == "Potion of Magicka") || (PotionName == "Potion of Plentiful Magicka")
	return true
	else
	return false
	endif
	
EndFunction

Bool Function CheckMediumMagickaPotions(String PotionName)

	;Fortify Medium
	if (PotionName == "Solution of Extra Magicka") || (PotionName == "Philter of Extra Magicka") 
	return true
	;Regenerate Medium
	elseif (PotionName == "Solution of Lasting Potency") || (PotionName == "Philter of Lasting Potency") 
	return true
	;Restore Medium
	elseif (PotionName == "Potion of Vigorous Magicka") || (PotionName == "Potion of Extreme Magicka") 
	return true
	else
	return false
	endif
	
EndFunction

Bool Function CheckBestMagickaPotions(String PotionName)

	;Fortify Best
	if (PotionName == "Elixir of Extra Magicka") 
	return true
	;Regenerate Best
	elseif (PotionName == "Elixir of Lasting Potency") 
	return true
	;Restore Best
	elseif (PotionName == "Potion of Ultimate Magicka")  
	return true
	else
	return false
	endif
	
EndFunction


Bool[] Property RobberyRunning Auto

;bool Robbery01running = false
;bool Robbery02running = false
;bool Robbery03running = false
;bool Robbery04running = false
;bool Robbery05running = false

;/



;SAVE ROBBERY FUNCTION
Function StartRobbery(Actor akRobber)				;#robbery
			
Debug.trace("Naked Defeats configquest - StartRobbery() - ROBBER: "+GetLeveledActorBaseName(akRobber))
	
	bool robberyrunning = false
	
	if (akRobber != None) && akRobber.IsEnabled() && !akRobber.IsDead()

			int Gold = PlayerRef.GetGoldAmount()
			int GoldMin = 0
			
		;ROB ALL >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		
		
		;ROB ALL GOLD
		PlayerRef.RemoveItem(Gold001, Gold, True, akRobber)
		
	;	if (robqst.GetStage() == 100) || Robbed ;make sure we have only one robbery quest active at a time
	;	ScreenMessage("Your Enemies dont find anything to rob. Go get your stolen stuff first!")
	;	else	
		
			if !DefeatRobberyGold 
						
			ScreenMessage("All your belongings have been robbed by "+GetLeveledActorBaseName(akRobber))

			;	if NymBETA 
			;	;destroy stuff in inventory?
			;	endif
			;RobbedGold = PlayerRef.GetGoldAmount()
			;PlayerRef.RemoveItem(Gold001, RobbedGold, True, none)
				
			Int iFormIndex = PlayerRef.GetNumItems()	
			Int iFormCount
			Form RobbedItem
			String ItemName
						
				;RobbedGold = Utility.RandomInt(GoldMin,Gold)
				PlayerRef.RemoveItem(Gold001, RobbedGold, True, akRobber)		
						
				While iFormIndex > 0
					iFormIndex -= 1
					RobbedItem = PlayerRef.GetNthForm(iFormIndex)
					ItemName = RobbedItem.GetName()
					
					if !RobbedItem.HasKeyword(SexlabNoStrip)
					DebugTrace("ItemToCheck: "+ItemName)
					
						if CheckItem(RobbedItem)
						iFormCount = PlayerRef.GetItemCount(RobbedItem)
						PlayerRef.RemoveItem(RobbedItem, iFormCount, True, akRobber)
						else
						DebugTrace("ItemBlockedFromRobbery: "+ItemName)
						endif
						
					DebugTrace("ItemRobbed: "+ItemName)	
					else
					DebugTrace("Not Robbed (SexlabNoStrip): "+ItemName)
					endif
					
				EndWhile
				
				PlayerRef.QueueNiNodeUpdate()
			
			;ROB GOLD >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  	
		
			else 	; DefeatRobberyGold ;&& !robberyrunning


			
				if Gold > 1000
				GoldMin = 1000
				else
				GoldMin == Gold
				endif
				
				if Gold > 0
				RobbedGold = Utility.RandomInt(GoldMin,Gold)
				PlayerRef.RemoveItem(Gold001, RobbedGold, True, akRobber)
				endif
				
			;Debug.Notification(" ")
			ScreenMessage("Some gold has been robbed by "+GetLeveledActorBaseName(akRobber))
			Utility.Wait(2.0)
			endif
			
		(robqst as nade_robbedquest_qf_scr).RestartQuest(akRobber)
		
	;	endif
	else

	ScreenMessage("Fortunatly they forget to rob you...")
	endif
	
		
		;#TODO: add follower robbery too? will be messy when returning stuff to them, tho... see if we can find some other way to make this happen? 
		;can we check for ESPs of the robbers? 
		;OBIS SE.esp (add check and prevent those NPCs from beeing robbers?)
	;endif
	;return retval
EndFunction

/;

;---------------------------------------------------------------------------------------------------------------------------------------------------------

Bool Function CheckItem(Form akItem)		;#CheckItem 

NymTrace("CheckItem(Start)")

Bool IsArmor = false

;if 
;if akItem.HasKeyword(ArmorClothing) || akItem.HasKeyword(ArmorLight) || akItem.HasKeyword(ArmorHeavy)
;ShowDebugTrace("NAKED DEFEAT configquest: Robbery IS armor/clothing (KWD): " +akItem.GetName())
;IsArmor = true

if IsItem("Armor Type Light", akItem) || IsItem("Armor Type Heavy", akItem) || IsItem("Armor Type Clothing", akItem) || IsItem("Jewelery", akItem) 
NymTrace("IsArmorA")
;if (akItem as armor).IsLightArmor()|| (akItem as armor).IsHeavyArmor() || (akItem as armor).IsClothing() || (akItem as armor).IsJewelry()
;DebugTrace("Robbery IS armor/clothing (SKSE): " +akItem.GetName())
IsArmor = true
else
NymTrace("IsNOTarmor")
IsArmor = false
endif

if IsArmor
NymTrace("IsArmorB")
	Armor akArmor = akItem as Armor
	;int SlotMask = (akItem as armor).GetSlotMask()
	int SlotMask = akArmor.GetSlotMask()
	DebugTrace("SlotMask "+SlotMask)
		
	if akArmor	
	NymTrace("Is akArmor")
		if (SlotMask == 16) && BlockSlot[4]				;34 - Forearms
		return false
		elseif (SlotMask == 32) && BlockSlot[5]			;35 - Amulet
		return false
		elseif (SlotMask == 40) && BlockSlot[6]			;36 - Ring 
		return false
		elseif (SlotMask == 64) && BlockSlot[8]			;38 - Calves
		return false
		elseif (SlotMask == 512) && BlockSlot[9]			;39 - SHIELD	
		return false
		elseif (SlotMask == 1024) && BlockSlot[10]			;40 - TAIL 
		return false
		elseif (SlotMask == 2048) && BlockSlot[11]			;41 - Long Hair	
		return false	
		elseif (SlotMask == 8192) && BlockSlot[13]			;43 - Ears 
		return false
		elseif (SlotMask == 16384) && BlockSlot[14]		;44 - Unnamed 	(DD Gag/Mouth, SexlabTongue)
		return false
		elseif (SlotMask == 32768) && BlockSlot[15]		;45 - Unnamed 		(DD Collars)	
		return false
		elseif (SlotMask == 65536) && BlockSlot[16]		;46 - Unnamed 		(DD Armbinder/Yoke, Cloaks)
		return false	
		elseif (SlotMask == 131072) && BlockSlot[17]		;47 - Unnamed 		(DD -, Backpacks, Wings)
		return false	
		elseif (SlotMask == 262144) && BlockSlot[18]		;48 - Unnamed 		(DD plugs anal, Backpack left pouch)
		return false	
		elseif (SlotMask == 524288) && BlockSlot[19]		;49 - Unnamed 		(DD Body harness/Chastity belt)
		return false		
		elseif (SlotMask == 1048576) && BlockSlot[20]		;50 - Decap Head	(DD Piercings Vaginal, bracelets)
		return false	
		elseif (SlotMask == 2097152) && BlockSlot[21]		;51 - Decapitate 
		return false	
		elseif (SlotMask == 4194304) && BlockSlot[22]		;52 - Unnamed
		return false	
		elseif (SlotMask == 8388608) && BlockSlot[23]		;53 - Unnamed	(DD Cuffs Legs)
		return false	
		elseif (SlotMask == 16777216) && BlockSlot[24]		;54 - Unnamed	(DD Plugs vaginal)
		return false	
		elseif (SlotMask == 33554432) && BlockSlot[25]		;55 - Unnamed	(DD Blindfold)
		return false	
		elseif (SlotMask == 67108864) && BlockSlot[26]		;56 - Unnamed	(DD Chastity Bra)
		return false
		elseif (SlotMask == 134217728) && BlockSlot[27]	;57 - Unnamed	(DD Vaginal Plugs)
		return false
		elseif (SlotMask == 268435456) && BlockSlot[28]	;58 - Unnamed	(DD Body Harness/Corset
		return false
		elseif (SlotMask == 536870912) && BlockSlot[29]	;59 - Unnamed	(DD Cuffs Arms)
		return false
		elseif (SlotMask == 1073741824) && BlockSlot[30]	;60 - Unnamed
		return false	
		elseif (SlotMask == 2147483648) && BlockSlot[31]	;61 - Unnamed
		return false
		else
		return true
		endif
	else 
	NymTrace("akArmor = false")
	return false
	endif 
	;/
	;OLD WRONG ... HEX DEC FUCK YOU All
	if (SlotMask == 10) && !BlockSlot[4]			;34 - Forearms
	return false
	elseif (SlotMask == 20) && !BlockSlot[5]		;35 - Amulet
	return false
	elseif (SlotMask == 40) && !BlockSlot[6]		;36 - Ring 
	return false
	elseif (SlotMask == 100) && !BlockSlot[8]		;38 - Calves
	return false
	elseif (SlotMask == 200) && !BlockSlot[9]		;39 - SHIELD	
	return false
	elseif (SlotMask == 400) && !BlockSlot[10]		;40 - TAIL 
	return false
	elseif (SlotMask == 800) && !BlockSlot[11]		;41 - Long Hair	
	return false	
	elseif (SlotMask == 2000) && !BlockSlot[13]		;43 - Ears 
	return false
	elseif (SlotMask == 4000) && !BlockSlot[14]		;44 - Unnamed 	(DD Gag/Mouth, SexlabTongue)
	return false
	elseif (SlotMask == 8000) && !BlockSlot[15]		;45 - Unnamed 		(DD Collars)	
	return false
	elseif (SlotMask == 10000) && !BlockSlot[16]	;46 - Unnamed 		(DD Armbinder/Yoke, Cloaks)
	return false	
	elseif (SlotMask == 20000) && !BlockSlot[17]	;47 - Unnamed 		(DD -, Backpacks, Wings)
	return false	
	elseif (SlotMask == 40000) && !BlockSlot[18]	;48 - Unnamed 		(DD plugs anal, Backpack left pouch)
	return false	
	elseif (SlotMask == 80000) && !BlockSlot[19]	;49 - Unnamed 		(DD Body harness/Chastity belt)
	return false		
	elseif (SlotMask == 100000) && !BlockSlot[20]	;50 - Decap. Head	(DD Piercings Vaginal, bracelets)
	return false	
	elseif (SlotMask == 200000) && !BlockSlot[21]	;51 - Decapitate 
	return false	
	elseif (SlotMask == 400000) && !BlockSlot[22]	;52 - Unnamed
	return false	
	elseif (SlotMask == 800000) && !BlockSlot[23]	;53 - Unnamed	(DD Cuffs Legs)
	return false	
	elseif (SlotMask == 1000000) && !BlockSlot[24]	;54 - Unnamed	(DD Plugs vaginal)
	return false	
	elseif (SlotMask == 2000000) && !BlockSlot[25]	;55 - Unnamed	(DD Blindfold)
	return false	
	elseif (SlotMask == 4000000) && !BlockSlot[26]	;56 - Unnamed	(DD Chastity Bra)
	return false
	elseif (SlotMask == 8000000) && !BlockSlot[27]	;57 - Unnamed	(DD Vaginal Plugs)
	return false
	elseif (SlotMask == 10000000) && !BlockSlot[28]	;58 - Unnamed	(DD Body Harness/Corset
	return false
	elseif (SlotMask == 20000000) && !BlockSlot[29]	;59 - Unnamed	(DD Cuffs Arms)
	return false
	elseif (SlotMask == 40000000) && !BlockSlot[30]	;60 - Unnamed
	return false	
	elseif (SlotMask == 80000000) && !BlockSlot[31]	;61 - Unnamed
	return false
	else
	return true
	endif
	/;
	
else
return true	
endif

EndFunction

;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


;---------------------------------------------------------------------------------------------------------------------------

Bool Function EnableMod(Bool value = true)			;#enable
	
	if value	;if Mod enabled
		
;		Debug.SetGodMode(false)		
		
	;	if PlayerRef.GetActorValue("health") > 100000
	;	PlayerRef.ModActorValue("health", -100000.0)
	;	endif
		
		CheckSoftDependencies()

		DefeatEnabled = EnableDefeat(true)

		folqst.StartFollowerQuest()

		ResetBools()
		
		
		
	;	FNISstuff()
		
		;OnConfigInit() THIS CANNOT BE HERE!!!!
		
	else
	
	;>>>>>>>>>>>>>>>>>>>>>>>>>>> NAKED DEFEAT MOD DISABLED #DISABLED >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
			
	;	if PlayerRef.GetActorValue("health") > 100000
	;	PlayerRef.ModActorValue("health", -100000.0)
	;	endif
	
		Game.EnableFastTravel()
		
		Debug.Notification("Naked Defeat DISABLED - Starting Cleanup.")
		Debug.trace("Naked Defeats configquest - Starting Cleanup.")
		;mod clear up test
			
	;	Debug.SetGodMode(false)	
		
		ItIsNymrasGame = false 
			
		if (CaptiveQuest.GetStage() > 0) && (CaptiveQuest.GetStage() < 1000)
		CaptiveQuest.SetStage(1000)
		endif
		
		if (CaptureQuest.GetStage() > 0) && (CaptureQuest.GetStage() < 1000)
		CaptureQuest.SetStage(1000)
		endif
		
		if (CalmQuest.GetStage() > 0) && (CalmQuest.GetStage() < 1000)
		CalmQuest.SetStage(1000)
		endif
		
		if (folqst.GetStage() > 0) && (folqst.GetStage() < 1000)
		folqst.SetStage(1000)
		endif
		
		if (Allegiancequest.GetStage() > 0) && (Allegiancequest.GetStage() < 1000)
		Allegiancequest.SetStage(1000)
		endif

		if DefeatQuestRunning
		DefeatQuestRunning = false
		endIf

		if CivilRapeRunning
		CivilRapeRunning = false
		endIf
		
		if RapeAgain
		RapeAgain = false
		endIf
		
		if WhipAgain
		WhipAgain = false
		endIf
	
		if InitialAllegiance
		InitialAllegiance = false
		endif
		
		;Soft Dependency Disable
		ModBiS = false
		ModDDe = false
		ModSLUplus = false

		EnableDefeat(false)

		if LastAddedDevice
		Debug.trace("NAKED DEFEAT configquest: LastAddedDevice")
			LastAddedDevice.DisableNoWait()
			LastAddedDevice.Delete()
			LastAddedDevice = None
		endif
		
		UnregisterForModEvents()
		
	endif
	return value
EndFunction

Function UnregisterForModEvents()		;#UnregisterForModEvents()

		UnRegisterForModEvent("OnSSLV Exit")
		UnRegisterForModEvent("xpoPCinPrison")
		UnRegisterForModEvent("xpoPCisFree")
		UnRegisterForModEvent("dhlp-Suspend")
		UnRegisterForModEvent("dhlp-Resume")
		UnRegisterForModEvent("Moan")
		UnRegisterForModEvent("ResetPhoneme")
		UnRegisterForModEvent("Bis_BatheEvent")
		UnRegisterForModEvent("StartGetDefeatType")
		UnRegisterForModEvent("StartAllegianceQuest")
		UnRegisterForModEvent("StartRestartCalmQuest")	
		UnRegisterForModEvent("StartLoadGameCountdown")	
		UnRegisterForModEvent("StartNakedAfterlife")	
		UnRegisterForModEvent("StartNakedDefeatExternal")	
		UnRegisterForModEvent("StartNakedSlavery")
		UnRegisterForModEvent("RestartAllegianceQuest")
		UnRegisterForModEvent("StartNakedBathing")
		UnRegisterForModEvent("StartFallingCountdown")
		
		
		UnRegisterForAnimationEvent(PlayerRef, "getupend")
		UnRegisterForAnimationEvent(PlayerRef, "RemoveCharacterControllerFromWorld")

		UnRegisterForAnimationEvent(PlayerRef, "JumpUp")
		UnRegisterForAnimationEvent(PlayerRef, "JumpFall")
		UnRegisterForAnimationEvent(PlayerRef, "JumpDown")
		UnRegisterForAnimationEvent(PlayerRef, "tailSprint")
		
		UnRegisterForAnimationEvent(PlayerRef, "TKDR_DodgeStart") ;#DODGE
		UnRegisterForAnimationEvent(PlayerRef, "SoundPlay.FSTSwimSwim") ;#DODGE
		
		
		
		UnRegisterForModEvent("dt_IsCommonTrap")
		UnRegisterForModEvent("dt_IsDeviousTrap")
		
		UnRegisterForModEvent("NakedDefeatTransition")
		
		UnRegisterForKey(57)	;SPACE
		UnRegisterForKey(207)	;End	
		
		if IsNymrasGame()
		UnRegisterForKey(44)
		endif 
	;UnRegisterForAnimationEvent(PlayerRef, "MTState") ;EXITING WATER (for bathing) ---> not working
	;UnRegisterForAnimationEvent(PlayerRef, "FootLeft")
	;UnRegisterForAnimationEvent(PlayerRef, "FootRight")
			
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

Bool Function EnableDefeat(Bool value)				;DEFEAT QUEST ENABLED
	Bool b = false
	Int stg = DefeatQuest.GetStage()
	
	if value
	
		if Nym()
		Save_JSON_Ini()
		endif 
		Load_JSON_Ini()
		;LOAD_CONFIG_EXTERNAL()	
	
		if stg != 10
			b = true
			DefeatQuest.Start()
			
		endif
		RegisterForKey(DefeatKey)
		
		if NakedLoot
		RegisterForLootHotkeys()
		endif
		
	else
		if stg == 10
			b = true
			DefeatQuest.SetStage(1000)		
		endif
		UnregisterForKey(DefeatKey)
		UnRegisterForLootHotkeys()
	endif

	if b
		if value
			Debug.Notification("NAKED DEFEAT: DEFEAT QUEST ENABLED. Version: "+NakedDefeat_ModVersion)
			
			Debug.MessageBox("You just enabled Naked Defeat. Please save & reload NOW to allow all its functions to start correctly.")
		else
			Debug.Notification("NAKED DEFEAT: DEFEAT QUEST DISABLED.")
		endif
	endif

	return value
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

;/
string Function AddStr(String s1="", String s2="")			;NYMRA what is this?
	if s1 == ""
		return s2
	elseif s2 == ""
		return s1
	else
		return s1+","+s2
	endif
EndFunction
/;

;---------------------------------------------------------------------------------------------------------------------------

Int Function AddQuestStageOption(String txt, Quest qst)
	Int i = qst.GetStage()
	if (i > 0) && (i < 1000)
		return AddTextOption(txt, i)
	else
		return AddTextOption(txt, i, OPTION_FLAG_DISABLED)
	endif
EndFunction

;/
Function AddFixSlaveFaction(bool )

	if PlayerRef.IsInFaction(zbfSlaveFaction)
	PlayerRef.RemoveFromFaction(zbfSlaveFaction)
		return AddTextOption(txt, i)
	
	if (i > 0) && (i < 1000)
		return AddTextOption(txt, i)
	else
		return AddTextOption(txt, i, OPTION_FLAG_DISABLED)
	endif
EndFunction
/;

;---------------------------------------------------------------------------------------------------------------------------

Bool Function DoResetQuest(Int option, Quest quest_to_reset)	;#resetquest
	Int i = quest_to_reset.GetStage()
	if (i > 0) && (i < 1000)
		quest_to_reset.SetStage(1000)
		i = quest_to_reset.GetStage()
		SetTextOptionValue(option, i)
	endif
	return (i == 1000) 
EndFunction

;---------------------------------------------------------------------------------------------------------------------------

;String Version = "" ;#MODVERSION

;String MODVERSION = "" ;#MODVERSION

String Property NakedDefeat_ModVersion Auto

Event OnPageReset(String page)
	Int pid = 0
	Int fid = 0
	Int pcid = 0
	Int ocid = 0
	Bool hasspell = false
	
		if (page == "")
			LoadCustomContent("NDUN/nakeddefeatlogo.dds", 95, 1)
			return
		else
			UnloadCustomContent()
		endif

	
;----------------------------------------------------------------------------------------------------

;>>>>>>>>>>>>>>>>> PAGE 1 >>>>>>>>>> SYSTEM >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

		if (page == "$nade_Options")

;		if ObesityStomachCapacity <= 0.0
;			UpdateObesitySettings()
;		endif
		
		SetCursorFillMode(TOP_TO_BOTTOM)
		
		SetCursorPosition(0)
		
		AddHeaderOption("Naked Defeat Version")
		AddTextOption("Version:", NakedDefeat_ModVersion, OPTION_FLAG_DISABLED)	
		
		if Nym()
		AddHeaderOption("$nade_Debug")
		;AddTextOption("Has SexlabNoStrip Keyword:", HasKWDSexlabNoStrip, OPTION_FLAG_DISABLED)
		DebugPunishmentTypeOID_S = AddSliderOption("Punishment Test", DebugPunishmentType, "{0}")
		endif 
		
		AddHeaderOption("$nade_Settings")
		EnabledOID_B = AddToggleOption("$nade_Enabled", ModEnabled)
		
		DefeatKeyOID_K = AddKeyMapOption("$nade_ActionKey", DefeatKey)

		NymStrippingOID_B = AddToggleOption("$nade_NymStripping", NymStripping)
		NymSpawningOID_B = AddToggleOption("$nade_NymSpawning", NymSpawning)
		NymBetaOID_B = AddToggleOption("$nade_NymBeta", NymBeta)
		HeelsFixOID_B = AddToggleOption("$nade_HeelsFix", HeelsFix)
		
		VRfixOID_B = AddToggleOption("$nade_VRfix", VRfix)
		SSEfixOID_B = AddToggleOption("$nade_SSEfix", SSEfix)
		;NoCrawlingOID_B = AddToggleOption("$nade_NoCrawling", NoCrawling)
		NakedBlurOID_B = AddToggleOption("$nade_NakedBlur", NakedBlur)
		LagFixOID_B = AddToggleOption("$nade_LagFix", LagFix)
		
		AddHeaderOption("Message & Notification Settings")
		ShowNarrativeMessagesOID_B = AddToggleOption("<font color='#ff0000'>$nade_ShowNarrativeMessages</font>", ShowNarrativeMessages)
		ShowInfoMessagesOID_B = AddToggleOption("<font color='#ff7f00'>$nade_ShowInfoMessages</font>", ShowInfoMessages)
		MessagesOID_B = AddToggleOption("<font color='#00ffff'>$nade_Messages</font>", ShowDebugMessages)	
			
	;	if SafeCont.GetNumItems()
	;		FinishQuestOID_B = AddToggleOption("$nade_FinishQuest", false, OPTION_FLAG_NONE)
	;	else
	;		FinishQuestOID_B = AddToggleOption("$nade_FinishQuest", false, OPTION_FLAG_DISABLED)
	;	endif
;		SlaveOID_B = AddToggleOption("$nade_Var12", PlayerRef.IsInFaction(SlaveFaction))

		;FOLLOWERS
		AddHeaderOption("$nade_Followers")
		
		AddTextOption("Follower Count", FollowerCount, OPTION_FLAG_DISABLED)
		AddTextOption("Follower 1", folqst.Name_Follower01, OPTION_FLAG_DISABLED)
		AddTextOption("Follower 2", folqst.Name_Follower02, OPTION_FLAG_DISABLED)
		AddTextOption("Follower 3", folqst.Name_Follower03, OPTION_FLAG_DISABLED)
		AddTextOption("Follower 4", folqst.Name_Follower04, OPTION_FLAG_DISABLED)
		AddTextOption("Follower 5", folqst.Name_Follower05, OPTION_FLAG_DISABLED)
		
		oidSavedNames_01 = AddInputOption("Named Follower 1", SavedNames_01)
		
		AddHeaderOption("Mods")
		;mod Version
	;	AddTextOption("Devious Devices Equip found:", ModDDe, OPTION_FLAG_DISABLED)
		AddTextOption("Demonic Creatures found:", ModDEM, OPTION_FLAG_DISABLED)
		if ModBiS
		AddTextOption("Bathing in Skyrim found:", ModBiS, OPTION_FLAG_DISABLED)
		elseif ModBiS_R
		AddTextOption("Bathing in Skyrim found:", ModBiS_R, OPTION_FLAG_DISABLED)
		else
		AddTextOption("Bathing in Skyrim found:", ModBiS_R, OPTION_FLAG_DISABLED)
		endif 

		AddTextOption("pchs Immersive Plugs found:", ModPLUGS, OPTION_FLAG_DISABLED)
		AddTextOption("Babo Dialogue found:", ModBABOdia, OPTION_FLAG_DISABLED)
		AddTextOption("DD Framework found:", ModDDframework, OPTION_FLAG_DISABLED)
		AddTextOption("DD NG found:", ModDDNG, OPTION_FLAG_DISABLED)
		AddTextOption("Precision found:", ModPrecision, OPTION_FLAG_DISABLED)
		AddTextOption("Devious Enchanted Chests found:", ModdbChests, OPTION_FLAG_DISABLED)
		;AddTextOption("Submissive Lola found:", ModSublo, OPTION_FLAG_DISABLED)
		
		bool naked = IsPlayerNaked()
		bool cumsoaked = IsPlayerCumsoaked()
;		bool helpless = IsPlayerHandsBound()
;		bool collared = IsPlayerCollared()
		bool guardpunish = cumsoaked ;&& !((helpless && Math.LogicalAnd(IndecencyExceptionBound, 1)) || (collared && Math.LogicalAnd(IndecencyExceptionCollared, 1)))			;NYMRA CHECK THIS LINE
;		bool civilianrape = naked ;|| (helpless && !Math.LogicalAnd(IndecencyExceptionBound, 2))) && !(collared && Math.LogicalAnd(IndecencyExceptionCollared, 2))
		bool harmlesstarget = IsPlayerNaked() && Harmlessness && IsPlayerUnarmed()
		string s
	;	AddTextOption("Follower 6", folqst.Name_Follower06, OPTION_FLAG_DISABLED)
	;	AddTextOption("Follower 7", folqst.Name_Follower07, OPTION_FLAG_DISABLED)
	;	AddTextOption("Follower 8", folqst.Name_Follower08, OPTION_FLAG_DISABLED)
	;	AddTextOption("Follower 9", folqst.Name_Follower09, OPTION_FLAG_DISABLED)
	;	AddTextOption("Follower 10", folqst.Name_Follower10, OPTION_FLAG_DISABLED)
		
		;DEBUG
	
		SetCursorPosition(1)
	;	SetCursorFillMode(TOP_TO_BOTTOM)

	;	SetCursorPosition(0)
	
		;DefeatQuest quest stage
;		AddTextOption("capturequest stage", CaptureQuest.GetStage(), OPTION_FLAG_DISABLED)
		
		;DebugAllegianceOID_B = AddQuestStageOption("Calm Enemies - Stage", AllegianceQuest)
		;AddTextOption("DHLP-suspended (external):", dhlpSuspendStatus, OPTION_FLAG_DISABLED)
		;DebugCalmOID_B = AddQuestStageOption("Defeat (MAIN) - Stage", CalmQuest)							;CalmQuest stage
		;DebugCaptureOID_B = AddQuestStageOption("Bondage Setup - Stage (", CaptureQuest)
		;DebugCaptiveOID_B = AddQuestStageOption("Escape Game - Stage", CaptiveQuest)					;ClothingQuest stage
		;AddTextOption("Robbery - Stage", ErrandQuest.GetStage()+"/"+(ErrandQuest as nade_errandquest_scr).QuestMode, OPTION_FLAG_DISABLED) ;EQUIPMENT RETRIEVEL QUEST
	
		AddHeaderOption("Load Profile")
		Load_Profile1_T = AddTextOption("Profile 1", "Load")
		Load_Profile2_T = AddTextOption("Profile 2", "Load")
		Load_Profile3_T = AddTextOption("Profile 3", "Load")
		Load_Profile4_T = AddTextOption("Profile 4", "Load")
		Load_Profile5_T = AddTextOption("Profile 5", "Load")

		AddHeaderOption("Save Profile")
		Save_Profile1_T = AddTextOption("Profile 1", "Save")
		Save_Profile2_T = AddTextOption("Profile 2", "Save")
		Save_Profile3_T = AddTextOption("Profile 3", "Save")
		Save_Profile4_T = AddTextOption("Profile 4", "Save")
		Save_Profile5_T = AddTextOption("Profile 5", "Save")
	
		AddHeaderOption("Debug Info Internal")	
		AddTextOption("Player defeated (hostiles):", DefeatQuestRunning, OPTION_FLAG_DISABLED)
		AddTextOption("Player punished (public):", CivilRapeRunning, OPTION_FLAG_DISABLED)	
		AddTextOption("Enemies Type", DefeatTypeGeneral, OPTION_FLAG_DISABLED)
		AddTextOption("Defeat Type", DefeatType, OPTION_FLAG_DISABLED)
		AddTextOption("Scenario:", DefeatTypeScenario, OPTION_FLAG_DISABLED)
		AddTextOption("Player State:", DefeatStateChapter, OPTION_FLAG_DISABLED)
		AddTextOption("Calmquest Stage:", CalmQuest.GetStage(), OPTION_FLAG_DISABLED)
		
		AddTextOption("Player Monitor Running:", PlayerMonitorOn, OPTION_FLAG_DISABLED)	
		
		AddHeaderOption("Debug Info External")		;Quest Variables
		AddTextOption("NaDe suspended by DHLP-Suspend:", dhlpSuspendStatus, OPTION_FLAG_DISABLED)	
		;AddTextOption("POP running:", IsArrestedPOP(), OPTION_FLAG_DISABLED)
		AddTextOption("Player in zbfSlaveFaction:", IsSlave(PlayerRef), OPTION_FLAG_DISABLED)
	;	AddHeaderOption("")		;Quest Variable
	;	AddTextOption("Monitoring - Stage", DefeatQuest.GetStage(), OPTION_FLAG_DISABLED)	
	
;----------------------------------------------------------------------------------------------------
		
;>>>>>>>>>>>>>>>>> PAGE 2 >>>>>>>>>> OPTIONS: Defeat & Sex >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
				
	elseif (page == "$nade_OptionsDefeat")				
						
		SetCursorFillMode(TOP_TO_BOTTOM)
		
		SetCursorPosition(0)
	
		AddHeaderOption("Defeat Start Options")															;Start Options	
		
		BleedoutCounterOID_S = AddSliderOption("<font color='#ff0000'>$nade_BleedoutCounter</font>", BleedoutCounter, "{0}%")		;DefeatChance on Bleedout	
		DefeatShortProbOID_S = AddSliderOption("$nade_DefeatShortProb", DefeatShortProb, "{0}%")
		
	
		;DefeatSpotAndEscapeOID_B = AddToggleOption("$nade_DefeatSpotAndEscape", DefeatSpotAndEscape)	
		AddHeaderOption("")
		DefeatFindSpot_OID_M = AddMenuOption("$nade_DefeatFindSpot", DefeatFindSpotList[DefeatFindSpot])
		FindSpotTimeOID_S = AddSliderOption("$nade_FindSpotTime", FindSpotTime, "{0} sec")
		AddHeaderOption("")
		;AddHeaderOption("")
		RagdollOID_B = AddToggleOption("$nade_Ragdoll", Ragdoll)
		;RemoveDDsOID_B = AddToggleOption("$nade_RemoveDDs", RemoveDDs)									;Always Remove DD items before rape
		RemoveDDChanceOID_S = AddSliderOption("<font color='#6a5acd'>$nade_RemoveDDChance</font>", RemoveDDChance, "{0}%")
		
		;GodModeOID_B = AddToggleOption("$nade_GodMode", GodMode)										;add godmode for the duration of defeat
		HealthBoostOID_B = AddToggleOption("$nade_HealthBoost", HealthBoost)							;add 100000 health during defeat	
		NoEssentialPlayerOID_B = AddToggleOption("$nade_NoEssentialPlayer", NoEssentialPlayer)			;remove EssentialPlayer			
		PlayExpressionsOID_B = AddToggleOption("$nade_PlayExpressions", PlayExpressions)				;toggles forced expressions during rape
		
		SetCursorPosition(1)

		AddHeaderOption("$nade_SexOptions")															;Rape Options

		SkipSexOID_B = AddToggleOption("$nade_SkipSex", SkipSex)
		NakedCummingOID_B = AddToggleOption("$nade_NakedCumming", NakedCumming) 
		FemalesAllowedOID_B = AddToggleOption("$nade_FemalesAllowed", FemalesAllowed)					;Allow Female Rapers
		AllowCreaturesOID_B = AddToggleOption("$nade_AllowCreatures", AllowCreatures)					;AllowCreatures
		StageGoBackOID_B = AddToggleOption("$nade_StageGoBack", StageGoBack)
		MaleFollowerOID_B = AddToggleOption("$nade_MaleFollower", MaleFollower)	
		FemaleFollowerOID_B = AddToggleOption("$nade_FemaleFollower", FemaleFollower)
		FemalesAsMalesOID_S = AddSliderOption("$nade_FemalesAsMales", FemalesAsMales, "{0}%")
		AddHeaderOption("")
		SearchRadiusOID_S = AddSliderOption("$nade_SearchRadius", SearchRadius, "{0} units")			;SearchRadius
		SearchRadiusInteriorOID_S = AddSliderOption("$nade_SearchRadiusInterior", SearchRadiusInterior, "{0} units")			;SearchRadiusInterior
		AddHeaderOption("")
		ScenarioChanceOID_S = AddSliderOption("$nade_ScenarioChance", ScenarioChance, "{0}%")				;ScenarioChance
		DefeatPeeProbOID_S = AddSliderOption("$nade_DefeatPeeProb", DefeatPeeProb, "{0}%")				;Forced bathing event chance 
		Group5PchanceOID_S = AddSliderOption("$nade_Group5Pchance", Group5Pchance, "{0}%")					;Gangrape chance
		Group4PchanceOID_S = AddSliderOption("$nade_Group4Pchance", Group4Pchance, "{0}%")					;Gangrape chance
		Group3PchanceOID_S = AddSliderOption("$nade_Group3Pchance", Group3Pchance, "{0}%")					;Gangrape chance
		DefeatChainOID_S = AddSliderOption("$nade_ChainRape", DefeatChainProb, "{0}%")					;Chainrape chance
		DefeatForeplayChanceOID_S = AddSliderOption("$nade_DefeatForeplayChance", DefeatForeplayChance, "{0}%")
		DefeatIdleTimeOID_S = AddSliderOption("$nade_DefeatIdleTime", DefeatIdleTime, "{0} sec")	

		AddHeaderOption("Sexlab Custom Tags")
		oidTagInput_01 = AddInputOption("Tags 1", SavedTags_01)
		oidTagInput_02 = AddInputOption("Tags 2", SavedTags_02)
		oidTagInput_03 = AddInputOption("Tags 3", SavedTags_03)
		oidTagInput_04 = AddInputOption("Tags 4", SavedTags_04)
		oidTagInput_05 = AddInputOption("Supressed Tags", SavedTags_05)
		
;----------------------------------------------------------------------------------------------------


;>>>>>>>>>>>>>>>>> PAGE 3 >>>>>>>>>> OPTIONS: Aftermath >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

	elseif (page == "$nade_OptionsAftermath") 
	
	SetCursorFillMode(TOP_TO_BOTTOM)
	SetCursorPosition(0)
	
	AddHeaderOption("Captivity Options (Escape Game)")												;Captivity Options	
	;--- Captivtiy Chance [<- slider ->]
	DefeatCaptivityOID_S = AddSliderOption("$nade_Captivity", DefeatCaptivityProb, "{0}%")			;Captivity event chance
	;--- DDe Weight (replace) [<- slider ->]
	DefeatDDeProbOID_S = AddSliderOption("<font color='#6a5acd'>$nade_DefeatDDeProb</font>", DefeatDDeProb)				;DDe weight
	;									 "<font color='#6a5acd'>$nade_BleedoutCounter</font>"
	AddHeaderOption("")	
	;--- Wiggle Key [KEY] 
	EscapeKeyOID_K = AddKeyMapOption("$nade_EscapeKey", EscapeKey)									;Wiggle free from furniture	
	
	;--- Wiggle Difficulty Defeat [Dropdown] 
	WiggleOptions_OID_M = AddMenuOption("$nade_WiggleOptions", WiggleOptionsList[WiggleOptions])
	;--- Wiggle Difficulty Slavery [Dropdown] 
	WiggleOptionsSS_OID_M = AddMenuOption("$nade_WiggleOptionsSS", WiggleOptionsSSList[WiggleOptionsSS])
	
	
	;SimpleSurrenderOID_B = AddToggleOption("$nade_SimpleSurrender", SimpleSurrender)
	;--- Delete Placed Furnitures [ ] ---;
	ToggleDeleteDeviceOID_B = AddToggleOption("$nade_ToggleDeleteDevice", ToggleDeleteDevice)		;ToggleDeleteDevice
	
	AddHeaderOption("")	
	DefeatEscapeCrawl_OID_M = AddMenuOption("$nade_DefeatEscapeCrawl", DefeatEscapeCrawlList[DefeatFindSpot])
	DefeatEscTimeOID_S = AddSliderOption("$nade_EscTime", DefeatEscTime, "{0} sec")	
	;DefeatSpeedMultOID_S = AddSliderOption("$nade_DefeatSpeedMult", DefeatSpeedMult, "{0}")	
	
	AddHeaderOption("Furniture Escape Events")
	PunishWhipChanceOID_S = AddSliderOption("$nade_PunishWhipChance", PunishWhipChance, "{0}%")
	PunishSexChanceOID_S = AddSliderOption("$nade_PunishSexChance", PunishSexChance, "{0}%")
	PunishBukkakeChanceOID_S = AddSliderOption("$nade_PunishBukkakeChance", PunishBukkakeChance, "{0}%")
		
	SetCursorPosition(1)	
		
	AddHeaderOption("Whipping Options")
	DefeatWhipProbOID_S = AddSliderOption("$nade_DefeatWhipProb", DefeatWhipProb, "{0}%")			;Whip chance
	DefeatWhipTimeOID_S = AddSliderOption("$nade_DefeatWhipTime", DefeatWhipTime, "{0} sec")		;Whip time
	DefeatSceneProtectorsOID_B = AddToggleOption("$nade_DefeatSceneProtectors", DefeatSceneProtectors)	
		
	AddHeaderOption("Rescue Options")														;Aftermath Options
	DefeatRescueProbOID_S = AddSliderOption("$nade_DefeatRescueProb", DefeatRescueProb, "{0}%")
	;#todo Dropped in the Wild

	AddHeaderOption("Slavery Options")	
	DefeatSlaveryOID_S = AddSliderOption("$nade_Slavery", DefeatSlaveryProb, "{0}%")	
	DefeatSDweightOID_S = AddSliderOption("$nade_DefeatSDweight", DefeatSDweight, "{0}%")
	
	AddHeaderOption("Robbery Options")
	DefeatRobberyOID_S = AddSliderOption("$nade_Robbery", DefeatRobberyProb, "{0}%")
	DefeatRobberyGoldOID_B = AddToggleOption("$nade_DefeatRobberyGold", DefeatRobberyGold)			;toggle rob gold only
	
	AddHeaderOption("Death & Execution Options")
	DefeatDeathChanceOID_S = AddSliderOption("$nade_DefeatDeathChance", DefeatDeathChance, "{0}%")
	
	
	
;	AddHeaderOption("Death Options")
;	NakedDeathChanceOID_S = AddSliderOption("$nade_NakedDeathChance", NakedDeathChance, "{0}%")

	

;----------------------------------------------------------------------------------------------------

;>>>>>>>>>>>>>>>>> PAGE 4 >>>>>>>>>> OPTIONS: Combat >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>		##combat##
	
elseif (page == "$nade_OptionsCombat")		

		SetCursorFillMode(TOP_TO_BOTTOM)
		SetCursorPosition(0)
		AddHeaderOption("$nade_Clothing")
		
		DefeatBreakArmorOID_B = AddToggleOption("$nade_BreakArmor", DefeatBreakArmor)
		DefeatBreakClothingOID_S = AddSliderOption("$nade_BreakClothing", DefeatBreakClothingProb, "{0}%")
		AddTextOption("Naked Loot: Find Clothing chance:", LootClothingProb+"%", OPTION_FLAG_DISABLED)
		AddTextOption("Naked Loot: Fitting Cost Clothing:", LootFittingCostClothingInt+" Gold", OPTION_FLAG_DISABLED)
		
		;LIGHT ARMOR
		DefeatBreakLightOID_S = AddSliderOption("$nade_BreakLight", DefeatBreakLightProb, "{0}%")
		AddTextOption("Naked Loot: Find Light Armor chance", LootBreakLightProb+"%",OPTION_FLAG_DISABLED)
		AddTextOption("Naked Loot: Fitting Cost Light Armor", LootFittingCostLightInt+" Gold", OPTION_FLAG_DISABLED)
		
		;HEAVY ARMOR
		DefeatBreakHeavyOID_S = AddSliderOption("$nade_BreakHeavy", DefeatBreakHeavyProb, "{0}%")	
		AddTextOption("Naked Loot: Find Heavy Armor chance", LootBreakHeavyProb+"%",OPTION_FLAG_DISABLED)
		AddTextOption("Naked Loot: Fitting Cost Heavy Armor", LootFittingCostHeavyInt+" Gold", OPTION_FLAG_DISABLED)
			
		CriticalDefeatOID_S = AddSliderOption("<font color='#ff0000'>$nade_CriticalDefeat</font>", CriticalDefeat, "{0}%")	
		NakedChanceOID_S = AddSliderOption("<font color='#ff0000'>$nade_NakedChance</font>", NakedChance, "{0}%")
	
		;DropItemOID_B = AddToggleOption("$nade_DropItem", DropItem)
		SlipperyOID_B = AddToggleOption("$nade_Slippery", Slippery)	
		StripAttackOID_B = AddToggleOption("$nade_StripAttack", StripAttack)
		StripOptions_OID_M = AddMenuOption("$nade_StripOptions", StripOptionsList[StripOptions])
		;IndecencyGenderOID_M = AddMenuOption("$ndun_IndecencyGender", IndecencyGenderList[IndecencyGender])
		
		;PosesDefeatOID_M = AddMenuOption("$ndun_PosesDefeat", PosesDefeat.Length+" pose(s)")
		
		
		;#BLOCK SLOTS ;from xpopconfig (drop down menue selection)
		;oidTravelSpeed = MyAddMenuOption("Captor's Travel Speed", xpop.xpopTravelSpeed.GetValueInt(), sTravelSpeed, 3, "Here you can choose your captor's travel speed.")
		
	;	MoanOnHitOID_B = AddToggleOption("$nade_MoanOnHit", MoanOnHit)
		MoanOnHitChanceOID_S = AddSliderOption("$nade_MoanOnHitChance", MoanOnHitChance, "{0}%")

		SetCursorPosition(1)
		
		AddHeaderOption("$nade_SurrenderOptions")
		WeaponOutSurrenderOID_B = AddToggleOption("$nade_WeaponOutSurrender", WeaponOutSurrender)
		CooperativeSurrenderChanceOID_S = AddSliderOption("$nade_CooperativeSurrenderChance", CooperativeSurrenderChance, "{0}%")
		
		AddHeaderOption("Follower Protection Options")
		DefeatDowntimeOID_S = AddSliderOption("$nade_DefeatDowntime", DefeatDowntime, "{0} sec")
		DefeatGetUpOID_B = AddToggleOption("$nade_DefeatGetUp", DefeatGetUp)	

;----------------------------------------------------------------------------------------------------

;>>>>>>>>>>>>>>>>> PAGE 5 >>>>>>>>>> OPTIONS: Public Punishment >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>		##public##
	
	elseif (page == "$nade_OptionsPublicPunish") 

;	AddHeaderOption("This page is a placeholder for future updates")
	;
		SetCursorFillMode(TOP_TO_BOTTOM)
;;
		SetCursorPosition(0)
		AddHeaderOption("$nade_Indecency")
;		IndecencyRapeOID_S = AddSliderOption("$nade_IndecencyRape", IndecencyRapeProb, "{0}%")												;HARMLESS AND GUARDPUNISHMENT
;		IndecencyGenderOID_M = AddMenuOption("$nade_IndecencyGender", IndecencyGenderList[IndecencyGender])
;		IndecencyRobberyOID_S = AddSliderOption("$nade_IndecencyRobbery", IndecencyRobberyProb, "{0}%")
		GuardPunishOID_B = AddToggleOption("$nade_IndecencyEnabled", Indecency)									;GUARD PUNISHMENT TOGGLE
		ExposureChanceOID_S = AddSliderOption("$nade_ExposureChance", ExposureChance, "{0}")	
		AddTextOption("Punishment Chance when Exposure = 10", DisplayExposure+"%",OPTION_FLAG_DISABLED)
		LoopTime_OID_S = AddSliderOption("$nade_LoopTime", LoopTime, "{0} sec")

		DefeatArrestProbOID_S = AddSliderOption("$nade_DefeatArrestProb", DefeatArrestProb, "{0}%")
		
		PunishShortProbOID_S = AddSliderOption("$nade_PunishShortProb", PunishShortProb, "{0}%")
		NoExtraOID_B = AddToggleOption("$nade_NoExtra", NoExtra)

		SetCursorPosition(1)
		
		AddHeaderOption("Punishment Weights")
		Naked_Weight_OID_S = AddSliderOption("$nade_Naked_Weight", Naked_Weight, "{0}")
		
		;if IsNymrasGame()
		AddTextOption("Exposure Gain Chance/Tick", DisplayWeight[0]+"%",OPTION_FLAG_DISABLED)
		;endif 
		Barefoot_Weight_OID_S = AddSliderOption("$nade_Barefoot_Weight", Barefoot_Weight, "{0}")
		AddTextOption("Exposure Gain Chance/Tick", DisplayWeight[1]+"%",OPTION_FLAG_DISABLED)
		Dirty_Weight_OID_S = AddSliderOption("$nade_Dirty_Weight", Dirty_Weight, "{0}")
		AddTextOption("Exposure Gain Chance/Tick", DisplayWeight[2]+"%",OPTION_FLAG_DISABLED)
		Sneaking_Weight_OID_S = AddSliderOption("$nade_Sneaking_Weight", Sneaking_Weight, "{0}")
		AddTextOption("Exposure Gain Chance/Tick", DisplayWeight[3]+"%",OPTION_FLAG_DISABLED)
		Running_Weight_OID_S = AddSliderOption("$nade_Running_Weight", Running_Weight, "{0}")
		AddTextOption("Exposure Gain Chance/Tick", DisplayWeight[4]+"%",OPTION_FLAG_DISABLED)
		Sprinting_Weight_OID_S = AddSliderOption("$nade_Sprinting_Weight", Sprinting_Weight, "{0}")
		AddTextOption("Exposure Gain Chance/Tick", DisplayWeight[5]+"%",OPTION_FLAG_DISABLED)
		Cum_Weight_OID_S = AddSliderOption("$nade_Cum_Weight", Cum_Weight, "{0}")
		AddTextOption("Exposure Gain Chance/Tick", DisplayWeight[6]+"%",OPTION_FLAG_DISABLED)
		Unarmed_Weight_OID_S = AddSliderOption("$nade_Unarmed_Weight", Unarmed_Weight, "{0}")		
		AddTextOption("Exposure Gain Chance/Tick", DisplayWeight[7]+"%",OPTION_FLAG_DISABLED)
			
			
;>>>>>>>>>>>>>>>>> PAGE 6 >>>>>>>>>> OPTIONS: Extra Features >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
	
elseif (page == "$nade_OptionsExtras") 

;	AddHeaderOption("This page is a placeholder for future updates")
	;
		SetCursorFillMode(TOP_TO_BOTTOM)
;;
		SetCursorPosition(0)

		AddHeaderOption("$nade_BodyVisuals")
		WhipMarksOID_B = AddToggleOption("$nade_WhipMarks", WhipMarks)											;WHIPMARKS TOGGLE
		RapeHandsProbOID_S = AddSliderOption("$nade_RapeHandsProb", RapeHandsProb, "{0}%")		
		WhipmarksDurOID_S = AddSliderOption("$nade_WhipMarksDuration", WhipmarksDur, "{0} hrs")					;WHIPMARKS DURATION SLIDER	

		AddHeaderOption("$nade_HairCut")																		;HAIRCUT TOGGLE	
		BondageHaircutOID_S = AddSliderOption("$nade_BondageHaircut", BondageHaircutProb, "{0}%")
	;	HairRegrowthOID_S = AddSliderOption("$nade_HairRegrowthTime", HairRegrowthTime, "{0} hrs")
		
		AddHeaderOption("Naked Slavery")
		SSHandlingOID_B = AddToggleOption("$nade_SSHandling", SSHandling)	
		
		AddHeaderOption("Devious Devices [DD] Options")
		KeyDDWiggleFreeChance_OID_S = AddSliderOption("<font color='#6a5acd'>$nade_KeyDDWiggleFreeChance</font>", KeyDDWiggleFreeChance, "{0}%")		;Falling DEFEAT
		KeyDDWiggleFreeFailChance_OID_S = AddSliderOption("<font color='#6a5acd'>$nade_KeyDDWiggleFreeFailChance</font>", KeyDDWiggleFreeFailChance, "{0}%")		;Falling DEFEAT
		DeviousPiercingEffectsOID_B = AddToggleOption("<font color='#6a5acd'>$nade_DeviousPiercingEffects</font>", DeviousPiercingEffects)

		SetCursorPosition(1)
	
		AddHeaderOption("Naked Loot")
		NakedLootOID_B = AddToggleOption("$nade_NakedLoot", NakedLoot)	
		NakedLootHotkeysOID_B = AddToggleOption("$nade_NakedLootHotkeys", NakedLootHotkeys)

		AddHeaderOption("$nade_PoisonDefeat")
		PoisonDefeatChanceOID_S = AddSliderOption("$nade_PoisonDefeatChance", PoisonDefeatChance, "{0}%")		;POISON DEFEAT
		
		AddHeaderOption("$nade_NakedDrowning")
		NakedDrowningOID_B = AddToggleOption("$nade_NakedDrowning", NakedDrowning)		;POISON DEFEAT
		
		AddHeaderOption("$nade_NakedTravelling")
		NakedTravelOID_B = AddToggleOption("$nade_NakedTravelling", NakedTravel)		;POISON DEFEAT
		
		AddHeaderOption("$nade_NakedFalling")
		FallingDamageTreshold_OID_S = AddSliderOption("$nade_NakedFalling", FallingDamageTreshold)		;Falling DEFEAT



;>>>>>>>>>>>>>>>>> PAGE 7 >>>>>>>>>> LIBARY: Outfits >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
	
elseif (page == "$nade_LibraryOutfitsTags")			
	
		SetCursorFillMode(TOP_TO_BOTTOM)
;;
		SetCursorPosition(0)
		AddHeaderOption("Save your Outfits here")
		;Save_Outfit_01_T = AddTextOption("Outfit 1: "+Outfit_01_Type, "Save")
		;Save_Outfit_01_T = AddTextOption(outfit_01_name, "Save")
		Save_Outfit_01_T = AddInputOption("01: "+outfit_JSON_01_type, outfit_JSON_01_name)	;BOTH GET SAVED and LOADED IN PROFILE JSON
		Save_Outfit_02_T = AddInputOption("02: "+outfit_JSON_02_type, outfit_JSON_02_name)
		Save_Outfit_03_T = AddInputOption("03: "+outfit_JSON_03_type, outfit_JSON_03_name)
		Save_Outfit_04_T = AddInputOption("04: "+outfit_JSON_04_type, outfit_JSON_04_name)
		Save_Outfit_05_T = AddInputOption("05: "+outfit_JSON_05_type, outfit_JSON_05_name)
		Save_Outfit_06_T = AddInputOption("06: "+outfit_JSON_06_type, outfit_JSON_06_name)
		Save_Outfit_07_T = AddInputOption("07: "+outfit_JSON_07_type, outfit_JSON_07_name)
		Save_Outfit_08_T = AddInputOption("08: "+outfit_JSON_08_type, outfit_JSON_08_name)
		Save_Outfit_09_T = AddInputOption("09: "+outfit_JSON_09_type, outfit_JSON_09_name)
		Save_Outfit_10_T = AddInputOption("10: "+outfit_JSON_10_type, outfit_JSON_10_name)
		
		AddHeaderOption("Save your Weapons here")
		;Save_Outfit_01_T = AddTextOption("Outfit 1: "+Outfit_01_Type, "Save")
		;Save_Outfit_01_T = AddTextOption(outfit_01_name, "Save")
		Save_weapon_01_T = AddInputOption("01: "+weapon_JSON_01_type, weapon_JSON_01_name)
		Save_weapon_02_T = AddInputOption("02: "+weapon_JSON_02_type, weapon_JSON_02_name)
		Save_weapon_03_T = AddInputOption("03: "+weapon_JSON_03_type, weapon_JSON_03_name)
		Save_weapon_04_T = AddInputOption("04: "+weapon_JSON_04_type, weapon_JSON_04_name)
		Save_weapon_05_T = AddInputOption("05: "+weapon_JSON_05_type, weapon_JSON_05_name)
		Save_weapon_06_T = AddInputOption("06: "+weapon_JSON_06_type, weapon_JSON_06_name)
		Save_weapon_07_T = AddInputOption("07: "+weapon_JSON_07_type, weapon_JSON_07_name)
		Save_weapon_08_T = AddInputOption("08: "+weapon_JSON_08_type, weapon_JSON_08_name)
		Save_weapon_09_T = AddInputOption("09: "+weapon_JSON_09_type, weapon_JSON_09_name)
		Save_weapon_10_T = AddInputOption("10: "+weapon_JSON_10_type, weapon_JSON_10_name)
		
		AddHeaderOption("Punishment Outfits")
		AddHeaderOption("WIP - Will return later and better")
		;/
		oidTextInput_01 = AddInputOption("Outfit 1", SavedText_01)
		oidTextInput_02 = AddInputOption("Outfit 2", SavedText_02)
		oidTextInput_03 = AddInputOption("Outfit 3", SavedText_03)
		oidTextInput_04 = AddInputOption("Outfit 4", SavedText_04)
		oidTextInput_05 = AddInputOption("Outfit 5", SavedText_05)
		
		oidTextInput_06 = AddInputOption("Outfit 6", SavedText_06)
		oidTextInput_07 = AddInputOption("Outfit 7", SavedText_07)
		oidTextInput_08 = AddInputOption("Outfit 8", SavedText_08)
		oidTextInput_09 = AddInputOption("Outfit 9", SavedText_09)
		oidTextInput_10 = AddInputOption("Outfit 10", SavedText_10)
		/;
		
		;/
		AddHeaderOption("Bound Punishments")
		AddTextOption("Keywords: Pain, Belt, Whip, Rape", Option_Flag_Disabled)
		AddTextOption("Setting a keyword often increases its chance", Option_Flag_Disabled)
		oidPunishmentInput_01 = AddInputOption("Punishment 1", SavedPunishment_01)
		oidPunishmentInput_02 = AddInputOption("Punishment 2", SavedPunishment_02)
		oidPunishmentInput_03 = AddInputOption("Punishment 3", SavedPunishment_03)
		oidPunishmentInput_04 = AddInputOption("Punishment 4", SavedPunishment_04)
		oidPunishmentInput_05 = AddInputOption("Punishment 5", SavedPunishment_05)
		oidPunishmentInput_06 = AddInputOption("Punishment 6", SavedPunishment_06)
		oidPunishmentInput_07 = AddInputOption("Punishment 7", SavedPunishment_07)
		oidPunishmentInput_08 = AddInputOption("Punishment 8", SavedPunishment_08)
		oidPunishmentInput_09 = AddInputOption("Punishment 9", SavedPunishment_09)
		oidPunishmentInput_10 = AddInputOption("Punishment 10", SavedPunishment_10)
	
		/;
		SetCursorPosition(1)
		
		AddHeaderOption("Load your Outfits here (cheat)")
		Load_Outfit_01_T = AddTextOption("01: "+outfit_JSON_01_name+" :: "+outfit_JSON_01_type , "Load")
		Load_Outfit_02_T = AddTextOption("02: "+outfit_JSON_02_name+" :: "+outfit_JSON_02_type , "Load")
		Load_Outfit_03_T = AddTextOption("03: "+outfit_JSON_03_name+" :: "+outfit_JSON_03_type , "Load")
		Load_Outfit_04_T = AddTextOption("04: "+outfit_JSON_04_name+" :: "+outfit_JSON_04_type , "Load")
		Load_Outfit_05_T = AddTextOption("05: "+outfit_JSON_05_name+" :: "+outfit_JSON_05_type , "Load")
		Load_Outfit_06_T = AddTextOption("06: "+outfit_JSON_06_name+" :: "+outfit_JSON_06_type , "Load")
		Load_Outfit_07_T = AddTextOption("07: "+outfit_JSON_07_name+" :: "+outfit_JSON_07_type , "Load")
		Load_Outfit_08_T = AddTextOption("08: "+outfit_JSON_08_name+" :: "+outfit_JSON_08_type , "Load")
		Load_Outfit_09_T = AddTextOption("09: "+outfit_JSON_09_name+" :: "+outfit_JSON_09_type , "Load")
		Load_Outfit_10_T = AddTextOption("10: "+outfit_JSON_10_name+" :: "+outfit_JSON_10_type , "Load")
		
		AddHeaderOption("Load your Weapons here (cheat)")
		Load_weapon_01_T = AddTextOption("01: "+weapon_JSON_01_name+" :: "+weapon_JSON_01_type , "Load")
		Load_weapon_02_T = AddTextOption("02: "+weapon_JSON_02_name+" :: "+weapon_JSON_02_type , "Load")
		Load_weapon_03_T = AddTextOption("03: "+weapon_JSON_03_name+" :: "+weapon_JSON_03_type , "Load")
		Load_weapon_04_T = AddTextOption("04: "+weapon_JSON_04_name+" :: "+weapon_JSON_04_type , "Load")
		Load_weapon_05_T = AddTextOption("05: "+weapon_JSON_05_name+" :: "+weapon_JSON_05_type , "Load")
		Load_weapon_06_T = AddTextOption("06: "+weapon_JSON_06_name+" :: "+weapon_JSON_06_type , "Load")
		Load_weapon_07_T = AddTextOption("07: "+weapon_JSON_07_name+" :: "+weapon_JSON_07_type , "Load")
		Load_weapon_08_T = AddTextOption("08: "+weapon_JSON_08_name+" :: "+weapon_JSON_08_type , "Load")
		Load_weapon_09_T = AddTextOption("09: "+weapon_JSON_09_name+" :: "+weapon_JSON_09_type , "Load")
		Load_weapon_10_T = AddTextOption("10: "+weapon_JSON_10_name+" :: "+weapon_JSON_10_type , "Load")


;----------------------------------------------------------------------------------------------------

;>>>>>>>>>>>>>>>>> PAGE 8 >>>>>>>>>> LIBRARY: CreatureToggles >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

elseif (page == "$nade_LibraryCreatures")			
	
		SetCursorFillMode(TOP_TO_BOTTOM)

		SetCursorPosition(0)
		
		AddHeaderOption("Humanoids")
		AllowArgonKajitOID_B = AddToggleOption("$nade_AllowArgonKajit", AllowArgonKajit) 					;argonian/kajit
		AllowHumanoidBeastsOID_B = AddToggleOption("$nade_AllowHumanoidBeasts", AllowHumanoidBeasts)		;Gargoyles // Werewolves // Trolls // Giants // Lurkers			
		AllowUndeadOID_B = AddToggleOption("$nade_AllowUndead", AllowUndead)								;draugr // skelettons // dragonpriests // vampirelord 	
		AllowRieklingsOID_B = AddToggleOption("$nade_AllowRieklings", AllowRieklings)						;rieklings and boars
		AllowFalmersOID_B = AddToggleOption("$nade_AllowFalmers", AllowFalmers)
		
		AllowSpriggansOID_B = AddToggleOption("$nade_AllowSpriggans", AllowSpriggans)
		AllowElementalsFemaleOID_B = AddToggleOption("$nade_AllowElementalsFemale", AllowElementalsFemale)	;Atronach Flame // WispMothers // Hagravens
		AllowElementalsMaleOID_B = AddToggleOption("$nade_AllowElementalsMale", AllowElementalsMale)		;Atronach Storm // Atronach Frost // Wisps // IceWraiths //
		AllowTentacleStuffOID_B = AddToggleOption("$nade_AllowTentacleStuff", AllowTentacleStuff)		;Seekers // Tentacle animations	
			
		AddHeaderOption("Predators")
		AllowInsectsOID_B = AddToggleOption("$nade_AllowInsects", AllowInsects)								;charus // chaurushunter // chaurusreaper // ashhopper
		AllowSpidersOID_B = AddToggleOption("$nade_AllowSpiders", AllowSpiders)								;all spider sizes	
		AllowSabreCatsOID_B = AddToggleOption("$nade_AllowSabreCats", AllowSabreCats)	
		AllowSkeeversOID_B = AddToggleOption("$nade_AllowSkeevers", AllowSkeevers)
		AllowBearsOID_B = AddToggleOption("$nade_AllowBears", AllowBears)
		AllowCaninesOID_B = AddToggleOption("$nade_AllowCanines", AllowCanines)
	;	AllowDragonsOID_B = AddToggleOption("$nade_AllowDragons", AllowDragons)
		
		SetCursorPosition(1)
		
		AddHeaderOption("Wild Animals")
		AllowDeersOID_B = AddToggleOption("$nade_AllowDeers", AllowDeers)
		AllowFoxesOID_B = AddToggleOption("$nade_AllowFoxes", AllowFoxes)
		AllowRabbitsOID_B = AddToggleOption("$nade_AllowRabbits", AllowRabbits)
		AllowHorkersOID_B = AddToggleOption("$nade_AllowHorkers", AllowHorkers)
		AllowMammothsOID_B = AddToggleOption("$nade_AllowMammoths", AllowMammoths)
		
		AddHeaderOption("Domestic Animals")	
		AllowHorsesOID_B = AddToggleOption("$nade_AllowHorses", AllowHorses)
		AllowCowsOID_B = AddToggleOption("$nade_AllowCows", AllowCows)
		AllowChickenOID_B = AddToggleOption("$nade_AllowChicken", AllowChicken)
		AllowGoatsOID_B = AddToggleOption("$nade_AllowGoats", AllowGoats)
	
		AddHeaderOption("Other Creatures")	
		AllowDwarvenOID_B = AddToggleOption("$nade_AllowDwarven", AllowDwarven)
		;AllowNetchesOID_B = AddToggleOption("$nade_AllowNetches", AllowNetches)

;>>>>>>>>>>>>>>>>> PAGE 9 >>>>>>>>>> LIBRARY: Hair >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>		
		
elseif (page == "$nade_LibraryHairs")			
		
		SetCursorFillMode(TOP_TO_BOTTOM)
		
		SetCursorPosition(0)
		
		AddHeaderOption("Current Hairstyle")
		AddTextOption("$nade_HairCurrent", GetCurrentHair().GetPartName(), OPTION_FLAG_DISABLED)
		
		AddHeaderOption("Original Hairstyles")
	;	AddTextOption("$nade_HairOriginal", SavedHair_00, OPTION_FLAG_DISABLED)	
		oidHairInput_00 = AddInputOption("Original Hair", SavedHair_00)
		oidHairInput_11 = AddInputOption("Original Hair 2", SavedHair_11)
		oidHairInput_12 = AddInputOption("Original Hair 3", SavedHair_12)
		oidHairInput_13 = AddInputOption("Original Hair 4", SavedHair_13)
		oidHairInput_14 = AddInputOption("Original Hair 5", SavedHair_14)
		oidHairInput_15 = AddInputOption("Original Hair 6", SavedHair_15)
		oidHairInput_16 = AddInputOption("Original Hair 7", SavedHair_16)
		oidHairInput_17 = AddInputOption("Original Hair 8", SavedHair_17)
		oidHairInput_18 = AddInputOption("Original Hair 9", SavedHair_18)
		oidHairInput_19 = AddInputOption("Original Hair 10", SavedHair_19)
		oidHairInput_20 = AddInputOption("Original Hair 11", SavedHair_20)
		
		SetCursorPosition(1)
		AddHeaderOption("Forced Hairstyles")
		oidHairInput_01 = AddInputOption("Forced Hair 1", SavedHair_01)
		oidHairInput_02 = AddInputOption("Forced Hair 2", SavedHair_02)
		oidHairInput_03 = AddInputOption("Forced Hair 3", SavedHair_03)
		oidHairInput_04 = AddInputOption("Forced Hair 4", SavedHair_04)
		oidHairInput_05 = AddInputOption("Forced Hair 5", SavedHair_05)
		
		oidHairInput_06 = AddInputOption("Forced Hair 6", SavedHair_06)
		oidHairInput_07 = AddInputOption("Forced Hair 7", SavedHair_07)
		oidHairInput_08 = AddInputOption("Forced Hair 8", SavedHair_08)
		oidHairInput_09 = AddInputOption("Forced Hair 9", SavedHair_09)
		oidHairInput_10 = AddInputOption("Forced Hair 10", SavedHair_10)
		
		
		
;>>>>>>>>>>>>>>>>> PAGE 10 >>>>>>>>>> LIBRARY: Slots >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>		
	
elseif (page == "$nade_LibrarySlots")			
		
		SetCursorFillMode(TOP_TO_BOTTOM)
		
		SetCursorPosition(0)
		
		AddHeaderOption("Block Slots from stripping")
		AddTextOption("Blocked Slots wont be stripped from hits", "")
		AddTextOption("or from Nymras' Strip service", "")
		
		AddHeaderOption("")
		AddTextOption("DD items are currently NEVER stripped ", "")
		AddHeaderOption("")
	;	BlockSlot30_OID_B = AddToggleOption("Slot 30", BlockSlot[0])		;30
		AddTextOption("Primary Slot 30 (Head): cannot be blocked", "")
		BlockSlot31_OID_B = AddToggleOption("Slot 31 (Hair)", BlockSlot[1])
	;	BlockSlot32_OID_B = AddToggleOption("Slot 32", BlockSlot[2])
		AddTextOption("Primary Slot 32 (Body): cannot be blocked", "")
	;	BlockSlot33_OID_B = AddToggleOption("Slot 33", BlockSlot[3])
		AddTextOption("Primary Slot 33 (Hands): cannot be blocked", "")
		BlockSlot34_OID_B = AddToggleOption("Slot 34 (Forearms)", BlockSlot[4])
		
		BlockSlot35_OID_B = AddToggleOption("Slot 35 (Amulett)", BlockSlot[5])
		BlockSlot36_OID_B = AddToggleOption("Slot 36 (Ring)", BlockSlot[6])
	;	BlockSlot37_OID_B = AddToggleOption("Slot 37", BlockSlot[7])
		AddTextOption("Primary Slot 37 (Feet): cannot be blocked", "")
		BlockSlot38_OID_B = AddToggleOption("Slot 38 (Calves)", BlockSlot[8])
		BlockSlot39_OID_B = AddToggleOption("Slot 39 (Shield)", BlockSlot[9])
		
		
		BlockSlot40_OID_B = AddToggleOption("Slot 40 (Tail)", BlockSlot[10])
		BlockSlot41_OID_B = AddToggleOption("Slot 41 (Long Hair)", BlockSlot[11])
		BlockSlot42_OID_B = AddToggleOption("Slot 42 (Circlet)", BlockSlot[12])
		BlockSlot43_OID_B = AddToggleOption("Slot 43 (Ears)", BlockSlot[13])
		
		SetCursorPosition(1)
		
		BlockSlot44_OID_B = AddToggleOption("Slot 44", BlockSlot[14])
		
		BlockSlot45_OID_B = AddToggleOption("Slot 45", BlockSlot[15])
		BlockSlot46_OID_B = AddToggleOption("Slot 46", BlockSlot[16])
		BlockSlot47_OID_B = AddToggleOption("Slot 47", BlockSlot[17])
		BlockSlot48_OID_B = AddToggleOption("Slot 48", BlockSlot[18])
		BlockSlot49_OID_B = AddToggleOption("Slot 49", BlockSlot[19])
		
		
		BlockSlot50_OID_B = AddToggleOption("Slot 50", BlockSlot[20])
		BlockSlot51_OID_B = AddToggleOption("Slot 51", BlockSlot[21])
		BlockSlot52_OID_B = AddToggleOption("Slot 52", BlockSlot[22])
		BlockSlot53_OID_B = AddToggleOption("Slot 53", BlockSlot[23])
		BlockSlot54_OID_B = AddToggleOption("Slot 54", BlockSlot[24])
		
		BlockSlot55_OID_B = AddToggleOption("Slot 55", BlockSlot[25])
		BlockSlot56_OID_B = AddToggleOption("Slot 56", BlockSlot[26])
		BlockSlot57_OID_B = AddToggleOption("Slot 57", BlockSlot[27])
		BlockSlot58_OID_B = AddToggleOption("Slot 58", BlockSlot[28])
		BlockSlot59_OID_B = AddToggleOption("Slot 59", BlockSlot[29])
		
		BlockSlot60_OID_B = AddToggleOption("Slot 60", BlockSlot[30])
		BlockSlot61_OID_B = AddToggleOption("Slot 61", BlockSlot[31])
	
;>>>>>>>>>>>>>>>>> PAGE 11 >>>>>>>>>> INFO: Shortcuts >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>		
	
	
elseif (page == "INFO: Shortcuts")			;#info
		SetCursorFillMode(TOP_TO_BOTTOM)
		
		SetCursorPosition(0)

		;--- DEFEAT ---;
		;AddHeaderOption("Defeat: Always")	
		;AddTextOption("Abort everything (cheat)", "CTRL+ALT+K")
		AddHeaderOption("Wheel Menues")
		AddTextOption("Debug Menu", "Alt + K")
		AddTextOption("Action Menu", "Shift + K")
		;--- DEFEAT find spot ---;
		AddHeaderOption("Defeat: Find Spot")		
		AddTextOption("Stop Crawling", "K")
		;AddTextOption("Spawn Flat Ground", "SHIFT+K")
		
		;--- DEFEAT captured ---;
		AddHeaderOption("Defeat: in Furniture")		
		AddTextOption("Remove Punishment Gear", "K")
		AddTextOption("Wiggle free", "SPACE")
		AddTextOption("Sold as Slave", "SHIFT+K")
		;AddTextOption("Break free (cheat)", "ALT+K")
		
		;--- after DEFEAT crawl away ---;
		AddHeaderOption("After Defeat - Crawl Away")		
		AddTextOption("Stop Crawling", "K")

		SetCursorPosition(1)
				
		;--- FREE ---;
		AddHeaderOption("While Free")	
		AddTextOption("Change Hairstyle", "K")		
		;AddTextOption("Wash yourself", "SHIFT+K")
		;AddTextOption("Fast Travel Ritual", "ALT+K")
		;AddTextOption("Public Punishment ON/OFF", "CTRL+ALT+K")
		
		;--- COMBAT ---;
		AddHeaderOption("Combat")		
		AddTextOption("Surrender", "K")
		
		AddHeaderOption("Outfit/Equipment Hotkeys")
		AddTextOption("Only work with saved outfits/weapons", "")
		AddTextOption("Equip Weapon 1->10", "1->0")
		AddTextOption("Equip Outfits 1->10", "Alt+(1->0)")
		AddTextOption("Equip Fists", "Shift+1")
		AddTextOption("Equip Random Outfit", "Shift+2")
		AddTextOption("Strip Naked", "Shift+3")
		;"ALT+(1,2,3,...,0)" will equip (animated) the saved outfit from inventory. Numbers alone (1,2,3,...,0) will equip the saved weapon from inventory. Shift+1: Fists // Shift+2: equip random outift // Shift+3: UnequipAll()

		;--- ALWAYS ---;
		AddHeaderOption("Always")		
		AddTextOption("Speed things up", "Open Console")
		AddTextOption("When stuff takes too long open/close console", "")
		AddTextOption("Especially when starting/ending sex,", "")
		AddTextOption("or while Your captors decide who goes first,", "")
		AddTextOption("or when ending crawling.", "")
		
		AddHeaderOption("INTERNAL MOD INFO")	
		AddTextOption("DefeatTypeGeneral", DefeatTypeGeneral, OPTION_FLAG_DISABLED)
		AddTextOption("DefeatType", DefeatType, OPTION_FLAG_DISABLED)
		AddTextOption("Defeat Scenario", DefeatTypeScenario, OPTION_FLAG_DISABLED)
		AddTextOption("Defeat Entrance", DefeatEntranceVia, OPTION_FLAG_DISABLED)
		
		
		
endif
EndEvent


;/
				
				elseif j == 2
				a = cfgqst.PlayerRef.GetWornForm(0x00000010)	;34 - Forearms
				
				elseif j == 3
				a = cfgqst.PlayerRef.GetWornForm(0x00000020)	;35 - Amulet 

				elseif j == 4
				a = cfgqst.PlayerRef.GetWornForm(0x00000040)	;36 - Ring 

				elseif j == 5
				a = cfgqst.PlayerRef.GetWornForm(0x00000100)	;38 - Calves
			
				elseif j == 6
				a = cfgqst.PlayerRef.GetWornForm(0x00000200)	;39 - SHIELD
				
				elseif j == 7
				a = cfgqst.PlayerRef.GetWornForm(0x00000400)	;40 - TAIL 

				elseif j == 8
				a = cfgqst.PlayerRef.GetWornForm(0x00000800)	;41 - Long Hair
			
				elseif j == 9
				a = cfgqst.PlayerRef.GetWornForm(0x00001000)	;42 - Circlet
				
				elseif j == 10
				a = cfgqst.PlayerRef.GetWornForm(0x00002000)	;43 - Ears 

				elseif j == 11
				a = cfgqst.PlayerRef.GetWornForm(0x00004000)	;44 - Unnamed 	(DD Gag/Mouth, SexlabTongue)
			
				elseif j == 12
				a = cfgqst.PlayerRef.GetWornForm(0x00008000)	;45 - Unnamed 		(DD Collars)
				
				elseif j == 13
				a = cfgqst.PlayerRef.GetWornForm(0x00010000)	;46 - Unnamed 		(DD Armbinder/Yoke, Cloaks)

				elseif j == 14
				a = cfgqst.PlayerRef.GetWornForm(0x00020000)	;47 - Unnamed 		(DD -, Backpacks, Wings)
			
				elseif j == 15
				a = cfgqst.PlayerRef.GetWornForm(0x00040000)	;48 - Unnamed 		(DD plugs anal, Backpack left pouch)

				elseif j == 16
				a = cfgqst.PlayerRef.GetWornForm(0x00080000)	;49 - Unnamed 		(DD Body harness/Chastity belt)
			
				elseif j == 17
				a = cfgqst.PlayerRef.GetWornForm(0x00100000)	;50 - Decap. Head	(DD Piercings Vaginal, bracelets)
				
				elseif j == 18
				a = cfgqst.PlayerRef.GetWornForm(0x00200000)	;51 - Decapitate 	

				elseif j == 19
				a = cfgqst.PlayerRef.GetWornForm(0x00400000)	;52 - Unnamed
			
				elseif j == 20
				a = cfgqst.PlayerRef.GetWornForm(0x00800000)	;53 - Unnamed	(DD Cuffs Legs)
			
				elseif j == 21
				a = cfgqst.PlayerRef.GetWornForm(0x01000000)	;54 - Unnamed	(DD Plugs vaginal)
			
				elseif j == 22
				a = cfgqst.PlayerRef.GetWornForm(0x02000000)	;55 - Unnamed	(DD Blindfold)
				
				elseif j == 23
				a = cfgqst.PlayerRef.GetWornForm(0x04000000)	;56 - Unnamed	(DD Chastity Bra)
				
				elseif j == 24
				a = cfgqst.PlayerRef.GetWornForm(0x08000000)	;57 - Unnamed	(DD Vaginal Plugs)
				
				elseif j == 25
				a = cfgqst.PlayerRef.GetWornForm(0x10000000)	;58 - Unnamed	(DD Body Harness/Corset
				
				elseif j == 26
				a = cfgqst.PlayerRef.GetWornForm(0x20000000)	;59 - Unnamed	(DD Cuffs Arms)
				
				elseif j == 27
				a = cfgqst.PlayerRef.GetWornForm(0x40000000)	;60 - Unnamed
				
				elseif j == 28
				a = cfgqst.PlayerRef.GetWornForm(0x80000000)	;61 - Unnamed
				
				/;


event OnOptionInputAccept(int option, string input2)						;TEXTX
	
	;/
	if (option == oidTextInput_01)
		SavedText_01 = input2
		SetInputOptionValue(oidTextInput_01, SavedText_01)
	endIf
	if (option == oidTextInput_02)
		SavedText_02 = input2
		SetInputOptionValue(oidTextInput_02, SavedText_02)
	endIf
	if (option == oidTextInput_03)
		SavedText_03 = input2
		SetInputOptionValue(oidTextInput_03, SavedText_03)
	endIf
	if (option == oidTextInput_04)
		SavedText_04 = input2
		SetInputOptionValue(oidTextInput_04, SavedText_04)
	endIf
	if (option == oidTextInput_05)
		SavedText_05 = input2
		SetInputOptionValue(oidTextInput_05, SavedText_05)
	endIf
	
	if (option == oidTextInput_06)
		SavedText_06 = input2
		SetInputOptionValue(oidTextInput_06, SavedText_06)
	endIf
	if (option == oidTextInput_07)
		SavedText_07 = input2
		SetInputOptionValue(oidTextInput_07, SavedText_07)
	endIf
	if (option == oidTextInput_08)
		SavedText_08 = input2
		SetInputOptionValue(oidTextInput_08, SavedText_08)
	endIf
	if (option == oidTextInput_09)
		SavedText_09 = input2
		SetInputOptionValue(oidTextInput_09, SavedText_09)
	endIf
	if (option == oidTextInput_10)
		SavedText_10 = input2
		SetInputOptionValue(oidTextInput_10, SavedText_10)
	endIf
	
	/;
	
	if (option == Save_Outfit_01_T)			;01
		outfit_JSON_01_name = input2
		SetInputOptionValue(Save_Outfit_01_T, outfit_JSON_01_name)
		Save_JSON_Outfit("01")
	endIf
	
	if (option == Save_Outfit_02_T)			;02
		outfit_JSON_02_name = input2
		SetInputOptionValue(Save_Outfit_02_T, outfit_JSON_02_name)
		Save_JSON_Outfit("02")
	endIf
	
	if (option == Save_Outfit_03_T)			;03
		outfit_JSON_03_name = input2
		SetInputOptionValue(Save_Outfit_03_T, outfit_JSON_03_name)
		Save_JSON_Outfit("03")
	endIf
	
	if (option == Save_Outfit_04_T)			;04
		outfit_JSON_04_name = input2
		SetInputOptionValue(Save_Outfit_04_T, outfit_JSON_04_name)
		Save_JSON_Outfit("04")
	endIf
	
	if (option == Save_Outfit_05_T)			;05
		outfit_JSON_05_name = input2
		SetInputOptionValue(Save_Outfit_05_T, outfit_JSON_05_name)
		Save_JSON_Outfit("05")
	endIf
	
	if (option == Save_Outfit_06_T)			;06
		outfit_JSON_06_name = input2
		SetInputOptionValue(Save_Outfit_06_T, outfit_JSON_06_name)
		Save_JSON_Outfit("06")
	endIf

	if (option == Save_Outfit_07_T)			;07
		outfit_JSON_07_name = input2
		SetInputOptionValue(Save_Outfit_07_T, outfit_JSON_07_name)
		Save_JSON_Outfit("07")
	endIf
	
	if (option == Save_Outfit_08_T)			;08
		outfit_JSON_08_name = input2
		SetInputOptionValue(Save_Outfit_08_T, outfit_JSON_08_name)
		Save_JSON_Outfit("08")
	endIf
	
	if (option == Save_Outfit_09_T)			;09
		outfit_JSON_09_name = input2
		SetInputOptionValue(Save_Outfit_09_T, outfit_JSON_09_name)
		Save_JSON_Outfit("09")
	endIf
	
	if (option == Save_Outfit_10_T)			;10
		outfit_JSON_10_name = input2
		SetInputOptionValue(Save_Outfit_10_T, outfit_JSON_10_name)
		Save_JSON_Outfit("10")
	endIf
	
	if (option == Save_Weapon_01_T)			;01
		Weapon_JSON_01_name = input2
		SetInputOptionValue(Save_Weapon_01_T, Weapon_JSON_01_name)
		Save_JSON_Weapon("01")
	endIf
	
	if (option == Save_Weapon_02_T)			;02
		Weapon_JSON_02_name = input2
		SetInputOptionValue(Save_Weapon_02_T, Weapon_JSON_02_name)
		Save_JSON_Weapon("02")
	endIf
	
	if (option == Save_Weapon_03_T)			;03
		Weapon_JSON_03_name = input2
		SetInputOptionValue(Save_Weapon_03_T, Weapon_JSON_03_name)
		Save_JSON_Weapon("03")
	endIf
	
	if (option == Save_Weapon_04_T)			;04
		Weapon_JSON_04_name = input2
		SetInputOptionValue(Save_Weapon_04_T, Weapon_JSON_04_name)
		Save_JSON_Weapon("04")
	endIf
	
	if (option == Save_Weapon_05_T)			;05
		Weapon_JSON_05_name = input2
		SetInputOptionValue(Save_Weapon_05_T, Weapon_JSON_05_name)
		Save_JSON_Weapon("05")
	endIf
	
	if (option == Save_Weapon_06_T)			;06
		Weapon_JSON_06_name = input2
		SetInputOptionValue(Save_Weapon_06_T, Weapon_JSON_06_name)
		Save_JSON_Weapon("06")
	endIf

	if (option == Save_Weapon_07_T)			;07
		Weapon_JSON_07_name = input2
		SetInputOptionValue(Save_Weapon_07_T, Weapon_JSON_07_name)
		Save_JSON_Weapon("07")
	endIf
	
	if (option == Save_Weapon_08_T)			;08
		Weapon_JSON_08_name = input2
		SetInputOptionValue(Save_Weapon_08_T, Weapon_JSON_08_name)
		Save_JSON_Weapon("08")
	endIf
	
	if (option == Save_Weapon_09_T)			;09
		Weapon_JSON_09_name = input2
		SetInputOptionValue(Save_Weapon_09_T, Weapon_JSON_09_name)
		Save_JSON_Weapon("09")
	endIf
	
	if (option == Save_Weapon_10_T)			;10
		Weapon_JSON_10_name = input2
		SetInputOptionValue(Save_Weapon_10_T, Weapon_JSON_10_name)
		Save_JSON_Weapon("10")
	endIf
	
	if (option == oidSavedNames_01)
		SavedNames_01 = input2
		SetInputOptionValue(oidSavedNames_01, SavedNames_01)
	endIf
	
	if (option == oidTagInput_01)
		SavedTags_01 = input2
		SetInputOptionValue(oidTagInput_01, SavedTags_01)
	endIf
	if (option == oidTagInput_02)
		SavedTags_02 = input2
		SetInputOptionValue(oidTagInput_02, SavedTags_02)
	endIf
	if (option == oidTagInput_03)
		SavedTags_03 = input2
		SetInputOptionValue(oidTagInput_03, SavedTags_03)
	endIf
	if (option == oidTagInput_04)
		SavedTags_04 = input2
		SetInputOptionValue(oidTagInput_04, SavedTags_04)
	endIf
	if (option == oidTagInput_05)
		SavedTags_05 = input2
		SetInputOptionValue(oidTagInput_05, SavedTags_05)
	endIf
	
	if (option == oidHairInput_00)
		SavedHair_00 = input2
		SetInputOptionValue(oidHairInput_00, SavedHair_00)
	endIf		
	if (option == oidHairInput_01)
		SavedHair_01 = input2
		SetInputOptionValue(oidHairInput_01, SavedHair_01)
	endIf
	if (option == oidHairInput_02)
		SavedHair_02 = input2
		SetInputOptionValue(oidHairInput_02, SavedHair_02)
	endIf
	if (option == oidHairInput_03)
		SavedHair_03 = input2
		SetInputOptionValue(oidHairInput_03, SavedHair_03)
	endIf
	if (option == oidHairInput_04)
		SavedHair_04 = input2
		SetInputOptionValue(oidHairInput_04, SavedHair_04)
	endIf
	if (option == oidHairInput_05)
		SavedHair_05 = input2
		SetInputOptionValue(oidHairInput_05, SavedHair_05)
	endIf
	if (option == oidHairInput_06)
		SavedHair_06 = input2
		SetInputOptionValue(oidHairInput_06, SavedHair_06)
	endIf
	if (option == oidHairInput_07)
		SavedHair_07 = input2
		SetInputOptionValue(oidHairInput_07, SavedHair_07)
	endIf
	if (option == oidHairInput_08)
		SavedHair_08 = input2
		SetInputOptionValue(oidHairInput_08, SavedHair_08)
	endIf
	if (option == oidHairInput_09)
		SavedHair_09 = input2
		SetInputOptionValue(oidHairInput_09, SavedHair_09)
	endIf
	if (option == oidHairInput_10)
		SavedHair_10 = input2
		SetInputOptionValue(oidHairInput_10, SavedHair_10)
	endIf
	
	
	if (option == oidHairInput_11)
		SavedHair_11 = input2
		SetInputOptionValue(oidHairInput_11, SavedHair_11)
	endIf
	if (option == oidHairInput_12)
		SavedHair_12 = input2
		SetInputOptionValue(oidHairInput_12, SavedHair_12)
	endIf
	if (option == oidHairInput_13)
		SavedHair_13 = input2
		SetInputOptionValue(oidHairInput_13, SavedHair_13)
	endIf
	if (option == oidHairInput_14)
		SavedHair_14 = input2
		SetInputOptionValue(oidHairInput_14, SavedHair_14)
	endIf
	if (option == oidHairInput_15)
		SavedHair_15 = input2
		SetInputOptionValue(oidHairInput_15, SavedHair_15)
	endIf
	
		
	if (option == oidHairInput_16)
		SavedHair_16 = input2
		SetInputOptionValue(oidHairInput_16, SavedHair_16)
	endIf
	if (option == oidHairInput_17)
		SavedHair_17 = input2
		SetInputOptionValue(oidHairInput_17, SavedHair_17)
	endIf
	if (option == oidHairInput_18)
		SavedHair_18 = input2
		SetInputOptionValue(oidHairInput_18, SavedHair_18)
	endIf
	if (option == oidHairInput_19)
		SavedHair_19 = input2
		SetInputOptionValue(oidHairInput_19, SavedHair_19)
	endIf
	if (option == oidHairInput_20)
		SavedHair_20 = input2
		SetInputOptionValue(oidHairInput_20, SavedHair_20)
	endIf
	;/
	if (option == oidPunishmentInput_01)
		SavedPunishment_01 = input2
		SetInputOptionValue(oidPunishmentInput_01, SavedPunishment_01)
	endIf
	if (option == oidPunishmentInput_02)
		SavedPunishment_02 = input2
		SetInputOptionValue(oidPunishmentInput_02, SavedPunishment_02)
	endIf
	if (option == oidPunishmentInput_03)
		SavedPunishment_03 = input2
		SetInputOptionValue(oidPunishmentInput_03, SavedPunishment_03)
	endIf
	if (option == oidPunishmentInput_04)
		SavedPunishment_04 = input2
		SetInputOptionValue(oidPunishmentInput_04, SavedPunishment_04)
	endIf
	if (option == oidPunishmentInput_05)
		SavedPunishment_05 = input2
		SetInputOptionValue(oidPunishmentInput_05, SavedPunishment_05)
	endIf
	if (option == oidPunishmentInput_06)
		SavedPunishment_06 = input2
		SetInputOptionValue(oidPunishmentInput_06, SavedPunishment_06)
	endIf
	if (option == oidPunishmentInput_07)
		SavedPunishment_07 = input2
		SetInputOptionValue(oidPunishmentInput_07, SavedPunishment_07)
	endIf
	if (option == oidPunishmentInput_08)
		SavedPunishment_08 = input2
		SetInputOptionValue(oidPunishmentInput_08, SavedPunishment_08)
	endIf
	if (option == oidPunishmentInput_09)
		SavedPunishment_09 = input2
		SetInputOptionValue(oidPunishmentInput_09, SavedPunishment_09)
	endIf
	if (option == oidPunishmentInput_10)
		SavedPunishment_10 = input2
		SetInputOptionValue(oidPunishmentInput_10, SavedPunishment_10)
		
		
	endIf
	
	/;
	
endEvent
	
	
Function SpellOnVictims(String Type)
	;if IsNymrasGame()
	;if folqst.Actor_Follower01 && D100(50)
	;	SexlabMoan(folqst.Actor_Follower01)
	;endif 
	;if folqst.Actor_Follower02 && D100(50)
;		SexlabMoan(folqst.Actor_Follower02)
;	endif 
	
	if Type == "Shock"
		if folqst.Actor_Follower01
		ShockSpell.RemoteCast(PlayerRef, folqst.Actor_Follower01, folqst.Actor_Follower01)
		endif 
		if folqst.Actor_Follower02
		ShockSpell.RemoteCast(PlayerRef, folqst.Actor_Follower02, folqst.Actor_Follower02)
		endif 
	elseif Type == "Frost"
		if folqst.Actor_Follower01
		Frostspell.RemoteCast(PlayerRef, folqst.Actor_Follower01, folqst.Actor_Follower01)
		endif 
		if folqst.Actor_Follower02
		Frostspell.RemoteCast(PlayerRef, folqst.Actor_Follower02, folqst.Actor_Follower02)
		endif
	elseif Type == "Fire"
		if folqst.Actor_Follower01
		FireSpell.RemoteCast(PlayerRef, folqst.Actor_Follower01, folqst.Actor_Follower01)
		endif 
		if folqst.Actor_Follower02
		FireSpell.RemoteCast(PlayerRef, folqst.Actor_Follower02, folqst.Actor_Follower02)
		endif	
	elseif Type == "Pain"
		if folqst.Actor_Follower01
		PainSpell.RemoteCast(PlayerRef, folqst.Actor_Follower01, folqst.Actor_Follower01)
		endif 
		if folqst.Actor_Follower02
		PainSpell.RemoteCast(PlayerRef, folqst.Actor_Follower02, folqst.Actor_Follower02)
		endif	
	endif 
Endfunction	

Function ShockSpellOnVictims()
	;if IsNymrasGame()
	ShockSpell.RemoteCast(PlayerRef, folqst.Actor_Follower01, folqst.Actor_Follower01)
	ShockSpell.RemoteCast(PlayerRef, folqst.Actor_Follower02, folqst.Actor_Follower02)
	;endif 
Endfunction	
	
								  ;"XXXXXXXXXXXXXXXXXXXXXXX"			<--- available space
								 			  
				
Int Function KeyShowWheelMenuTEST() 		;##test 

	UIMenuBase wheelMenu = UIExtensions.GetMenu("UIWheelMenu")
	
	;DESCRIPTION down in the middle													;"XXXXXXXXXXXXXXXXXXXXXXX"   <--- available space
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 0, value = "Test ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 1, value = "Test ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 2, value = "Test ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 3, value = "Test ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 4, value = "Test ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 5, value = "Test ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 6, value = "Test ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 7, value = "Test ")
																						
	;OPTION TEXT 																	    ;"XXXXXXXXXXXXXXXXXXXXXXX" <--- available space
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 0, value = "1: Fol Combat Strip ")		;1
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 1, value = "2: Load Fol Outit")		;2
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 2, value = "3: TEST Teleport ")		;3
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 3, value = "4: SPE Calm Test ")		;4
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 4, value = "5: fol_OUTFIT"+DebugPunishmentType+"SAVE ")		;5
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 5, value = "6: SoulGem ") 	;6
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 6, value = "7: PosingTest")		;7
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 7, value = "8: SOUND TEST ")		;8
	
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 0, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 1, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 2, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 3, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 4, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 5, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 6, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 7, value = true)
	
	;If Self.GetState() != ""
	;	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 8, value = GetLastActionString())
	;	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 8, value = GetLastActionString())
	;	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 8, value = LastActionAvailable())
	;EndIf

	int selectedIndex = WheelMenu.OpenMenu()
	
	; --- Test [1] --------------------------------------------------------------
	if selectedIndex == 0
	
	Utility.Wait(1.0)
	FollowerStripCombat()
		
	; --- Test [2] --------------------------------------------------------------
	elseif selectedIndex == 1
	
	FollowerStripCompletely()
	Utility.Wait(3.0)
	FollowerLoadOutfit()
	
	; --- Test [3] --------------------------------------------------------------	Removcast
	elseif selectedIndex == 2		
	
	
	calmqst.CreateModEvent("NakedDefeatTransition", "Teleport Misshap")
	;/
		Debug.Messagebox("Round 1")
		PlayerRef.SetExpressionOverride(16, 0)  ; Skyrim SE		;?????
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 1, 100)    ;	;BIG AAAH
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 2, 100)    ;
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 11, 100)    ; Oh
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 5, 100)    ;
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 10, 100)    ; Oldrim 	
			
		Utility.Wait(4.0)

		ResetExpressions()
		
		Debug.Messagebox("Round 2")
		PlayerRef.SetExpressionOverride(16, 0)  ; Skyrim SE		;?????
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 1, 100)    ;	;BIG AAAH
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 2, 100)    ;	BMP?
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 11, 100)    ; Oh
		;MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 5, 100)    ; Eee
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 6, 100)    ; Eh
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 10, 100)    ; Oldrim 
		
		Utility.Wait(4.0)

		ResetExpressions()
		
		Debug.Messagebox("Round 3")
		PlayerRef.SetExpressionOverride(16, 0)  ; Skyrim SE		;?????
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 1, 100)    ;	;BIG AAAH
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 2, 100)    ;	BMP?
		;MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 11, 100)    ; Oh
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 12, 100)    ; oohq
		;MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 5, 100)    ; Eee
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 6, 100)    ; Eh
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 10, 100)    ; Oldrim 
		
		Utility.Wait(4.0)

		ResetExpressions()
		
		Debug.Messagebox("Round 4")
		PlayerRef.SetExpressionOverride(16, 0)  ; Skyrim SE		;?????
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 1, 100)    ;	;BIG AAAH
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 2, 100)    ;	BMP?
		;MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 11, 100)    ; Oh
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 12, 100)    ; oohq
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 5, 100)    ; Eee
		;MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 6, 100)    ; Eh
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 10, 100)    ; Oldrim 
		/;
		
	; --- Test [4] --------------------------------------------------------------
	elseif selectedIndex == 3
	
	if SPE_Actor.IsActorCalmed(PlayerRef)
	SPE_Actor.SetActorCalmed(PlayerRef, false)
	else
	SPE_Actor.SetActorCalmed(PlayerRef, true)
	endif 
	
	
	;nade_DDint.EquipDDtoActor(PlayerRef, "Random")
	
;	Debug.Messagebox("Cuffs Struggle 0")
;	PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[0])
;	Utility.Wait(3.0)
;	Debug.Messagebox("Cuffs Struggle 9")
;	PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[9])
		
	; --- Test [5] --------------------------------------------------------------
	elseif selectedIndex == 4       
	
			
			if DebugPunishmentType == 1
			NymMessage("OutFit 01 Saved")
			SaveOutfit("Follower Outfit 01")
			endif 
			
	; --- Test 6 -------------------------------------------------------------- SOUL GEM
	elseif selectedIndex == 5
	
	
	

	
	
		;else ;SOUL GEMS 
			;worx... but how good is it? 
			SoulGem PettySoulGem_0 = (Game.GetFormFromFile(0x0002E4E2, "Skyrim.esm")) As SoulGem	;empty
			SoulGem PettySoulGem_1 = (Game.GetFormFromFile(0x0002E4E3, "Skyrim.esm")) As SoulGem	;full
			ObjectReference MyPettySoulGem_0
			
			MyPettySoulGem_0 = Game.FindClosestReferenceOfTypeFromRef(PettySoulGem_0, PlayerRef, 125.0)
			if MyPettySoulGem_0	
			Debug.Messagebox("This worked")
			MyPettySoulGem_0.PlaceAtMe(PettySoulGem_1, 1, true, false)
			MyPettySoulGem_0.Disable()
			MyPettySoulGem_0.Delete()
			else
			Debug.Messagebox("This did not work")
			endif 
		;endif 
			;	Utility.Wait(10.0)
			
		;	SoulGem MyPettySoulGem2_0
			
		;	MyPettySoulGem2_0 = Game.FindClosestReferenceOfTypeFromRef(PettySoulGem_0, PlayerRef, 125.0)
		;	if MyPettySoulGem2_0	
		;	Debug.Messagebox("This worked, too")
		;	MyPettySoulGem2_0.PlaceAtMe(PettySoulGem_1, 1, true, false)
		;	MyPettySoulGem2_0.Disable()
		;	MyPettySoulGem2_0.Delete()
		;	else
		;	Debug.Messagebox("This did not work either")
		;	endif
			;(Diamond, Game.GetPlayer(), 5.0)
			
		
	; --- Test 7 --------------------------------------------------------------
	elseif selectedIndex == 6
	
	PosingTest()
	
	;SendModEvent("SSLV Entry")
	
	; --- Test 8 --------------------------------------------------------------
	elseif selectedIndex == 7



		Sound mySFX			;SOUNDMARKER
		;-----------------------
		Debug.Messagebox("PLAY SOUND: aaaAMBWaterDripsRadiusMarker2DLP")
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0010FD02, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)
		;-----------------------
		Debug.Messagebox("PLAY SOUND: AMBDungeonCaveWindRadius2DLP")					;
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0001989B, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)
		;-----------------------
		Debug.Messagebox("PLAY SOUND: AMBDustDropImpact")				;
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x00016E68D, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: AMBRumbleALP")				;
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0001C152, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self
	
		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: AMBShipCreakBaseLP")			;
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0010C2E7, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)	
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: AMBShipCreakDeckDLP")			;
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0010C2E9, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)	
		
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: AMBWindLightLP")			;
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x00012EA2, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)	
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: DRSDarkBrotzherHoodSanctuaryClose")			;FURNITURE SOUND (Fall From Furntirue)
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x00104BCF, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)	
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: DRSDarkBrotzherHoodSanctuaryOpen")			;FURNITURE SOUND (Put Inside Furntirue)
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x00104BCE, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		


		;-----------------------
		Debug.Messagebox("PLAY SOUND: DRSLocked")			;
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0003316D, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		


		;-----------------------
		Debug.Messagebox("PLAY SOUND: DRSIronDoubleNordicCage01Close")			;				;put in Metal Furniture(Cage
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0003BD90, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: DRSIronDoubleNordicCage01Close")			;				;put in Metal Furniture(Cage
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0003BD90, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: MagFail")			;									;Item Not Fitting!
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x00022472, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: MagShockImpact")			;	^					;For Shock and Pain Punish
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x00038B03, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: QSTDA10Rumble")			;
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0010CB68, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: QSTTimeTravel2DSound")			;				;FOR TELEPORT MISSHAP
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0010F736, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)	

		;-----------------------
		Debug.Messagebox("PLAY SOUND: QSTVaultLockEnter")			;					;FOR Furniture lock in place Metal
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x00108282, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)	
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: QSTVaultLockExit")			;					;DD Removal!!!!
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0010E94B, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)									
		
		;-----------------------
;/

		Debug.Messagebox("PLAY SOUND: NPCHorseDismount")			;000 for Successfull Dodge
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0007717E, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		
		
		Debug.Messagebox("PLAY SOUND: AMBDustDropDrbris")				;000 for Trap?
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0001E68C, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self
	
		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)	
		
				Debug.Messagebox("PLAY SOUND: MagAlterarionInvisibilityIn")				;MAGIC MISSHAP SOUND?
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x00058E0F, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)	

/;
	;FadeToBlack(true)
	;Utility.Wait(1.0)
	;Dead = 6
	;SendModEvent("StartNakedAfterlife") 
	endif
	
	
	;DEBUG WHEEL ALT + K 
	;0	done - Public Punishment On/Off
	;1	done - Short Defeat On/Off (100%) or reset to MCM setting
	;2 	done - Abort Defeat Scenario
	;3  done - Place Floor / Remove Floor  (just always? hmm) --> helps other mods 
	;4  
	;5  done - Unstuck from Ragdoll 
	;6 	done - ReRegister Followers 
	;7  later - Fix Camera (attempt all known fixes in sequence) 
	
EndFunction				
								  
Function PlaySoundOnActor(actor akActor, string sSoundType, float fVolume)			;#Sound ;#PlaySoundOnActor()

		Sound mySFX	
	
		if sSoundType == "Furniture Exit"
		mySFX = (Game.GetFormFromFile(0x00104BCF, "Skyrim.esm") As Sound)		;DRSDarkBrotzherHoodSanctuaryClose	
		elseif sSoundType == "Furniture Enter"					
		mySFX = (Game.GetFormFromFile(0x00104BCE, "Skyrim.esm") As Sound) ;DRSDarkBrotzherHoodSanctuaryOpen
		
		elseif sSoundType == "Item does not Fit"					
		mySFX = (Game.GetFormFromFile(0x00022472, "Skyrim.esm") As Sound) ;MagFail

		elseif sSoundType == "Punishment Shock Extra"					
		mySFX = (Game.GetFormFromFile(0x00038B03, "Skyrim.esm") As Sound) ;MagShockImpact

		elseif sSoundType == "DDs Removed"					
		mySFX = (Game.GetFormFromFile(0x0010E94B, "Skyrim.esm") As Sound) ;QSTVaultLockExit
				
		elseif sSoundType == "DDs Equiped"					
		mySFX = (Game.GetFormFromFile(0x00108282, "Skyrim.esm") As Sound) ;QSTVaultLockEnter

		elseif sSoundType == "Dodged 01"					
		mySFX = (Game.GetFormFromFile(0x0007717E, "Skyrim.esm") As Sound) ;NPCHorseDismount

		endif 

		instanceID_02 = mySFX.play(akActor)          ; play mySFX sound from my sel
		Sound.SetInstanceVolume(instanceID_02, fVolume)         ; play at half volume
		

;/
		;-----------------------
		Debug.Messagebox("PLAY SOUND: AMBShipCreakBaseLP")			;TEST AGAIN
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0010C2E7, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)	
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: AMBShipCreakDeckDLP")			;;TEST AGAIN
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0010C2E9, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)	
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: DRSIronDoubleNordicCage01Close")			;				;put in Metal Furniture(Cage
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0003BD90, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		
		
		;-----------------------
		Debug.Messagebox("PLAY SOUND: DRSIronDoubleNordicCage01Close")			;				;put in Metal Furniture(Cage
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0003BD90, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)		
	
		;-----------------------
		Debug.Messagebox("PLAY SOUND: QSTTimeTravel2DSound")			;				;FOR TELEPORT MISSHAP
		Utility.Wait(2.0)
		mySFX = (Game.GetFormFromFile(0x0010F736, "Skyrim.esm") As Sound)
		Sound.StopInstance(instanceID)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self

		Sound.SetInstanceVolume(instanceID, 1)         ; play at half volume

		Utility.Wait(5.0)
		Sound.StopInstance(instanceID)	

	/;	

EndFunction 					

					
String WheelMenuPublicPunishment	
String WheelMenuQuestmode = "Quest Mode OFF "	
String WheelMenuFloorPlacement

Float Property TempDefeatShortProb Auto

Int Function ShowWheelMenuDebug() 		;#wheel ##debug

	UIMenuBase wheelMenu = UIExtensions.GetMenu("UIWheelMenu")
	
	if Indecency
	WheelMenuPublicPunishment = "Public Rape ON "
	else
	WheelMenuPublicPunishment = "Public Rape OFF "
	endif 
	
;	if (WheelMenuShortDefeat == "Short Defeat 100%") || (WheelMenuShortDefeat == "Short Defeat 100% ") || (WheelMenuShortDefeat == "Quest Mode OFF") 
;	WheelMenuShortDefeat = "Quest Mode OFF "
;	endif 
	
	if floorplaced
	WheelMenuFloorPlacement = "Remove Floor "
	else
	WheelMenuFloorPlacement = "Place Floor "
	endif 
	
	;DESCRIPTION down in the middle													;"XXXXXXXXXXXXXXXXXXXXXXX"   <--- available space
	if IsDefeatRunning()
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 0, value = "Change Hairstyle ") ;during Sex
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 1, value = "Toggle Quest Mode ")	;during Sex
	else 
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 0, value = "Toggle Public Rape ") ;not during Sex
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 1, value = "Toggle Quest Mode ")	;not during Sex
	endif 
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 2, value = "Abort Defeat ")		
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 3, value = "Place/Remove Floor ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 4, value = "Place Lanterns ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 5, value = "Unstuck Player ")			;not during Sex
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 6, value = "Update Followers ")		;not during Sex
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 7, value = "Heels Height Test ")
																						
	;OPTION TEXT 																	    ;"XXXXXXXXXXXXXXXXXXXXXXX" <--- available space
	if IsDefeatRunning()
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 0, value = "Change Hairstyle ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 1, value = WheelMenuQuestmode)
	else 
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 0, value = WheelMenuPublicPunishment)
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 1, value = WheelMenuQuestmode)
	endif
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 2, value = "Abort Defeat ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 3, value = WheelMenuFloorPlacement)
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 4, value = "Place Lanterns ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 5, value = "Unstuck Player ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 6, value = "Update Followers ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 7, value = "Heels Height Test ")
	
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 0, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 1, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 2, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 3, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 4, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 5, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 6, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 7, value = true)
	
	;If Self.GetState() != ""
	;	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 8, value = GetLastActionString())
	;	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 8, value = GetLastActionString())
	;	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 8, value = LastActionAvailable())
	;EndIf

	int selectedIndex = WheelMenu.OpenMenu()
	
	; --- [0] Public Punishment ON/OFF --------------------------------------------------------------
	if (selectedIndex == 0) && !IsDefeatRunning()
	
		;Public Rape OFF
        if WheelMenuPublicPunishment == "Public Rape ON "
                                   ;"XXXXXXXXXXXXXXXXXXXXXXX"
        WheelMenuPublicPunishment = "Public Rape OFF "
        PublicExposure = 0
        Indecency = false
        Debug.notification ("NAKED DEFEAT: Public Punishment/Rape: OFF ")
        
		;Public Rape ON
		elseif WheelMenuPublicPunishment == "Public Rape OFF "
        WheelMenuPublicPunishment = "Public Rape ON "
        Indecency = true
        Debug.notification ("NAKED DEFEAT: Public Punishment/Rape: ON" )
        endif
		
	; --- [0] SEX: Change Hair --------------------------------------------------------------
	elseif (selectedIndex == 0) && IsDefeatRunning()

		ChangeHairStyle()
		
	; --- [1] Toggle Quest Mode --------------------------------------------------------------
	elseif selectedIndex == 1
	
	;WheelMenuQuestmode = "Quest Mode OFF "
	
		;turn Quest Mode OFF 		
		if WheelMenuQuestmode == "Quest Mode ON "
							  ;"XXXXXXXXXXXXXXXXXXXXXXX"
		WheelMenuQuestmode = "Quest Mode OFF "
		DefeatShortProb = TempDefeatShortProb
		TempDefeatShortProb = 0.0 
		int TempInt = DefeatShortProb as int 
		Debug.notification ("NAKED DEFEAT: Short Defeat Chance set to the MCM setting: "+TempInt+"%") 

		;turn Quest Mode ON 	
		elseif WheelMenuQuestmode == "Quest Mode OFF "
		WheelMenuQuestmode = "Quest Mode ON "
		
		TempDefeatShortProb = DefeatShortProb
		DefeatShortProb = 100.0 
		Debug.notification ("NAKED DEFEAT: Short Defeat Chance set to 100%") 
		
		
		endif	
					
	; --- Abort Defeat Scenario --------------------------------------------------------------	
	elseif selectedIndex == 2	
		
		if IsDefeatRunning(); WheelMenuShortDefeat == "Abort Defeat Scenario"
                                  ;"XXXXXXXXXXXXXXXXXXXXXXX"
         Debug.notification ("NAKED DEFEAT: Attemping to abort the Defeat Scenario...")
        KeyAbortAll()
        
        else
        Debug.Messagebox("NAKED DEFEAT: Defeat Scenario not running.")
        Debug.notification ("NAKED DEFEAT: Defeat Scenario not running.")
        
        endif 
	
	; --- Place/Remove Floor --------------------------------------------------------------
	elseif selectedIndex == 3
	
		if !floorplaced
			ScreenMessage("Flat ground for bad things...")
			PlaceFloor("setup")			
		
		elseif floorplaced
			ScreenMessage("Manually removing the placed floor.")
			PlaceFloor("remove")
		endif 	
		
	; --- Place/Remove Lantern --------------------------------------------------------------
	elseif selectedIndex == 4
		
		if Lantern 
		ScreenMessage("Lantern removed")
		PlaceLight("remove")
			
		else
		ScreenMessage("A lantern is placed.")
		PlaceLight("setup")			
		endif 
		
	; --- Unstuck from Ragdoll --------------------------------------------------------------
	elseif selectedIndex == 5       

	KeyFixBleedout()    
    Debug.notification ("NAKED DEFEAT: Attempt to unstuck Player from Ragdoll.") 		
		
		
	; --- Update Followers --------------------------------------------------------------
	elseif selectedIndex == 6
			ScreenMessage("You make a quick checkup on your followers")

			ProximityQuestStart("FollowerNameScan")

			Utility.Wait(1.0)
			;if folqst.GetStage() < 1000
			folqst.EndFollowerQuest()
			Utility.Wait(1.0)
			folqst.StartFollowerQuest()
			;ScreenMessage("Make sure nobody is missing! (you can check in the MCM/System)")
			;endif
			
	; --- Fix Player Speed --------------------------------------------------------------
	elseif selectedIndex == 7
		
		RestoreHeelsEffectOnActor(PlayerRef)
	;	int TempSpeed = DefeatSpeedMult as int
	;	ScreenMessage("Your speed is now "+TempSpeed+" (MCM value)")
	;	SetSpeedMultTo(DefeatSpeedMult)

	endif
	
	
	;DEBUG WHEEL ALT + K 
	;0	done - Public Punishment On/Off
	;1	done - Short Defeat On/Off (100%) or reset to MCM setting
	;2 	done - Abort Defeat Scenario
	;3  done - Place Floor / Remove Floor  (just always? hmm) --> helps other mods 
	;4  - Place Lantern / Remove Lantern
	;5  done - Unstuck from Ragdoll 
	;6 	done - ReRegister Followers 
	;7  later - Fix Camera (attempt all known fixes in sequence) 
	
EndFunction




Int Function ShowWheelMenuAction() 		;#wheel ##action

	UIMenuBase wheelMenu = UIExtensions.GetMenu("UIWheelMenu")
	

	;DESCRIPTION down in the middle													;"XXXXXXXXXXXXXXXXXXXXXXX"   <--- available space
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 0, value = "Start Bathing ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 1, value = "Cost: 1000 septims ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 2, value = "Cost: risky outcome ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 3, value = "Load Ini File ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 4, value = "Test Afterlife ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 5, value = "Test Hostile Slavery ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 6, value = "Test Public Slavery ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 7, value = "Start Simple Slavery ")
																						
	;OPTION TEXT 																	    ;"XXXXXXXXXXXXXXXXXXXXXXX" <--- available space
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 0, value = "Bathing ")
																						;  "Start Naked Travel"
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 1, value = "Save Travel Ritual ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 2, value = "Risky Travel Ritual ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 3, value = "Load Ini File ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 4, value = "Test Afterlife ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 5, value = "Test Hostile Slavery ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 6, value = "Test Public Slavery ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 7, value = "Test Slavery ")
	
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 0, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 1, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 2, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 3, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 4, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 5, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 6, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 7, value = true)
	
	int selectedIndex = WheelMenu.OpenMenu()
	
	; --- Bathing --------------------------------------------------------------
	if selectedIndex == 0
	;abort Bathing? 		
	ScreenMessage("You thoroughly clean yourself... everywhere...")
	KeyStartBathing()
     	
	; --- Naked Travel --------------------------------------------------------------
	elseif selectedIndex == 1

	ScreenMessage("You summon magical creatures to prepare you for Teleportation")
	
;	if IsNymrasGame()
		if HasPlayerEnoughGold(1000)
		KeyStartFastTravelRitual()
		DefeatEntranceVia = "Travel Ritual Save"
		else
		ScreenMessage("You cannot afford the save ritual cost (1000 septims)")
		endif 
;	else
;	KeyStartFastTravelRitual()
;	cfgqst.DefeatEntranceVia = "Travel Ritual Save"
;	endif 

	; --- NONE --------------------------------------------------------------	
	elseif selectedIndex == 2	

	;	if IsNymrasGame()
	;	LocationEvent("Teleport Misshap")
	;	else
	

		DefeatEntranceVia = "Travel Ritual Risky"
		
		if D100(33)
		StartRobberyAtLocation()
		PlayMoaningSound()
		Utility.Wait(3.0)
		PlayBreathingSound()
		endif 
		
		KeyStartFastTravelRitual()
	;	endif 

	; --- NONE --------------------------------------------------------------
	elseif selectedIndex == 3
		
;if Nym()		
;		Save_JSON_Ini()
;endif 		
		
	; --- NONE --------------------------------------------------------------
	elseif selectedIndex == 4	
	
	StartRobberyAtLocation()
	CreateModEvent("NakedDefeatTransition", "Afterlife")

	; --- NONE --------------------------------------------------------------
	elseif selectedIndex == 5       

		;FollowerStripCompletely()
		;StartRobberyAtLocation()
		StartSimpleSlaveryHostile()
		
	; --- NONE --------------------------------------------------------------
	elseif selectedIndex == 6
	
		;FollowerStripCompletely()
		;StartRobberyAtLocation()
		StartSimpleSlaveryPublic()
	
		; --- NONE --------------------------------------------------------------
	elseif selectedIndex == 7
	
		;calmqst.StripFollower(0)	I need a convenient FollowerStrip Function 
		;calmqst.StripFollower(1)
		FollowerStripCompletely()
		StartRobberyAtLocation()
		SendModEvent("SSLV Entry")

	;	if D100(50)
	;	ScreenMessage("Test Slavery Location (Public) Started") 
	;	StartSimpleSlaveryPublic()
	;	else
	;	StartSimpleSlaveryHostile()
	;	ScreenMessage("Test Slavery Location (Hostile) Started") 
	;	endif 
		
	endif
	

	;ACTION WHEEL SHIFT + K 
	;0	done - Bathing
	;1	done - Naked Travel
	;2 	wip - Soul Gem Action 
	;3  later - Toggle Bait/Beg 
	;4  later - Sleep? 
	;5  
	;6 
	;7   	
	
	;CONCEPT: DURING DEFEAT WHEEL 
	; Abort All
	; Change Furniture 
	; 
	
	;K will still be situational 
	;change hair 
	;surrender 
	;bait/beg 
	;do action 

	;Return wheelMenu.OpenMenu(PlayerRef)
	
EndFunction


Int Function ShowWheelMenuProstitution() 		;#wheel #Prostitution

	UIMenuBase wheelMenu = UIExtensions.GetMenu("UIWheelMenu")
	

	;DESCRIPTION down in the middle													;"XXXXXXXXXXXXXXXXXXXXXXX"   <--- available space
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 0, value = "Bound Whore ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 1, value = "Furniture Whore ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 2, value = "ChainRape Whore ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 3, value = "Girlfriend Whore ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 4, value = "Rodeo Whore ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 5, value = "none ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 6, value = "none ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionText", index = 7, value = "none ")
																						
	;OPTION TEXT 																	    ;"XXXXXXXXXXXXXXXXXXXXXXX" <--- available space
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 0, value = "Bound Whore ")
																						;  "Start Naked Travel"
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 1, value = "Furniture Whore ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 2, value = "ChainRape Whore ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 3, value = "Girlfriend Whore ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 4, value = "Rodeo Whore ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 5, value = "none ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 6, value = "none ")
	wheelMenu.SetPropertyIndexString(propertyName = "optionLabelText", index = 7, value = "none ")
	
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 0, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 1, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 2, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 3, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 4, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 5, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 6, value = true)
	wheelMenu.SetPropertyIndexBool(propertyName = "optionEnabled", index = 7, value = true)
	
	int selectedIndex = WheelMenu.OpenMenu()
	
	; --- Bathing --------------------------------------------------------------
	if selectedIndex == 0

	ProstitutionScenario = "Bound"
	DefeatEntranceVia = "Prostitution"
	CivilRapeRunning = True
	DefeatViaSurrender = true
	DefeatViaSlavery = true
	StartDefeat()
	
	; --- NONE --------------------------------------------------------------
	elseif selectedIndex == 1

	ProstitutionScenario = "FURNITURE"
	DefeatEntranceVia = "Prostitution"
	DefeatViaSurrender = true
	DefeatViaSlavery = true
	CivilRapeRunning = True
	StartDefeat()

	; --- NONE --------------------------------------------------------------	
	elseif selectedIndex == 2	

	ProstitutionScenario = "ChainRape"
	DefeatEntranceVia = "Prostitution"	
	CivilRapeRunning = True
	DefeatViaSurrender = true
	DefeatViaSlavery = true
	StartDefeat()

	; --- NONE --------------------------------------------------------------
	elseif selectedIndex == 3
	
	ProstitutionScenario = "Girlfriend"
	DefeatEntranceVia = "Prostitution"
	CivilRapeRunning = True
	DefeatViaSurrender = true
	DefeatViaSlavery = true
	StartDefeat()
	; --- NONE --------------------------------------------------------------
	elseif selectedIndex == 4       
	
	ProstitutionScenario = "Rodeo"
	DefeatEntranceVia = "Prostitution"	
	CivilRapeRunning = True
	DefeatViaSurrender
	DefeatViaSlavery
	StartDefeat()
		
	; --- NONE --------------------------------------------------------------
	elseif selectedIndex == 6
	

		; --- NONE --------------------------------------------------------------
	elseif selectedIndex == 7
	

		
	endif

	
EndFunction

Event OnOptionSliderOpen(Int option)
	Int i

	;if (option == FollowerOID_S)
	;	SetSliderDialogStartValue(FollowerProb)
	;	SetSliderDialogDefaultValue(100.0)
	;	SetSliderDialogRange(0.0, 100.0)
	;	SetSliderDialogInterval(1.0)
		
	if (option == FindSpotTimeOID_S)
		SetSliderDialogStartValue(FindSpotTime)
		SetSliderDialogDefaultValue(30.0)
		SetSliderDialogRange(5.0, 300.0)
		SetSliderDialogInterval(1.0)	
			
	elseif (option == Group5PchanceOID_S)
		SetSliderDialogStartValue(Group5Pchance)
		SetSliderDialogDefaultValue(10.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)	
		
	elseif (option == Group4PchanceOID_S)
		SetSliderDialogStartValue(Group4Pchance)
		SetSliderDialogDefaultValue(30.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == Group3PchanceOID_S)
		SetSliderDialogStartValue(Group3Pchance)
		SetSliderDialogDefaultValue(50.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == ScenarioChanceOID_S)
		SetSliderDialogStartValue(ScenarioChance)
		SetSliderDialogDefaultValue(50.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == DebugPunishmentTypeOID_S)
		SetSliderDialogStartValue(DebugPunishmentType)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 50.0)
		SetSliderDialogInterval(1.0)			
	elseif (option == BleedoutCounterOID_S)
		SetSliderDialogStartValue(BleedoutCounter)
		SetSliderDialogDefaultValue(100.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(5.0)	
	elseif (option == DefeatChainOID_S)
		SetSliderDialogStartValue(DefeatChainProb)
		SetSliderDialogDefaultValue(33.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)	
	elseif (option == DefeatForeplayChanceOID_S)
		SetSliderDialogStartValue(DefeatForeplayChance)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)			
	elseif (option == DefeatEscapeOID_S)						;Difficutly Slider %
		SetSliderDialogStartValue(DefeatEscapeDiff)
		SetSliderDialogDefaultValue(20.0)
		SetSliderDialogRange(1.0, 50.0)
		SetSliderDialogInterval(1.0)
	elseif (option == DefeatRobberyOID_S)
		SetSliderDialogStartValue(DefeatRobberyProb)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == NakedDeathChanceOID_S)
		SetSliderDialogStartValue(NakedDeathChance)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == DefeatRescueProbOID_S)
		SetSliderDialogStartValue(DefeatRescueProb)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == FemalesAsMalesOID_S)
		SetSliderDialogStartValue(FemalesAsMales)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == RemoveDDChanceOID_S)
		SetSliderDialogStartValue(RemoveDDChance)
		SetSliderDialogDefaultValue(100.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)	
	elseif (option == SearchRadiusOID_S)
		SetSliderDialogStartValue(SearchRadius)
		SetSliderDialogDefaultValue(5000.0)
		SetSliderDialogRange(1000.0, 10000.0)
		SetSliderDialogInterval(500.0)			
	elseif (option == SearchRadiusInteriorOID_S)
		SetSliderDialogStartValue(SearchRadiusInterior)
		SetSliderDialogDefaultValue(5000.0)
		SetSliderDialogRange(1000.0, 10000.0)
		SetSliderDialogInterval(500.0)			
	elseif (option == DefeatIdleTimeOID_S)
		SetSliderDialogStartValue(DefeatIdleTime)
		SetSliderDialogDefaultValue(4.0)
		SetSliderDialogRange(0.0, 40.0)
		SetSliderDialogInterval(4.0)				
	elseif (option == DefeatPeeProbOID_S)
		SetSliderDialogStartValue(DefeatPeeProb)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)		
	elseif (option == DefeatDDeProbOID_S)
		SetSliderDialogStartValue(DefeatDDeProb)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	
	elseif (option == PunishWhipChanceOID_S)
		SetSliderDialogStartValue(PunishWhipChance)
		SetSliderDialogDefaultValue(15.0)
		SetSliderDialogRange(0.0, 50.0)
		SetSliderDialogInterval(1.0)
	elseif (option == PunishSexChanceOID_S)
		SetSliderDialogStartValue(PunishSexChance)
		SetSliderDialogDefaultValue(15.0)
		SetSliderDialogRange(0.0, 50.0)
		SetSliderDialogInterval(1.0)
	elseif (option == DefeatDeathChanceOID_S)
		SetSliderDialogStartValue(DefeatDeathChance)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)	
		
	elseif (option == PunishBukkakeChanceOID_S)
		SetSliderDialogStartValue(PunishBukkakeChance)
		SetSliderDialogDefaultValue(15.0)
		SetSliderDialogRange(0.0, 50.0)
		SetSliderDialogInterval(1.0)	
	elseif (option == DefeatSlaveryOID_S)
		SetSliderDialogStartValue(DefeatSlaveryProb)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == DefeatSDweightOID_S)
		SetSliderDialogStartValue(DefeatSDweight)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)		
	elseif (option == DefeatCaptivityOID_S)
		SetSliderDialogStartValue(DefeatCaptivityProb)
		SetSliderDialogDefaultValue(50.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == CooperativeSurrenderChanceOID_S)
		SetSliderDialogStartValue(CooperativeSurrenderChance)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(5.0)	
		
		
		
		
	elseif (option == WhipmarksDurOID_S)
		SetSliderDialogStartValue(WhipmarksDur)
		SetSliderDialogDefaultValue(12.0)
		SetSliderDialogRange(1.0, 100.0)
		SetSliderDialogInterval(1.0)	
	elseif (option == DefeatDowntimeOID_S)
		SetSliderDialogStartValue(DefeatDowntime)
		SetSliderDialogDefaultValue(30.0)
		SetSliderDialogRange(5.0, 200.0)
		SetSliderDialogInterval(5.0)					
	elseif (option == DefeatEscTimeOID_S)
		SetSliderDialogStartValue(DefeatEscTime)
		SetSliderDialogDefaultValue(30.0)
		SetSliderDialogRange(5.0, 300.0)
		SetSliderDialogInterval(1.0)
		
	elseif (option == DefeatSpeedMultOID_S)
		SetSliderDialogStartValue(DefeatSpeedMult)
		SetSliderDialogDefaultValue(100.0)
		SetSliderDialogRange(40.0, 200.0)
		SetSliderDialogInterval(1.0)			
		
	elseif (option == RapeHandsProbOID_S)
		SetSliderDialogStartValue(RapeHandsProb)
		SetSliderDialogDefaultValue(33.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == PoisonDefeatChanceOID_S)
		SetSliderDialogStartValue(PoisonDefeatChance)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == DefeatBreakClothingOID_S)
		SetSliderDialogStartValue(DefeatBreakClothingProb)
		SetSliderDialogDefaultValue(50.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == DefeatBreakLightOID_S)
		SetSliderDialogStartValue(DefeatBreakLightProb)
		SetSliderDialogDefaultValue(20.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == DefeatBreakHeavyOID_S)
		SetSliderDialogStartValue(DefeatBreakHeavyProb)
		SetSliderDialogDefaultValue(10.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)	
	elseif (option == CriticalDefeatOID_S)
		SetSliderDialogStartValue(CriticalDefeat)
		SetSliderDialogDefaultValue(35.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)	
	elseif (option == NakedChanceOID_S)
		SetSliderDialogStartValue(NakedChance)
		SetSliderDialogDefaultValue(5.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)	
	elseif (option == MoanOnHitChanceOID_S)
		SetSliderDialogStartValue(MoanOnHitChance)
		SetSliderDialogDefaultValue(50.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(5.0)			
	elseif (option == DefeatWhipProbOID_S)
		SetSliderDialogStartValue(DefeatWhipProb)
		SetSliderDialogDefaultValue(100.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)	

	elseif (option == DefeatWhipTimeOID_S)
		SetSliderDialogStartValue(DefeatWhipTime)
		SetSliderDialogDefaultValue(30.0)
		SetSliderDialogRange(10.0, 200.0)
		SetSliderDialogInterval(5.0)	
	
;	elseif (option == IndecencyRapeOID_S)
;		SetSliderDialogStartValue(IndecencyRapeProb)
;		SetSliderDialogDefaultValue(20.0)
;		SetSliderDialogRange(0.0, 100.0)
;		SetSliderDialogInterval(1.0)
;	elseif (option == IndecencyRobberyOID_S)
;		SetSliderDialogStartValue(IndecencyRobberyProb)
;		SetSliderDialogDefaultValue(0.0)
;;		SetSliderDialogRange(0.0, 100.0)
	;	SetSliderDialogInterval(1.0)
		;HAIRCUT
	elseif (option == BondageHaircutOID_S)
		SetSliderDialogStartValue(BondageHaircutProb)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)
	elseif (option == ExposureChanceOID_S)
		SetSliderDialogStartValue(ExposureChance)
		SetSliderDialogDefaultValue(100.0)
		SetSliderDialogRange(100.0, 2000.0)
		SetSliderDialogInterval(50.0)	
	elseif (option == PunishShortProbOID_S)
		SetSliderDialogStartValue(PunishShortProb)
		SetSliderDialogDefaultValue(90.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)	

	elseif (option == DefeatArrestProbOID_S)
		SetSliderDialogStartValue(DefeatArrestProb)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)	




		
	elseif (option == DefeatShortProbOID_S)
		SetSliderDialogStartValue(DefeatShortProb)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(5.0)		
		
;civilrape weights			
	elseif (option == LoopTime_OID_S)
		SetSliderDialogStartValue(LoopTime)
		SetSliderDialogDefaultValue(15.0)
		SetSliderDialogRange(5.0, 30.0)
		SetSliderDialogInterval(1.0)
	elseif (option == Naked_Weight_OID_S)
		SetSliderDialogStartValue(Naked_Weight)
		SetSliderDialogDefaultValue(15.0)
		SetSliderDialogRange(0.0, 500.0)
		SetSliderDialogInterval(1.0)	
		;SetInfoDisplayWeight(0)

		
		
	elseif (option == Barefoot_Weight_OID_S)
		SetSliderDialogStartValue(Barefoot_Weight)
		SetSliderDialogDefaultValue(5.0)
		SetSliderDialogRange(0.0, 500.0)
		SetSliderDialogInterval(1.0)	
		;SetInfoDisplayWeight(1)
	elseif (option == Dirty_Weight_OID_S)
		SetSliderDialogStartValue(Dirty_Weight)
		SetSliderDialogDefaultValue(15.0)
		SetSliderDialogRange(0.0, 500.0)
		SetSliderDialogInterval(1.0)
		;SetInfoDisplayWeight(2)		
	elseif (option == Sneaking_Weight_OID_S)
		SetSliderDialogStartValue(Sneaking_Weight)
		SetSliderDialogDefaultValue(5.0)
		SetSliderDialogRange(0.0, 500.0)
		SetSliderDialogInterval(1.0)	
		;SetInfoDisplayWeight(3)		
	elseif (option == Running_Weight_OID_S)
		SetSliderDialogStartValue(Running_Weight)
		SetSliderDialogDefaultValue(10.0)
		SetSliderDialogRange(0.0, 500.0)
		SetSliderDialogInterval(1.0)	
	;	SetInfoDisplayWeight(4)
	elseif (option == Sprinting_Weight_OID_S)
		SetSliderDialogStartValue(Sprinting_Weight)
		SetSliderDialogDefaultValue(15.0)
		SetSliderDialogRange(0.0, 500.0)
		SetSliderDialogInterval(1.0)
	;	SetInfoDisplayWeight(5)		
	elseif (option == Cum_Weight_OID_S)
		SetSliderDialogStartValue(Cum_Weight)
		SetSliderDialogDefaultValue(15.0)
		SetSliderDialogRange(0.0, 500.0)
		SetSliderDialogInterval(1.0)	
	;	SetInfoDisplayWeight(6)
	elseif (option == Unarmed_Weight_OID_S)
		SetSliderDialogStartValue(Unarmed_Weight)
		SetSliderDialogDefaultValue(5.0)
		SetSliderDialogRange(0.0, 500.0)
		SetSliderDialogInterval(1.0)	
		;SetInfoDisplayWeight(7)
	elseif (option == FallingDamageTreshold_OID_S)
		SetSliderDialogStartValue(FallingDamageTreshold)
		SetSliderDialogDefaultValue(300.0)
		SetSliderDialogRange(0.0, 5000.0)
		SetSliderDialogInterval(10.0)
	elseif (option == KeyDDWiggleFreeChance_OID_S)
		SetSliderDialogStartValue(KeyDDWiggleFreeChance)
		SetSliderDialogDefaultValue(30.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)	
	elseif (option == KeyDDWiggleFreeFailChance_OID_S)
		SetSliderDialogStartValue(KeyDDWiggleFreeFailChance)
		SetSliderDialogDefaultValue(5.0)
		SetSliderDialogRange(0.0, 100.0)
		SetSliderDialogInterval(1.0)			
		
	elseif (option == HairRegrowthOID_S)
		SetSliderDialogStartValue(HairRegrowthTime)
		SetSliderDialogDefaultValue(0.0)
		SetSliderDialogRange(0.0, 24.0)
		SetSliderDialogInterval(1.0)	
		
		;/
	elseif (option == oidTextInput_01)						;TEXTX
		SetInputDialogStartText(SavedText_01)
	elseif (option == oidTextInput_02)						;TEXTX
		SetInputDialogStartText(SavedText_02)	
	elseif (option == oidTextInput_03)						;TEXTX
		SetInputDialogStartText(SavedText_03)	
	elseif (option == oidTextInput_04)						;TEXTX
		SetInputDialogStartText(SavedText_04)	
	elseif (option == oidTextInput_05)						;TEXTX
		SetInputDialogStartText(SavedText_05)	
		
	elseif (option == oidTextInput_06)						;TEXTX
		SetInputDialogStartText(SavedText_06)
	elseif (option == oidTextInput_07)						;TEXTX
		SetInputDialogStartText(SavedText_07)	
	elseif (option == oidTextInput_08)						;TEXTX
		SetInputDialogStartText(SavedText_08)	
	elseif (option == oidTextInput_09)						;TEXTX
		SetInputDialogStartText(SavedText_09)	
	elseif (option == oidTextInput_10)						;TEXTX
		SetInputDialogStartText(SavedText_10)	
		
		/;
		
	elseif (option == oidSavedNames_01)						;TEXTX
		SetInputDialogStartText(SavedNames_01)	
		
		
		
	elseif (option == oidTagInput_01)						;TEXTX
		SetInputDialogStartText(SavedTags_01)
	elseif (option == oidTagInput_02)						;TEXTX
		SetInputDialogStartText(SavedTags_02)	
	elseif (option == oidTagInput_03)						;TEXTX
		SetInputDialogStartText(SavedTags_03)	
	elseif (option == oidTagInput_04)						;TEXTX
		SetInputDialogStartText(SavedTags_04)	
	elseif (option == oidTagInput_05)						;TEXTX
		SetInputDialogStartText(SavedTags_05)			
		
	elseif (option == oidHairInput_00)						;TEXTX
		SetInputDialogStartText(SavedHair_00)			
	elseif (option == oidHairInput_01)						;TEXTX
		SetInputDialogStartText(SavedHair_01)		
	elseif (option == oidHairInput_02)						;TEXTX
		SetInputDialogStartText(SavedHair_02)			
	elseif (option == oidHairInput_03)						;TEXTX
		SetInputDialogStartText(SavedHair_03)				
	elseif (option == oidHairInput_04)						;TEXTX
		SetInputDialogStartText(SavedHair_04)		
	elseif (option == oidHairInput_05)						;TEXTX
		SetInputDialogStartText(SavedHair_05)		
	elseif (option == oidHairInput_06)						;TEXTX
		SetInputDialogStartText(SavedHair_06)		
	elseif (option == oidHairInput_07)						;TEXTX
		SetInputDialogStartText(SavedHair_07)		
	elseif (option == oidHairInput_08)						;TEXTX
		SetInputDialogStartText(SavedHair_08)		
	elseif (option == oidHairInput_09)						;TEXTX
		SetInputDialogStartText(SavedHair_09)		
	elseif (option == oidHairInput_10)						;TEXTX
		SetInputDialogStartText(SavedHair_10)	

	elseif (option == oidHairInput_11)						;TEXTX
		SetInputDialogStartText(SavedHair_11)		
	elseif (option == oidHairInput_12)						;TEXTX
		SetInputDialogStartText(SavedHair_12)			
	elseif (option == oidHairInput_13)						;TEXTX
		SetInputDialogStartText(SavedHair_13)				
	elseif (option == oidHairInput_14)						;TEXTX
		SetInputDialogStartText(SavedHair_14)		
	elseif (option == oidHairInput_15)						;TEXTX
		SetInputDialogStartText(SavedHair_15)		
	elseif (option == oidHairInput_16)						;TEXTX
		SetInputDialogStartText(SavedHair_16)		
	elseif (option == oidHairInput_17)						;TEXTX
		SetInputDialogStartText(SavedHair_17)		
	elseif (option == oidHairInput_18)						;TEXTX
		SetInputDialogStartText(SavedHair_18)		
	elseif (option == oidHairInput_19)						;TEXTX
		SetInputDialogStartText(SavedHair_19)		
	elseif (option == oidHairInput_20)						;TEXTX
		SetInputDialogStartText(SavedHair_20)	
	
	;/
	elseif (option == oidPunishmentInput_01)						;PunishmentX
		SetInputDialogStartText(SavedPunishment_01)
	elseif (option == oidPunishmentInput_02)						;PunishmentX
		SetInputDialogStartText(SavedPunishment_02)	
	elseif (option == oidPunishmentInput_03)						;PunishmentX
		SetInputDialogStartText(SavedPunishment_03)	
	elseif (option == oidPunishmentInput_04)						;PunishmentX
		SetInputDialogStartText(SavedPunishment_04)	
	elseif (option == oidPunishmentInput_05)						;PunishmentX
		SetInputDialogStartText(SavedPunishment_05)			
	elseif (option == oidPunishmentInput_06)						;PunishmentX
		SetInputDialogStartText(SavedPunishment_06)
	elseif (option == oidPunishmentInput_07)						;PunishmentX
		SetInputDialogStartText(SavedPunishment_07)	
	elseif (option == oidPunishmentInput_08)						;PunishmentX
		SetInputDialogStartText(SavedPunishment_08)	
	elseif (option == oidPunishmentInput_09)						;PunishmentX
		SetInputDialogStartText(SavedPunishment_09)	
	elseif (option == oidPunishmentInput_10)						;PunishmentX
		SetInputDialogStartText(SavedPunishment_10)	
/;
	endif
	
	
	
	
EndEvent


Function SetInfoDisplayWeightAll()
		
	Float tempFloat = 0
	
				;	50/10 = 20 		10/50 = 0,2
				;	100/10 = 10		10/100 = 0,1 
				;	400/10 = 2.5 	10/400 = 0,025 
					
				;	10/400 
	tempFloat = (10/ExposureChance)*100 
	DisplayExposure = tempFloat as int 

	SetInfoDisplayWeight(0)
	SetInfoDisplayWeight(1)
	SetInfoDisplayWeight(2)
	SetInfoDisplayWeight(3)
	SetInfoDisplayWeight(4)
	SetInfoDisplayWeight(5)
	SetInfoDisplayWeight(6)
	SetInfoDisplayWeight(7)
	
EndFunction


Function SetInfoDisplayWeight(int mode)		;#SetInfoDisplayWeight()
							;200						400 
				
;NymMessage("SetInfoDisplayWeight")
;	if DisplayWeight[] 				

;	endif			
	Float tempFloat = 0
		
	if mode == 0	
	
		;NymMessage("SetInfoDisplayWeight Mode 0, Naked_Weight: "+Naked_Weight)
		;NymMessage("SetInfoDisplayWeight Mode 0, ExposureChance: "+ExposureChance)
		tempFloat = (Naked_Weight/ExposureChance)*100 
		DisplayWeight[0] = tempFloat as int 
		if DisplayWeight[0] > 100 
		DisplayWeight[0] = 100
		endif		
	elseif mode == 1
		tempFloat = (Barefoot_Weight/ExposureChance)*100 
		DisplayWeight[1] = tempFloat as int 
		if DisplayWeight[1] > 100 
		DisplayWeight[1] = 100
		endif		
	elseif mode == 2		
		tempFloat = (Dirty_Weight/ExposureChance)*100 
		DisplayWeight[2] = tempFloat as int 
		if DisplayWeight[2] > 100 
		DisplayWeight[2] = 100
		endif		
	elseif mode == 3
		tempFloat = (Sneaking_Weight/ExposureChance)*100 
		DisplayWeight[3] = tempFloat as int 
		if DisplayWeight[3] > 100 
		DisplayWeight[3] = 100
		endif		
	elseif mode == 4
		tempFloat = (Running_Weight/ExposureChance)*100 
		DisplayWeight[4] = tempFloat as int 
		if DisplayWeight[4] > 100 
		DisplayWeight[4] = 100
		endif		
	elseif mode == 5	
		tempFloat = (Sprinting_Weight/ExposureChance)*100 
		DisplayWeight[5] = tempFloat as int 
		if DisplayWeight[5] > 100 
		DisplayWeight[5] = 100
		endif		
	elseif mode == 6	
		tempFloat = (Cum_Weight/ExposureChance)*100 
		DisplayWeight[6] = tempFloat as int 
		if DisplayWeight[6] > 100 
		DisplayWeight[6] = 100
		endif		
	elseif mode == 7			
		tempFloat = (Unarmed_Weight/ExposureChance)*100 
		DisplayWeight[7] = tempFloat as int 
		if DisplayWeight[7] > 100 
		DisplayWeight[7] = 100
		endif
	endif 	
		
EndFunction 


Event OnOptionSliderAccept(Int option, Float value)
	Int i

	;if (option == FollowerOID_S)
	;	FollowerProb = value
	;	SetSliderOptionValue(FollowerOID_S, FollowerProb, "{0}%")

	;elseif (option == IndecencyRapeOID_S)
	;	IndecencyRapeProb = value
	;	SetSliderOptionValue(IndecencyRapeOID_S, IndecencyRapeProb, "{0}%")
	;	if ModEnabled
	;		if IndecencyRapeProb
	;			Debug.Notification("Naked Dungeons' Civilian Rape feature ENABLED.")
	;		else
	;			Debug.Notification("Naked Dungeons' Civilian Rape feature DISABLED.")
	;		endif
	;	endif
	;elseif (option == IndecencyRobberyOID_S)
	;	IndecencyRobberyProb = value
	;	SetSliderOptionValue(IndecencyRobberyOID_S, IndecencyRobberyProb, "{0}%")
		
	if (option == FindSpotTimeOID_S)
		FindSpotTime = value
		SetSliderOptionValue(FindSpotTimeOID_S, FindSpotTime, "{0} sec")				
		
		
	elseif (option == Group5PchanceOID_S)
		Group5Pchance = value
		SetSliderOptionValue(Group5PchanceOID_S, Group5Pchance, "{0}%")	
	elseif (option == Group4PchanceOID_S)
		Group4Pchance = value
		SetSliderOptionValue(Group4PchanceOID_S, Group4Pchance, "{0}%")	
	elseif (option == Group3PchanceOID_S)
		Group3Pchance = value
		SetSliderOptionValue(Group3PchanceOID_S, Group3Pchance, "{0}%")
	elseif (option == ScenarioChanceOID_S)
		ScenarioChance = value
		SetSliderOptionValue(ScenarioChanceOID_S, ScenarioChance, "{0}%")
	elseif (option == DebugPunishmentTypeOID_S)
		DebugPunishmentType = value
		SetSliderOptionValue(DebugPunishmentTypeOID_S, DebugPunishmentType, "{0}")
	elseif (option == BleedoutCounterOID_S)
		BleedoutCounter = value
		SetSliderOptionValue(BleedoutCounterOID_S, BleedoutCounter, "{0}%")	
	elseif (option == DefeatChainOID_S)
		DefeatChainProb = value
		SetSliderOptionValue(DefeatChainOID_S, DefeatChainProb, "{0}%")

		
	elseif (option == DefeatForeplayChanceOID_S)
		DefeatForeplayChance = value
		SetSliderOptionValue(DefeatForeplayChanceOID_S, DefeatForeplayChance, "{0}%")
		
		if value > 0 	
		Debug.Messagebox("WARNING! Requires: Nymra SLAL Forced Foreplay to work. NOTE: Nymra SLAL Forced Foreplay needs extra work for Sexlab P+ SLSB")
		endif 
		
	elseif (option == DefeatEscapeOID_S)
		DefeatEscapeDiff = value
		SetSliderOptionValue(DefeatEscapeOID_S, DefeatEscapeDiff, "{0}%")
	elseif (option == DefeatRobberyOID_S)
		DefeatRobberyProb = value
		SetSliderOptionValue(DefeatRobberyOID_S, DefeatRobberyProb, "{0}%")
	elseif (option == NakedDeathChanceOID_S)
		NakedDeathChance = value
		SetSliderOptionValue(NakedDeathChanceOID_S, NakedDeathChance, "{0}%")		
	elseif (option == DefeatRescueProbOID_S)
		DefeatRescueProb = value
		SetSliderOptionValue(DefeatRescueProbOID_S, DefeatRescueProb, "{0}%")	

	elseif (option == FemalesAsMalesOID_S)
		FemalesAsMales = value
		SetSliderOptionValue(FemalesAsMalesOID_S, FemalesAsMales, "{0}%")
	elseif (option == RemoveDDChanceOID_S)
		RemoveDDChance = value
		SetSliderOptionValue(RemoveDDChanceOID_S, RemoveDDChance, "{0}%")
	elseif (option == SearchRadiusOID_S)
		SearchRadius = value
		SetSliderOptionValue(SearchRadiusOID_S, SearchRadius, "{0} units")	
	elseif (option == SearchRadiusInteriorOID_S)
		SearchRadiusInterior = value
		SetSliderOptionValue(SearchRadiusInteriorOID_S, SearchRadiusInterior, "{0} units")	
				
	elseif (option == DefeatIdleTimeOID_S)
		DefeatIdleTime = value
		SetSliderOptionValue(DefeatIdleTimeOID_S, DefeatIdleTime, "{0} sec")		
	elseif (option == DefeatPeeProbOID_S)
		DefeatPeeProb = value
		SetSliderOptionValue(DefeatPeeProbOID_S, DefeatPeeProb, "{0}%")			
	elseif (option == DefeatDDeProbOID_S)
		DefeatDDeProb = value
		SetSliderOptionValue(DefeatDDeProbOID_S, DefeatDDeProb, "{0}%")	
		
	elseif (option == PunishWhipChanceOID_S)
		PunishWhipChance = value
		SetSliderOptionValue(PunishWhipChanceOID_S, PunishWhipChance, "{0}%")	
	elseif (option == PunishSexChanceOID_S)
		PunishSexChance = value
		SetSliderOptionValue(PunishSexChanceOID_S, PunishSexChance, "{0}%")	
	elseif (option == PunishBukkakeChanceOID_S)
		PunishBukkakeChance = value
		SetSliderOptionValue(PunishBukkakeChanceOID_S, PunishBukkakeChance, "{0}%")	
		
	elseif (option == DefeatDeathChanceOID_S)
		DefeatDeathChance = value
		SetSliderOptionValue(DefeatDeathChanceOID_S, DefeatDeathChance, "{0}%")	
			
			if value > 0 
			Debug.Messagebox("WARNING! Requires SLAL Packs: Nymra, Proxy & Funnybiz to work properly. NOTE: Nymra SLAL needs extra work for Sexlab P+ SLSB")
			endif 
			
	elseif (option == DefeatSlaveryOID_S)
		DefeatSlaveryProb = value
		SetSliderOptionValue(DefeatSlaveryOID_S, DefeatSlaveryProb, "{0}%")
	elseif (option == DefeatSDweightOID_S)
		DefeatSDweight = value
		SetSliderOptionValue(DefeatSDweightOID_S, DefeatSDweight, "{0}%")		
	elseif (option == DefeatCaptivityOID_S)
		DefeatCaptivityProb = value
		SetSliderOptionValue(DefeatCaptivityOID_S, DefeatCaptivityProb, "{0}%")
	elseif (option == CooperativeSurrenderChanceOID_S)
		CooperativeSurrenderChance = value
		SetSliderOptionValue(CooperativeSurrenderChanceOID_S, CooperativeSurrenderChance, "{0}%")
	
	elseif (option == DefeatEscTimeOID_S)
		DefeatEscTime = value
		SetSliderOptionValue(DefeatEscTimeOID_S, DefeatEscTime, "{0} sec")	
			
	elseif (option == DefeatSpeedMultOID_S)
		DefeatSpeedMult = value
		SetSliderOptionValue(DefeatSpeedMultOID_S, DefeatSpeedMult, "{0}")	

	elseif (option == DefeatThrowOutOID_S)
		DefeatThrowOutProb = value
		SetSliderOptionValue(DefeatThrowOutOID_S, DefeatThrowOutProb, "{0}%")
	elseif (option == DefeatBreakClothingOID_S)
		DefeatBreakClothingProb = value
		SetSliderOptionValue(DefeatBreakClothingOID_S, DefeatBreakClothingProb, "{0}%")
		LootClothingProb = DefeatBreakClothingProb as int
		LootClothingProb = LootClothingProb*5
		
		LootFittingCostClothing = 500/DefeatBreakClothingProb
		LootFittingCostClothingInt = LootFittingCostClothing as int
			
		if LootClothingProb > 100
		LootClothingProb = 100
		endif
		ForcePageReset()
		
	elseif (option == DefeatBreakLightOID_S)
		DefeatBreakLightProb = value
		SetSliderOptionValue(DefeatBreakLightOID_S, DefeatBreakLightProb, "{0}%")
		LootBreakLightProb = DefeatBreakLightProb as int
		LootBreakLightProb = LootBreakLightProb*5
		
		LootFittingCostLight = 1000/DefeatBreakLightProb
		LootFittingCostLightInt = LootFittingCostLight as int
		
		if LootBreakLightProb > 100
		LootBreakLightProb = 100
		endif
		ForcePageReset()
	elseif (option == DefeatBreakHeavyOID_S)
		DefeatBreakHeavyProb = value
		SetSliderOptionValue(DefeatBreakHeavyOID_S, DefeatBreakHeavyProb, "{0}%")
		;#lorena
		LootBreakHeavyProb = DefeatBreakHeavyProb as int
		LootBreakHeavyProb = LootBreakHeavyProb*5
		
		LootFittingCostHeavy = 5000/DefeatBreakHeavyProb
		LootFittingCostHeavyInt = LootFittingCostHeavy as int
		
		if LootBreakHeavyProb > 100
		LootBreakHeavyProb = 100
		endif
		ForcePageReset()

	elseif (option == DefeatWhipProbOID_S)
		DefeatWhipProb = value
		SetSliderOptionValue(DefeatWhipProbOID_S, DefeatWhipProb, "{0}%")			
	elseif (option == DefeatWhipTimeOID_S)
		DefeatWhipTime = value
		SetSliderOptionValue(DefeatWhipTimeOID_S, DefeatWhipTime, "{0} sec")		
	elseif (option == CriticalDefeatOID_S)
		CriticalDefeat = value
		SetSliderOptionValue(CriticalDefeatOID_S, CriticalDefeat, "{0}%")
	elseif (option == NakedChanceOID_S)
		NakedChance = value
		SetSliderOptionValue(NakedChanceOID_S, NakedChance, "{0}%")
	elseif (option == MoanOnHitChanceOID_S)
		MoanOnHitChance = value
		SetSliderOptionValue(MoanOnHitChanceOID_S, MoanOnHitChance, "{0}%")		
	elseif (option == WhipmarksDurOID_S)
		WhipmarksDur = value
		SetSliderOptionValue(WhipmarksDurOID_S, WhipmarksDur, "{0} hrs")
	elseif (option == DefeatDowntimeOID_S)
		DefeatDowntime = value
		SetSliderOptionValue(DefeatDowntimeOID_S, DefeatDowntime, "{0} sec")	
	elseif (option == RapeHandsProbOID_S)
		RapeHandsProb = value
		SetSliderOptionValue(RapeHandsProbOID_S, RapeHandsProb, "{0}%")	
	elseif (option == PoisonDefeatChanceOID_S)
		PoisonDefeatChance = value
		SetSliderOptionValue(PoisonDefeatChanceOID_S, PoisonDefeatChance, "{0}%")	
	elseif (option == HairRegrowthOID_S)
		HairRegrowthTime = value
		SetSliderOptionValue(HairRegrowthOID_S, HairRegrowthTime, "{0} hrs")		
	elseif (option == BondageHaircutOID_S)
		BondageHaircutProb = value
		SetSliderOptionValue(BondagehaircutOID_S, BondageHaircutProb, "{0}%")
	elseif (option == ExposureChanceOID_S)
		ExposureChance = value
		SetSliderOptionValue(ExposureChanceOID_S, ExposureChance, "{0}")
		
		SetInfoDisplayWeightAll()	
		ForcePageReset()
		
	elseif (option == PunishShortProbOID_S)
		PunishShortProb = value
		SetSliderOptionValue(PunishShortProbOID_S, PunishShortProb, "{0}%")
		
	elseif (option == DefeatArrestProbOID_S)
		DefeatArrestProb = value
		SetSliderOptionValue(DefeatArrestProbOID_S, DefeatArrestProb, "{0}%")
			
		

	elseif (option == DefeatShortProbOID_S)
		DefeatShortProb = value
		SetSliderOptionValue(DefeatShortProbOID_S, DefeatShortProb, "{0}%")

		
	;civil rape sliders	
	elseif (option == LoopTime_OID_S)
		LoopTime = value
		SetSliderOptionValue(LoopTime_OID_S, LoopTime, "{0} sec")
	elseif (option == Naked_Weight_OID_S)
		Naked_Weight = value
		SetSliderOptionValue(Naked_Weight_OID_S, Naked_Weight, "{0}")	
		
		SetInfoDisplayWeight(0)
		ForcePageReset()
		
	elseif (option == Barefoot_Weight_OID_S)
		Barefoot_Weight = value
		SetSliderOptionValue(Barefoot_Weight_OID_S, Barefoot_Weight, "{0}")		
		
		SetInfoDisplayWeight(1)
		ForcePageReset()
	elseif (option == Dirty_Weight_OID_S)
		Dirty_Weight = value
		SetSliderOptionValue(Dirty_Weight_OID_S, Dirty_Weight, "{0}")
		
		SetInfoDisplayWeight(2)
		ForcePageReset()
	elseif (option == Sneaking_Weight_OID_S)
		Sneaking_Weight = value
		SetSliderOptionValue(Sneaking_Weight_OID_S, Sneaking_Weight, "{0}")
		
		SetInfoDisplayWeight(3)
		ForcePageReset()
	elseif (option == Running_Weight_OID_S)
		Running_Weight = value
		SetSliderOptionValue(Running_Weight_OID_S, Running_Weight, "{0}")	
		
		SetInfoDisplayWeight(4)
		ForcePageReset()
	elseif (option == Sprinting_Weight_OID_S)
		Sprinting_Weight = value
		SetSliderOptionValue(Sprinting_Weight_OID_S, Sprinting_Weight, "{0}")	
		
		SetInfoDisplayWeight(5)
		ForcePageReset()
	elseif (option == Cum_Weight_OID_S)
		Cum_Weight = value
		SetSliderOptionValue(Cum_Weight_OID_S, Cum_Weight, "{0}")
					
		SetInfoDisplayWeight(6)
		ForcePageReset()
	elseif (option == Unarmed_Weight_OID_S)
		Unarmed_Weight = value
		SetSliderOptionValue(Unarmed_Weight_OID_S, Unarmed_Weight, "{0}")
					
		SetInfoDisplayWeight(7)
		ForcePageReset()
	elseif (option == FallingDamageTreshold_OID_S)
		FallingDamageTreshold = value
		SetSliderOptionValue(FallingDamageTreshold_OID_S, FallingDamageTreshold, "{0}")
	elseif (option == KeyDDWiggleFreeChance_OID_S)
		KeyDDWiggleFreeChance = value
		SetSliderOptionValue(KeyDDWiggleFreeChance_OID_S, KeyDDWiggleFreeChance, "{0}")
	elseif (option == KeyDDWiggleFreeFailChance_OID_S)
		KeyDDWiggleFreeFailChance = value
		SetSliderOptionValue(KeyDDWiggleFreeFailChance_OID_S, KeyDDWiggleFreeFailChance, "{0}")
	
	endif	
	
EndEvent

Int[] Property DisplayWeight Auto 


Event OnOptionSelect(Int option)
	Int i
	Bool b

;	if (option == ExciteOID_B)				;WHAT IS THIS?
;		Excite = !Excite
;		SetToggleOptionValue(ExciteOID_B, Excite)
;	if (option == NuditySLAOID_B)
;		NuditySLA = !NuditySLA
;		SetToggleOptionValue(NuditySLAOID_B, NuditySLA)
;	elseif (option == NudityUnderwearOID_B)				;REENABLE
;		NudityUnderwear = !NudityUnderwear
;		SetToggleOptionValue(NudityUnderwearOID_B, NudityUnderwear)
	if (option == GuardPunishOID_B)				;PublicRape																;PROBLEM HERE
		Indecency = !Indecency
		SetToggleOptionValue(GuardPunishOID_B, Indecency)
		if ModEnabled && Indecency
				Debug.Notification("NAKED DEFEAT: Public Rape ENABLED.")
		else
				Debug.Notification("NAKED DEFEAT: Public Rape DISABLED.")
		endif
		
		;UpdateIndecency()
	;elseif (option == IndecencyHaircutOID_B)
	;	IndecencyHaircut = !IndecencyHaircut
	;	SetToggleOptionValue(IndecencyHaircutOID_B, IndecencyHaircut)
	elseif (option == WhipMarksOID_B)
		WhipMarks = !WhipMarks
		SetToggleOptionValue(WhipMarksOID_B, WhipMarks)
	elseif (option == MaleFollowerOID_B)
		MaleFollower = !MaleFollower
		SetToggleOptionValue(MaleFollowerOID_B, MaleFollower)	
	elseif (option == FemaleFollowerOID_B)
		FemaleFollower = !FemaleFollower
		SetToggleOptionValue(FemaleFollowerOID_B, FemaleFollower)		
	elseif (option == DefeatGetUpOID_B)
		DefeatGetUp = !DefeatGetUp
		SetToggleOptionValue(DefeatGetUpOID_B, DefeatGetUp)		
	elseif (option == DropItemOID_B)
		DropItem = !DropItem
		SetToggleOptionValue(DropItemOID_B, DropItem)	
	elseif (option == SlipperyOID_B)
		Slippery = !Slippery
		SetToggleOptionValue(SlipperyOID_B, Slippery)	
	elseif (option == StripAttackOID_B)
		StripAttack = !StripAttack
		SetToggleOptionValue(StripAttackOID_B, StripAttack)	
		
	elseif (option == NoExtraOID_B)
		NoExtra = !NoExtra
		SetToggleOptionValue(NoExtraOID_B, NoExtra)	
		
	elseif (option == MoanOnHitOID_B)
		MoanOnHit = !MoanOnHit
		SetToggleOptionValue(MoanOnHitOID_B, MoanOnHit)	

	elseif (option == DefeatOID_B)
		DefeatEnabled = !DefeatEnabled
		SetToggleOptionValue(DefeatOID_B, DefeatEnabled)
		if ModEnabled
			EnableDefeat(DefeatEnabled)
		endif
	elseif (option == DefeatBreakArmorOID_B)
		DefeatBreakArmor = !DefeatBreakArmor
		SetToggleOptionValue(DefeatBreakArmorOID_B, DefeatBreakArmor)
		;#lorena LootChance


	elseif (option == NakedDrowningOID_B)
		NakedDrowning = !NakedDrowning
		SetToggleOptionValue(NakedDrowningOID_B, NakedDrowning)	
		
	elseif (option == NakedLootOID_B)
		NakedLoot = !NakedLoot
		SetToggleOptionValue(NakedLootOID_B, NakedLoot)	

	elseif (option == SSHandlingOID_B)
		SSHandling = !SSHandling
		SetToggleOptionValue(SSHandlingOID_B, SSHandling)			

	elseif (option == DeviousPiercingEffectsOID_B)
		DeviousPiercingEffects = !DeviousPiercingEffects
		SetToggleOptionValue(DeviousPiercingEffectsOID_B, DeviousPiercingEffects)			

	elseif (option == NakedLootHotkeysOID_B)
		NakedLootHotkeys = !NakedLootHotkeys
		SetToggleOptionValue(NakedLootHotkeysOID_B, NakedLootHotkeys)	
		
		if NakedLootHotkeys 
		RegisterForLootHotkeys()
		else
		UnRegisterForLootHotkeys()
		endif
		
		;#Linda
		
	elseif (option == NakedTravelOID_B)
		NakedTravel = !NakedTravel
		SetToggleOptionValue(NakedTravelOID_B, NakedTravel)	
		if NakedTravel
		FastTravel("Disabled", false)
	;	ScreenMessage("FAST TRAVEL DISABLED")
		else 
		FastTravel("Enabled", false)
	;	ScreenMessage("FAST TRAVEL DISABLED")
		endif
		
	elseif (option == RemoveDDsOID_B)
		RemoveDDs = !RemoveDDs
		SetToggleOptionValue(RemoveDDsOID_B, RemoveDDs)
	elseif (option == GodModeOID_B)
		GodMode = !GodMode
		SetToggleOptionValue(GodModeOID_B, GodMode)	
	
	elseif (option == HealthBoostOID_B)
		HealthBoost = !HealthBoost
		SetToggleOptionValue(HealthBoostOID_B, HealthBoost)	
			
	elseif (option == NoEssentialPlayerOID_B)
		NoEssentialPlayer = !NoEssentialPlayer
		SetToggleOptionValue(NoEssentialPlayerOID_B, NoEssentialPlayer)		
		
		if NoEssentialPlayer
			;we do NOT want Essential Player
			if PlayerRef.GetActorBase().IsEssential()
			PlayerRef.GetActorBase().SetEssential(false)
			Debug.Messagebox("NAKED DEFEAT: Essential Player OFF") 
			elseif !PlayerRef.GetActorBase().IsEssential()
			Debug.Messagebox("NAKED DEFEAT: Player was NOT essential already (other mod interfering?).")
			endif 
			
		elseif !NoEssentialPlayer	
			;we DO want an Essential Player
			if PlayerRef.GetActorBase().IsEssential()
			Debug.Messagebox("NAKED DEFEAT: Player was already essential (other mod interfering?.")
			elseif !PlayerRef.GetActorBase().IsEssential()
			PlayerRef.GetActorBase().SetEssential(true)
			Debug.Messagebox("NAKED DEFEAT: Essential Player ON") 	
			endif
		endif
		
	elseif (option == PlayExpressionsOID_B)
		PlayExpressions = !PlayExpressions
		SetToggleOptionValue(PlayExpressionsOID_B, PlayExpressions)
	elseif (option == NakedBlurOID_B)
		NakedBlur = !NakedBlur
		SetToggleOptionValue(NakedBlurOID_B, NakedBlur)	
	elseif (option == LagFixOID_B)
		LagFix = !LagFix
		SetToggleOptionValue(LagFixOID_B, LagFix)	

	elseif (option == HarmlessOID_B)				;REACTIVAE?
		Harmlessness = !Harmlessness
		SetToggleOptionValue(HarmlessOID_B, Harmlessness)
		if !Harmlessness && PlayerRef.IsInFaction(nade_HarmlessFaction)
			PlayerRef.RemoveFromFaction(nade_HarmlessFaction)
			Debug.Notification("cfgqst 3028 Harmless removed.")
		endif
		if ModEnabled
			if Harmlessness
				Debug.Notification("NAKED DEFEAT: Harmless ENABLED.")
			else
				Debug.Notification("NAKED DEFEAT: Harmless DISABLED.")
			endif
		endif

	elseif (option == EnabledOID_B)
		ModEnabled = !ModEnabled
		SetToggleOptionValue(EnabledOID_B, ModEnabled)
		EnableMod(ModEnabled)	

	elseif (option == ShowNarrativeMessagesOID_B)
		ShowNarrativeMessages = !ShowNarrativeMessages			
		SetToggleOptionValue(ShowNarrativeMessagesOID_B, ShowNarrativeMessages)
	elseif (option == ShowInfoMessagesOID_B)
		ShowInfoMessages = !ShowInfoMessages			
		SetToggleOptionValue(ShowInfoMessagesOID_B, ShowInfoMessages)		

	elseif (option == MessagesOID_B)
		ShowDebugMessages = !ShowDebugMessages			
		SetToggleOptionValue(MessagesOID_B, ShowDebugMessages)
	elseif (option == NymStrippingOID_B)
		NymStripping = !NymStripping			
		SetToggleOptionValue(NymStrippingOID_B, NymStripping)
		
	elseif (option == NymSpawningOID_B)
		NymSpawning = !NymSpawning			
		SetToggleOptionValue(NymSpawningOID_B, NymSpawning)
		
	elseif (option == HeelsFixOID_B)
		HeelsFix = !HeelsFix			
		SetToggleOptionValue(HeelsFixOID_B, HeelsFix)
		
		
	elseif (option == NymBetaOID_B)
		NymBeta = !NymBeta			
		SetToggleOptionValue(NymBetaOID_B, NymBeta)
		
		if NymBeta
		Debug.MessageBox("You just enabled Nymra's BETA Features. Read the the DETAILS for this in the Mod Description on LoversLab BEFORE asking me in the support thread why stuff happens...")
		endif
		
	elseif (option == VRfixOID_B)
		VRfix = !VRfix			
		SetToggleOptionValue(VRfixOID_B, VRfix)	

	elseif (option == SSEfixOID_B)
		SSEfix = !SSEfix			
		SetToggleOptionValue(SSEfixOID_B, SSEfix)	
	
	elseif (option == NoCrawlingOID_B)
		NoCrawling = !NoCrawling			
		SetToggleOptionValue(NoCrawlingOID_B, NoCrawling)		
			
	elseif (option == RagdollOID_B)
		Ragdoll = !Ragdoll			
		SetToggleOptionValue(RagdollOID_B, Ragdoll)
		
	elseif (option == DefeatRobberyGoldOID_B)
		DefeatRobberyGold = !DefeatRobberyGold			
		SetToggleOptionValue(DefeatRobberyGoldOID_B, DefeatRobberyGold)	
		
	
	elseif (option == ToggleDeleteDeviceOID_B)
		ToggleDeleteDevice = !ToggleDeleteDevice			
		SetToggleOptionValue(ToggleDeleteDeviceOID_B, ToggleDeleteDevice)	
		
	elseif (option == DefeatSceneProtectorsOID_B)
		DefeatSceneProtectors = !DefeatSceneProtectors			
		SetToggleOptionValue(DefeatSceneProtectorsOID_B, DefeatSceneProtectors)	
			
	elseif (option == AllowCreaturesOID_B)
		AllowCreatures = !AllowCreatures				
		SetToggleOptionValue(AllowCreaturesOID_B, AllowCreatures)	
	elseif (option == DefeatSpotAndEscapeOID_B)
		DefeatSpotAndEscape = !DefeatSpotAndEscape				
		SetToggleOptionValue(DefeatSpotAndEscapeOID_B, DefeatSpotAndEscape)	

	elseif (option == FemalesAllowedOID_B)
		FemalesAllowed = !FemalesAllowed				
		SetToggleOptionValue(FemalesAllowedOID_B, FemalesAllowed)	
		
	elseif (option == StageGoBackOID_B)
		StageGoBack = !StageGoBack				
		SetToggleOptionValue(StageGoBackOID_B, StageGoBack)	
		
	elseif (option == SkipSexOID_B)
		SkipSex = !SkipSex				
		SetToggleOptionValue(SkipSexOID_B, SkipSex)	
			
	elseif (option == NakedCummingOID_B)
		NakedCumming = !NakedCumming				
		SetToggleOptionValue(NakedCummingOID_B, NakedCumming)	
						
			
	elseif (option == SimpleSurrenderOID_B)
		SimpleSurrender = !SimpleSurrender				
		SetToggleOptionValue(SimpleSurrenderOID_B, SimpleSurrender)		
	elseif (option == WeaponOutSurrenderOID_B)
		WeaponOutSurrender = !WeaponOutSurrender				
		SetToggleOptionValue(WeaponOutSurrenderOID_B, WeaponOutSurrender)
	elseif (option == FinishQuestOID_B)
		SetToggleOptionValue(FinishQuestOID_B, true)
		(ErrandQuest as nade_errandquest_scr).QuestReset()
	;elseif (option == DebugCalmOID_B)
	;	DoResetQuest(DebugCalmOID_B, CalmQuest)
	;elseif (option == DebugCaptureOID_B)
;		DoResetQuest(DebugCaptureOID_B, CaptureQuest)
;	elseif (option == DebugCaptiveOID_B)
;		DoResetQuest(DebugCaptiveOID_B, CaptiveQuest)
	
;	elseif (option == DebugAllegianceOID_B)
	;	DoResetQuest(DebugAllegianceOID_B, AllegianceQuest)		
		
	;CREATURE TOGGLES-----------------------	
		
	elseif (option == AllowArgonKajitOID_B)
		AllowArgonKajit = !AllowArgonKajit			
		SetToggleOptionValue(AllowArgonKajitOID_B, AllowArgonKajit)	
	elseif (option == AllowHumanoidBeastsOID_B)
		AllowHumanoidBeasts = !AllowHumanoidBeasts			
		SetToggleOptionValue(AllowHumanoidBeastsOID_B, AllowHumanoidBeasts)		
	elseif (option == AllowUndeadOID_B)
		AllowUndead = !AllowUndead			
		SetToggleOptionValue(AllowUndeadOID_B, AllowUndead)		
	elseif (option == AllowRieklingsOID_B)
		AllowRieklings = !AllowRieklings			
		SetToggleOptionValue(AllowRieklingsOID_B, AllowRieklings)			
	elseif (option == AllowFalmersOID_B)
		AllowFalmers = !AllowFalmers			
		SetToggleOptionValue(AllowFalmersOID_B, AllowFalmers)			
	elseif (option == AllowSpriggansOID_B)
		AllowSpriggans = !AllowSpriggans			
		SetToggleOptionValue(AllowSpriggansOID_B, AllowSpriggans)			
	elseif (option == AllowElementalsFemaleOID_B)
		AllowElementalsFemale = !AllowElementalsFemale			
		SetToggleOptionValue(AllowElementalsFemaleOID_B, AllowElementalsFemale)			
	elseif (option == AllowElementalsMaleOID_B)
		AllowElementalsMale = !AllowElementalsMale			
		SetToggleOptionValue(AllowElementalsMaleOID_B, AllowElementalsMale)			
	elseif (option == AllowTentacleStuffOID_B)
		AllowTentacleStuff = !AllowTentacleStuff			
		SetToggleOptionValue(AllowTentacleStuffOID_B, AllowTentacleStuff)			
	elseif (option == AllowInsectsOID_B)
		AllowInsects = !AllowInsects			
		SetToggleOptionValue(AllowInsectsOID_B, AllowInsects)			
	elseif (option == AllowSpidersOID_B)
		AllowSpiders = !AllowSpiders			
		SetToggleOptionValue(AllowSpidersOID_B, AllowSpiders)
	elseif (option == AllowSabreCatsOID_B)
		AllowSabreCats = !AllowSabreCats			
		SetToggleOptionValue(AllowSabreCatsOID_B, AllowSabreCats)			
	elseif (option == AllowSkeeversOID_B)
		AllowSkeevers = !AllowSkeevers			
		SetToggleOptionValue(AllowSkeeversOID_B, AllowSkeevers)			
	elseif (option == AllowBearsOID_B)
		AllowBears = !AllowBears			
		SetToggleOptionValue(AllowBearsOID_B, AllowBears)			
	elseif (option == AllowCaninesOID_B)
		AllowCanines = !AllowCanines			
		SetToggleOptionValue(AllowCaninesOID_B, AllowCanines)			
	elseif (option == AllowDeersOID_B)
		AllowDeers = !AllowDeers			
		SetToggleOptionValue(AllowDeersOID_B, AllowDeers)			
	elseif (option == AllowFoxesOID_B)
		AllowFoxes = !AllowFoxes			
		SetToggleOptionValue(AllowFoxesOID_B, AllowFoxes)			
	elseif (option == AllowRabbitsOID_B)
		AllowRabbits = !AllowRabbits			
		SetToggleOptionValue(AllowRabbitsOID_B, AllowRabbits)	
	elseif (option == AllowHorkersOID_B)
		AllowHorkers = !AllowHorkers			
		SetToggleOptionValue(AllowHorkersOID_B, AllowHorkers)	
	elseif (option == AllowMammothsOID_B)
		AllowMammoths = !AllowMammoths			
		SetToggleOptionValue(AllowMammothsOID_B, AllowMammoths)	
	elseif (option == AllowHorsesOID_B)
		AllowHorses = !AllowHorses			
		SetToggleOptionValue(AllowHorsesOID_B, AllowHorses)	
	elseif (option == AllowCowsOID_B)
		AllowCows = !AllowCows			
		SetToggleOptionValue(AllowCowsOID_B, AllowCows)	
	elseif (option == AllowChickenOID_B)
		AllowChicken = !AllowChicken			
		SetToggleOptionValue(AllowChickenOID_B, AllowChicken)	
	elseif (option == AllowGoatsOID_B)
		AllowGoats = !AllowGoats			
		SetToggleOptionValue(AllowGoatsOID_B, AllowGoats)	
	elseif (option == AllowDwarvenOID_B)
		AllowDwarven = !AllowDwarven			
		SetToggleOptionValue(AllowDwarvenOID_B, AllowDwarven)	
;	elseif (option == AllowNetchesOID_B)
;		AllowNetches = !AllowNetches			
;		SetToggleOptionValue(AllowNetchesOID_B, AllowNetches)	
	;------------------------------------------------------	
	
	;------ BODY SLOTS --------------------------------------------
	
	elseif (option == BlockSlot30_OID_B)
		BlockSlot[0] = !BlockSlot[0]			
		SetToggleOptionValue(BlockSlot30_OID_B, BlockSlot[0])	
	elseif (option == BlockSlot31_OID_B)
		BlockSlot[1] = !BlockSlot[1]			
		SetToggleOptionValue(BlockSlot31_OID_B, BlockSlot[1])	
	elseif (option == BlockSlot32_OID_B)
		BlockSlot[2] = !BlockSlot[2]			
		SetToggleOptionValue(BlockSlot32_OID_B, BlockSlot[2])	
	elseif (option == BlockSlot33_OID_B)
		BlockSlot[3] = !BlockSlot[3]			
		SetToggleOptionValue(BlockSlot33_OID_B, BlockSlot[3])		
	elseif (option == BlockSlot34_OID_B)
		BlockSlot[4] = !BlockSlot[4]			
		SetToggleOptionValue(BlockSlot34_OID_B, BlockSlot[4])
		
	elseif (option == BlockSlot35_OID_B)
		BlockSlot[5] = !BlockSlot[5]			
		SetToggleOptionValue(BlockSlot35_OID_B, BlockSlot[5])	
	elseif (option == BlockSlot36_OID_B)
		BlockSlot[6] = !BlockSlot[6]			
		SetToggleOptionValue(BlockSlot36_OID_B, BlockSlot[6])	
	elseif (option == BlockSlot37_OID_B)
		BlockSlot[7] = !BlockSlot[7]			
		SetToggleOptionValue(BlockSlot37_OID_B, BlockSlot[7])	
	elseif (option == BlockSlot38_OID_B)
		BlockSlot[8] = !BlockSlot[8]			
		SetToggleOptionValue(BlockSlot38_OID_B, BlockSlot[8])		
	elseif (option == BlockSlot39_OID_B)
		BlockSlot[9] = !BlockSlot[9]			
		SetToggleOptionValue(BlockSlot39_OID_B, BlockSlot[9])
		
		
	elseif (option == BlockSlot40_OID_B)
		BlockSlot[10] = !BlockSlot[10]			
		SetToggleOptionValue(BlockSlot40_OID_B, BlockSlot[10])	
	elseif (option == BlockSlot41_OID_B)
		BlockSlot[11] = !BlockSlot[11]			
		SetToggleOptionValue(BlockSlot41_OID_B, BlockSlot[11])	
	elseif (option == BlockSlot42_OID_B)
		BlockSlot[12] = !BlockSlot[12]			
		SetToggleOptionValue(BlockSlot42_OID_B, BlockSlot[12])	
	elseif (option == BlockSlot43_OID_B)
		BlockSlot[13] = !BlockSlot[13]			
		SetToggleOptionValue(BlockSlot43_OID_B, BlockSlot[13])		
	elseif (option == BlockSlot44_OID_B)
		BlockSlot[14] = !BlockSlot[14]			
		SetToggleOptionValue(BlockSlot44_OID_B, BlockSlot[14])
		
	elseif (option == BlockSlot45_OID_B)
		BlockSlot[15] = !BlockSlot[15]			
		SetToggleOptionValue(BlockSlot45_OID_B, BlockSlot[15])	
	elseif (option == BlockSlot46_OID_B)
		BlockSlot[16] = !BlockSlot[16]			
		SetToggleOptionValue(BlockSlot46_OID_B, BlockSlot[16])	
	elseif (option == BlockSlot47_OID_B)
		BlockSlot[17] = !BlockSlot[17]			
		SetToggleOptionValue(BlockSlot47_OID_B, BlockSlot[17])	
	elseif (option == BlockSlot48_OID_B)
		BlockSlot[18] = !BlockSlot[18]			
		SetToggleOptionValue(BlockSlot48_OID_B, BlockSlot[18])		
	elseif (option == BlockSlot49_OID_B)
		BlockSlot[19] = !BlockSlot[19]			
		SetToggleOptionValue(BlockSlot49_OID_B, BlockSlot[19])
	
	
	elseif (option == BlockSlot50_OID_B)
		BlockSlot[20] = !BlockSlot[20]			
		SetToggleOptionValue(BlockSlot50_OID_B, BlockSlot[20])	
	elseif (option == BlockSlot51_OID_B)
		BlockSlot[21] = !BlockSlot[21]			
		SetToggleOptionValue(BlockSlot51_OID_B, BlockSlot[21])	
	elseif (option == BlockSlot52_OID_B)
		BlockSlot[22] = !BlockSlot[22]			
		SetToggleOptionValue(BlockSlot52_OID_B, BlockSlot[22])	
	elseif (option == BlockSlot53_OID_B)
		BlockSlot[23] = !BlockSlot[23]			
		SetToggleOptionValue(BlockSlot53_OID_B, BlockSlot[23])		
	elseif (option == BlockSlot54_OID_B)
		BlockSlot[24] = !BlockSlot[24]			
		SetToggleOptionValue(BlockSlot54_OID_B, BlockSlot[24])  		
	
	elseif (option == BlockSlot55_OID_B)
		BlockSlot[25] = !BlockSlot[25]			
		SetToggleOptionValue(BlockSlot55_OID_B, BlockSlot[25])	
	elseif (option == BlockSlot56_OID_B)
		BlockSlot[26] = !BlockSlot[26]			
		SetToggleOptionValue(BlockSlot56_OID_B, BlockSlot[26])	
	elseif (option == BlockSlot57_OID_B)
		BlockSlot[27] = !BlockSlot[27]			
		SetToggleOptionValue(BlockSlot57_OID_B, BlockSlot[27])	
	elseif (option == BlockSlot58_OID_B)
		BlockSlot[28] = !BlockSlot[28]			
		SetToggleOptionValue(BlockSlot58_OID_B, BlockSlot[28])		
	elseif (option == BlockSlot59_OID_B)
		BlockSlot[29] = !BlockSlot[29]			
		SetToggleOptionValue(BlockSlot59_OID_B, BlockSlot[29])

	elseif (option == BlockSlot60_OID_B)
		BlockSlot[30] = !BlockSlot[30]			
		SetToggleOptionValue(BlockSlot60_OID_B, BlockSlot[30])		
	elseif (option == BlockSlot61_OID_B)
		BlockSlot[31] = !BlockSlot[31]			
		SetToggleOptionValue(BlockSlot61_OID_B, BlockSlot[31])
	
	;------------------------------------------------------
	
	endif
	
	;save/load profile

	If (option == Save_Profile1_T)
		Profile = "1"
		LoadSaveProfile(False)
	ElseIf (option == Load_Profile1_T)
		Profile = "1"
		LoadSaveProfile(True)
		ImportOutfitsAndWeapons()
	EndIf
	If (option == Save_Profile2_T)
		Profile = "2"
		LoadSaveProfile(False)
	ElseIf (option == Load_Profile2_T)
		Profile = "2"
		LoadSaveProfile(True)
		ImportOutfitsAndWeapons()
	EndIf
	If (option == Save_Profile3_T)
		Profile = "3"
		LoadSaveProfile(False)
	ElseIf (option == Load_Profile3_T)
		Profile = "3"
		LoadSaveProfile(True)
		ImportOutfitsAndWeapons()
	EndIf
	If (option == Save_Profile4_T)
		Profile = "4"
		LoadSaveProfile(False)
	ElseIf (option == Load_Profile4_T)
		Profile = "4"
		LoadSaveProfile(True)
		ImportOutfitsAndWeapons()
	EndIf
	If (option == Save_Profile5_T)
		Profile = "5"
		LoadSaveProfile(False)
	ElseIf (option == Load_Profile5_T)
		Profile = "5"
		LoadSaveProfile(True)
		ImportOutfitsAndWeapons()
	EndIf	
	;save/load profile	
	
		
	If (option == Save_Outfit_01_T)			;01
		Save_JSON_Outfit("01")
	ElseIf (option == Load_Outfit_01_T)
		IsCheat = True
		Load_JSON_Outfit("01", "All", false)

	EndIf
	
	If (option == Save_Outfit_02_T)			;02
		Save_JSON_Outfit("02")
	ElseIf (option == Load_Outfit_02_T)
		IsCheat = True
		Load_JSON_Outfit("02", "All", false)

	EndIf
	
	If (option == Save_Outfit_03_T)			;03
		Save_JSON_Outfit("03")
	ElseIf (option == Load_Outfit_03_T)
		IsCheat = True
		Load_JSON_Outfit("03", "All", false)
	
	EndIf
	
	If (option == Save_Outfit_04_T)			;04
		Save_JSON_Outfit("04")
	ElseIf (option == Load_Outfit_04_T)
		IsCheat = True
		Load_JSON_Outfit("04", "All", false)
	EndIf
	
	If (option == Save_Outfit_05_T)			;05
		Save_JSON_Outfit("05")
	ElseIf (option == Load_Outfit_05_T)
		IsCheat = True
		Load_JSON_Outfit("05", "All", false)

	EndIf
	
	If (option == Save_Outfit_06_T)			;06
		Save_JSON_Outfit("06")
	
	ElseIf (option == Load_Outfit_06_T)
		IsCheat = True
		Load_JSON_Outfit("06", "All", false)
	EndIf

	If (option == Save_Outfit_07_T)			;07
		Save_JSON_Outfit("07")
	ElseIf (option == Load_Outfit_07_T)
		IsCheat = True
		Load_JSON_Outfit("07", "All", false)
	EndIf

	If (option == Save_Outfit_08_T)			;08
		Save_JSON_Outfit("08")
	ElseIf (option == Load_Outfit_08_T)
		IsCheat = True
		Load_JSON_Outfit("08", "All", false)

	EndIf

	If (option == Save_Outfit_09_T)			;09
		Save_JSON_Outfit("09")
	ElseIf (option == Load_Outfit_09_T)
		IsCheat = True
		Load_JSON_Outfit("09", "All", false)

	EndIf

	If (option == Save_Outfit_10_T)			;10
		Save_JSON_Outfit("10")
	ElseIf (option == Load_Outfit_10_T)
		IsCheat = True
		Load_JSON_Outfit("10", "All", false)

	EndIf
	
	If (option == Save_Weapon_01_T)			;01
		Save_JSON_Weapon("01")
	ElseIf (option == Load_Weapon_01_T)
		IsCheat = True
		Load_JSON_Weapon("01", false)

	EndIf
	
	If (option == Save_Weapon_02_T)			;02
		Save_JSON_Weapon("02")
	ElseIf (option == Load_Weapon_02_T)
		IsCheat = True
		Load_JSON_Weapon("02", false)
	EndIf
	
	If (option == Save_Weapon_03_T)			;03
		Save_JSON_Weapon("03")
	ElseIf (option == Load_Weapon_03_T)
		IsCheat = True
		Load_JSON_Weapon("03", false)

	EndIf
	
	If (option == Save_Weapon_04_T)			;04
		Save_JSON_Weapon("04")
	ElseIf (option == Load_Weapon_04_T)
		IsCheat = True
		Load_JSON_Weapon("04", false)

	EndIf
	
	If (option == Save_Weapon_05_T)			;05
		Save_JSON_Weapon("05")
	ElseIf (option == Load_Weapon_05_T)
		IsCheat = True
		Load_JSON_Weapon("05", false)

	EndIf
	
	If (option == Save_Weapon_06_T)			;06
		Save_JSON_Weapon("06")
	ElseIf (option == Load_Weapon_06_T)
		IsCheat = True
		Load_JSON_Weapon("06", false)

	EndIf

	If (option == Save_Weapon_07_T)			;07
		Save_JSON_Weapon("07")
	ElseIf (option == Load_Weapon_07_T)
		IsCheat = True
		Load_JSON_Weapon("07", false)

	EndIf

	If (option == Save_Weapon_08_T)			;08
		Save_JSON_Weapon("08")
	ElseIf (option == Load_Weapon_08_T)
		IsCheat = True
		Load_JSON_Weapon("08", false)

	EndIf

	If (option == Save_Weapon_09_T)			;09
		Save_JSON_Weapon("09")
	ElseIf (option == Load_Weapon_09_T)
			IsCheat = True
		Load_JSON_Weapon("09", false)

	EndIf

	If (option == Save_Weapon_10_T)			;10
		Save_JSON_Weapon("10")
	ElseIf (option == Load_Weapon_10_T)
			IsCheat = True
		Load_JSON_Weapon("10", false)

	EndIf
	
	;/
	If (option == Save_Outfit_02_T)
		SaveOutfit(2)
	ElseIf (option == Load_Outfit_02_T)
		LoadOutfitCheat(2)
	EndIf
	
	If (option == Save_Outfit_03_T)
		SaveOutfit(3)
	ElseIf (option == Load_Outfit_03_T)
		LoadOutfitCheat(3)
	EndIf
	
	If (option == Save_Outfit_04_T)
		SaveOutfit(4)
	ElseIf (option == Load_Outfit_04_T)
		LoadOutfitCheat(4)
	EndIf
	
	If (option == Save_Outfit_05_T)
		SaveOutfit(5)
	ElseIf (option == Load_Outfit_05_T)
		LoadOutfitCheat(5)
	EndIf
	
	/;
	
		
	If (option == Save_PunishmentOutfit1_T)
		SaveOutfit(11)
	;ElseIf (option == Load_Outfit_01_T)
	;	LoadOutfitCheat("1")
	EndIf
	If (option == Save_PunishmentOutfit2_T)
		SaveOutfit(12)
	;ElseIf (option == Load_Outfit_02_T)
	;	LoadOutfitCheat("2")
	EndIf
	If (option == Save_PunishmentOutfit3_T)
		SaveOutfit(13)
	;ElseIf (option == Load_Outfit_03_T)
	;	LoadOutfitCheat("3")
	EndIf
	If (option == Save_PunishmentOutfit4_T)
		SaveOutfit(14)
	;ElseIf (option == Load_Outfit_04_T)
	;	LoadOutfitCheat("4")
	EndIf
	If (option == Save_PunishmentOutfit5_T)
		SaveOutfit(15)
	;ElseIf (option == Load_Outfit_05_T)
	;	LoadOutfitCheat("5")
	EndIf
	

EndEvent



;/
SD CAGES IMPLEMENTATION

fd0b1abc 	bedroll		Redorans Retread		small cage, bad for sex
fd2f485d	bedroll		Swindlers Den			medium cage, enough for 1 scene
fd52253d	haypile 	Riften Entrance

Whiterun Public Bondage 

000a8050	redmarker	Roof of Guard House
0002d826	redmarker	On the bride to dragonsreach

000ac9c7	idlemarker	Markarth 				PUBLIC BONDAGE on the ramparts outside
4601b9a5	Xmarker		Markarth				PUBLIC BONDAGE under the waterfall!!!

0e07d6ac	Furniture	Kennel Bondage			TRANSPORT
0e039530	Furniture	Gibbet Small 			TRANSPORT	kneeling wiggle

/;

Event OnOptionMenuOpen(Int option)			

		if (option == StripOptions_OID_M)
		SetMenuDialogOptions(StripOptionsList)
		SetMenuDialogStartIndex(StripOptions)
		SetMenuDialogDefaultIndex(0)
		elseif (option == WiggleOptions_OID_M)
		SetMenuDialogOptions(WiggleOptionsList)
		SetMenuDialogStartIndex(WiggleOptions)
		SetMenuDialogDefaultIndex(4)
		elseif (option == WiggleOptionsSS_OID_M)
		SetMenuDialogOptions(WiggleOptionsSSList)
		SetMenuDialogStartIndex(WiggleOptionsSS)
		SetMenuDialogDefaultIndex(0)
		
		elseif (option == DefeatFindSpot_OID_M)
		SetMenuDialogOptions(DefeatFindSpotList)
		SetMenuDialogStartIndex(DefeatFindSpot)
		SetMenuDialogDefaultIndex(1)
		elseif (option == DefeatEscapeCrawl_OID_M)
		SetMenuDialogOptions(DefeatEscapeCrawlList)
		SetMenuDialogStartIndex(DefeatEscapeCrawl)
		SetMenuDialogDefaultIndex(1)
		
		endif

		
EndEvent

Event OnOptionMenuAccept(Int option, Int index)		

	if (option == StripOptions_OID_M)
		StripOptions = index
		SetMenuOptionValue(StripOptions_OID_M, StripOptionsList[StripOptions])
	elseif (option == WiggleOptions_OID_M)
		WiggleOptions = index
		SetMenuOptionValue(WiggleOptions_OID_M, WiggleOptionsList[WiggleOptions])
	elseif (option == WiggleOptionsSS_OID_M)
		WiggleOptionsSS = index
		SetMenuOptionValue(WiggleOptionsSS_OID_M, WiggleOptionsSSList[WiggleOptionsSS])
		
		
	elseif (option == DefeatFindSpot_OID_M)
		DefeatFindSpot = index
		
		if !LagFix && DefeatFindSpot == 2
		Debug.Messagebox("I highly recommend to also enable LagFix in System (Page 1)") 
		endif 
		
		SetMenuOptionValue(DefeatFindSpot_OID_M, DefeatFindSpotList[DefeatFindSpot])
	elseif (option == DefeatEscapeCrawl_OID_M)
		DefeatEscapeCrawl = index
		
			if !LagFix && DefeatEscapeCrawl == 2
			Debug.Messagebox("I highly recommend to also enable LagFix in System (Page 1)") 
			endif 
		
		SetMenuOptionValue(DefeatEscapeCrawl_OID_M, DefeatEscapeCrawlList[DefeatEscapeCrawl])
		
	endif

	
	
EndEvent

;FelixChialStart
Event OnOptionKeyMapChange(int option, int keyCode, string conflictControl, string conflictName)			;NYMRA fuck this piece of keycodes lol... remove: here are changed keybinds?

	if option == DefeatKeyOID_K
		if ModEnabled && DefeatEnabled
			if keyCode == 1 || keyCode == 211
				UnregisterForKey(DefeatKey)
				DefeatKey = 0
				SetKeyMapOptionValue(DefeatKeyOID_K, 211)
			elseif conflictControl == ""
				UnregisterForKey(DefeatKey)
				DefeatKey = keyCode
				RegisterForKey(DefeatKey)
				SetKeyMapOptionValue(DefeatKeyOID_K, DefeatKey)
			elseif conflictName == ""
				bool choice = ShowMessage("Key is in conflict with '" + conflictControl + "'. Do you still want to use this key?", true, "Yes", "No")
				if choice
					UnregisterForKey(DefeatKey)
					DefeatKey = keyCode
					RegisterForKey(DefeatKey)
					SetKeyMapOptionValue(DefeatKeyOID_K, DefeatKey)
				endif
			else
				bool choice = ShowMessage("Key is in conflict with '" + conflictControl + "' from the mod, '" + conflictName + "'. Do you still want to use this key?", true, "Yes", "No")
				if choice
					UnregisterForKey(DefeatKey)
					DefeatKey = keyCode
					RegisterForKey(DefeatKey)
					SetKeyMapOptionValue(DefeatKeyOID_K, DefeatKey)
				endif
			endif
		endif
	elseif option == EscapeKeyOID_K
		if ModEnabled && DefeatEnabled
			if keyCode == 1 || keyCode == 211
				UnregisterForKey(EscapeKey)
				EscapeKey = 0
				SetKeyMapOptionValue(EscapeKeyOID_K, 211)
			elseif conflictControl == ""
				UnregisterForKey(EscapeKey)
				EscapeKey = keyCode
				RegisterForKey(EscapeKey)
				SetKeyMapOptionValue(EscapeKeyOID_K, EscapeKey)
			elseif conflictName == ""
				bool choice = ShowMessage("Key is in conflict with '" + conflictControl + "'. Do you still want to use this key?", true, "Yes", "No")
				if choice
					UnregisterForKey(EscapeKey)
					EscapeKey = keyCode
					RegisterForKey(EscapeKey)
					SetKeyMapOptionValue(EscapeKeyOID_K, EscapeKey)
				endif
			else
				bool choice = ShowMessage("Key is in conflict with '" + conflictControl + "' from the mod, '" + conflictName + "'. Do you still want to use this key?", true, "Yes", "No")
				if choice
					UnregisterForKey(EscapeKey)
					EscapeKey = keyCode
					RegisterForKey(EscapeKey)
					SetKeyMapOptionValue(EscapeKeyOID_K, EscapeKey)
				endif
			endif
		endif
	endif

EndEvent
;FelixChialEnd
 
 
Event OnOptionDefault(int option)

;	if option == ModMenuKeyOID_K
;	    SetKeyMapOptionValue(ModMenuKeyOID_K, 73)		;O	;NYMRA changed to NUM9
;	elseif option == DeflationKeyOID_K
;	    SetKeyMapOptionValue(DeflationKeyOID_K, 73)		;P ;NYMRA changed to NUM9
	if option == DefeatKeyOID_K
	    SetKeyMapOptionValue(DefeatKeyOID_K, 37)		;K
	elseif option == EscapeKeyOID_K
	    SetKeyMapOptionValue(EscapeKeyOID_K, 57)		;Space
;	elseif option == DebugCalmOID_B		
;		DoResetQuest(DebugCalmOID_B, CalmQuest)
;	elseif option == DebugCaptiveOID_B		
;		DoResetQuest(DebugCaptureOID_B, CaptureQuest)
;	elseif option == DebugCaptureOID_B		
;		DoResetQuest(DebugCaptiveOID_B, CaptiveQuest)
;	elseif option == DebugAllegianceOID_B		
;		DoResetQuest(DebugAllegianceOID_B, AllegianceQuest)			
	endif

EndEvent

string Function GetCustomControl(int keyCode) ;WHAT IS THIS? #todo

    if (keyCode == DefeatKey)
        return "NAKED DEFEAT Surrender"
	elseif (keyCode == EscapeKey)
        return "NAKED DEFEAT Escape"		;NYMRA k
    else
        return ""
    endif
EndFunction

Function RegisterForLootHotkeys()	
		
;RegisterForKey(56)	  	;Left Alt 
;RegisterForKey(184)   	;Right Alt

RegisterForKey(2)		;1
RegisterForKey(3)		;2
RegisterForKey(4)		;3
RegisterForKey(5)		;4
RegisterForKey(6)		;5
RegisterForKey(7)		;6
RegisterForKey(8)		;7
RegisterForKey(9)		;8
RegisterForKey(10)		;9
RegisterForKey(11)		;0




EndFunction


Function UnRegisterForLootHotkeys()	
		
;UnRegisterForKey(56)	;Left Alt 
;UnRegisterForKey(184)   ;Right Alt

UnRegisterForKey(2)		;1
UnRegisterForKey(3)		;2
UnRegisterForKey(4)		;3
UnRegisterForKey(5)		;4
UnRegisterForKey(6)		;5
UnRegisterForKey(7)		;6
UnRegisterForKey(8)		;7
UnRegisterForKey(9)		;8
UnRegisterForKey(10)	;9
UnRegisterForKey(11)	;0


EndFunction


Event OnOptionHighlight(Int option)
	Int i

	;if (option == PlayerOID_S)
	;	SetInfoText("$nade_PlayerHL")
	;elseif (option == FollowerOID_S)
	;	SetInfoText("$nade_FollowerHL")
;	elseif (option == NuditySLAOID_B)
;		SetInfoText("$nade_NuditySLAHL")
;	elseif (option == NudityUnderwearOID_B)
;		SetInfoText("$nade_NudityUnderwearHL")
;	elseif (option == IndecencyRapeOID_S)
;		SetInfoText("$nade_IndecencyRapeHL")
	if (option == GuardPunishOID_B)
		SetInfoText("$nade_IndecencyHL")
	;elseif (option == IndecencyRobberyOID_S)
	;	SetInfoText("$nade_IndecencyRobberyHL")
	;elseif (option == IndecencyXBOID_M)
	;	SetInfoText("$nade_IndecencyXBoundHL")
	;elseif (option == IndecencyXCOID_M)
	;	SetInfoText("$nade_IndecencyXCollaredHL")
;	elseif (option == IndecencyGenderOID_M)
;		SetInfoText("$nade_IndecencyGenderHL")
	elseif (option == WhipMarksOID_B)
		SetInfoText("$nade_WhipMarksHL")
	elseif (option == MaleFollowerOID_B)
		SetInfoText("$nade_MaleFollowerHL")	
	elseif (option == FemaleFollowerOID_B)
		SetInfoText("$nade_FemaleFollowerHL")	
	elseif (option == DefeatGetUpOID_B)
		SetInfoText("$nade_DefeatGetUpHL")	
	
	elseif (option == DefeatDowntimeOID_S)
		SetInfoText("$nade_DefeatDowntimeHL")	

	elseif (option == DropItemOID_B)
		SetInfoText("$nade_DropItemHL")
	elseif (option == SlipperyOID_B)
		SetInfoText("$nade_SlipperyHL")	
	elseif (option == StripAttackOID_B)
		SetInfoText("$nade_StripAttackHL")	
	
	elseif (option == NoExtraOID_B)
		SetInfoText("$nade_NoExtraHL")	
		
	elseif (option == MoanOnHitOID_B)
		SetInfoText("$nade_MoanOnHitHL")			
	elseif (option == CriticalDefeatOID_S)
		SetInfoText("$nade_CriticalDefeatHL")
	elseif (option == NakedChanceOID_S)
		SetInfoText("$nade_NakedChanceHL")	
	elseif (option == MoanOnHitChanceOID_S)
		SetInfoText("$nade_MoanOnHitChanceHL")			
	;elseif (option == DefeatOID_B)
	;	SetInfoText("$nade_BleedoutCounterHL")
	elseif (option == DefeatKeyOID_K)
		SetInfoText("$nade_ActionKeyHL")
	elseif (option == EscapeKeyOID_K)
		SetInfoText("$nade_EscapeKeyHL")
	elseif (option == DefeatEscTimeOID_S)
		SetInfoText("$nade_EscTimeHL")
		
	elseif (option == DefeatSpeedMultOID_S)
		SetInfoText("$nade_DefeatSpeedMultHL")	
		
		
		
	elseif (option == BleedoutCounterOID_S)
		SetInfoText("$nade_BleedoutCounterHL")		
	elseif (option == DefeatChainOID_S)
		SetInfoText("$nade_ChainRapeHL")
	elseif (option == DefeatEscapeOID_S)
		SetInfoText("$nade_EscapeDifficultyHL")
	elseif (option == DefeatRobberyOID_S)
		SetInfoText("$nade_RobberyHL")
	elseif (option == SearchRadiusOID_S)
		SetInfoText("$nade_SearchRadiusHL")	
	elseif (option == SearchRadiusInteriorOID_S)
		SetInfoText("$nade_SearchRadiusInteriorHL")			
	elseif (option == StripOptions_OID_M)
		SetInfoText("$nade_StripOptionsHL")		
	elseif (option == WiggleOptions_OID_M)
		SetInfoText("$nade_WiggleOptionsHL")		
	elseif (option == WiggleOptionsSS_OID_M)
		SetInfoText("$nade_WiggleOptionsSSHL")
		
	elseif (option == DefeatFindSpot_OID_M)
		SetInfoText("$nade_DefeatFindSpotHL")		
	elseif (option == DefeatEscapeCrawl_OID_M)
		SetInfoText("$nade_DefeatEscapeCrawlHL")	
		
		
	elseif (option == DefeatIdleTimeOID_S)
		SetInfoText("$nade_DefeatIdleTimeHL")	
	elseif (option == DefeatPeeProbOID_S)
		SetInfoText("$nade_DefeatPeeProbHL")
	elseif (option == DefeatDDeProbOID_S)
		SetInfoText("$nade_DefeatDDeProbHL")

	elseif (option == PunishWhipChanceOID_S)
		SetInfoText("$nade_PunishWhipChanceHL")
	elseif (option == PunishSexChanceOID_S)
		SetInfoText("$nade_PunishSexChanceHL")
		
	elseif (option == DefeatDeathChanceOID_S)
		SetInfoText("$nade_DefeatDeathChanceHL")

	
	elseif (option == PunishBukkakeChanceOID_S)
		SetInfoText("$nade_PunishBukkakeChanceHL")	
		
		

	elseif (option == DefeatSlaveryOID_S)
		SetInfoText("$nade_SlaveryHL")
	elseif (option == DefeatSDweightOID_S)
		SetInfoText("$nade_DefeatSDweightHL")	
	elseif (option == DefeatCaptivityOID_S)
		SetInfoText("$nade_CaptivityHL")
		
	elseif (option == CooperativeSurrenderChanceOID_S)
		SetInfoText("$nade_CooperativeSurrenderChanceHL")		

		
	elseif (option == DefeatThrowOutOID_S)
		SetInfoText("$nade_ThrowOutHL")
	elseif (option == DefeatBreakArmorOID_B)
		SetInfoText("$nade_BreakArmorHL")
	elseif (option == NakedDrowningOID_B)
		SetInfoText("$nade_NakedDrowningHL")	
		
		
	elseif (option == NakedLootOID_B)
		SetInfoText("$nade_NakedLootHL")
	elseif (option == NakedLootHotkeysOID_B)
		SetInfoText("$nade_NakedLootHotkeysHL")	
	elseif (option == SSHandlingOID_B)
		SetInfoText("$nade_SSHandlingHL")			
	elseif (option == DeviousPiercingEffectsOID_B)
		SetInfoText("$nade_DeviousPiercingEffectsHL")			
			
		
		
	elseif (option == NakedTravelOID_B)
		SetInfoText("$nade_NakedTravellingHL")	

	elseif (option == RemoveDDsOID_B)
		SetInfoText("$nade_RemoveDDsHL")
	elseif (option == GodModeOID_B)
		SetInfoText("$nade_GodModeHL")
	elseif (option == HealthBoostOID_B)
		SetInfoText("$nade_HealthBoostHL")
	elseif (option == FindSpotTimeOID_S)
		SetInfoText("$nade_FindSpotTimeHL")				
	elseif (option == NoEssentialPlayerOID_B)
		SetInfoText("$nade_NoEssentialPlayerHL")	
	elseif (option == PlayExpressionsOID_B)
		SetInfoText("$nade_PlayExpressionsHL")
	elseif (option == NakedBlurOID_B)
		SetInfoText("$nade_NakedBlurHL")
	elseif (option == LagFixOID_B)
		SetInfoText("$nade_LagFixHL")


	elseif (option == PoisonDefeatChanceOID_S)
		SetInfoText("$nade_PoisonDefeatChanceHL")	
	elseif (option == Group3PchanceOID_S)
		SetInfoText("$nade_Group3PchanceHL")
	elseif (option == Group4PchanceOID_S)
		SetInfoText("$nade_Group4PchanceHL")
	elseif (option == DefeatForeplayChanceOID_S)
		SetInfoText("$nade_DefeatForeplayChanceHL")		
	elseif (option == Group5PchanceOID_S)
		SetInfoText("$nade_Group5PchanceHL")
	elseif (option == ScenarioChanceOID_S)
		SetInfoText("$nade_ScenarioChanceHL")		
	elseif (option == DebugPunishmentTypeOID_S)
		SetInfoText("$nade_DebugPunishmentTypeHL")		
	elseif (option == DefeatBreakClothingOID_S)
		SetInfoText("$nade_BreakClothingHL")
	elseif (option == DefeatBreakLightOID_S)
		SetInfoText("$nade_BreakLightHL")
	elseif (option == DefeatBreakHeavyOID_S)
		SetInfoText("$nade_BreakHeavyHL")
	elseif (option == DefeatWhipProbOID_S)
		SetInfoText("$nade_DefeatWhipProbHL")
	elseif (option == DefeatWhipTimeOID_S)
		SetInfoText("$nade_DefeatWhipTimeHL")
	elseif (option == FemalesAsMalesOID_S)
		SetInfoText("$nade_FemalesAsMalesHL")	
	elseif (option == RemoveDDChanceOID_S)
		SetInfoText("$nade_RemoveDDChanceHL")	

	elseif (option == DefeatRescueProbOID_S)
		SetInfoText("$nade_DefeatRescueProbHL")			
	elseif (option == HarmlessOID_B)
		SetInfoText("$nade_HarmlessHL")
	elseif (option == BondageHaircutOID_S)
		SetInfoText("$nade_BondageHaircutHL")
	elseif (option == ExposureChanceOID_S)
		SetInfoText("$nade_ExposureChanceHL")	
	elseif (option == PunishShortProbOID_S)
		SetInfoText("$nade_PunishShortProbHL")	
	elseif (option == DefeatArrestProbOID_S)
		SetInfoText("$nade_DefeatArrestProbHL")	
	elseif (option == DefeatShortProbOID_S)
		SetInfoText("$nade_DefeatShortProbHL")	
	elseif (option == HairRegrowthOID_S)
		SetInfoText("$nade_HairRegrowthTimeHL")
;	elseif (option == PosesDefeatOID_M)
;		SetInfoText("$nade_PosesDefeatHL")
	elseif (option == NymStrippingOID_B)
		SetInfoText("$nade_NymStrippingHL")			
	elseif (option == NymSpawningOID_B)
		SetInfoText("$nade_NymSpawningHL")	
	elseif (option == HeelsFixOID_B)
		SetInfoText("$nade_HeelsFixHL")		
		
		
		
	elseif (option == NymBetaOID_B)
		SetInfoText("$nade_NymBetaHL")		
	elseif (option == VRfixOID_B)
		SetInfoText("$nade_VRfixHL")
	elseif (option == SSEfixOID_B)
		SetInfoText("$nade_SSEfixHL")	
	elseif (option == NoCrawlingOID_B)
		SetInfoText("$nade_NoCrawlingHL")			
	elseif (option == RagdollOID_B)
		SetInfoText("$nade_RagdollHL")		
	elseif (option == DefeatRobberyGoldOID_B)
		SetInfoText("$nade_DefeatRobberyGoldHL")	
	elseif (option == ToggleDeleteDeviceOID_B)
		SetInfoText("$nade_ToggleDeleteDeviceHL")		
	elseif (option == DefeatSceneProtectorsOID_B)
		SetInfoText("$nade_DefeatSceneProtectorsHL")	
	elseif (option == MessagesOID_B)
		SetInfoText("$nade_MessagesHL")	
	elseif (option == ShowNarrativeMessagesOID_B)
	SetInfoText("$nade_ShowNarrativeMessagesHL")		
	elseif (option == ShowInfoMessagesOID_B)
	SetInfoText("$nade_ShowInfoMessagesHL")			
	elseif (option == AllowCreaturesOID_B)
		SetInfoText("$nade_AllowCreaturesHL")	
	elseif (option == DefeatSpotAndEscapeOID_B)
		SetInfoText("$nade_DefeatSpotAndEscapeHL")	
		
	elseif (option == FemalesAllowedOID_B)
		SetInfoText("$nade_FemalesAllowedHL")
	elseif (option == StageGoBackOID_B)
		SetInfoText("$nade_StageGoBackHL")	
	elseif (option == SkipSexOID_B)
		SetInfoText("$nade_SkipSexHL")	

	elseif (option == NakedCummingOID_B)
		SetInfoText("$nade_NakedCummingHL")	

	
	elseif (option == SimpleSurrenderOID_B)
		SetInfoText("$nade_SimpleSurrenderHL")		
	elseif (option == WeaponOutSurrenderOID_B)
		SetInfoText("$nade_WeaponOutSurrenderHL")
		
	;----- Save/Load Profile
	ElseIf (option == Load_Profile1_T) || (option == Load_Profile2_T) || (option == Load_Profile3_T) || (option == Load_Profile4_T) || (option == Load_Profile5_T)
		SetInfoText("$DescriptionLoadProfiles")
	ElseIf (option == Save_Profile1_T) || (option == Save_Profile2_T) || (option == Save_Profile3_T) || (option == Save_Profile4_T) || (option == Save_Profile5_T)
		SetInfoText("$DescriptionSaveProfiles")	
	;----- Save/Load Profile	
			
	ElseIf (option == Save_Outfit_01_T) || (option == Save_Outfit_02_T) || (option == Save_Outfit_03_T) || (option == Save_Outfit_04_T) || (option == Save_Outfit_05_T) || (option == Save_Outfit_06_T) || (option == Save_Outfit_07_T)|| (option == Save_Outfit_08_T) || (option == Save_Outfit_09_T) || (option == Save_Outfit_10_T)
		SetInfoText("$DescriptionSaveOutfits")
		
	ElseIf (option == Save_Weapon_01_T) || (option == Save_Weapon_02_T) || (option == Save_Weapon_03_T) || (option == Save_Weapon_04_T) || (option == Save_Weapon_05_T) || (option == Save_Weapon_06_T) || (option == Save_Weapon_07_T)|| (option == Save_Weapon_08_T) || (option == Save_Weapon_09_T) || (option == Save_Weapon_10_T)
		SetInfoText("$DescriptionSaveWeapons")	
	
	;civil rape sliders
		
	elseif (option == LoopTime_OID_S)
		SetInfoText("$nade_LoopTimeHL")
	elseif (option == Naked_Weight_OID_S)
		SetInfoText("$nade_Naked_WeightHL")
	elseif (option == Barefoot_Weight_OID_S)
		SetInfoText("$nade_Barefoot_WeightHL")
	elseif (option == Dirty_Weight_OID_S)
		SetInfoText("$nade_Dirty_WeightHL")	
	elseif (option == Sneaking_Weight_OID_S)
		SetInfoText("$nade_Sneaking_WeightHL")
	elseif (option == Running_Weight_OID_S)
		SetInfoText("$nade_Running_WeightHL")
	elseif (option == Sprinting_Weight_OID_S)
		SetInfoText("$nade_Sprinting_WeightHL")
	elseif (option == Unarmed_Weight_OID_S)
		SetInfoText("$nade_Unarmed_WeightHL")	
	elseif (option == FallingDamageTreshold_OID_S)
		SetInfoText("$nade_NakedFallingHL")		
	elseif (option == KeyDDWiggleFreeChance_OID_S)
		SetInfoText("$nade_KeyDDWiggleFreeChanceHL")	
	elseif (option == KeyDDWiggleFreeFailChance_OID_S)
		SetInfoText("$nade_KeyDDWiggleFreeFailChanceHL")
		

	elseif (option == Cum_Weight_OID_S)
		SetInfoText("$nade_Cum_WeightHL")
	
	;CREATURE TOGGLES ------------------------------------------
	
	
	elseif (option == AllowArgonKajitOID_B)
		SetInfoText("$nade_AllowArgonKajitHL")	
	elseif (option == AllowHumanoidBeastsOID_B)
		SetInfoText("$nade_AllowHumanoidBeastsHL")	
	elseif (option == AllowInsectsOID_B)
		SetInfoText("$nade_AllowInsectsHL")	
	elseif (option == AllowSkeeversOID_B)
		SetInfoText("$nade_AllowSkeeversHL")
	elseif (option == AllowSpidersOID_B)
		SetInfoText("$nade_AllowSpidersHL")	
	elseif (option == AllowSabreCatsOID_B)
		SetInfoText("$nade_AllowSabreCatsHL")		
	
	elseif (option == AllowBearsOID_B)
		SetInfoText("$nade_AllowBearsHL")	
	
	elseif (option == AllowCaninesOID_B)
		SetInfoText("$nade_AllowCaninesHL")
	
	elseif (option == AllowMammothsOID_B)
		SetInfoText("$nade_AllowMammothsHL")	
	
	elseif (option == AllowDragonsOID_B)
		SetInfoText("$nade_AllowDragonsHL")
	
;	elseif (option == AllowNetchesOID_B)
;		SetInfoText("$nade_AllowNetchesHL")	
	
	elseif (option == AllowDwarvenOID_B)
		SetInfoText("$nade_AllowDwarvenHL")
	
	elseif (option == AllowUndeadOID_B)
		SetInfoText("$nade_AllowUndeadHL")	
	
	elseif (option == AllowRieklingsOID_B)
		SetInfoText("$nade_AllowRieklingsHL")
	
	elseif (option == AllowFalmersOID_B)
		SetInfoText("$nade_AllowFalmersHL")	
	
	elseif (option == AllowSpriggansOID_B)
		SetInfoText("$nade_AllowSpriggansHL")
	
	elseif (option == AllowElementalsFemaleOID_B)
		SetInfoText("$nade_AllowElementalsFemaleHL")	
	
	elseif (option == AllowElementalsMaleOID_B)
		SetInfoText("$nade_AllowElementalsMaleHL")

	elseif (option == AllowTentacleStuffOID_B)
		SetInfoText("$nade_AllowTentacleStuffHL")

	elseif (option == AllowChickenOID_B)
		SetInfoText("$nade_AllowChickenHL")

	elseif (option == AllowHorsesOID_B)
		SetInfoText("$nade_AllowHorsesHL")

	elseif (option == AllowCowsOID_B)
		SetInfoText("$nade_AllowCowsHL")

	elseif (option == AllowGoatsOID_B)
		SetInfoText("$nade_AllowGoatsHL")		
		
	elseif (option == AllowDeersOID_B)
		SetInfoText("$nade_AllowDeersHL")

	elseif (option == AllowFoxesOID_B)
		SetInfoText("$nade_AllowFoxesHL")		

	elseif (option == AllowRabbitsOID_B)
		SetInfoText("$nade_AllowRabbitsHL")

	elseif (option == AllowHorkersOID_B)
		SetInfoText("$nade_AllowHorkersHL")
;-----------------------------------------
	
	endif

EndEvent

;/
Int Function ChangeArousal(Int delta_exposure = 0)
	Int exposure = sla.GetActorExposure(PlayerRef)
	if !(sla.IsActorArousalLocked(PlayerRef) || sla.IsActorArousalBlocked(PlayerRef))
		exposure += delta_exposure
			if exposure > 100
				exposure = 100
			endif
		sla.SetActorExposure(PlayerRef, exposure)
	endif
	return exposure
EndFunction

/;

String[] Function GetPackNames()
	String[] PackNames = new String[1]
	PackNames[0] = "nade_Defeat"
	return PackNames
EndFunction



Function GetArraysFromJson(String[] PackNames)
	PosesDefeat =    JsonUtil.StringListToArray("../Naked Dungeons/PoserData/Favorites", PackNames[0]);
;	PosesShowPussy = JsonUtil.StringListToArray("../Naked Dungeons/PoserData/Favorites", PackNames[1]);

EndFunction

Function GetJsonFromArrays(String[] PackNames)
	SyncJsonPack(0, PosesDefeat, PackNames)
;	SyncJsonPack(1, PosesShowPussy, PackNames)
;	SyncJsonPack(2, PosesShowAss, PackNames)

EndFunction	

Function SyncJsonPack(Int pack_index, String[] pack_array, String[] PackNames)
	JsonUtil.StringListClear("../Naked Dungeons/PoserData/Favorites", PackNames[pack_index])
	Int i = 0
	while i < pack_array.Length
		JsonUtil.StringListAdd("../Naked Dungeons/PoserData/Favorites", PackNames[pack_index], pack_array[i])
		i += 1
	endwhile
EndFunction	
	
;Event OnAnimationEvent(ObjectReference akSource, string asEventName)
;	if (akSource == PlayerRef) && IsPlayerNaked() && ((ContaminationTime > 0.0) || SexLab.CountCum(PlayerRef)) ;&& (asEventName == "SoundPlay.FSTSwimSwim")
;		SexLab.ClearCum(PlayerRef)
;		if Yeast && (ContaminationTime > 0.0) && (!Inflation || (BellyRatio == 0.0))
;			ContaminationTime = 0.0
;		endif
;		Debug.Notification("You are clean again!")
;	endif
;EndEvent


;/ NOT IN USE
Function SetPlayerPosing(Bool value = true)				;NYMRA what is this and causes it problems? (breakt anim)
	if IsPlayerPosing != value
		if value
			PlayerIsNPC = (PlayerRef.GetAnimationVariableInt("IsNPC") == 1)
			PlayerRef.SetAnimationVariableInt("IsNPC", 0)
			if LastVehicle
				PlayerRef.SetVehicle(LastVehicle)
			endif
		elseif PlayerIsNPC
			PlayerRef.SetAnimationVariableInt("IsNPC", 1)
			if LastVehicle
				PlayerRef.SetVehicle(PlayerRef)
				LastVehicle.Delete()
				LastVehicle = None
			endif
		endif
		IsPlayerPosing = value	
		PlayerRef.SetAnimationVariableBool("bHumanoidFootIKDisable", value)
	endif
EndFunction
/;

;/
Function ForceResetPose()									;NYMRA what is this and causes it problems? (breakt anim)
	IsPlayerPosing = false	
	LastAnimEventName = "IdleForceDefaultState"
	PlayerRef.SetVehicle(PlayerRef)
	if LastVehicle
		LastVehicle.Delete()
		LastVehicle = None
	endif
	PlayerRef.SetAnimationVariableBool("bHumanoidFootIKDisable", false)
	if PlayerIsNPC
		PlayerRef.SetAnimationVariableInt("IsNPC", 1)
	endif
	Debug.SendAnimationEvent(PlayerRef, LastAnimEventName)
EndFunction
/;

;/NOT IN USE
Function ShowPose(String AnimEventName = "", Bool CreateVehicle = false)		;I THINK I NEED TO LOOK AT THIS CLOSER!!!!!!!!!!!!!! XXX #########
	Bool b = (AnimEventName != "")
	if b
		b = (AnimEventName != "IdleForceDefaultName")
	else
		AnimEventName = "IdleForceDefaultState"
	endif
	if AnimEventName != LastAnimEventName
		if b && CreateVehicle && !LastVehicle
			LastVehicle = PlayerRef.PlaceAtMe(PoseVehicleType, 1, true, false)
			LastVehicle.SetActorOwner(PlayerRef.GetActorBase())
			LastVehicle.SetAngle(0.0, 0.0, LastVehicle.GetAngleZ())
		endif
		SetPlayerPosing(b)
		LastAnimEventName = AnimEventName
		Debug.SendAnimationEvent(PlayerRef, AnimEventName)
		if ShowDebugMessages
			Debug.Notification("Anim Event Name = " + AnimEventName)
		endif
	endif
EndFunction
/;

Static Property PoseVehicleType Auto
;String LastAnimEventName = "IdleForceDefaultState"
;ObjectReference LastVehicle = None
;String[] LastPoseArray
;Float LastPoseInterval
Bool Property IsPlayerPosing Auto Conditional
;Bool PlayerIsNPC = false


;/
Function ShowNPCPose(String AnimEventName = "", Bool CreateVehicle = false, actor akActor)		;I THINK I NEED TO LOOK AT THIS CLOSER!!!!!!!!!!!!!! XXX #########
	Bool b = (AnimEventName != "")
	if b
		b = (AnimEventName != "IdleForceDefaultName")
	else
		AnimEventName = "IdleForceDefaultState"
	endif
	if AnimEventName != LastAnimEventName
		if b && CreateVehicle && !LastVehicle
			LastVehicle = akActor.PlaceAtMe(PoseVehicleType, 1, true, false)
			LastVehicle.SetActorOwner(akActor.GetActorBase())
			LastVehicle.SetAngle(0.0, 0.0, LastVehicle.GetAngleZ())
		endif
;		SetPlayerPosing(b)
		LastAnimEventName = AnimEventName
		Debug.SendAnimationEvent(akActor, AnimEventName)
		;if ShowDebugMessages
			;Debug.Notification("Anim Event Name = " + AnimEventName)
		;endif
	endif
EndFunction
/;

;/ NOT IN USE 
Function ShowRandomPose(String[] PoseArray)										;NYMRA what is this and causes it problems? (breakt anim)
	ShowPose(PoseArray[Utility.RandomInt(0, PoseArray.Length - 1)])
EndFunction

/;
;bool ValidateCalmquest = false

;bool ResetPhoneme = false
;bool StartAllegianceQuest = false

Function OnUpdate()		;#update		#OnUpdate
	Debug.Trace("NAKED DEFEAT configquest: OnUpdate()")
	
	;TKD DOGDE 
	if Dodged == 2 	;perfect dodge
	Dodged = 1
	RegisterForSingleUpdate(1)
	elseif Dodged == 1	;late dodge
	Dodged = 0
	endif 
	
	;NOT WORKING TOO
;if StartDeviousTrapStarted
;	Input.TapKey(1) ;ESC Key
	;Utility.Wait(5.0)
	;Input.TapKey(15) ;ESC Key
	;UI.Invoke("ContainerMenu", "_root.Menu_mc.onExitMenuRectClick")
;endif	
	
	;if IsNymrasGame()	
	;SpawnNakedEncounters(utility.randomInt(1,5), false)
	;endif
	;Function Restartds NAked Encounters
	
	;/
	
	OLD
	if RestartCalmQuest
	Debug.Trace("NAKED DEFEAT configquest: OnUpdate(Restart CalmQuest)")
	RestartCalmQuest = false	
		while CalmQuest.GetStage() < 1000
		CalmQuest.SetStage(1000)
		Debug.Trace("NAKED DEFEAT configquest: Restart CalmQuest - this happened")
		Utility.Wait(1.0)
		endwhile
				
		if (CalmQuest.GetStage() == 1000) || (CalmQuest.GetStage() == 0)
		Debug.Trace("NAKED DEFEAT configquest: Restart CalmQuest (HERE)")
		CalmQuest.Start()
		else
		Debug.Trace("NAKED DEFEAT #ERROR 6765: CalmQuest already started")
		endif
		
		
;	elseif ResetPhoneme
;	Debug.Trace("NAKED DEFEAT configquest: OnUpdate(ResetPhoneme)")
;	ResetPhoneme = false
;	;MfgConsoleFunc.SetPhonemeModifier(PlayerRef)		
;	MfgConsoleFunc.SetPhoneme(PlayerRef, 1, 0) 	;reset BIG AAH to 0
	elseif StartAllegianceQuest
	Debug.Trace("NAKED DEFEAT configquest: OnUpdate(StartAllegianceQuest)")
	StartAllegianceQuest = false	
		
		if (AllegianceQuest.GetStage() == 1000) || (AllegianceQuest.GetStage() == 0)
		Debug.Trace("NAKED DEFEAT configquest: OnUpdate(StartAllegianceQuest)")
		AllegianceQuest.Start()
		else
		Debug.Trace("NAKED DEFEAT #ERROR 6780: AllegianceQuest already started")
		endif
		
	endif

	/;
	
EndFunction	

;/
Bool Function UpdateRandomPose()
	if IsPlayerPosing && LastPoseArray && LastPoseArray.Length
		ShowRandomPose(LastPoseArray)
		return true
	else
		return false
	endif
EndFunction
/;

;Event OnControlDown(string control)							;NYMRA killed this, looks suspicious (Break anim)
;	if IsPlayerPosing && !LastVehicle
;		if control == "Jump"
;			SetPlayerPosing(false)
;;			PlayerRef.SetVehicle(PlayerRef)
;		else
;			ForceResetPose()
;		endif
;		ApplyPee(false)
;		ApplySquirt(false)
;	endif	
;EndEvent

String Function GetPoseName(String pack_name, Int pose_index)
	return JsonUtil.StringListGet("../PoserHotKeys/PoserData/Favorites.json", pack_name, pose_index)
EndFunction

		
;Event OnCrosshairRefChange(ObjectReference ref)				
;crosshairRef = ref as Actor
;Debug.Trace("NAKED DEFEAT configquest: OnCrosshairRefChange()")
;EndEvent


Function SendWashPlayerEvent()						;#bathing event

if ModBIS

Debug.trace ("NAKED DEFEAT confiquest: SendWashPlayerEvent(Player ModBIS)")	
    Int WashActor = ModEvent.Create("BiS_WashActor")
    if (WashActor)	
   ;   ModEvent.PushForm(WashActor, (cfgqst.PlayerRef as Form))		;akActor
		ModEvent.PushForm(WashActor, (PlayerRef))	
		ModEvent.PushBool(WashActor, false)							;animation play
		ModEvent.PushBool(WashActor, true)							;full clean (true) or 20% (false)
		ModEvent.PushBool(WashActor, false)							;soap
		ModEvent.Send(WashActor)
    endIf
	
elseif ModBIS_R
	
	Debug.trace ("NAKED DEFEAT confiquest: SendWashPlayerEvent(Player ModBIS_R)")	
    Int WashActor = ModEvent.Create("BiS_WashActor")
    if (WashActor)	
   ;   ModEvent.PushForm(WashActor, (cfgqst.PlayerRef as Form))		;akActor
		ModEvent.PushForm(WashActor, (PlayerRef))	
		ModEvent.PushForm(WashActor, none)							;wash Form (soap or what?)
		ModEvent.PushBool(WashActor, false)							;abDoShower
		ModEvent.PushBool(WashActor, false)							;abDoPlayerTeammates
		ModEvent.PushBool(WashActor, false)							;abDoAnimate
		ModEvent.PushBool(WashActor, true)							;abFullClean
		ModEvent.PushBool(WashActor, false)							;abDoSoap
		ModEvent.Send(WashActor)
    endIf
	
endif 
	
EndFunction

;OnBiS_WashActor(Form akDirtyActor, Form akWashProp, Bool abDoShower, bool abDoPlayerTeammates = false, Bool abDoAnimate = false, Bool abFullClean = false, Bool abDoSoap = false)



Function SendModEvent_BiS_WashActor(actor akactor)						;#bathing3

if ModBIS
Debug.trace ("NAKED DEFEAT confiquest: SendWashPlayerEvent(Follower - ModBIS)")	
    Int WashActor = ModEvent.Create("BiS_WashActor")
    if (WashActor)	
   ;   ModEvent.PushForm(WashActor, (cfgqst.PlayerRef as Form))		;akActor
		ModEvent.PushForm(WashActor, (akactor))	
		ModEvent.PushBool(WashActor, false)							;animation play
		ModEvent.PushBool(WashActor, true)							;full clean (true) or 20% (false)
		ModEvent.PushBool(WashActor, false)							;soap
		ModEvent.Send(WashActor)
    endIf
	
elseif ModBIS_R	
		
	Debug.trace ("NAKED DEFEAT confiquest: SendWashPlayerEvent(Follower - ModBIS_R)")	
    Int WashActor = ModEvent.Create("BiS_WashActor")
    if (WashActor)	
   ;   ModEvent.PushForm(WashActor, (cfgqst.PlayerRef as Form))		;akActor
		ModEvent.PushForm(WashActor, (akactor))	
		ModEvent.PushForm(WashActor, none)							;wash Form (soap or what?)
		ModEvent.PushBool(WashActor, false)							;abDoShower
		ModEvent.PushBool(WashActor, false)							;abDoPlayerTeammates
		ModEvent.PushBool(WashActor, false)							;abDoAnimate
		ModEvent.PushBool(WashActor, true)							;abFullClean
		ModEvent.PushBool(WashActor, false)							;abDoSoap
		ModEvent.Send(WashActor)
    endIf
	
endif 
EndFunction



bool IsBathing = false

Function SendNakedDefeatExternal()

	Form Actor0 = game.GetFormFromFile(0x000B1F96, "Skyrim.esm") as Form
	Form Actor1 = game.GetFormFromFile(0x000B1F97, "Skyrim.esm") as Form
	Form Actor2 = game.GetFormFromFile(0x000B1F98, "Skyrim.esm") as Form
	Form Actor3 = game.GetFormFromFile(0x000B1F99, "Skyrim.esm") as Form
	Form Actor4 = none
	Form Actor5 = none
	
    Int Whatever = ModEvent.Create("StartNakedDefeatExternal")
    if (Whatever)	
   ;   ModEvent.PushForm(WashActor, (cfgqst.PlayerRef as Form))		;akActor
		ModEvent.PushForm(Whatever, Actor0)					;Enemy0
		ModEvent.PushBool(Whatever, Actor1)							;Enemy1
		ModEvent.PushBool(Whatever, Actor2)							;Enemy2
		ModEvent.PushBool(Whatever, Actor3)							;Enemy3
		ModEvent.PushBool(Whatever, Actor4)							;Enemy4
		ModEvent.PushBool(Whatever, Actor5)							;Enemy5
		ModEvent.Send(Whatever)
    endIf

EndFunction



;/
[0] Wipe Head (Finish)
[1] Wipe Body (Equip Body?)
[2] Wipe Belly and Wipe Thighs (Equip Boots?)
[3] Forearmes (equip Gauntlets?
[4] Wipe Upper arms
[5] wipe hands
[6] Rub Pussy (maybe at the end of equip sequence?
[7] Wash Pussy
[8] Wash Belly and Pussy
/;

bool AnimatedEquip = true

Function IdleEquipHead()	
if AnimatedEquip
PlayerRef.PlayIdle(IdlesFixHair[1])		;PlayerRef.PlayIdle(IdlesFixHair[1])	
endif	
EndFunction

Function IdleEquipBody()
if AnimatedEquip
PlayerRef.PlayIdle(IdlesBathingStanding[1])		;Wipe Body (Equip Body?)	
endif	
EndFunction

Function IdleEquipFeet()
if AnimatedEquip
PlayerRef.PlayIdle(IdlesBathingStanding[2])		;[2] Wipe Belly and Wipe Thighs (Equip Boots?)	
endif	
EndFunction

Function IdleEquipHands()
if AnimatedEquip
PlayerRef.PlayIdle(IdlesBathingStanding[3])		;[3] Forearmes (equip Gauntlets?	
endif	
EndFunction

Function IdleEquipFinish()
if AnimatedEquip
PlayerRef.PlayIdle(IdlesBathingStanding[6])		;[6] Rub Pussy (maybe at the end of equip sequence?	
endif	
EndFunction


Function BathingRemoveBlood()
Debug.trace ("NAKED DEFEAT confiquest: BathingRemoveBlood()")	
			PlayerRef.AddItem(ArmorEmpty[0], 1, true)			;HEAD		
			PlayerRef.EquipItem(ArmorEmpty[0], false, true)
			PlayerRef.RemoveItem(ArmorEmpty[0], 1, true, None)
			
			PlayerRef.AddItem(ArmorEmpty[1], 1, true)			;BODY	
			PlayerRef.EquipItem(ArmorEmpty[1], false, true)
			PlayerRef.RemoveItem(ArmorEmpty[1], 1, true, None)
			
			PlayerRef.AddItem(ArmorEmpty[2], 1, true)			;HANDS	
			PlayerRef.EquipItem(ArmorEmpty[2], false, true)
			PlayerRef.RemoveItem(ArmorEmpty[2], 1, true, None)
			
			PlayerRef.AddItem(ArmorEmpty[3], 1, true)			;FEET 
			PlayerRef.EquipItem(ArmorEmpty[3], false, true)
			PlayerRef.RemoveItem(ArmorEmpty[3], 1, true, None)
EndFunction


bool AbortBathing = false

Function NakedBathing()	;#bath1	
Debug.trace ("NAKED DEFEAT confiquest: NakedBathing()")		
		;NEEDS COMBAT CHECK or ALLEGIANCE QUEST OR WHATNOT
		
		if IsNymrasGame() && !IsDefeatRunning() && (DefeatStatePlayer != ("Bathing"))
		Debug.MessageBox("BATHING #ERROR 6888")
		endif
		
		if !IsDefeatRunning()
		InfoMessage("Naked Bathing Started - Abort with Shift + K")
		endif 
		
		IsBathing = true
		float DirtinessValue = GetDirtiness()	
		float minA
		float maxA
		float minB
		float maxB

		;/
		;TO DO:
		
		- add expressions
		- add tongue?
		- add wet water effect (drops?)
		- detect water?
		- add the bowed down bathing anim. In general add MORE bathing anims
		- add autosurrender when in combat
		
		
		
		/;
	;	if ModBiS
	;	GlobalVariable Dirtiness = (Game.GetFormFromFile(0x00000DA8, "Bathing in Skyrim - Main.esp") As GlobalVariable)
	;	DirtinessValue = (Dirtiness.GetValue()*100)
	;	endif
		
		if DirtinessValue < 30
		minA = 1.0
		maxA = 1.0
		minB = 1.0
		maxB = 2.0
		elseif DirtinessValue < 60
		minA = 1.0
		maxA = 2.0
		minB = 1.0
		maxB = 3.0
		elseif DirtinessValue < 90
		minA = 2.0
		maxA = 3.0
		minB = 2.0
		maxB = 4.0
		else
		minA = 3.0
		maxA = 4.0
		minB = 3.0
		maxB = 4.0
		endif
		
	;	Bool WashFollower01
		
	;	if IsNymrasGame()
	;	WashFollower01 = true
	;	endif 

		if ModBIS
			if !AbortBathing && !PartyInCombat()
			SendWashPlayerEvent()
				if folqst.Actor_Follower01
				SendModEvent_BiS_WashActor(folqst.Actor_Follower01)
				endif 
				if folqst.Actor_Follower02
				SendModEvent_BiS_WashActor(folqst.Actor_Follower02)
				endif 
			endif
		endif 
		
		if !AbortBathing && !PartyInCombat()
		PlayerRef.PlayIdle(IdlesBathingStanding[8])
			if folqst.Actor_Follower01
			folqst.Actor_Follower01.UnequipAll()
			folqst.Actor_Follower01.PlayIdle(IdlesBathingStanding[7])
			endif 
			if folqst.Actor_Follower02
			folqst.Actor_Follower02.UnequipAll()
			folqst.Actor_Follower02.PlayIdle(IdlesBathingStanding[6])
			endif 
		endif 	

		if DefeatQuestRunning || CivilRapeRunning
		RealWaiting(2.0)
		
		;FADE TO BLACK - STARTING (OFF)
		FadeToBlack(false)
		endif

		
		if !AbortBathing && !PartyInCombat()
		RealWaiting(Utility.RandomFloat(minB, maxB))
		PlayerRef.DamageAV("Stamina", 200)
		endif
		
		if !AbortBathing && !PartyInCombat()
		PlayerRef.PlayIdle(IdlesBathingStanding[1])
			if folqst.Actor_Follower01
			folqst.Actor_Follower01.PlayIdle(IdlesBathingStanding[2])
			endif 
			if folqst.Actor_Follower02
			folqst.Actor_Follower02.PlayIdle(IdlesBathingStanding[3])
			endif 
		endif

		PlayerRef.DamageAV("Stamina", 300)
		RealWaiting(Utility.RandomFloat(minB, maxB))
		PlayerRef.DamageAV("Stamina", 500)
		
		if !AbortBathing && !PartyInCombat()
		PlayerRef.PlayIdle(IdlesBathingStanding[2])
			if folqst.Actor_Follower01
			folqst.Actor_Follower01.PlayIdle(IdlesBathingStanding[3])
			endif 
			if folqst.Actor_Follower02
			folqst.Actor_Follower02.PlayIdle(IdlesBathingStanding[2])
			endif 
		RealWaiting(Utility.RandomFloat(minB, maxB))
		endif
		
		if !AbortBathing && !PartyInCombat()
		PlayerRef.PlayIdle(IdlesBathingStanding[3])
			if folqst.Actor_Follower01
			folqst.Actor_Follower01.PlayIdle(IdlesBathingStanding[1])
			endif 
			if folqst.Actor_Follower02
			folqst.Actor_Follower02.PlayIdle(IdlesBathingStanding[4])
			endif 
		RealWaiting(Utility.RandomFloat(minB, maxB))
		endif
		
		if !AbortBathing && !PartyInCombat()
		PlayerRef.PlayIdle(IdlesFixHair[1])	
		RealWaiting(Utility.RandomFloat(minA, maxA))
		endif
		
		if !AbortBathing && !PartyInCombat()	
		;remove Blood and other	
		;	Debug.trace("Naked Defeat calmquest start empty armor")		
		BathingRemoveBlood()
		endif
		
	;	Debug.trace("Naked Defeat calmquest finish empty armor")			
		if !AbortBathing && !PartyInCombat()
		PlayerRef.PlayIdle(IdlesBathingStanding[4])
			if folqst.Actor_Follower01
			folqst.Actor_Follower01.PlayIdle(IdlesBathingStanding[6])
			endif 
			if folqst.Actor_Follower02
			folqst.Actor_Follower02.PlayIdle(IdlesBathingStanding[5])
			endif 
		RealWaiting(Utility.RandomFloat(minA, maxA))
		endif
		
		if !AbortBathing && !PartyInCombat()
		PlayerRef.PlayIdle(IdlesBathingStanding[5])
			if folqst.Actor_Follower01
			folqst.Actor_Follower01.PlayIdle(IdlesBathingStanding[2])
			endif 
			if folqst.Actor_Follower02
			folqst.Actor_Follower02.PlayIdle(IdlesBathingStanding[3])
			endif 
		RealWaiting(Utility.RandomFloat(minA, maxA))
		endif
		
		if DefeatQuestRunning || CivilRapeRunning
		Utility.Wait(3.0)	
		endif
		
		if !AbortBathing && !PartyInCombat()
		PlayerRef.PlayIdle(IdlesBathingStanding[6])
			if folqst.Actor_Follower01
			folqst.Actor_Follower01.PlayIdle(IdlesBathingStanding[7])
			endif 
			if folqst.Actor_Follower02
			folqst.Actor_Follower02.PlayIdle(IdlesBathingStanding[5])
			endif 
		RealWaiting(Utility.RandomFloat(minB, maxB))
		endif
		
		if !AbortBathing && !PartyInCombat()		
		PlayerRef.PlayIdle(IdlesBathingStanding[7])
			if folqst.Actor_Follower01
			folqst.Actor_Follower01.PlayIdle(IdlesBathingStanding[6])
			endif 
			if folqst.Actor_Follower02
			folqst.Actor_Follower02.PlayIdle(IdlesBathingStanding[4])
			endif 
		
		if ModBIS_R
			if !AbortBathing && !PartyInCombat()
			SendWashPlayerEvent()
				if folqst.Actor_Follower01
				SendModEvent_BiS_WashActor(folqst.Actor_Follower01)
				endif 
				if folqst.Actor_Follower02
				SendModEvent_BiS_WashActor(folqst.Actor_Follower02)
				endif 
			endif
		endif 
		
		RealWaiting(Utility.RandomFloat(minB, maxB))
		int i = 15
			while (BathingEventReceived == false) && (i > 0)
			Utility.Wait(0.5)
			i -= 1
			endwhile
			Utility.Wait(3.0)
		BathingEventReceived = false	
		endif
		;FADE TO BLACK - ENDING (ON)		;OnPeeFinished() toggles it off again
		
		if DefeatQuestRunning || CivilRapeRunning
		FadeToBlack(true)
		Utility.Wait(2.0)	
		endif	

		if !AbortBathing && !PartyInCombat()
		PlayerRef.PlayIdle(IdlesBathingStanding[0])
		RealWaiting(Utility.RandomFloat(2, 3))
		endif
		
		;if !AbortBathing && !PartyInCombat()
		PlayerRef.PlayIdle(IdlesFixHair[0])		;RESET IDLE
		PlayerRef.RestoreAV("Stamina", 10000)
		
			if folqst.Actor_Follower01
			folqst.Actor_Follower01.PlayIdle(IdlesFixHair[0])
			endif 
			if folqst.Actor_Follower02
			folqst.Actor_Follower02.PlayIdle(IdlesFixHair[0])
			endif 

		;endif
		
		if PartyInCombat()
		ScreenMessage("You are attacked, prepare your defense!")
		elseif AbortBathing
		ScreenMessage("You stop washing yourself.")
		endif
		
		AbortBathing = false
		IsBathing = false
		
		if !IsDefeatRunning()
		Immobilize(false)
		endif
		
		;if DefeatStatePlayer == ("Bathing")
		if !IsDefeatRunning()
		DefeatStatePlayer = ("Free")	;change to "free" later?
		endif 
		;endif
		
	;	if WashFollower01
		folqst.FollowerStripUpdate()
	;	endif 
		;WashFollower01 = false
		
EndFunction				

				
bool HasHelmet = false
;bool Aborted = false
bool IsFastTravelRitualStarted = false

;/

SOUL GEM LOADING #soulgem

1P: 
"nazonootoko Soulgem Showing" 
"nazonootoko Soulgem Laying"

"Billyy EnchantingWorkBench Fuck"


/;


;/
bool Function IsAborted()
 if Aborted 
 return true
 else
 return false
 endif
EndFunction
/;

;https://ck.uesp.net/wiki/Input_Script#DXScanCodes 
;KEYCODES
; 56  Left Alt
; 29  Left Control
; 42  Left Shift

Bool ItIsNymrasGame = false


;NYMRAS WORLD IDEAS

;Higher Exposure in JARL Longhouses and Guard Barracks. Lower in Inns

Bool Function Nym()

	if IsNymrasGame()
	return TRUE
	else
	return false
	endif 
EndFunction

Bool Function IsNymrasGame()		;#NAME #BETA #SARANA #IsNymrasGame()
	
	if ItIsNymrasGame
	;	if !NymrasWorld
	;	NymrasWorld = true 
	;	endif 
	return true
	elseif (PlayerRef.GetBaseObject().GetName() == "Sarana") ||  (PlayerRef.GetBaseObject().GetName() == "Zhonya") || (PlayerRef.GetBaseObject().GetName() == "Nellgard")
	;Debug.trace ("NAKED DEFEAT confiquest (#NYMRA): PERSONAL SETTING OF NYMRA")
		if !NymrasWorld
		NymrasWorld = true 
		endif 
	ItIsNymrasGame = true
	return true
	else
	return false
	endif
	
EndFunction

int PressedTimes = 0


;FREEZE PROBLEM 

;mfg reset via ConsoleUtil, or using ResetExpressionOverrides() or ClearExpressionOverride()

	
Event OnKeyDown(Int KeyCode)				;#keydown	
				
	;<<<<<<< ESTRUS TRAP EVASION >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>	;#evade
	if LootTrapIsTriggered > 0  
	Debug.trace ("NAKED DEFEAT confiquest: OnKeyDown(EvadeTrap)")
	KeyEvadeDeviousTrap(KeyCode)
	
	elseif SexScene && IsNymrasGame() && ((KeyCode == 57) || (KeyCode == 207) || Input.IsKeyPressed(45))
	Debug.trace ("NAKED DEFEAT confiquest: OnKeyDown(SexScene)")	
		if (KeyCode == 57) 
			if Input.IsKeyPressed(42) 	;SPACE + LShift (go Back)
			ScreenMessage("GoBack Stage")
			Leniency += 1			

			else	;SPACE (advance)
			ScreenMessage("Advancing Stage")
			Leniency -= 1
			endif
		elseif (KeyCode == 207) 	;End
		ScreenMessage("End Scene")
		Leniency -= 10		
		elseif Input.IsKeyPressed(45)
		ScreenMessage("Changed Scene")		
		Leniency += 2
		endif
	
	;NOT IN MENU, NOT CRAFTING, NOT RIDING
	elseif !Utility.IsInMenuMode() && !UI.IsMenuOpen("Crafting Menu") && !PlayerRef.IsOnMount() ;&& !SexLab.IsRunning	;changed 03-01-2024 --- Sexlab running is not imporant here
	
		bool AltPressed = false
					
		; >>>> NUMBER (pressed) >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		if ((KeyCode == 2) || (KeyCode == 3) || (KeyCode == 4) || (KeyCode == 5) || (KeyCode == 6) || (KeyCode == 7) || (KeyCode == 8) || (KeyCode == 9) || (KeyCode == 10) || (KeyCode == 11))
		Debug.trace ("NAKED DEFEAT confiquest: Keypress NUMBER (pressed)")	
			
			; --- OUTFIT UTILITY --- SHIFT + .... -- ;
			if !IsDefeatRunning()
				if Input.IsKeyPressed(42)
						
					;FISTS OUT 
					if KeyCode == 2 ;1 	
					UnequipWeapons()
						if Nym()
						AddItemFromFile("Fists Divine",false)	
						endif	
									
					PlayerRef.DrawWeapon()

					;EquipRandomWeapon()
					;RANDOM OUTFIT
					elseif KeyCode == 3 && !PartyInCombat()	;2
					ScreenMessage("You dress with what you have [Random Outfit equipped]")
					EquipRandomOutfit()
					
						if folqst.Actor_Follower01 || folqst.Actor_Follower02
						ScreenMessage("Your followers do the same.")
						FollowersRedress()
						folqst.FollowerStripUpdate()
						endif 
					
					;STRIP ALL
					elseif KeyCode == 4 ;3
					ScreenMessage("You strip completely naked [UnequipAll]")
					NymTrace("Immobilize(true) for Stripping Naked")
					Immobilize(true)
					IdleEquipBody()
					Utility.Wait(1.5)
					PlayerRef.UnequipAll()
					Utility.Wait(1.5)
					IdleEquipFinish()
					Utility.Wait(1)
					Immobilize(false)
					endif
				
				; --- EQUIP OUTFIT --- ALT + 1,2,3,4,5,6,7,8,9,0 --- ;
				elseif Input.IsKeyPressed(56) || (KeyCode == 184)
					String OutfitNum 
					Int TempKeyCode = KeyCode
					Int TempInt
					if KeyCode == 11
					OutfitNum = "10"
					else
					TempKeyCode -= 1
					OutfitNum = "0"+TempKeyCode
					endif
					Load_JSON_Outfit(OutfitNum, "All", true)

				; --- EQUIP WEAPON --- 1,2,3,4,5,6,7,8,9,0 --- ;
				else		
					String WeaponNum 
					Int TempKeyCode = KeyCode
					Int TempInt			
					if KeyCode == 11
					WeaponNum = "10"
					else
					TempKeyCode -= 1
					WeaponNum = "0"+TempKeyCode
					endif
					Debug.trace ("NAKED DEFEAT confiquest: Keypress LOAD_WEAPON NUM: "+WeaponNum)			
					Load_JSON_Weapon(WeaponNum, true)
					AddRandomHarness()
				endif 
			endif 
		; >>>>>>>>>>>> Z (y on german keybaords...) <<<<<<<<<<<<<<< ;
		elseif KeyCode == 44
		Debug.trace ("NAKED DEFEAT confiquest: Keypress Z/Y()")
			if !IsDefeatRunning()
			DrinkPotion()
			endif 

		; >>>>>>>>>>>> K <<<<<<<<<<<<<<< ;
		elseif KeyCode == DefeatKey
		Debug.trace ("NAKED DEFEAT confiquest: Keypress DefeatKey (pressed)")
		;if K is ressed we check further conditions here. ALL of them	
								
			;if IsNymrasGame() && (DefeatStateChapter != "Free") 
			;DefeatStateChapter = "Free"
			;Debug.trace ("NAKED DEFEAT confiquest: OnKeyDown(#ERROR State)")
			;Debug.MessageBox("#ERROR yes its the state") 
			
			;	if DefeatStatePlayer != "Free"
			;	DefeatStatePlayer = "Free"
			;	Debug.MessageBox("#ERROR AND its this state") 
			;	endif 
			;	
			;endif 
							
			if !IsDefeatRunning() ;&& (DefeatStatePlayer == "none")
			DefeatStatePlayer = "Free"
			elseif !IsDefeatRunning() && (DefeatStatePlayer != "Free")
			NymMessage("DefeatStatePlayer = "+DefeatStatePlayer) 
			endif 
			
			if AbortAll
			;while we aborting no key works
			
			;<<<< K >>>>>> Abort Naked Auction >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		;	elseif SSrunning
		;	SSrunning = false 
		
			;<<<< SHIFT + Alt + K >>>>>> FIX BLEEDOUT >>>>>>>>>>>>>>>>>>>>  
			;ALWAYS under ALL CONDITIONS
			elseif IsNymrasGame() && Input.IsKeyPressed(42) && Input.IsKeyPressed(56) ;&& DefeatStatePlayer != "EscapeGame" 			
			;KeyFixBleedout()
			ScreenMessage("Prositution Menu Opened")
			ShowWheelMenuProstitution()
		
			
			;<<<< SHIFT + K >>>>>> Show ACTION Wheel Menu >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
			elseif ModEnabled && Input.IsKeyPressed(42) ;LShift
			
			ScreenMessage("Action Menu Opened")
			ShowWheelMenuAction()
					
			;<<<< ALT + K >>>>>> Show DEBUG Wheel Menu >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
			elseif ModEnabled && Input.IsKeyPressed(56) ;LAlt 
			ScreenMessage("Debug Menu Opened")
			ShowWheelMenuDebug()
			
			;xxxxxxxxxxxxxxxxxXXXXXXXXX ---- !!! MOVED TO WHEEL !!! ---- XXXXXXXXXxxxxxxxxxxxxxxxxx

			
			;xxxxxxxxxxxxxxxxxXXXXXXXXX ---- !!! MOVED TO WHEEL !!! ---- XXXXXXXXXxxxxxxxxxxxxxxxxx			
			;<<<< CTRL + ALT + K >>>>>> ABORT ALL >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>				
			;ONLY DURING DEFEAT
			;elseif IsDefeatRunning() && Input.IsKeyPressed(29) && Input.IsKeyPressed(56) && !AbortAll  		
			;KeyAbortAll()		
			
			;xxxxxxxxxxxxxxxxxXXXXXXXXX ---- !!! MOVED TO WHEEL !!! ---- XXXXXXXXXxxxxxxxxxxxxxxxxx
			;<<<< CTRL + ALT + K --- Disable/Enable Public Punishment <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
			;elseif !PlayerInCombat() && !IsDefeatRunning() && !IsFucking(PlayerRef) &&  Input.IsKeyPressed(29) && Input.IsKeyPressed(56)
			;KeyTogglePublicPunishment()
			
			;xxxxxxxxxxxxxxxxxXXXXXXXXX ---- !!! MOVED TO WHEEL !!! ---- XXXXXXXXXxxxxxxxxxxxxxxxxx
			;<<<< SHIFT + K >>>>>> BATHING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 

		;	elseif !PlayerInCombat() && !IsDefeatRunning() && !IsFucking(PlayerRef) &&  ModBIS && Input.IsKeyPressed(42) && !DefeatQuestRunning && !CivilRapeRunning	&& !dhlpSuspendStatus && !IsFucking(PlayerRef)	;SHIFT + Actionkey
		;	KeyStartBathing()
			
			;xxxxxxxxxxxxxxxxxXXXXXXXXX ---- !!! MOVED TO WHEEL !!! ---- XXXXXXXXXxxxxxxxxxxxxxxxxx
			;<<<< SHIFT + K >>>>>> PLACE FLOOR >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
			;elseif Input.IsKeyPressed(42) && DefeatQuestRunning && !floorplaced ; && (DefeatStatePlayer == "SpotFound")	;allow floor placement all the time
		
			;xxxxxxxxxxxxxxxxxXXXXXXXXX ---- GOES TO WHEEL ---- XXXXXXXXXxxxxxxxxxxxxxxxxx
			;<<<< ALT + K >>>>>> FAST TRAVEL RITUAL >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
			;elseif !PlayerInCombat() && !IsDefeatRunning() && !IsFucking(PlayerRef) && Input.IsKeyPressed(56) && NakedTravel && !DefeatQuestRunning && !CivilRapeRunning && !IsFastTravelRitualStarted && !IsFucking(PlayerRef)
			;KeyStartFastTravelRitual()	
	
		
			;<<<< K >>>>>> ESCAPE/FINDSPOT >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 
			;during Defeat/Escape	
			elseif IsDefeatRunning() 			
			KeyEscapeFindSpot()	
			
			;<<<< K >>>>>> PlayerDown SURRENDER >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> #surrender1
			;during FollowersProtect
			elseif DefeatStateChapter == "FollowersProtect"
			Debug.trace ("NAKED DEFEAT confiquest: OnKeyDown(PlayerGivesUp)")
			DefeatStateChapter = "PlayerGivesUp"
			
			;<<<< K >>>>>> COMBAT SURRENDER >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> #surrender1
			;during Defeat/Escape
			elseif PlayerInCombat() && !DefeatQuestRunning && !CivilRapeRunning && !dhlpSuspendStatus && !PlayerRef.IsBleedingOut() 		
			Debug.trace ("NAKED DEFEAT confiquest: OnKeyDown(Surrender)")
			;we need this to work when player is down. 

			KeySurrender("CombatSurrender")	
			
	
			;<<<< K + while weapon drawn + sneaking + aiming    ;add/remove actor from naked followerfaction ----------------------------------- ;weapon drawn + sneaking + aiming at
			elseif !PlayerInCombat() && !IsDefeatRunning() && !IsFucking(PlayerRef) && crosshairRef && PlayerRef.IsWeaponDrawn() && !PlayerRef.IsSneaking()
			
				;remove
				if crosshairRef.IsInFaction(NadeFollower01Faction)
				ScreenMessage("Naked Defeat: Actor REMOVED as Naked Follower: "+crosshairRef.GetLeveledActorBase().GetName())
				crosshairRef.RemoveFromFaction(NadeFollower01Faction)
				;add
				else
				ScreenMessage("Naked Defeat: Actor ADDED as Naked Follower: "+crosshairRef.GetLeveledActorBase().GetName())
				crosshairRef.AddToFaction(NadeFollower01Faction)
				endif
			
			;xxxxxxxxxxxxxxxxxXXXXXXXXX ---- !!! MOVED TO WHEEL !!! ---- XXXXXXXXXxxxxxxxxxxxxxxxxx
			;<<<< K + while weapon drawn .... register followers -----------------------------------
		;	elseif !PlayerInCombat() && !IsDefeatRunning() && !IsFucking(PlayerRef) && PlayerRef.IsWeaponDrawn() && !PlayerRef.IsSneaking()
		;		ScreenMessage("You make a quick checkup on your followers")
		;		if folqst.GetStage() < 1000
		;		folqst.EndFollowerQuest()
		;		Utility.Wait(1.0)
		;		folqst.StartFollowerQuest()
		;		ScreenMessage("Make sure nobody is missing! (you can check in the MCM/System)")
		;		endif
		
			;<<<< K >>>>>> Reminder >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>							
			; ---_> THIS SHOULD NO LONGER TRIGGER NOW....
			;elseif !PlayerInCombat() && !IsDefeatRunning() && !IsFucking(PlayerRef) &&  WeaponOutSurrender && PlayerRef.IsWeaponDrawn() && !PartyInCombat()
			;ScreenMessage("You cannot surrender when not in combat. Sheath your weapon if you want to do other stuff")	
					
			
			
			
			;<<<< K >>>>>>>>>>>>>>>> ABORT BATHING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>	#hair1
			elseif IsBathing && !IsDefeatRunning()  
			;abort bathing if we are not defeated 
			AbortBathing = true
			ScreenMessage("You stop washing yourself")
			;<<<< K >>>>>>>>>>>>>>>> RESET/CHANGE HAIR && BETA TESTS >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>	#hair1
			elseif !PlayerInCombat() && !IsDefeatRunning() && !IsFucking(PlayerRef) && !PlayerRef.IsWeaponDrawn() && !PartyInCombat() && !IsDefeatRunning() && (DefeatStatePlayer == "Free") ;&& IsSuspended()
			;THIS HAS TO COME LAST ALL THE TIME!
			;NOT in Combat 		
			;NOT in Defeat
				int test = 0
				
				;I can use DebugOption in MCM to enable/disable Tests in the game. Can change the Debug Number again for the function afterwards.
				if Debugpunishmenttype > 0
				test = Debugpunishmenttype as int
				endif

				if (test > 0) && IsNymrasGame() 		
				KeyShowWheelMenuTEST()
				else	
				KeyHairAndMaintenance()
				endif
			endif		
		endif	
	endif	
EndEvent


Function AmbushStart(String sType)
		
		NymTrace("Immobilize(true) for AmbushStart")
		Immobilize(true)
		FadeToBlack(true)

		if sType == "Rieklings"
		DefeatQuestRunning = true
		DefeatTypeGeneral = "AreHumanoids"
		DefeatType = "Rieklings"
		DefeatEntranceVia = "Ambush"
		SendModEvent("StartRestartCalmQuest")
		endif 	

EndFunction 


Function KeyStartFastTravelRitual()
	
	;add additional checks for city? like if indecency still runs?
	DefeatQuestRunning = true	;15.01.2024 V 4.95 new --- set true here for no double starts? also need DHLP suspend?
								;in GENERAL improve mod entry and exit functions -> generalize + timing?
	IsFastTravelRitualStarted = true			
	
	SummonForFastTravel()
	
EndFunction

Function KeyStartBathing()
	
;	if DefeatStatePlayer == ("Bathing") && !AbortBathing
;	ScreenMessage("You stop washing yourself")
;	AbortBathing = True
;	Utility.Wait(3.0)
;	elseif !AbortBathing 
	NymTrace("Immobilize(true) for Bathing")					
	Immobilize(true)
	DefeatStatePlayer = ("Bathing")
	;dhlpSuspendStatus = true	;WTF is this and why? we need to add DHLP suspend events send out too
	;SpawnRapers("Bandits", false)	
	SendModevent("Moan")	
	;ScreenMessage("You thoroughly clean yourself.... everywhere.")
	SendModevent("StartNakedBathing")
;	endif

EndFunction

Function KeyAbortAll()

	if WhipAgain
	CaptureQuest.SetStage(25)
	endif 

	AbortAll = true	
	
	Sexlab.ThreadSlots.StopAll()
	
	FadeToBlack(False)
	

	if (CaptiveQuest.GetStage() > 0) && (CaptiveQuest.GetStage() < 1000)
	CaptiveQuest.SetStage(1000)
	endif
	
;	if IsWearingHeavyBondageDD(PlayerRef) && ModDDe
;	PlayerRef.SendModEvent("iDDeEquipWorn", "Mylist", -66)
;	endif

	
	Immobilize(false)
	FadeToBlack(false)

	LastAddedDevice.DisableNoWait()
	LastAddedDevice.Delete()
	LastAddedDevice = None

EndFunction

Function ResetIdle(actor akactor)
akactor.PlayIdle(IdlesFixHair[0])
EndFunction

Function KeyEscapeFindSpot()

			if DefeatStatePlayer == "Escaping"
				
				SendModevent("Moan")
			;	ScreenMessage("You take a short break before standing up. Brace yourself!")
			;	ImmobilizeCrawl(false)
			;	Immobilize(true)
				;PlayerRef.PlayIdle(IdlesDefeatUnbound[11])
				
					if Nym()
					;Utility.Wait(1.0)
					Game.SaveGame("Naked Defeat End")
					;Utility.Wait(2.0)
					endif
				
					;if IsNymrasGame() 
					DefeatQuestRunning = false ;by setting this false earlier, this ends the AllegianceQuest!
					Utility.Wait(1.0)	
					
						while (Allegiancequest.GetStage() < 1000) && ModEnabled 
						Utility.Wait(1.0)
						;Debug.Messagebox("AllegianceQuest Still running") 
						endwhile 
					;endif 
							
					Utility.Wait(2.0)
				;	ImmobilizeCrawl(false)
					
					DefeatStatePlayer = "Escaped"
					;PlayerRef.PlayIdle(IdlesFixHair[0])  ;RESET IDLE
					;ResetIdle(PlayerRef)
					;SlowDownPlayer(false)
			
				
				elseif DefeatStatePlayer == "Escaped"
				;do nothing
				
				elseif DefeatStatePlayer == "FindSpot"
				SendModevent("Moan")
			;	ScreenMessage("You found a good spot and prepare for your fate...")
			;	Immobilize(true)		
				;SlowDownPlayer(false)	

					Utility.Wait(2.0)
					
					DefeatStatePlayer = "SpotFound"
					
				endif
EndFunction

Function KeyFixBleedout()
	;CTRL + SHIFT + K
Debug.Trace("NAKED DEFEAT #DEBUG: FIX BLEEDOUT. PressedTimes: "+PressedTimes)
;Debug.Messagebox("Attempt Debug Bleedout. PressedTimes: "+PressedTimes)

	if PlayerRef.IsWeaponDrawn()
	PlayerRef.SheatheWeapon()
	endif

	SPE_actor.SetActorCalmed(PlayerRef, true)
		
	;consoleutil.ExecuteCommand("tcai")
;	while AllegianceQuest.GetStage() < 1000
;	Debug.Messagebox("AllegianceQuest running")
;	endif
	Immobilize(false)
	PlayerRef.PushActorAway(PlayerRef, 0.1)
	PlayerRef.RestoreActorValue("Health", 100)		
	PlayerRef.SetNoBleedoutRecovery(true)			
	SendModEvent("Moan")
	Utility.Wait(1.0)
		
	;if PressedTimes == 1 
	PlayerRef.PushActorAway(PlayerRef, 0.1)
	PlayerRef.MoveTo(PlayerRef)
	PlayerRef.PushActorAway(PlayerRef, 0.1)
	;endif 
	
;	PressedTimes += 1
	
	Utility.Wait(3.0)
	
	SPE_actor.SetActorCalmed(PlayerRef, false)
	;Immobilize(true)	;normal scripts shall immobilize
	;consoleutil.ExecuteCommand("tcai")

EndFunction


Function KeyTogglePublicPunishment()
	;CTRL + ALT + K
	if Indecency
	PublicExposure = 0
	Indecency = false
	Debug.notification ("NAKED DEFEAT: public rape disabled")
	
		if IsNymrasGame()
		FastTravel("Enable", True)
		endif
		
	elseif !Indecency
	Indecency = true
	Debug.notification ("NAKED DEFEAT: public rape enabled")
		
		if IsNymrasGame()
		FastTravel("Disable", false)
		endif
	endif
EndFunction

Bool AlreadyTrapped

Function KeyEvadeDeviousTrap(int Keycode)

bool Evaded = false
			
		;MEDIUM - evade with Space 	 	 
		if EvadeWithSpace && (KeyCode == DefeatKey) 	;K pressed 	
		NymTrace("#Trap Medium - evade with Space - K pressed - TRAPPED")
		Evaded = false
		LootTrapIsTriggered = 2
		elseif EvadeWithSpace && (KeyCode == 57) && (KeyCode == DefeatKey)
		NymTrace("#Trap Medium - evade with Space - K+Space pressed - TRAPPED")
		Evaded = false
		LootTrapIsTriggered = 2
		elseif EvadeWithSpace && (KeyCode == 57)
		NymTrace("#Trap Medium - evade with Space - Sace pressed - EVADED")
		Evaded = true
		
		;LOUD - evade with K 
		elseif EvadeWithDefeatKey && (KeyCode == 57)
		NymTrace("#Trap Loud - evade with K - SPACE pressed - TRAPPED")
		Evaded = false
		LootTrapIsTriggered = 2
		elseif EvadeWithDefeatKey && (KeyCode == 57) && (KeyCode == DefeatKey)
		NymTrace("#Trap Loud - evade with K - K+Soace pressed - TRAPPED")
		Evaded = false
		LootTrapIsTriggered = 2
		elseif EvadeWithDefeatKey && (KeyCode == DefeatKey)
		NymTrace("#Trap Loud - evade with K - K pressed - EVADED")
		Evaded = true
		endif
		
		if (LootTrapIsTriggered == 2) && Evaded
		Evaded = false
		endif 
		
		if Evaded	
		NymTrace("Immobilize(true) for Trap Evasion")	
		Immobilize(true)
		SendModevent("Moan")
		PlayerRef.PlayIdle(IdlesBathingStanding[1])	
		ScreenMessage("You evaded the trap")
		LootTrapIsTriggered = 0
		EvadeWithDefeatKey = false
		EvadeWithSpace = false
		Utility.Wait(1.5)
		PlayerRef.PlayIdle(IdlesBathingStanding[0])
		;ScreenMessage("You evaded the trap")
		;Debug.trace ("NAKED DEFEAT confiquest: Keypress SPACE (pressed)")
		;Debug.Messagebox("You evaded the trap")
		;Debug.trace ("NAKED DEFEAT confiquest: LootTrapTriggered - Evaded")
		Immobilize(false)

		endif
		
EndFunction

Function KeySurrender(String Scenario)		;#surrender

bool allowsurrender = false


				Debug.Trace("NAKED DEFEAT configquest: ##SURRENDER##")

			;/	if IsNymrasGame() 		;	;THIS WORKS! !!! #DUPLICATE #COPY #SPAWN
				Debug.Trace("NAKED DEFEAT configquest: StartCombatScan()")
				ProximityScanType = "DuplicateEnemyScan"
					if (ProximityQuest.GetStage() == 0) || (ProximityQuest.GetStage() == 1000)
					ProximityQuest.Start()		;proximityquest start for scan
					else
					ProximityQuest.Start()	
					endif 
				allowsurrender = false 
				Scenario = "none" 
				endif
				/;
				
				;---- CHECK IF WE ARE ALLOWED TO SURRENDER!!! ---:
				if Scenario == "CombatSurrender" 	
					;Weapon Drawn and allowed to surrender then
					if WeaponOutSurrender && PlayerRef.IsWeaponDrawn()  	
					allowsurrender = true
					
					;LEAVE COMBAT ----- FIX COMBAT BUG
					;Weapon NOT Drawn and NOT allowed to surrender then --> leave combat!
					elseif WeaponOutSurrender && !PlayerRef.IsWeaponDrawn() 
					allowsurrender = false
					ScreenMessage("Debug: Leaving Combat...") 
					SendModEvent("Moan")
					PlayerRef.StopCombatAlarm()
					;Weapon out or not ---> surrender
					else
					allowsurrender = true
					endif
				
				elseif Scenario == "Forced Surrender"
					
				allowsurrender = true

				elseif Scenario == "Crime" 
				allowsurrender = true
				endif				
				
				if allowsurrender
				
				PlayerDownAlready = true		;PREVENT DOUBLE STARTS!!! NEW 2025
				
				DefeatStatePlayer = "Surrendering"
				
					if Scenario == "CombatSurrender"
					ScreenMessage("You willingly surrender to your enemies")	;DEFEAT MESSAGE surrender
					AddVictimsToCalmFactions(true)
					DefeatQuestRunning = true				;#0 -- THIS ORDER HAS TO BE KEPT!!!!!
					DefeatViaSurrender = true				;#1 ----> NOTHING else should now trigger or process   
					FirstStartUp = true						;#2  

					ProximityQuestDefeatScenarioScanStart()	;____-WE NEED TO SCAN FOR ENEMIES IN CASE WE HAVE !!! NO HiTs !!! On PC 
					
					;TempSender = "Via Key Combat Surrender"
					AllegianceScanType = "CombatSurrenderStart"
					SendModEvent("StartAllegianceQuest") 	;#3
					ProcessCrimeGold()
					
					elseif Scenario == "Crime" 				
					ScreenMessage("You were caught committing a crime.")
					CivilRapeRunning = true				;#0 -- THIS ORDER HAS TO BE KEPT!!!!!
					;DefeatViaSurrender = true				;#1 ----> NOTHING else should now trigger or process   
					FirstStartUp = true						;#2 
					;TempSender = "Via Crime Forced Combat Surrender"		
					SendModEvent("StartAllegianceQuest") 	;#3
					endif  

				;	if IsWearingHeavyBondageDD(PlayerRef)
				;	DefeatTypeScenario = "DD"
				;	endif	
	
				allowsurrender = false	
				;Debug.SetGodMode(true)
					if PlayerRef.IsWeaponDrawn() 
					PlayerRef.SheatheWeapon()
					Utility.Wait(1.0)
					endif
					
				PlayerRef.AddToFaction(ProtectedActorFaction)
					
				StripWeapons()
				DefeatEntranceVia = "Surrendered in Combat"
				StartDefeat()
				endif

EndFunction


Function KeyTestFunction(int test)		;st OLD 
		
		
		if test == 1
			;StartRobberyAtLocation()
	
		;#ruby
		float Z = PlayerRef.GetPositionZ()
		float Y = PlayerRef.GetPositionY()
		float X = PlayerRef.GetPositionX()
		;Location PlayerLocation = PlayerRef.GetLocation()
		
		Debug.Messagebox("HAHA - X-Position: "+X+" Y-Position: "+Y+" Z-Position: "+Z)
		
		elseif test == 2
		;SOUND Test
		PlayCombatBlockingSound()
		Utility.Wait(3.0)
		PlayCombatStrippingSound()
		Utility.Wait(3.0)
		SoundLootTrap2[0].Play(PlayerRef)
		Utility.Wait(3.0)
		SoundLootTrap2[0].Play(PlayerRef)

		elseif test == 3
		
		StartSimpleSlaveryHostile()
			
;FUCK THIS 			
	
		;SendNakedDefeatExternal()
		
		;WORKS: 
		;LOAD_CONFIG_EXTERNAL()

		elseif test == 5
		

		elseif test == 6 

	;= PlayerRef.GetWornForm(0x00040000) as ObjectReference ;SLOT 48 (PLuGS) 
	
	
	;if oSoulGem.GetName() == "Petty Soulgem Anal Plug"
	;Debug.MessageBox("Petty Soul Gem in the ass") 
	
	;Float maxcharge 

	;maxcharge = oSoulGem.GetItemMaxCharge()
	;Debug.MessageBox("Petty Soul Gem maxcharge: "+maxcharge) 
	;oSoulGem.SetItemCharge(maxcharge)
	
	
	;ORDER OF THINGS:
	
	;/
	Drop Soul Gem
	PickUp and uses as Plug ---> trigger OnObject Equipped
	-> delete one matching Soul Gem in inventory 
	-> start timer 
	-> timer off, remove analplug and drop charged soulgem on ground ?
	
	02004376 Petty Soul Gem Anal Plug
	02004378  Lesser Soul Gem Anal Plug
	020048DD  Common Soul Gem Anal Plug
	
	0001FE9B Petty Soul Gem 
	
	ObjectReference closestDiamond = Game.FindClosestReferenceOfTypeFromRef(Diamond, Game.GetPlayer(), 5.0)
	
	/;
	
	;endif	;48 - Unnamed 
	
	elseif test == 7 

	;ShowDebugWheelMenu()	
			
		
	endif	;End Tests 
		
EndFunction

Function ProximityQuestStart(String sScanType)
Debug.Trace("NAKED DEFEAT configquest: ProximityQuestStart("+sScanType+")")
	ProximityScanType = sScanType
	ProximityQuest.Start()

EndFunction


;cfgqst.ProximityQuestStart("CombatScan")


String Property ProximityScanType Auto

Function ProximityQuestCombatScanStart() ;OLD REMOVE

	Debug.Trace("NAKED DEFEAT configquest: StartCombatScan()")
	ProximityScanType = "CombatScan"
		if (ProximityQuest.GetStage() == 0) || (ProximityQuest.GetStage() == 1000)
		ProximityQuest.Start()		;proximityquest start for scan
		else
		ProximityQuest.Start()	
		endif 
		
		;is this healthy?
		
Endfunction		

Function ProximityQuestDefeatScenarioScanStart() ;OLD REMOVE

	Debug.Trace("NAKED DEFEAT configquest: ProximityQuestDefeatScenarioScanStart()")
	ProximityScanType = "DefeatScenarioScan"
	
	;NOT NECESSARY ANYMORE: set Enemies to empty, all except the Enemy[0] which is the first hitter/initialized combat 
	;Enemy[1] = "none"
	;Enemy[2] = "none"
	;Enemy[3] = "none"
	;Enemy[4] = "none"
	;Enemy[5] = "none"
	
		if (ProximityQuest.GetStage() == 0) || (ProximityQuest.GetStage() == 1000)
		ProximityQuest.Start()		;proximityquest start for scan
		else
		ProximityQuest.Start()	
		endif 
Endfunction	

	bool HeelsON = true
	
	
	
Function DisableHeelsEffectOnActor(actor akActor)

NymTrace("DisableHeelsEffectOnActor("+akActor+")")
		if Nym()
			
			HeelsON = false
			; THIS REMOVES THE HIGH HEELS HEIGT WHEN WORN
			bool UpdateNiOPosition = NiOverride.RemoveNodeTransformPosition(akActor, false, 1, "NPC", "Naked Defeat.esp")
			; Remove NiOverride High Heels
			if NiOverride.HasNodeTransformPosition(akActor, false, 1, "NPC", "internal")
			NymTrace("HasNodeTransformPosition")		
			float[] pos = NiOverride.GetNodeTransformPosition(akActor, false, 1, "NPC", "internal")
			;	Log(pos, "RemoveHeelEffect (NiOverride)") Debug Log
				pos[0] = -pos[0]
				pos[1] = -pos[1]
				pos[2] = -pos[2]
				NiOverride.AddNodeTransformPosition(akActor, false, 1, "NPC", "Naked Defeat.esp", pos)
				NiOverride.UpdateNodeTransform(akActor, false, 1, "NPC")
			elseIf UpdateNiOPosition
			NymTrace("UpdateNiOPosition")	
				NiOverride.UpdateNodeTransform(akActor, false, 1, "NPC")
			endIf
		endif 

EndFunction 

Function RestoreHeelsEffectOnActor(actor akActor)
		NymTrace("RestoreHeelsEffectOnActor("+akActor+")")

		if Nym()
			HeelsON = true 
			
			bool UpdateNiOPosition = NiOverride.RemoveNodeTransformPosition(akActor, false, 1, "NPC", "Naked Defeat.esp")
			bool UpdateNiOScale = NiOverride.RemoveNodeTransformScale(akActor, false, 1, "NPC", "Naked Defeat.esp")
			;NiOverride.RemoveNodeTransformPosition(PlayerRef, false, 1, "NPC", "Naked Defeat.esp")
			;NiOverride.RemoveNodeTransformScale(PlayerRef, false, 1, "NPC", "Naked Defeat.esp")
			if UpdateNiOPosition || UpdateNiOScale ; I make the variables because not sure if execute both funtion in OR condition.
			NymTrace("UpdateNiOPosition")					
			NiOverride.UpdateNodeTransform(akActor, false, 1, "NPC")
			endIf
		endif 
EndFunction 


Function RemoveAllDDevices(Bool bDestroy, String sRemovalException01, String sRemovalException02, String sRemovalException03, String sRemovalException04, String sRemovalException05)
Debug.Trace("NAKED DEFEAT configquest: RemoveAllDDevices()")
		
		NymTrace("sRemovalException01: "+sRemovalException01)
		
		if Quest.GetQuest("zadQuest") != none
		
		PlaySoundOnActor(PlayerRef, "DDs Removed", 1.0)

			NymTrace("Quest.GetQuest(ZAD FUCKD DDD WAD ) != none")	
			nade_DDInt.RemoveAll_DDs_FromActor(PlayerRef, bDestroy, sRemovalException01, sRemovalException02, sRemovalException03, sRemovalException04, sRemovalException05)
			
		
		

			if folqst.IsWithUs_Follower(0) && nade_DDInt.IsWearingDDs(folqst.Actor_Follower01, "Lockable")
			nade_DDInt.RemoveDevicesFromActor(folqst.Actor_Follower01, true)
			Endif
			if folqst.IsWithUs_Follower(1) && nade_DDInt.IsWearingDDs(folqst.Actor_Follower02, "Lockable")
			nade_DDInt.RemoveDevicesFromActor(folqst.Actor_Follower02, true)
			Endif		
			if folqst.IsWithUs_Follower(2) && nade_DDInt.IsWearingDDs(folqst.Actor_Follower03, "Lockable")
			nade_DDInt.RemoveDevicesFromActor(folqst.Actor_Follower03, true)
			Endif		
			if folqst.IsWithUs_Follower(3) && nade_DDInt.IsWearingDDs(folqst.Actor_Follower04, "Lockable")
			nade_DDInt.RemoveDevicesFromActor(folqst.Actor_Follower04, true)
			Endif				
			if folqst.IsWithUs_Follower(4) && nade_DDInt.IsWearingDDs(folqst.Actor_Follower05, "Lockable")
			nade_DDInt.RemoveDevicesFromActor(folqst.Actor_Follower05, true)
			Endif	

		endif

EndFunction 


Function KeyHairAndMaintenance()
Debug.Trace("NAKED DEFEAT configquest: KeyHairAndMaintenance()")		;#hairandmaintenance
	int Test = 0		;##K
	bool DevicesRemovedByCheat = false
	

	;/
	if Nym()
	test = 0 ;USE WHEEL!!!!
	
		if folqst.NakedFollower[0].IsInFaction(CrawlFaction)
		NymTrace("folqst.NakedFollower[0].IsInFaction(CrawlFaction)")
		folqst.NakedFollower[0].RemoveFromFaction(CrawlFaction)
		endif 
		
		if folqst.NakedFollower[0].IsInFaction(ProtectedActorFaction)
		NymTrace("folqst.NakedFollower[0].IsInFaction(ProtectedActorFaction)")
		folqst.NakedFollower[0].RemoveFromFaction(ProtectedActorFaction)
		endif 
			
		if folqst.NakedFollower[0].IsInFaction(nade_DefeatFaction)
		NymTrace("folqst.NakedFollower[0].IsInFaction(nade_DefeatFaction)")
		folqst.NakedFollower[0].RemoveFromFaction(nade_DefeatFaction)
		endif 
	
	endif 
	/;

	If Nym() && PlayerRef.IsSneaking()
	RemoveAllDDevices(false, "empty01", "empty02", "empty03", "empty04", "empty05")
	DevicesRemovedByCheat = true
		;NymTrace("Inventory Weight: "+PO3_SKSEFunctions.GetEquippedWeight(PlayerRef))
	NymTrace("IsOverEncumbered(): "+PlayerRef.IsOverEncumbered())
	
		if PlayerRef.IsInFaction(ProtectedActorFaction)
		Debug.MessageBox("#ERROR Was in ProtectedActorFaction")
		PlayerRef.RemoveFromFaction(ProtectedActorFaction)
		endif 
	endif 

	if test == 404;<----- this was only for testing. move to TestWheel or remove
	Debug.Trace("NAKED DEFEAT configquest: StartCombatScan()")
	ProximityScanType = "CombatScan"
		if (ProximityQuest.GetStage() == 0) || (ProximityQuest.GetStage() == 1000)
		ProximityQuest.Start()		;proximityquest start for scan
		else
		ProximityQuest.Start()		;proximityquest start for scan
		Debug.Messagebox("DID NOT WORK") 
		endif 
	endif
	
	if test == 404
	Save_JSON_Ini()  ;export Out nadeConfig.json 
	endif 
	
	if test == 404
	;	if PlayerRef.IsSneaking()
	;	nade_DDInt.EquipDDtoActor(PlayerRef)
	;	endif 
	
		nade_DDInt.EquipDDtoActor(PlayerRef, "Random")
	endif 
		;sslActor
	
	;THIS DOES NOTHING?
	;	if NiOverride.RemoveNodeTransformScale(PlayerRef, False, 1, "NPC", "Naked Defeat.esp")
	;	NymTrace("RemoveNodeTransformScale")
	;	NiOverride.UpdateNodeTransform(PlayerRef, False, 1, "NPC")
	;	endif 		
	;	Utility.Wait(3.0	
	;endif 
	
	if Test == 404
	;CreateModEvent("NakedDefeatTransition", "Teleport Misshap")
	;zbfRopeDown "Rope Down" [FURN:05059B5C]
	
	OBJECTREFERENCE r
	r = PlayerRef.PlaceAtMe((Game.GetFormFromFile(0x05059B5C, "ZaZAnimationPack.esm")), 1, true, false) 
	r.SetAngle(0.0, 0.0, r.GetAngleZ())
	endif 

	
	
	if test == 404
	
		; we aim for keycode 47 (V)
		int iRunToggle = Input.GetMappedKey("Run", 0xFF) 
		NymMessage("iRunToggle: "+iRunToggle)
		
		int iAlwaysRunToggle = Input.GetMappedKey("Toggle Always Run", 0xFF) 
		NymMessage("iAlwaysRunToggle: "+iAlwaysRunToggle)
		
	;	NymTrace("SlowDownPlayerTEST: "+sAction)
	;	if sAction == "SlowDown"
		NymMessage("Walking")
		Input.TapKey(iAlwaysRunToggle)	
			
	;	elseif sAction == "Reset" 
	
	;	Input.TapKey(iWalkToggle)
	;
	endif 
	if test == 404
	
		if !playerref.IsInFaction(CrawlFaction)
		playerref.AddToFaction(CrawlFaction)
		elseif playerref.IsInFaction(CrawlFaction)
		playerref.RemoveFromFaction(CrawlFaction)	
		endif 
	endif 

	
	if IsCheat && IsNymrasGame()
	Debug.MessageBox("#NOTED - repaired Outfit Function. Sorry. You can proceed!")
	IsCheat = false
	NymTrace("IsCheat = false (Z)")
	Endif
					
	RemoveBrutalPlugs()
	;RapeAgain = false
;	if IsPlayerCrawling()	
;	SendModEvent("Moan")
;	Crawl(PlayerRef, false)	
;	endif

	;PRE CHECK PIERCINGS 
	Bool OnlyPiercings = false

	if DeviousPiercingEffects
		if nade_DDInt.IsWearingDDs(PlayerRef, "Only Piercings") ;|| nade_DDInt.IsWearingDDs(PlayerRef, "Piercing Vaginal")
		;	if !nade_DDInt.IsWearingDDs(PlayerRef, "BlockingSex")
		ScreenMessage("You need a nearby workbench to get rid of the piercings.")
		OnlyPiercings = true
		else 
		OnlyPiercings = false
		endif			
		
	endif 

	if !OnlyPiercings && !DevicesRemovedByCheat && ModDDNG && (KeyDDWiggleFreeChance > 0) && nade_DDInt.IsWearingDDs(PlayerRef, "Lockable")
		
		NymTrace("Immobilize(true) for DD Wiggle Free")
		Immobilize(True)
		
		if HeelsFix
		;DisableHeelsEffectOnActor(PlayerRef)
		;not required, we currently only use standing poses
		endif 
		
		WhipAgain = true
		ScreenMessage("You try to wiggle free from the Devices.")
	;	DefeatStateBindings = "Cuffs"
		calmqst.PlayPoseOnActor(PlayerRef, "DD Removal Wiggling", false)
		
			if folqst.IsWithUs_Follower(0) && nade_DDInt.IsWearingDDs(folqst.Actor_Follower01, "Lockable")
			calmqst.PlayPoseOnActor(folqst.Actor_Follower01, "DD Removal Wiggling", false)
			Endif
			if folqst.IsWithUs_Follower(1) && nade_DDInt.IsWearingDDs(folqst.Actor_Follower02, "Lockable")
			calmqst.PlayPoseOnActor(folqst.Actor_Follower02, "DD Removal Wiggling", false)
			Endif		
			if folqst.IsWithUs_Follower(2) && nade_DDInt.IsWearingDDs(folqst.Actor_Follower03, "Lockable")
			calmqst.PlayPoseOnActor(folqst.Actor_Follower03, "DD Removal Wiggling", false)
			Endif		
			if folqst.IsWithUs_Follower(3) && nade_DDInt.IsWearingDDs(folqst.Actor_Follower04, "Lockable")
			calmqst.PlayPoseOnActor(folqst.Actor_Follower04, "DD Removal Wiggling", false)
			Endif				
			if folqst.IsWithUs_Follower(4) && nade_DDInt.IsWearingDDs(folqst.Actor_Follower05, "Lockable")
			calmqst.PlayPoseOnActor(folqst.Actor_Follower05, "DD Removal Wiggling", false)
			Endif	
		
		
			PlayMoaningSound()
			Utility.Wait(3.0)
			PlayerRef.DamageAV("Stamina", 100)
			PlayerRef.RestoreAV("Stamina", 100)
			
			calmqst.PlayPoseOnActor(PlayerRef, "DD Removal Wiggling", false)
						
			PlayBreathingSound()
			Utility.Wait(3.0)
			PlayerRef.DamageAV("Stamina", 100)
			PlayerRef.RestoreAV("Stamina", 100)
			PlayMoaningSound()	
			Utility.Wait(3.0)
			PlayerRef.DamageAV("Stamina", 100)
			PlayerRef.RestoreAV("Stamina", 100)
		
		if D100(50)
		calmqst.PlayPoseOnActor(PlayerRef, "DD Removal Wiggling", false)
			PlayMoaningSound()
			Utility.Wait(3.0)
		WhipAgain = false
		endif 
		
		calmqst.PlayPoseOnActor(PlayerRef, "DD Removal Resting", false)
			PlayBreathingSound()
			Utility.Wait(Utility.RandomInt(2, 4))
			PlayBreathingSound()
			Utility.Wait(Utility.RandomInt(2, 4))
		
		Float WiggleFreeChanceTemp
		
		if IsWorkbenchNearby()		;easier with workbench, risk stays the same
		WiggleFreeChanceTemp = KeyDDWiggleFreeChance + KeyDDWiggleFreeChance 
		else
		WiggleFreeChanceTemp = KeyDDWiggleFreeChance
		endif 	
			
		if D100(WiggleFreeChanceTemp)
		
			if DeviousPiercingEffects && nade_DDInt.IsWearingDDs(PlayerRef, "Piercing Nipples")
				if IsWorkbenchNearby()
				ScreenMessage("You could wiggle free from the Devices and remove the piercings.")
				RemoveAllDDevices(false, "empty01", "empty02", "empty03", "empty04", "empty05")				
				else 
				ScreenMessage("You could wiggle free from the Devices but not remove the piercings.")
				ScreenMEssage("You need a workbench nearby to remove the Piercings [Devious Piercings]")
				RemoveAllDDevices(false, "zad_DeviousPiercingsNipple", "zad_DeviousPiercingsVaginal", "empty03", "empty04", "empty05")
				endif 
			else	
			ScreenMessage("You could wiggle free from the Devices.")
			RemoveAllDDevices(false, "empty01", "empty02", "empty03", "empty04", "empty05")	
			endif 

		Immobilize(False)
		calmqst.PlayPoseOnActor(PlayerRef, "reset", false)
		;DefeatStateBindings = "Unbound"
	
		elseif D100(KeyDDWiggleFreeFailChance)
		;............ooooooooooooooooOOOOOOOOOOOOO	FADE TO BLACK TRUE OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
		FadeToBlack(true) 
			PlayMoaningSound()
			Utility.Wait(4.0)
			PlayMoaningSound()
		Immobilize(False)		
			if D100(66)
			StartRobberyAtLocation()
			SendModEvent("SSLV Entry")
			else
			StartRobberyAtLocation()
			SendModevent("StartNakedAfterlife")
			endif 
		else 
		ScreenMessage("You could not wiggle free. Try again")
		calmqst.PlayPoseOnActor(PlayerRef, "Wait", false)
			PlayBreathingSound()
			Utility.Wait(2.0)
			PlayBreathingSound()
			Utility.Wait(2.0)
		Immobilize(False)
		calmqst.PlayPoseOnActor(PlayerRef, "Reset", false)
		
			if folqst.IsWithUs_Follower(0)
			calmqst.PlayPoseOnActor(PlayerRef, "Reset", false)
			Endif
			if folqst.IsWithUs_Follower(1)
			calmqst.PlayPoseOnActor(PlayerRef, "Reset", false)
			Endif		
			if folqst.IsWithUs_Follower(2)
			calmqst.PlayPoseOnActor(PlayerRef, "Reset", false)
			Endif		
			if folqst.IsWithUs_Follower(3)
			calmqst.PlayPoseOnActor(PlayerRef, "Reset", false)
			Endif				
			if folqst.IsWithUs_Follower(4)
			calmqst.PlayPoseOnActor(PlayerRef, "Reset", false)
			Endif	
		
		
		DefeatStateBindings = "Unbound"
		endif 
		
		if HeelsFix
		;RestoreHeelsEffectOnActor(PlayerRef)
		;not required, we currently only use standing poses
		endif 
	;endif 
	
	
	;------- CHANGE / RESET HAIR / DEBUG ---------------------------------------------------------------------------------------
	elseif ResetHair || ChangeHair			
	
		SendModEvent("Moan")
		
		while PlayerRef.IsWeaponDrawn() 
		PlayerRef.SheatheWeapon() 
		Utility.Wait(1.0)
		endWhile
		
		NymTrace("Immobilize(true) for Hair Change")
		Immobilize(true)	
		PlayerRef.PlayIdle(IdlesFixHair[1])		
							
		ChangeHairStyle()
		
		Utility.Wait(3.0)
		Immobilize(false)

		if ResetHair
		ScreenMessage("You fix your messed up hair.")
		elseif ChangeHair
		ScreenMessage("You change your hairstyle.")
		endif
			
		LootScriptRunning = false
		ResetExpressions()

		Orgasm = false
		floorplaced = false
		LootScriptRunning = false
		;Debug.SetGodMode(false)
		
	;	if IsPlayerCrawling()	
	;	Crawl(PlayerRef, false)	
	;	endif
	
	;-------- DEBUG STUFF ##FIX ---------------------------------------------------------------------------------------------------------------------
	
		if PlayerRef.IsInFaction(CrawlFaction)
		PlayerRef.RemoveFromFaction(CrawlFaction)
		endif 
		
		if PlayerRef.IsInFaction(ProtectedActorFaction)
		PlayerRef.RemoveFromFaction(ProtectedActorFaction)
		endif 
			
		if PlayerRef.IsInFaction(nade_DefeatFaction)
		PlayerRef.RemoveFromFaction(nade_DefeatFaction)
		endif 
		
		if HealthBoost && PlayerRef.GetActorValue("health") > 100000
			If IsNymrasGame()
			Debug.Messagebox("HealthBoost -100.000")
			endif
		PlayerRef.ModActorValue("health", -100000.0)
		endif
	endif
EndFunction
		
		
		
Bool Function IsWorkbenchNearby()

		ObjectReference ClosestWorkbench 

		Form Workbench = Game.GetFormFromFile(0x000D932F, "Skyrim.esm") as Form

		ClosestWorkbench = Game.FindClosestReferenceOfTypeFromRef(Workbench, PlayerRef, 100.0)
		
		if ClosestWorkbench
		return true
		else
		return false
		endif

EndFunction	
	
		;#Shader 2 TEST
					
					;/
					;FROST TESTING: DLC1SunDamageImpactSmoke [EFSH:02019C9E]
					Frostspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Utility.Wait(1.0)
					Frostspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Utility.Wait(1.0)
					Frostspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Utility.Wait(1.0)
					Frostspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Frostspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Frostspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Frostspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					
					Soundspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Utility.Wait(3.0)				
					Soundspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					
					;SHOCK TESTING:  ParalyzeFxShader [EFSH:0006DE84]
					ShockSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Utility.Wait(1.0)
					ShockSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Utility.Wait(1.0)
					ShockSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Utility.Wait(1.0)
					ShockSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					ShockSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					ShockSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					ShockSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					
					Soundspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					;FIRE TESTING:  DragonHolesSmokeFXS [EFSH:0004D6B5]
					Utility.Wait(3.0)
					Soundspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					
					FireSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Utility.Wait(1.0)
					FireSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Utility.Wait(1.0)
					FireSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					Utility.Wait(1.0)
					FireSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					FireSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					FireSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					FireSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					
					Soundspell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)	;WORKING ONLY EFFECT USES "ShockPlayerCloakFXShader [EFSH:0010F9A6]"
					
					/;
					;+++SoulTrapFXShader [EFSH:000506D7] PurpleOveryla and rumblind sound. Maybe as PAIN in general? USE
					;+++FrostChillRendFXShader [EFSH:0010A044] 	Different sound and effect, maybe add for variety to FrostCycle as second spell?
					;++FrostChillRendHitFXShader [EFSH:0010A044] seems the same as FrostFX almost
					
					;FrostFX very low volume
					;FrostChillRend low volume
					
					;+++ShockDisintegrate01FXS [EFSH:000D22FB]	Massive Effect, white overlay partially, strong shock for heavy punsiH? shock sound
					;ReanimateFXShader [EFSH:00075272]	 suple, purple overlay, no sound
					;AzuraEvil [EFSH:00050F02] 			 very cyan, ugly, too much, no sound
					;WebbedFXS [EFSH:0002E1CD]			too less, no sound
					;DamageHealthFXS [EFSH:000B93D8]	red pulse, boring, no sound
					;SteamFXShader [EFSH:0010FDF9]		electro sound, no effect
					;DLC01scBlackOozeFXS [EFSH:020038F8]	nothing at all
					;SovengardeFXS01 [EFSH:0010B2DF]	randomeffect not special, no sound
					;+DismayShout01FXS [EFSH:0007B6B9]	rainbowlike effekt, no sound, test for potions
					;forgeMasterFXs [EFSH:0200F670]		no effect no sound
					;DLC1DeathHoundFXS [EFSH:020028EE] 	no effect no sound
					;DragonResDirtFXS [EFSH:000CEE0F]	makes transparent, no sound
					;DeathHoundDeathFXShader [EFSH:02012D07]	does nothing
					
				;	if NymBeta
				;	DebugCheckCurrentCrimeGold()
				;	endif
			
	
					;PlayerPosing("Random", false)
					 ;TEST end
							
					;endif ;BETA

;FUCK THIS. REMOVE AGAIN


Function ResetExpressions()			;#Expressions

			PlayerRef.ClearExpressionOverride()
			MfgConsoleFunc.ResetPhonemeModifier(PlayerRef)
							
EndFunction


Bool Function IsPoseScenario()

	if (DefeatTypeScenario == "Yoke")
	return true
	elseif (DefeatTypeScenario == "Armbinder")
	return true
	elseif (DefeatTypeScenario == "Cuffs")
	return true
	elseif (DefeatTypeScenario == "DDeEvent")
	return true
	elseif (DefeatTypeScenario == "DD")
	return true
	elseif (DefeatTypeScenario == "Pillory")
	return true
	elseif (DefeatTypeScenario == "Wheel")
	return true	
	elseif (DefeatTypeScenario == "XCross")
	return true
	elseif (DefeatTypeScenario == "PoleStanding")
	return true
	elseif (DefeatTypeScenario == "PoleKneeling")
	return true
	elseif (DefeatTypeScenario == "Stockade")
	return true
	else
	return false
	endif
	
EndFunction

Idle Property ZAPTestXCross auto
Idle TestAnimation

objectreference PlacedBarrel
Furniture PlacedBarrel2	
bool chestspawned = false

Function TESTFUNCTION()			
Debug.Trace("NAKED DEFEAT configquest: TESTFUNCTION(START)")
		
		
	if IsNymrasGame()	
	
	Debug.MessageBox("TestFunctionStarted")
	
		bool AnimationTest = false
		bool Test = true
		
		if Test
		
		ObjectReference LocMining1
		ObjectReference LocMining2
		;Immobilize(true)
										    ;Cidhna Mine 000BC462
		;LocMining1 = (Game.GetFormFromFile(0x000BC462, "Skyrim.esm") As ObjectReference)
		;PlayerRef.MoveTo(LocMining1)
		
		;Utility.Wait(4.0)
		
		LocMining2 = (Game.GetFormFromFile(0x000BC462, "Skyrim.esm") As ObjectReference)
		Game.SetPlayerAIDriven()
		Utility.Wait(1.0)
		Game.DisablePlayerControls(false)
		Utility.Wait(1.0)
		
		;Debug.SetGodMode(true) ;If a creature would start combat with player then couldnt we cause that actor to stop combat or flee, etc.
		;Game.SetPlayerAIDriven()
;Game.GetPlayer().PlayIdle(IdleWalkingCameraStart) ;This should autofill. Make as idle property

;Game.GetPlayer().PathToReference(_target , 1) ;latent, script suspended until target reached.
;Game.GetPlayer().PlayIdle(IdleWalkingCameraEnd) ;This should autofill. Make as idle property
;Game.SetPlayerAIDriven(false)
		
			if PlayerRef.PathToReference(LocMining2, 1.0)
			ScreenMessage("Destination Reached")
			else
			ScreenMessage("Destination FAILED")
			endif
		endif 
	endif

EndFunction

Function SummonForFastTravel()			

	SendModEvent("Moan")
	
		while PlayerRef.IsWeaponDrawn() 
		PlayerRef.SheatheWeapon() 
		Utility.Wait(1.0)
		endWhile	
	NymTrace("Immobilize(true) for Fast Travel")	
	Immobilize(true)
	
	PlayerRef.PlayIdle(IdlesHumanSurrender[Utility.RandomInt(1,2)])
	
	StartFastTravelScenario()
	;endif
					
EndFunction


;/ 

SEND MOD EVENTS SENDMODEVENT Pamatronic Execution

SendModEvent 

MAIN SEQUENCE --- WIP.... ohman

	Bool Property FindSpot = false Auto
	Int Property Sex = 0-X Auto
	Bool Property Bukkake = false Auto
	Bool Property Pee = false Auto
	Bool Property Whip = false Auto
	Bool Property Furniture = false Auto
	
	
	Bool Property ShortCapYoke = false Auto
	Bool Property ShortCapCuffs = false Auto
	Bool Property Escape = false Auto
	
	Bool Property ShortSex = false Auto
	
	
	Bool Property ShortSex = false Auto
	Bool Property ShortBukkake = false Auto
	Bool Property ShortPee = false Auto
	Bool Property ShortWhip = false Auto
	Bool Property ShortCapFurniture = false Auto
	Bool Property ShortCapYoke = false Auto
	Bool Property ShortCapCuffs = false Auto
	Bool Property Escape = false Auto
/;


;IDLES TEST
					
				;	if NymBeta				
				;	
				;/	
					PlayerRef.PlayIdle(IdlesDefeatBigPoleStruggle[0])  ;12
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatBigPoleStruggle[1])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatBigPoleStruggle[2])
					Utility.Wait(3.0)					
					PlayerRef.PlayIdle(IdlesDefeatBigPoleStruggle[3])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatBigPoleStruggle[4])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatBigPoleStruggle[5])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatBigPoleStruggle[6])
					
					Utility.Wait(5.0)
					PlayerRef.PlayIdle(IdlesDefeatPillory[0])  ;12
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPillory[1])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPillory[2])
					Utility.Wait(3.0)					
					PlayerRef.PlayIdle(IdlesDefeatPillory[3])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPillory[4])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPillory[5])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPillory[6])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPillory[7])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPillory[8])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPillory[9])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPillory[10])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPillory[11])
					Utility.Wait(3.0)					
					PlayerRef.PlayIdle(IdlesDefeatPillory[12])
					Utility.Wait(3.0)

					Utility.Wait(5.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[0])  ;12
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[1])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[2])
					Utility.Wait(3.0)					
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[3])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[4])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[5])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[6])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[7])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[8])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[9])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[10])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[11])
					Utility.Wait(3.0)					
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[12])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[13])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[14])
					Utility.Wait(3.0)
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[15])
					Utility.Wait(3.0)					
					PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[16])
					Utility.Wait(3.0)
					
					
					;SendModEvent("StartNakedSlavery")	
/;

Function SexlabMoan(actor akActor, sslBaseVoice voice = none)				;#moan
Debug.trace ("NAKED DEFEAT confiquest: SexlabMoan()")
;Function SexlabMoan(actor akActor, int arousal=-1, sslBaseVoice voice = none)
	; Is the player gagged?
;	if akActor.WornHasKeyword(zad_DeviousGag)
;		int gsID = gaggedSound.Play(akActor)
;		Sound.SetInstanceVolume(gsID, 1)
;		return
;	EndIf
	; Select voice if needed
	if !voice
		voice = SexLab.PickVoice(akActor)
	EndIf
	; If arousal isn't provided, look it up.
;	if arousal == -1
;		arousal = Aroused.GetActorExposure(akActor)
;	EndIf
	; Play the voice.
	;voice.Moan(akActor, 100, true)		;old function
	if akActor == PlayerRef
	
		if DefeatQuestRunning || CivilRapeRunning
		MfgConsoleFunc.SetPhoneme(akActor, 1, 40)
		endif
		
		Utility.Wait(0.5)
		voice.PlayMoan(akActor, 100, true, false)	;uses PlayMoan Function from sslBaseVoice script
		
		if DefeatQuestRunning || CivilRapeRunning
		MfgConsoleFunc.SetPhoneme(akActor, 1, 100)
		SendModEvent("ResetPhoneme")
		endif

	
	else
	voice.PlayMoan(akActor, 100, true, false)
	;else
	;Utility.Wait(2.0)
	;MfgConsoleFunc.ResetPhonemeModifier(akActor)
	endif
	
EndFunction

;---------------------------------------------------------------------------------------------------------------------------
;--------------------- HAIR -------------------------------------------------------------------

Int Function GetLastHairStageIndex()
	
	if (SexLab.GetGender(PlayerRef)) == 1 && (HairStages.Length != 4)	;female PC
		HairStages = new HeadPart[4]							
		HairStages[0] = HeadPart.GetHeadPart("HairFemaleRedguard03")	;bald
		HairStages[1] = HeadPart.GetHeadPart("HairFemaleRedguard04")	;very short
		HairStages[2] = HeadPart.GetHeadPart("HairFemaleImperial1")		;short
		HairStages[3] = None											;original
	else
		HairStages = new HeadPart[4]							
		HairStages[0] = HeadPart.GetHeadPart("HairMaleRedguard03")		;bald
		HairStages[1] = HeadPart.GetHeadPart("HairMaleRedguard04")		;very short
		HairStages[2] = HeadPart.GetHeadPart("HairMaleImperial1")		;short
		HairStages[3] = None											;original
	endif
	return 3
EndFunction

HeadPart Function GetCurrentHair()

	HeadPart hair = None

	ActorBase a = PlayerRef.GetActorBase()
	int i = a.GetNumHeadParts()
	while i && !hair
		i -= 1
		HeadPart h = a.GetNthHeadPart(i)
		if h && (h.GetType() == 3)
			hair = h
		endif
	endwhile

	return hair

EndFunction

string Function GetCurrentHairName()	;still in use
	HeadPart hair = GetCurrentHair()
	if hair
		return hair.GetName()
	else
		return ""
	endif
EndFunction

string Function GetOriginalHairName()	;not in use anymore
	HeadPart hair = None
	Int i = HairStages.Length
	if i == 4
		hair = HairStages[3]
	endif
	if hair
		return hair.GetName()
	else
		return ""
	endif
EndFunction

Int Function GetHairIndex(HeadPart hair, Int LastIndex)
	Int i = LastIndex
	while (i >= 0) && (HairStages[i] != hair)
		i -= 1
	endwhile
	return i
EndFunction

bool ResetHair = false

;Function ChangeHairStyle(string Type = "none")		


String Function GetHairStyle(bool Slave)			;#hair2 #ChangeHairStyle	
	
				;	HairStages[0] = HeadPart.GetHeadPart("_d02HW_16BH")						;LONG
				;HairStages[1] = HeadPart.GetHeadPart("_d02HW_16H")			;very long, open
				;HairStages[2] = HeadPart.GetHeadPart("_d02HW_13H")			;long, open
				;HairStages[3] = HeadPart.GetHeadPart("_d02HW_12H")					;long, open
				
				
			
				;return "_d02HW_05H"
				;return "_d02HW_04H"
				;return "_d02HW_03LongH"
				;return "_d02HW_03LongH"
				;"KSSMP_StayAwake"
				;"KSSMP_Starlet"
				;KSSMP_Snow
				;KSSMP_Sky047 SLAVE
				;
		if Slave
		
		int i = Utility.RandomInt(1,11)
		
			if i == 1				;SLAVE
			return "_d02HW_16altH"		;00000 Long OPEN with Braids - black
			elseif i == 2			;SLAVE
			return "_d02HW_16BaltH"		;0000 Long OPEN NO Braids - black
			elseif i == 3			;SLAVE
			return "_d02HW_15altH"		;00000 Long OPEN with Braids and some in face - black
			elseif i == 4			;SLAVE			
			return "_d02HW_15BaltH"		;00000 Long OPEN NO Braids and some in face - black
			elseif i == 5			;SLAVE
			return "_d02HW_10altH"		;0000 Medium OPEN  Braids on Top  - black
			elseif i == 6			;SLAVE
			return "_d02HW_07altnoBowH"	;0000 Long OPEN Wild some braids - black
			elseif i == 7			;SLAVE
			return "_Fuse00_Yasha_ScalpFemale" ;Wild Braids medium Warrior Sarana and Slave - black
			elseif i == 8			;SLAVE	
			return "_d02HW_33BaltH"		;very long bushy Open Fucked Sarana Slave - black
			elseif i == 9			;SLAVE	
			return "_d02HW_32AaltH"			;JINX!!!!  Black Sarana Warrior and Slave - black
			elseif i == 10			;SLAVE	
			return "_d02HW_31AaltH"			;medium Open, Curly Sarana Slave - black
			elseif i == 11			;SLAVE	
			return "_d02HW_23CaltH"			;0000, High Open Unrcurly Open Slave  - black
			elseif i == 12			;SLAVE	
			return "KSSMP_Searching"
			elseif i == 13			;SLAVE			

			return "KSSMP_Runaway"
			elseif i == 14			;SLAVE
			return "KSSMP_Milliet"
			elseif i == 15			;SLAVE		
			return "KSSMP_Metropolis2"
			elseif i == 16			;SLAVE	
			return "KSSMP_Lotus"
			elseif i == 17			;SLAVE		
			return "KSSMP_Jackdaw"
			elseif i == 18			;SLAVE	
			return "KSSMP_Honey"
			elseif i == 19			;SLAVE		
			return "KSSMP_Gecko"
			elseif i == 20			;SLAVE		
			return "KSSMP_Desperate"
			elseif i == 21			;SLAVE		
			return "KSSMP_CrazyLove"
			elseif i == 22			;SLAVE		
			return "KSSMP_Anchor"
			elseif i == 23			;SLAVE		
			return "KSSMP_Platinum"
			elseif i == 24			;SLAVE		
			return "_d02HW_23BH"
			elseif i == 25				;SLAVE		
			return "KSSMP_Traveller"
			elseif i == 26		
			return ""
			elseif i == 27		
			return ""
			elseif i == 28				;SLAVE		
			return ""
			elseif i == 29		
			return ""
			elseif i == 30		
			return ""
			endif 
		else 
			int i = Utility.RandomInt(18,29)
		
			if i == 1				;free
			return "KSSMP_Paraguay"
			elseif i == 2				;free
			return "KSSMP_Sky188"
			elseif i == 3				;free
			return "KSSMP_Sky190"
			elseif i == 4				;free			
			return "KSSMP_Sky201"
			elseif i == 5				;free
			return "KSSMP_Sky208"
			elseif i == 6				;free
			return "KSSMP_Spring"
			elseif i == 7				;free		;VERY Boring 
			return "KSSMP_Traveller"
			elseif i == 8				;free	
			return "KSSMP_Sky022"
			elseif i == 9				;free	
			return "KSSMP_Princess"
			elseif i == 10				;free	
			return "KSSMP_Koala"
			elseif i == 11				;free	
			return "KSSMP_Kaysa"
			elseif i == 12				;free	
			return "KSSMP_Galaxy"
			elseif i == 13				;free			
			return "KSSMP_FontanaDiTrevi"
			elseif i == 14				;free	
			return "KSSMP_Erena"
			elseif i == 15				;free			;Boring, make Rape Hair instead
			return "KSSMP_Cambrian"
			elseif i == 16				;free	
			return "KSSMP_Bluebird"
			elseif i == 17				;free		
			return "KSSMP_Angels"
			elseif i == 18				;free	
			return "_d02HW_21nonbraidsH"
			elseif i == 19				;free		
			return "_d02HW_22AH"
			elseif i == 20		
			return "_d02HW_22BH"		;SARANA BEST (short double Braids + 4 small front braids )
			elseif i == 21		
			return "_d02HW_22CH"		;SARANA BEST (long double Braids)
			elseif i == 22				;free		
			return "_d02HW_22DH"
			elseif i == 23		
			return "_d02HW_26DH"
			elseif i == 24		
			return "_d02HW_30AH"
			elseif i == 25				;free		
			return "_d02HW_30BH"
			elseif i == 26		
			return "_d02HW_09noFratherH" ;ponytail, heavy top braids BLACK - Warrior Sarana"
			elseif i == 27		
			return "_d02HW_05altH"		;asian Style, long, high long ponytail, long thin braids, Warrior Sarana
			elseif i == 28				;free		
			return "_Fuse00_Yasha_ScalpFemale" ;Wild Braids medium Warrior Sarana and Slave
			elseif i == 29		
			return "_d02HW_32AaltH"			;JINX!!!!  Black Sarana Warrior and Slave
			elseif i == 30		
			return ""
			endif 
		endif 
;/	, TEST THESE
				HairStages[0] = HeadPart.GetHeadPart("KSSMP_Veneris")	
				HairStages[1] = HeadPart.GetHeadPart("KSSMP_hairsidebraids")	
				HairStages[2] = HeadPart.GetHeadPart("KSSMP_Tsugumi3")	
				HairStages[3] = HeadPart.GetHeadPart("KSSMP_ColdHeart")			
				HairStages[4] = HeadPart.GetHeadPart("KSSMP_GuineaPig")	
				HairStages[5] = HeadPart.GetHeadPart("KSSMP_Wing109")			;OO
				HairStages[6] = HeadPart.GetHeadPart("KSSMP_Equanimity")		
				HairStages[7] = HeadPart.GetHeadPart("KSSMP_Mhysa")	
				HairStages[8] = HeadPart.GetHeadPart("")	
				HairStages[9] = HeadPart.GetHeadPart("")					;			ApachiiHairHuman91 zu edel
				HairStages[10] = HeadPart.GetHeadPart("")		;new Ponytail		;			ApachiiHairHuman64	too high on head	
				HairStages[11] = HeadPart.GetHeadPart("")			;			ApachiiHairHuman38 too high on head	
				HairStages[12] = HeadPart.GetHeadPart("KSSMP_Daydream")		;OO
				HairStages[13] = HeadPart.GetHeadPart("KSSMP_Tsugumi2")		;OOO
				HairStages[14] = HeadPart.GetHeadPart("KSSMP_Tsugumi1")		;OOO
				HairStages[15] = HeadPart.GetHeadPart("KSSMP_CrayLove")		
				HairStages[16] = HeadPart.GetHeadPart("KSSMP_Wing1111")		;OOO	
				HairStages[17] = HeadPart.GetHeadPart("KSSMP_Peach")	
				/;

EndFunction


Function FixExpressions()
	
	Headpart TempHeadpartHair

	if Nym()
	TempHeadpartHair = GetCurrentHair()
		NymTrace("FixExpressions: GetCurrentHair NAME A: "+TempHeadpartHair.GetPartName())
			if TempHeadpartHair
		
		;	Debug.Messagebox("HairFound")
			PlayerRef.ChangeHeadPart(TempHeadpartHair) 
			endif 
		
		PlayerRef.ChangeHeadPart(TempHeadpartHair) 
		
		TempHeadpartHair = GetCurrentHair()
		NymTrace("GetCurrentHair NAMEB: "+TempHeadpartHair.GetPartName())
	endif 
EndFunction 

	
Function ChangeHairStyle()			;#hair2 #ChangeHairStyle

	String ChosenHair
	Headpart TempHeadpartHair
	Headpart TempHeadpartHair02
	
	if IsNymrasGame()
		
	
			if IsDefeatRunning()
			ChosenHair = GetHairStyle(true)		;Get Slave Hair
			else 
			ChosenHair = GetHairStyle(false)	;Get Free Hair 
			endif 
		
			NymMessage("Your new Hairstyle: "+ChosenHair)
		
			TempHeadpartHair = HeadPart.GetHeadPart(ChosenHair)
			PlayerRef.ChangeHeadPart(TempHeadpartHair) 

						
	else 
	
	HeadPart hair = GetCurrentHair()	;dont need this anymore?!


		HairStages = new HeadPart[21]	
		;original
		HairStages[0] = HeadPart.GetHeadPart(SavedHair_00)	
		;forced
		HairStages[1] = HeadPart.GetHeadPart(SavedHair_01)	
		HairStages[2] = HeadPart.GetHeadPart(SavedHair_02)	
		HairStages[3] = HeadPart.GetHeadPart(SavedHair_03)			
		HairStages[4] = HeadPart.GetHeadPart(SavedHair_04)	
		HairStages[5] = HeadPart.GetHeadPart(SavedHair_05)	
		HairStages[6] = HeadPart.GetHeadPart(SavedHair_06)		
		HairStages[7] = HeadPart.GetHeadPart(SavedHair_07)	
		HairStages[8] = HeadPart.GetHeadPart(SavedHair_08)	
		HairStages[9] = HeadPart.GetHeadPart(SavedHair_09)	
		HairStages[10] = HeadPart.GetHeadPart(SavedHair_10)		
		
		;modular styles (toggle if forced or original)
		HairStages[11] = HeadPart.GetHeadPart(SavedHair_11)	
		HairStages[12] = HeadPart.GetHeadPart(SavedHair_12)	
		HairStages[13] = HeadPart.GetHeadPart(SavedHair_13)	
		HairStages[14] = HeadPart.GetHeadPart(SavedHair_14)	
		HairStages[15] = HeadPart.GetHeadPart(SavedHair_15)	
		
		;more original styles
		HairStages[16] = HeadPart.GetHeadPart(SavedHair_16)	
		HairStages[17] = HeadPart.GetHeadPart(SavedHair_17)	
		HairStages[18] = HeadPart.GetHeadPart(SavedHair_18)	
		HairStages[19] = HeadPart.GetHeadPart(SavedHair_19)	
		HairStages[20] = HeadPart.GetHeadPart(SavedHair_20)	
		
	
		;RESTORE Hair				
		if !DefeatQuestRunning && !CivilRapeRunning		;restore original hair (outside of the quests running)


			;ShowDebugNotification("Naked Defeat:  RESET HAIR")
			
			;restore original hairstyle-----------------
			bool NymrasCustomHair = false
			
			if IsNymrasGame()
				
				Form a = None
				a = PlayerRef.GetWornForm(0x00001000)
				HeadPart CustomHairStages 
				;/
				if (a.GetName() == "Dragonplate Crown") 		
				NymrasCustomHair = true	
					if D100(50)					
					CustomHairStages = HeadPart.GetHeadPart("_DINT_SG_hairsidebraidsHDT")	
					PlayerRef.ChangeHeadPart(CustomHairStages) 
					InfoMessage("Nymra, your new Hairstyle: _DINT_SG_hairsidebraidsHDT")
					else
					CustomHairStages = HeadPart.GetHeadPart("_DINT_KS_EquanimityHDT")	
					PlayerRef.ChangeHeadPart(CustomHairStages) 
					InfoMessage("Nymra, your new Hairstyle: _DINT_KS_EquanimityHDT")
					endif
				
				elseif (a.GetName() == "Steel Sallet") 
				NymrasCustomHair = true	
					if D100(75)					
					CustomHairStages = HeadPart.GetHeadPart("_DINT_SG_hairsidebraidsHDT")	
					PlayerRef.ChangeHeadPart(CustomHairStages) 
					InfoMessage("Nymra, your new Hairstyle: _DINT_SG_hairsidebraidsHDT")
					else
					CustomHairStages = HeadPart.GetHeadPart("HairFemaleImperial1")	
					PlayerRef.ChangeHeadPart(CustomHairStages) 
					InfoMessage("Nymra, your new Hairstyle: HairFemaleImperial1")
					endif
					
				else
				/;	
				;NEW SE:
				NymrasCustomHair = true
				HairStages = new HeadPart[19]	

				HairStages[0] = HeadPart.GetHeadPart("KSSMP_Veneris")	
				HairStages[1] = HeadPart.GetHeadPart("KSSMP_hairsidebraids")	
				HairStages[2] = HeadPart.GetHeadPart("KSSMP_Tsugumi3")	
				HairStages[3] = HeadPart.GetHeadPart("KSSMP_ColdHeart")			
				HairStages[4] = HeadPart.GetHeadPart("KSSMP_GuineaPig")	
				HairStages[5] = HeadPart.GetHeadPart("KSSMP_Wing109")			;OO
				HairStages[6] = HeadPart.GetHeadPart("KSSMP_Equanimity")		
				HairStages[7] = HeadPart.GetHeadPart("KSSMP_Mhysa")	
				HairStages[8] = HeadPart.GetHeadPart("")	
				HairStages[9] = HeadPart.GetHeadPart("")					;			ApachiiHairHuman91 zu edel
				HairStages[10] = HeadPart.GetHeadPart("")		;new Ponytail		;			ApachiiHairHuman64	too high on head	
				HairStages[11] = HeadPart.GetHeadPart("")			;			ApachiiHairHuman38 too high on head	
				HairStages[12] = HeadPart.GetHeadPart("KSSMP_Daydream")		;OO
				HairStages[13] = HeadPart.GetHeadPart("KSSMP_Tsugumi2")		;OOO
				HairStages[14] = HeadPart.GetHeadPart("KSSMP_Tsugumi1")		;OOO
				HairStages[15] = HeadPart.GetHeadPart("KSSMP_CrayLove")		
				HairStages[16] = HeadPart.GetHeadPart("KSSMP_Wing1111")		;OOO	
				HairStages[17] = HeadPart.GetHeadPart("KSSMP_Peach")			;OOO

				int i = Utility.RandomInt (0,18)
					
				;/
				OLD:
				NymrasCustomHair = true
				HairStages = new HeadPart[19]	

				HairStages[0] = HeadPart.GetHeadPart("_DINT_KS_VenerisHDT")	
				HairStages[1] = HeadPart.GetHeadPart("_DINT_SG_hairsidebraidsHDT")	
				HairStages[2] = HeadPart.GetHeadPart("_DINT_KSTsugumi3HDT")	
				HairStages[3] = HeadPart.GetHeadPart("_DINT_HG_ColdHeartHDT")			
				HairStages[4] = HeadPart.GetHeadPart("_DINT_HG_GuineaPigHDT")	
				HairStages[5] = HeadPart.GetHeadPart("_DINT_HG_Wing109HDT")			;OO
				HairStages[6] = HeadPart.GetHeadPart("_DINT_KS_EquanimityHDT")		
				HairStages[7] = HeadPart.GetHeadPart("_DINT_KS_MhysaHDT")	
				HairStages[8] = HeadPart.GetHeadPart("_DINT_KS_KaysaHDT")	
				HairStages[9] = HeadPart.GetHeadPart("_DINT_KS_CambrianHDT")					;			ApachiiHairHuman91 zu edel
				HairStages[10] = HeadPart.GetHeadPart("_DINT_KSTsugumi2HDT")				;			ApachiiHairHuman64	too high on head	
				HairStages[11] = HeadPart.GetHeadPart("_DINT_KSTsugumi2HDT")			;			ApachiiHairHuman38 too high on head	
				HairStages[12] = HeadPart.GetHeadPart("_DINT_KS_DaydreamHDT")		;OO
				HairStages[13] = HeadPart.GetHeadPart("_DINT_KSTsugumi2HDT")		;OOO
				HairStages[14] = HeadPart.GetHeadPart("_DINT_KSTsugumi1HDT")		;OOO
				HairStages[15] = HeadPart.GetHeadPart("_DINT_KSCrayLoveHDT")		
				HairStages[16] = HeadPart.GetHeadPart("_DINT_HG_Wing1111HDT")		;OOO	
				HairStages[17] = HeadPart.GetHeadPart("_DINT_HG_PeachHDT")			;OOO
				HairStages[18] = HeadPart.GetHeadPart("_DINT_KS_CambrianHDT")		;OO			_DINT_HG_GorumHDT ---> NO
				
			
				int i = Utility.RandomInt (0,18)
				/;
				

				PlayerRef.ChangeHeadPart(HairStages[i]) 
				NymMessage("NYMRA - Your new Hairstyle: "+HairStages[i].GetName())
		
				;endif
			;for dragon crown ;CHANGE(WIP)
										
												
			endif				
			
			if NymrasCustomHair	
			NymrasCustomHair = false
			else
				
				if D100(10)
				PlayerRef.ChangeHeadPart(HairStages[0]) 
				InfoMessage("Your new Hairstyle: "+HairStages[0].GetName())
				;Debug.Notification("Your new Hairstyle: "+HairStages[0].GetName())
				;new original hairstyle variants
				else 
				int h = Utility.RandomInt(11,20)	
				;validate hairstyle change
					if GetCurrentHair() == HairStages[h]
					int i = 0
						if h == 20
						i = 19
						else
						i = h+1
						endif
					PlayerRef.ChangeHeadPart(HairStages[i]) 
					InfoMessage("Your new Hairstyle: "+HairStages[i].GetName())
					;Debug.Notification("Your new Hairstyle: "+HairStages[i].GetName())
					else
					PlayerRef.ChangeHeadPart(HairStages[h]) 
					InfoMessage("Your new Hairstyle: "+HairStages[h].GetName())
					;Debug.Notification("Your new Hairstyle: "+HairStages[h].GetName())
					endif
				
				;	if ShowDebugMessages
				;	Debug.Notification("Naked Defeat configquest: Original hair = "+HairStages[h].GetName())
				;	Debug.trace("Naked Defeat configquest: Original hair = "+HairStages[h].GetName())
				;	Debug.Notification("Naked Defeat configquest: Current hair = "+hair.GetName())
				;	Debug.trace("Naked Defeat configquest: Current hair = "+hair.GetName())
				;	endif
					
					endif
			endif
			;restore original hairstyle-----------------	
			
		;ResetHair = false		;add check if the hairstyle really changed?

		;FORCED Hair
		else	
		;Debug.Notification("Naked Defeat configquest: CHANGE HAIR")

		;ScreenMessage("They mess with your hair!")		
				;Debug.Notification("<font color='#ff0000'>They mess with your hair!</font>")
					;Debug.trace("NAKED DEFEAT calmquest: (#msg) They mess with your hair!")

			;HARD CODED NYMRAS SLAVE HAIR	
			if IsNymrasGame()
			;NymrasCustomHair = true
				
			;/ OLD LE ---- EXTRACT AS MUCH AS POSSIBLE
				HairStages = new HeadPart[22]	

				HairStages[0] = HeadPart.GetHeadPart("_DINT_SG_hairWildSoulHDT")		;OOO long, very wild
				HairStages[1] = HeadPart.GetHeadPart("_DINT_KSTAmberLightsHDT")			;very long, open
				HairStages[2] = HeadPart.GetHeadPart("_DINT_KSCaramellaHDT")			;long, open
				HairStages[3] = HeadPart.GetHeadPart("_DINT_KSEdenHDT")					;long, open
				HairStages[4] = HeadPart.GetHeadPart("_DINT_SG_hairWildSoulHDT")			;				NO__DINT_HG_GuineaPigHDT	twin ponytail
				HairStages[5] = HeadPart.GetHeadPart("_DINT_SG_hairpg4385HDT")		;				NO _DINT_HG_LetsFrompiNuHDT  merida 
				HairStages[6] = HeadPart.GetHeadPart("_DINT_KSSunshineHDT")				;long, open, elegant
				HairStages[7] = HeadPart.GetHeadPart("_DINT_KS_SleeperHDT")			;very long ;_DINT_KS_SteammistHDTFUCKIGN ANIME SHIT 
				HairStages[8] = HeadPart.GetHeadPart("_DINT_KS_Skyo84HDT")				;long, open, elegant
				HairStages[9] = HeadPart.GetHeadPart("_DINT_KSVenusHDT")				;long, open, curly
				HairStages[10] = HeadPart.GetHeadPart("_DINT_KSAnchorHDT")				;long, open, onesided
				HairStages[11] = HeadPart.GetHeadPart("_DINT_KS_AquariaHDT")			;long, open, onesided		
				HairStages[12] = HeadPart.GetHeadPart("_DINT_KS_Butterfly098HDT")		;long, open, onesided
				HairStages[13] = HeadPart.GetHeadPart("_DINT_KS_Butterfly098HDT")				;long, open, braids, slightly wild ;NAH "_DINT_KS_CloverHDT"
				HairStages[14] = HeadPart.GetHeadPart("_DINT_KSRunawayHDT")				;long, open, slidly wild
				HairStages[15] = HeadPart.GetHeadPart("_DINT_KSHelloHDT")				;long, open, curly, slightly wild
				HairStages[16] = HeadPart.GetHeadPart("_DINT_KS_PeppermindHDT")			;curly, slightly wild
				HairStages[17] = HeadPart.GetHeadPart("_DINT_KS_HourglassHDT")			;slighly wild
				HairStages[18] = HeadPart.GetHeadPart("_DINT_KS_GlowHDT")				;long. open, slighly wild
				HairStages[19] = HeadPart.GetHeadPart("_DINT_KSTemptressHDT")			;long, open, curly, slightly wild
				HairStages[20] = HeadPart.GetHeadPart("_DINT_KSTitaniummHDT")			;verylong, open, curly, braids, slightly wild
				HairStages[21] = HeadPart.GetHeadPart("_DINT_KS_SleeperHDT")			;slghtly wild
				
/;


				HairStages = new HeadPart[22]	
				HairStages[0] = HeadPart.GetHeadPart("_d02HW_16BH")						;LONG
				HairStages[1] = HeadPart.GetHeadPart("_d02HW_16H")			;very long, open
				HairStages[2] = HeadPart.GetHeadPart("_d02HW_13H")			;long, open
				HairStages[3] = HeadPart.GetHeadPart("_d02HW_12H")					;long, open
				HairStages[4] = HeadPart.GetHeadPart("_DINT_SG_hairWildSoulHDT")			;				NO__DINT_HG_GuineaPigHDT	twin ponytail
				HairStages[5] = HeadPart.GetHeadPart("_DINT_SG_hairpg4385HDT")		;				NO _DINT_HG_LetsFrompiNuHDT  merida 
				HairStages[6] = HeadPart.GetHeadPart("_DINT_KSSunshineHDT")				;long, open, elegant
				HairStages[7] = HeadPart.GetHeadPart("_DINT_KS_SleeperHDT")			;very long ;_DINT_KS_SteammistHDTFUCKIGN ANIME SHIT 
				HairStages[8] = HeadPart.GetHeadPart("_DINT_KS_Skyo84HDT")				;long, open, elegant
				HairStages[9] = HeadPart.GetHeadPart("_DINT_KSVenusHDT")				;long, open, curly
				HairStages[10] = HeadPart.GetHeadPart("_DINT_KSAnchorHDT")				;long, open, onesided
				HairStages[11] = HeadPart.GetHeadPart("_DINT_KS_AquariaHDT")			;long, open, onesided		
				HairStages[12] = HeadPart.GetHeadPart("_DINT_KS_Butterfly098HDT")		;long, open, onesided
				HairStages[13] = HeadPart.GetHeadPart("_DINT_KS_Butterfly098HDT")				;long, open, braids, slightly wild ;NAH "_DINT_KS_CloverHDT"
				HairStages[14] = HeadPart.GetHeadPart("_DINT_KSRunawayHDT")				;long, open, slidly wild
				HairStages[15] = HeadPart.GetHeadPart("_DINT_KSHelloHDT")				;long, open, curly, slightly wild
				HairStages[16] = HeadPart.GetHeadPart("_DINT_KS_PeppermindHDT")			;curly, slightly wild
				HairStages[17] = HeadPart.GetHeadPart("_DINT_KS_HourglassHDT")			;slighly wild
				HairStages[18] = HeadPart.GetHeadPart("_DINT_KS_GlowHDT")				;long. open, slighly wild
				HairStages[19] = HeadPart.GetHeadPart("_DINT_KSTemptressHDT")			;long, open, curly, slightly wild
				HairStages[20] = HeadPart.GetHeadPart("_DINT_KSTitaniummHDT")			;verylong, open, curly, braids, slightly wild
				HairStages[21] = HeadPart.GetHeadPart("_DINT_KS_SleeperHDT")			;slghtly wild
				;also arrange some nice slave styles?

				;_DINT_HG_NoFraudsHDT , veeery long and clean
				;_DINT_KS_DAWNHDT , zu volumins
				int i = Utility.RandomInt(0,21)
				
			;	if D100(25)  		;just the best slave hair
			;	i = 0
			;	elseif (DefeatTypeGeneral == "AreAnimals") || (DefeatTypeGeneral == "AreHumanoids")
			;	i = Utility.RandomInt(13,21)
			;	else ;Humans basically
			;	i = Utility.RandomInt(1,21)
			;	endif

				PlayerRef.ChangeHeadPart(HairStages[i]) 
				NymMessage("NYMRA - Your new Slave Hairstyle: "+HairStages[i].GetName())
						
			else			
				int h = Utility.RandomInt(1,10)	
				;validate hairstyle change
				if GetCurrentHair() == HairStages[h]
				int i = 0
					if h == 10
					i = 9
					else
					i = h+1
					endif
				PlayerRef.ChangeHeadPart(HairStages[i]) 
				else
				PlayerRef.ChangeHeadPart(HairStages[h]) 
				endif

					;if ShowDebugMessages
					;	Debug.Notification("Naked Defeat configquest: New hair = "+HairStages[1].GetName())
					;	Debug.trace("Naked Defeat configquest: New hair = "+HairStages[1].GetName())
						;Debug.Notification("Naked Defeat configquest: New hair = "+HairStages[h].GetName())
						InfoMessage("Naked Defeat configquest: New hair = "+HairStages[h].GetName())
			endIf
			;	endif
		;ResetHair = true
		endif
	endif 
EndFunction

		
Bool Function RegrowHair()
		; return values
		; false = cycle must be continued
		; true = cycle must be finished

			Int j = GetLastHairStageIndex()
			HeadPart orghair = HairStages[j]
			HeadPart oldhair = GetCurrentHair()
			HeadPart newhair = None
			Int i = GetHairIndex(oldhair, j) + 1
			if (i > 0) && (i <= j)
				newhair = HairStages[i]
			endif

			if oldhair && newhair && (oldhair != newhair)
				PlayerRef.ChangeHeadPart(newhair)
				if newhair == orghair
					ScreenMessage("Your hair has grown back fully.")
				else
					ScreenMessage("Your hair has grown back a little bit.")
				endif
			endif	
			Bool r = !oldhair || !newhair || (newhair == orghair)
			if r
				HairStages[j] = None
			endif

			if ShowDebugMessages
				if orghair
					InfoMessage("Original hair = "+orghair.GetName())
				else
					InfoMessage("Original hair = None")
				endif	
				if oldhair
					InfoMessage("Current hair = "+oldhair.GetName())
				else
					InfoMessage("Current hair = None")
				endif	
				if newhair
					InfoMessage("New hair = "+newhair.GetName())
				else
					InfoMessage("New hair = None")
				endif
				InfoMessage("END OF HAIR GROWTH CYCLE = "+r)
			endif

			return r
	
		
		
		;/		
		if !HairStages[0]
		ScreenMessage("Naked Defeat configquest: Original Hair is empty or not compatible (check support thread)")
		endif	
		if !HairStages[1]
		ScreenMessage("Naked Defeat configquest: SavedHair_01 is empty or not compatible (check FAQ)")
		endif
		if !HairStages[2]
		ScreenMessage("Naked Defeat configquest: SavedHair_02 is empty or not compatible (check FAQ)")
		endif
		if !HairStages[3]
		ScreenMessage("Naked Defeat configquest: SavedHair_03 is empty or not compatible (check FAQ)")
		endif
		if !HairStages[4]
		ScreenMessage("Naked Defeat configquest: SavedHair_04 is empty or not compatible (check FAQ)")
		endif
		if !HairStages[5]
		ScreenMessage("Naked Defeat configquest: SavedHair_05 is empty or not compatible (check FAQ)")
		endif
		if !HairStages[6]
		ScreenMessage("Naked Defeat configquest: SavedHair_06 is empty or not compatible (check FAQ)")
		endif
		if !HairStages[7]
		ScreenMessage("Naked Defeat configquest: SavedHair_07 is empty or not compatible (check FAQ)")
		endif
		if !HairStages[8]
		ScreenMessage("Naked Defeat configquest: SavedHair_08 is empty or not compatible (check FAQ)")
		endif
		if !HairStages[9]
		ScreenMessage("Naked Defeat configquest: SavedHair_09 is empty or not compatible (check FAQ)")
		endif
		if !HairStages[10]
		ScreenMessage("Naked Defeat configquest: SavedHair_10 is empty or not compatible (check FAQ)")
		endif
		/;
		
	;	HairStages[0] = HeadPart.GetHeadPart("HairFemaleRedguard03")	;bald
	;	HairStages[1] = HeadPart.GetHeadPart("HairFemaleRedguard04")	;very short
	;	HairStages[2] = HeadPart.GetHeadPart("HairFemaleImperial1")		;short
	;	HairStages[3] = None											;original
			
	;	Debug.Notification("Naked Defeat configquest: SavedHair00 = "+SavedHair_00)
	;	Debug.Notification("Naked Defeat configquest: SavedHair01 = "+SavedHair_01)
	;	Debug.Notification("Naked Defeat configquest: HairStages[0] = "+HairStages[0].GetName())
	;	Debug.Notification("Naked Defeat configquest: HairStages[1] = "+HairStages[1].GetName())
		;Debug.trace("Naked Defeat configquest: Current hair = "+hair.GetName()+", HAIRCUT SUCCESSFUL")		
			
	
	
EndFunction

String PlayerGender = "none"
Bool Property Gagged Auto



Function PlayMoan()			;is started via "OnMoan"

		;WHIPPING MOAN 					
		if Whipagain && D100(MoanOnHitChance)
			if D100(66) 
			SexlabMoan(PlayerRef)	
			else		
			PlaySound()
			endif
			
		elseif IsNymrasGame() && PlayerRef.IsInCombat() ; && D100(MoanOnHitChance) 	
			SexlabMoan(PlayerRef)
			
		;COMBAT MOAN
		elseif PlayerRef.IsInCombat() && D100(MoanOnHitChance) 
			if D100(66) 
			SexlabMoan(PlayerRef)
			else		
			PlaySound()
			endif
	
		;NORMAL MOAN (active call)
		elseif DefeatQuestRunning || CivilRapeRunning					
			if D100(80) 
			SexlabMoan(PlayerRef)	
			else		
			PlaySound()
			endif	
		endif

EndFunction

Function PlayGagged()
	Debug.Trace("NAKED DEFEAT configquest: PlayGagged()")	
	
	if PlayerGender == "none"
		if Sexlab.GetGender(PlayerRef) == 0
		PlayerGender = "male"
		Debug.Trace("NAKED DEFEAT configquest: PlayGagged(male)")
		else
		PlayerGender = "female"
		Debug.Trace("NAKED DEFEAT configquest: PlayGagged(female)")
		endif
	endif
		
	if PlayerGender == "female" 	
	SoundGagFemale[0].Play(PlayerRef)
	elseif PlayerGender == "male"
	SoundGagMale[0].Play(PlayerRef)
	endif
		
EndFunction

Function PlayOrgasm()
SoundOrgasmFemale[0].Play(PlayerRef)
EndFunction

Function PlaySound()
		Breathing[0].Play(PlayerRef)
EndFunction


Function PlayBreathingSound()
		Breathing[0].Play(PlayerRef)
EndFunction

Function PlayMoaningSound()
		SexlabMoan(PlayerRef)
EndFunction

Function PlaySoundFuckBelt()
			SoundFuckBelt[0].Play(PlayerRef)	
EndFunction

Function PlayCuffsSoundMetal()
			SoundCuffsMetal[0].Play(PlayerRef)
EndFunction

Function PlayCuffsSoundRope()
			SoundCuffsRope[0].Play(PlayerRef)
EndFunction

Function PlaySoundPeeLong()
			SoundPeeLong[0].Play(PlayerRef)
EndFunction

Function PlaySoundPeeShort()
			SoundPeeShort[0].Play(PlayerRef)
EndFunction

Function PlayProximitySound()
			SoundProximity[0].Play(PlayerRef)
EndFunction

Function PlayCombatBlockingSound()
			SoundCombat2[0].Play(PlayerRef)
EndFunction

Function PlayCombatStrippingSound()
			SoundCombat2[1].Play(PlayerRef)
EndFunction


bool Function PlayerInCombat()
if PlayerRef.IsInCombat() 
return true
else
return false
endif
EndFunction


;/
;------------------------------ WHIP THAT ASS start -------------------------------------------------------------------------------

Int[] Property WhipTracking			;AssSpankTracking
    Int[] Function Get()
        Return WhipCounter			;AssSpankCounter
    EndFunction
EndProperty

Float Property Intensity = 0.0 Auto Hidden Conditional		;IntensityAss

Float Property MaxIntensity = 1.0 Auto Hidden ; Needs MCM Setting		;MaxAssIntensity

Int Property SpanksToMaxIntensity = WhipmarksDur Auto Hidden      ; this should mean: 1 spank = +12 hours

Int SpankCounterLimit = WhipmarksDur ; Number of hours to consider. Also equals array size
									;will this set the right thing? omg
Function DoGameTimeUpdate()
	Float CurrentTime = Utility.GetCurrentGameTime()
	Int NumOfHours = Math.Floor((CurrentTime - LastUpdate) / 0.041667)
	Debug.Trace("NAKED DEFEAT: Waited " + NumOfHours + " hours ===============================================================================================")

	HealSpanks(NumOfHours, false)
	
	ShiftIntArrayLeft(WhipCounter, WhipCounterLimit, NumOfHours)
;	ShiftIntArrayLeft(TitsSpankCounter, SpankCounterLimit, NumOfHours)
		
	Intensity = GetOverlayIntensity(WhipCounter)
;	IntensityTits = GetOverlayIntensity(TitsSpankCounter)
	
	; Update Alphas
	UpdateAlpha(PlayerRef, Intensity, "\\SL Survival\\spanky\\spank_ass_light.dds", "Body")
;	UpdateAlpha(PlayerRef, IntensityTits, "\\SL Survival\\spanky\\spank_breasts_light.dds", "Body")
	
	
	
;	AdjustMasochismAttitude(CurrentTime)
;	SexDialog.ApplyPainEffect()
	LastUpdate = CurrentTime
EndFunction

Function HealSpanks(Int NumOfHours, Bool ForceUpdate = false)
	If SpanksToHeal > 0
		Int NumOfHoursHealing
		If !ForceUpdate ; First application of balm is a freebie
			NumOfHoursHealing = Math.Ceiling(SpanksToHeal / Menu.SpanksHealedDecay)
			If NumOfHours < NumOfHoursHealing
				NumOfHoursHealing = NumOfHours
				SpanksToHeal -= (NumOfHours * Menu.SpanksHealedDecay)
			Else
				SpanksToHeal = 0.0
			EndIf
		Else
			NumOfHoursHealing = 1
		EndIf
		
		Int SpankTemp
	;	SpankTemp = AssSpankCounter[SpankCounterLimit - 1] - Utility.RandomInt(Math.Floor(SpanksToHeal), Math.Ceiling(SpanksToHeal))
	;	If SpankTemp < 0
	;		SpankTemp = 0
	;	EndIf
	;	AssSpankCounter[SpankCounterLimit - 1] = SpankTemp
		
		SpankTemp = WhipCounter[SpankCounterLimit - 1] - Utility.RandomInt(Math.Floor(SpanksToHeal), Math.Ceiling(SpanksToHeal))
		If SpankTemp < 0
			SpankTemp = 0
		EndIf
		WhipCounter[SpankCounterLimit - 1] = SpankTemp
		
		If !ForceUpdate ; First application of balm does not affect old spanks
			DecArrayAll(WhipCounter, NumOfHoursHealing)
		;	DecArrayAll(TitsSpankCounter, NumOfHoursHealing)
			UpdateBalmEffect()
		EndIf

		If ForceUpdate ; Normally, DoGameTimeUpdate() will handle updating the overlays. Only used when balm first applied
			Intensity = GetOverlayIntensity(WhipCounter)
			UpdateAlpha(PlayerRef, Intensity, "\\SL Survival\\spanky\\spank_ass_light.dds", "Body")
		;	IntensityTits = GetOverlayIntensity(TitsSpankCounter)
		;	UpdateAlpha(PlayerRef, IntensityTits, "\\SL Survival\\spanky\\spank_breasts_light.dds", "Body")
		;	SexDialog.ApplyPainEffect()
		EndIf
	EndIf
EndFunction

Function PlayerLoadsGame()
;	CheckDependencies()
	Intensity = GetOverlayIntensity(WhipCounter)
;	IntensityTits = GetOverlayIntensity(TitsSpankCounter)
	UpdateAlpha(PlayerRef, Intensity, "\\SL Survival\\spanky\\spank_ass_light.dds", "Body")
;	UpdateAlpha(PlayerRef, IntensityTits, "\\SL Survival\\spanky\\spank_breasts_light.dds", "Body")
;	SexDialog.ApplyPainEffect()
;	RegEvents()
EndFunction

Float Function GetOverlayIntensity(Int[] ArraySelect)
	Float IntensityTemp = 0.0
	Float AgeFactor
	Int i = SpankCounterLimit
	Float SpankCounterLimitAsFloat = SpankCounterLimit as Float
	While i >= 0
		AgeFactor = (i / SpankCounterLimitAsFloat)
		;Debug.Messagebox("i: " + i + ". AgeFactor: " + AgeFactor)
		IntensityTemp += (AgeFactor * AgeFactor * AgeFadeFactor) * ArraySelect[i]
		;Debug.Trace("_STA_: Spanky: i: " + i + ". SpankCounterLimitAsFloat: " + SpankCounterLimitAsFloat + ". AgeFactor: " + AgeFactor + ". Spanks: " + ArraySelect[i])
		i -= 1
	EndWhile
	IntensityTemp = (IntensityTemp / SpanksToMaxIntensity)
	If IntensityTemp > 1.0
		IntensityTemp = 1.0
	EndIf
	
	; Cap intensity
	If ArraySelect == WhipCounter
		IntensityTemp *= MaxIntensity
;	ElseIf ArraySelect == TitsSpankCounter
;		IntensityTemp *= MaxTitsIntensity
	EndIf
	Debug.Trace("NAKED DEFEAT: IntensityTemp: " + IntensityTemp)
	Return IntensityTemp
EndFunction

Int Function GetNumSlots(String Area)
	If Area == "Body"
		Return NiOverride.GetNumBodyOverlays()
	ElseIf Area == "Face"
		Return NiOverride.GetNumFaceOverlays()
	ElseIf Area == "Hands"
		Return NiOverride.GetNumHandOverlays()
	Else
		Return NiOverride.GetNumFeetOverlays()
	EndIf
EndFunction

Function RemoveOverlay(Actor akTarget, String TextureToRemove, String Area)
	Debug.Trace("_STA_: RemoveOverlay : " + TextureToRemove + " called on " + akTarget.GetLeveledActorBase().GetName() + " from area: " + Area)
	Bool Gender = akTarget.GetLeveledActorBase().GetSex() as Bool
	String TexPath
	Int j = 0
	While j < GetNumSlots(Area)
		String Node = Area + " [ovl" + j + "]"
		TexPath = NiOverride.GetNodeOverrideString(akTarget, Gender, Node, 9, 0)
		If TexPath == TextureToRemove
			NiOverride.AddNodeOverrideString(akTarget, Gender, Node, 9, 0, "actors\\character\\overlays\\default.dds", true)
			NiOverride.RemoveNodeOverride(akTarget, Gender, Node, 9, 0)
			NiOverride.RemoveNodeOverride(akTarget, Gender, Node, 7, -1)
			NiOverride.RemoveNodeOverride(akTarget, Gender, Node, 0, -1)
			NiOverride.RemoveNodeOverride(akTarget, Gender, Node, 8, -1)
			NiOverride.RemoveNodeOverride(akTarget, Gender, Node, 2, -1)
			NiOverride.RemoveNodeOverride(akTarget, Gender, Node, 3, -1)

			Debug.Trace("_STA_: Removing overlay from slot " + j + " of area: " + Area + " on " + akTarget.GetLeveledActorBase().GetName())
		EndIf
		j += 1
	EndWhile
EndFunction

Int Function GetSpankOverlaySlot(Actor akTarget, String TextureToUpdate, String Area)
	String Node
	Bool Result = false	
	Bool Gender = akTarget.GetLeveledActorBase().GetSex() as Bool
	String MatchString = TextureToUpdate
	Int j = GetNumSlots(Area)
	While j > 0 && !Result
		j -= 1
		Node = Area + " [ovl" + j + "]"
		If NiOverride.GetNodeOverrideString(akTarget, Gender, Node, 9, 0) == MatchString
			Return j
		EndIf
	EndWhile
	Return -1
EndFunction

Function UpdateAlpha(Actor akTarget, Float Alpha, String TextureToUpdate, String Area)
	Int SpankSlot = GetSpankOverlaySlot(akTarget, TextureToUpdate, Area)
	If SpankSlot == -1
		BeginOverlay(akTarget, Alpha, TextureToUpdate, Area)
		SpankSlot = GetSpankOverlaySlot(akTarget, TextureToUpdate, Area)
		If SpankSlot == -1
			Debug.Trace("_STA_: Spanky: Critical error getting spank overlay slot")
			Return
		EndIf
	EndIf

	Debug.Trace("_STA_: Spanky: Update alpha on " + akTarget.GetBaseObject().GetName() + " to " + Alpha)
	String Node = Area + " [ovl" + SpankSlot + "]"
	Bool Gender = akTarget.GetLeveledActorBase().GetSex() as Bool
	NiOverride.AddNodeOverrideFloat(akTarget, Gender, Node, 8, -1, Alpha, TRUE)
EndFunction

Int Function GetEmptySlot(Actor akTarget, Bool Gender, String Area)
	Int i = GetNumSlots(Area)
	String TexPath
	While i > 0
		i -= 1
		TexPath = NiOverride.GetNodeOverrideString(akTarget, Gender, Area + " [ovl" + i + "]", 9, 0)
		If TexPath == "" || TexPath == "actors\\character\\overlays\\default.dds"
			Debug.Trace("_STA_: GetEmptySlot: Slot " + i + " chosen for area: " + area + " on " + akTarget.GetBaseObject().GetName())
			Return i
		EndIf
	EndWhile
	Debug.Trace("_STA_: GetEmptySlot: Error: Could not find a free slot in area: " + Area + " on "  + akTarget.GetBaseObject().GetName())
	Return -1
EndFunctionFunction BeginOverlay(Actor akTarget, Float Alpha, String TextureToApply, String Area)
	Bool Gender = akTarget.GetLeveledActorBase().GetSex() as Bool
	Debug.Trace("_STA_: Spanky: Applying " + TextureToApply + " to " + akTarget.GetBaseObject().GetName())
	ReadyOverlay(akTarget, Gender, Area, TextureToApply, Alpha)
EndFunction

Function ReadyOverlay(Actor akTarget, Bool Gender, String Area, String TextureToApply, Float Alpha)
	Int SlotToUse = GetEmptySlot(akTarget, Gender, Area)
	If SlotToUse != -1
		ApplyOverlay(akTarget, Gender, Area, SlotToUse, TextureToApply, Alpha)
	Else
		Debug.Trace("_STA_: Spanky: Error applying overlay to area: " + Area)
	EndIf
EndFunction

Function ApplyOverlay(Actor akTarget, Bool Gender, String Area, String OverlaySlot, String TextureToApply, Float Alpha)
	String Node = Area + " [ovl" + OverlaySlot + "]"
	If !NiOverride.HasOverlays(akTarget)
		NiOverride.AddOverlays(akTarget)
	EndIf
	NiOverride.AddNodeOverrideString(akTarget, Gender, Node, 9, 0, TextureToApply, TRUE)
	NiOverride.AddNodeOverrideInt(akTarget, Gender, Node, 0, 0, 0, TRUE)
	NiOverride.AddNodeOverrideInt(akTarget, Gender, Node, 7, 0, 0, TRUE)
	
	NiOverride.AddNodeOverrideInt(akTarget, Gender, Node, 7, -1, 0, TRUE)
    NiOverride.AddNodeOverrideInt(akTarget, Gender, Node, 0, -1, 0, TRUE)
    NiOverride.AddNodeOverrideFloat(akTarget, Gender, Node, 8, -1, Alpha, TRUE)
	NiOverride.AddNodeOverrideFloat(akTarget, Gender, Node, 2, -1, 0.0, TRUE)
	NiOverride.AddNodeOverrideFloat(akTarget, Gender, Node, 3, -1, 0.0, TRUE)
	NiOverride.ApplyNodeOverrides(akTarget)
EndFunction

Function BeginOverlay(Actor akTarget, Float Alpha, String TextureToApply, String Area)
	Bool Gender = akTarget.GetLeveledActorBase().GetSex() as Bool
	Debug.Trace("_STA_: Spanky: Applying " + TextureToApply + " to " + akTarget.GetBaseObject().GetName())
	ReadyOverlay(akTarget, Gender, Area, TextureToApply, Alpha)
EndFunction

Function ReadyOverlay(Actor akTarget, Bool Gender, String Area, String TextureToApply, Float Alpha)
	Int SlotToUse = GetEmptySlot(akTarget, Gender, Area)
	If SlotToUse != -1
		ApplyOverlay(akTarget, Gender, Area, SlotToUse, TextureToApply, Alpha)
	Else
		Debug.Trace("_STA_: Spanky: Error applying overlay to area: " + Area)
	EndIf
EndFunction

Function ApplyOverlay(Actor akTarget, Bool Gender, String Area, String OverlaySlot, String TextureToApply, Float Alpha)
	String Node = Area + " [ovl" + OverlaySlot + "]"
	If !NiOverride.HasOverlays(akTarget)
		NiOverride.AddOverlays(akTarget)
	EndIf
	NiOverride.AddNodeOverrideString(akTarget, Gender, Node, 9, 0, TextureToApply, TRUE)
	NiOverride.AddNodeOverrideInt(akTarget, Gender, Node, 0, 0, 0, TRUE)
	NiOverride.AddNodeOverrideInt(akTarget, Gender, Node, 7, 0, 0, TRUE)
	
	NiOverride.AddNodeOverrideInt(akTarget, Gender, Node, 7, -1, 0, TRUE)
    NiOverride.AddNodeOverrideInt(akTarget, Gender, Node, 0, -1, 0, TRUE)
    NiOverride.AddNodeOverrideFloat(akTarget, Gender, Node, 8, -1, Alpha, TRUE)
	NiOverride.AddNodeOverrideFloat(akTarget, Gender, Node, 2, -1, 0.0, TRUE)
	NiOverride.AddNodeOverrideFloat(akTarget, Gender, Node, 3, -1, 0.0, TRUE)
	NiOverride.ApplyNodeOverrides(akTarget)
EndFunction

Function ShiftIntArrayLeft(Int[] ArraySelect, Int ArrayLength, Int NumOfHours)

	Int CurrentSpanks = ArraySelect[ArrayLength - 1]
	
	; Shift array left by NumOfHours
	Int i = 0
	While i < (ArrayLength - 1) - NumOfHours
		ArraySelect[i] = ArraySelect[i+NumOfHours]
		i += 1
	EndWhile
	
	; Save Current spanks
	If i < ArrayLength
		ArraySelect[i] = CurrentSpanks
		i += 1
	EndIf
	
	; Zero the rest of the array
	While i <= (ArrayLength - 1)
		ArraySelect[i] = 0
		i += 1
	EndWhile
EndFunction

;------------------------------ WHIP THAT ASS end -------------------------------------------------------------------------------
/;



;SPAWN FUNCTIONS >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

bool RestartCalmQuest = false

Function SpawnGhostsHuman()			;OLD REMOVE
;actorbase GhostTest
Debug.Trace("NAKED DEFEAT configquest: SpawnGhostsHuman")
playerref.PlaceAtMe(GhostsHuman[0], 1)
playerref.PlaceAtMe(GhostsHuman[1], 1)
playerref.PlaceAtMe(GhostsHuman[2], 1)
playerref.PlaceAtMe(GhostsHuman[3], 1)
;RestartCalmquest()

SendModEvent("StartRestartCalmQuest")

EndFunction

;ActorBase goblin
;ActorBase goblinskirmisher
;ActorBase goblinshaman
bool ActorsSpawned = false

Bool Function AreActorsSpawned()
if ActorsSpawned
return true
else
return false
endIf
EndFunction

	
;ObjectReference TempActor


Function StartRobberyAtLocation()	;#StartRobberyAtLocation() #maya 

Debug.Trace("NAKED DEFEAT configquest: StartRobberyAtLocation()")

		ObjectReference LocHostile = none
		ActorBase TempRobberyBandit
		String sLocationName
		
	;	Actor aa = pt.PlaceActorAtMe(ab, aiLevelMod)
		
		;Actor SpawnedRobber
		
		Bool NewRobberSystem = true

		int i = Utility.RandomInt(1,9)
		;WIP Need to fix the locations
		;i = 3
		
		if NewRobberSystem
		;i = 2 ;DUMB!!!!
		endif 
		
		
		if i == 1
		;SWINDLERS DEN
		LocHostile = (Game.GetFormFromFile(0x000435DA, "Skyrim.esm") As ObjectReference)	;XMarkerHeading
		sLocationName = "Swindler's Den"
		elseif i == 2
		;WHITE RIVER WATCH
		LocHostile = (Game.GetFormFromFile(0x0008132F, "Skyrim.esm") As ObjectReference)	;PatrolIdleMarker (seem to work then?)
		sLocationName = "White River Watch"
		elseif i == 3
		;REDORANS RETREAT
		LocHostile = (Game.GetFormFromFile(0x0002B02F, "Skyrim.esm") As ObjectReference)	;XMarkerHeading
		sLocationName = "Redoran's Retreat"
		
		elseif i == 4
		;Four Skull Lookout					
		LocHostile = (Game.GetFormFromFile(0x000B23AB, "Skyrim.esm") As ObjectReference)	;XMarkerHeading	
		sLocationName = "Four Skull Lookout"

		elseif i == 5
		;Bilegulch Mine		
		LocHostile = (Game.GetFormFromFile(0x000EF02C, "Skyrim.esm") As ObjectReference)	;PatrolIdleMarker
		sLocationName = "Bilegulch Mine"
			
		elseif i == 6	
		;Broken Helm Hollow		
		LocHostile = (Game.GetFormFromFile(0x0002AE50, "Skyrim.esm") As ObjectReference)	;XMarkerHeading
		sLocationName = "Broken Helm Hollow"
			
		elseif i == 7	
		;Faldar's Tooth					
		LocHostile = (Game.GetFormFromFile(0x00043706, "Skyrim.esm") As ObjectReference)	;PatrolIdleMarker
		sLocationName = "Faldar's Tooth"
		
		elseif i == 8	
		;Embershard Mine			
		LocHostile = (Game.GetFormFromFile(0x000B6FF5, "Skyrim.esm") As ObjectReference)	;XMarkerHeading	
		sLocationName = "Embershard Mine"
			
		elseif i == 9	
		;Cragslane Cavern			
		LocHostile = (Game.GetFormFromFile(0x000E160E, "Skyrim.esm") As ObjectReference)	;XMarkerHeading
		sLocationName = "Cragslane Cavern"
		
		elseif i == 10	
		;Cracked Tusk Keep			
		LocHostile = (Game.GetFormFromFile(0x000696ED, "Skyrim.esm") As ObjectReference)	;!!!!!!!!!!!!!!! TEMP STATIC 
		sLocationName = "Cracked Tusk Keep"
		
		elseif i == 11		
		;Frostmere Crypt			
		LocHostile = (Game.GetFormFromFile(0x000B2EEF, "Skyrim.esm") As ObjectReference)	;!!!!!!!!!!!!!!! TEMP STATIC 
		sLocationName = "Frostmere Crypt"
		
		elseif i == 12		
		;Fort Fellhammer						
		LocHostile = (Game.GetFormFromFile(0x000E65DF, "Skyrim.esm") As ObjectReference)	;!!!!!!!!!!!!!!! TEMP STATIC  MistLow... damn
		sLocationName = "Fort Fellhammer"
					
		elseif i == 13	
		;Robbers Cave 	
		LocHostile = (Game.GetFormFromFile(0x000EE357, "Skyrim.esm") As ObjectReference)	;!!!!!!!!!!!!!!! TEMP STATIC 
		sLocationName = "Robbers Cave"

		endif
		
		if !LocHostile
		NymMessage("#ERROR  !LocHostile = none") 
		endif 
		
		ObjectReference TempAnActor
		Actor SpawnedRobber
		
		int iChief = 0

		;#luisa
		;	0x0001B0DB 	;Bandit CHief
		;	0x0001B0DD	;Bandit CHief
		;	0x0001B0E1	;Bandit CHief
		;	0x0001B0EB	;Bandit CHief Orc
		;	0x0003DF17	;Bandit CHief	
		;	0x000E1646	;Bandit CHief
		
		;TEST: GetRobbed, Kill Robbert, GetRobbed by same guy again
		;NOTE: we cannot use the same robber again when he is already "in use" it seems
			
			iChief = Utility.RandomInt(1,5)
		;	iChief = 4
			if iChief == 1
			;TempAnActor = LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001B0DB, "Skyrim.esm"), 1) ;Bandit CHief 
			TempAnActor = LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001A341, "Skyrim.esm"), 1) ;Bandit CHief NordM LVLActor Base DONE
			elseif iChief == 2
			;TempAnActor = LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001B0DD, "Skyrim.esm"), 1) ;Bandit CHief 
			TempAnActor = LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001A33A, "Skyrim.esm"), 1) ;Bandit CHief Commoner LVLActor Base
			elseif iChief == 3
			;TempAnActor = LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001B0E1, "Skyrim.esm"), 1) ;Bandit CHief 
			TempAnActor = LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001B0FB, "Skyrim.esm"), 1) ;Bandit Wizard  LVLActor Base  done
			elseif iChief == 4
			;TempAnActor = LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001B0EB, "Skyrim.esm"), 1) ;Bandit CHief Orc	;actor
			TempAnActor = LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001B0EA, "Skyrim.esm"), 1) ;Bandit CHief Orc ;BaseObject (LvL NPC) ;DONE
			elseif iChief == 5
			;TempAnActor = LocHostile.PlaceAtMe(game.GetFormFromFile(0x0003DF17, "Skyrim.esm"), 1) ;Bandit CHief 
			TempAnActor = LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001A320, "Skyrim.esm"), 1) ;Bandit MeleeNorDM  LVLActor Base

			endif 
			
			SpawnedRobber = TempAnActor as actor
			if IsNymrasGame()
			SpawnedRobber.Moveto(PlayerRef, 150 * Math.Sin(PlayerRef.GetAngleZ()), 150 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			else			
			SpawnedRobber.Moveto(PlayerRef, -250 * Math.Sin(PlayerRef.GetAngleZ()), -250 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			endif 
			
			if IsNymrasGame()
				if SpawnedRobber
			;	NymMessage("#Robber Name: "+SpawnedRobber.GetBaseObject().GetName())
				else 
				Debug.Messagebox("#ERRROR SpawnedRobber = NONE") 
				endif 
			endif 
			SpawnedRobber.StopCombat()		
			SpawnedRobber.StopCombatAlarm()	
			SpawnedRobber.RemoveFromAllFactions()
			SpawnedRobber.AddToFaction(nade_DefeatFaction)
			;SpawnedRobber.AddToFaction(CalmFaction)
			;SpawnedRobber.AddToFaction(AllegianceFaction)
			SpawnedRobber.IsAlerted()
			SpawnedRobber.SetAlert(False)
			
			;NymTrace("#Robbery Test 01")
			;TempIntBridge = 1
			IsRobberyOnLocation = true
			StartRobbery(SpawnedRobber)
			;TempIntBridge = 0
			;NymTrace("#Robbery Test 02")
			SpawnedRobber.RemoveFromFaction(nade_DefeatFaction)
			SpawnedRobber.AddToFaction(BanditFaction)
			SpawnedRobber.AddToFaction(RobberFaction)
			SpawnedRobber.Moveto(LocHostile)
			Utility.Wait(1.0)
				
			if IsRobberyWorthIt 	
			StartRobberTrackingQuest(SpawnedRobber)
			endif 
			IsRobberyOnLocation = false
			
			;add Quest Item check, that does the tracking for us!
			
			if IsRobberyWorthIt
				if DefeatEntranceVia == "Travel Ritual Risky"
				ScreenMessage("Your stuff was teleported to some Bandits at "+sLocationName+" [Teleport Misshap]")
				InfoMessage("Robbery Tracking Quest Started to help you get your stuff back")
				else 
				ScreenMessage("Your stuff was sold to some Bandits at "+sLocationName)
				InfoMessage("Robbery Tracking Quest Started to help you get your stuff back")
				endif 
			elseif !IsRobberyWorthIt 
				if DefeatEntranceVia == "Travel Ritual Risky"
				ScreenMessage("The small amount of gear you had was teleported to some Bandits at "+sLocationName+" [Teleport Misshap] but you lose track of them.")
				InfoMessage("No Robbery Tracking Quest Started because item and gold count was so low")
				else 
				ScreenMessage("The small amount of gear you had was sold to some Bandits at "+sLocationName+" but you lose track of them.")
				InfoMessage("No Robbery Tracking Quest Started because item and gold count was so low")
				endif 
			endif 	

		;spawn extra bandits on location
		TempAnActor	= LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001AF77, "Skyrim.esm"), 1)		;
		TempAnActor	= LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001B0D5, "Skyrim.esm"), 1)		;
		TempAnActor	= LocHostile.PlaceAtMe(game.GetFormFromFile(0x00015BE5, "Skyrim.esm"), 1)		;
		TempAnActor	= LocHostile.PlaceAtMe(game.GetFormFromFile(0x0001B0BC, "Skyrim.esm"), 1)		;
	
	
EndFunction		
	
Bool IsRobberyOnLocation = false	
	
Function StartScenarioAfterlife() ;#Afterlife #StartScenarioAfterlife	#hell

	Utility.Wait(3.0)
	FadeToBlack(true)
	Utility.Wait(3.0)
	Debug.Trace("NAKED DEFEAT configquest: StartScenarioAfterlife()")
	ScreenMessage("Hellish Fiends will torture you now!")
	
	DefeatTypeScenario = "Afterlife"
	
	FadeToBlack(false)
	
	DefeatEntranceVia = "Send to Afterlife"
	
	StartDefeat()
		
EndFunction 


Function StartFastTravelScenario() ;#FastTravel #Travel
	Debug.Trace("NAKED DEFEAT configquest: StartFastTravelScenario()")

	DefeatTypeScenario = "FastTravel"
	
	FadeToBlack(false)
	
	SendModEvent("StartRestartCalmQuest")
	;RestartCalmQuest()		;4.92
		
EndFunction 

;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

		
Function PosingTest()			;##PosingTest

;if posing == "IdlesDefeatYoke"
int i = 18
Idle IdleTemp
Bool PlayOnce = false

;if Debugpunishmenttype > 0
;i = Debugpunishmenttype as int
;PlayOnce = true
;endif 

While i > 0

	;IdlesDefeatUnbound[17]		- BUGGED		16, 12, 11, 4, 9 
	;IdlesDefeatUnbound[16]		- Sitting on Ass, flat, holding stomach, hanging arms (bleedout/exhaustion), SLOW - HEELS OFF
	;IdlesDefeatUnbound[15]		- On All Fours, SLOW  HEELS OFF
	;IdlesDefeatUnbound[14]		- On All Fours, Rubbing Pussy with one hand SLOW  HEELS OFF
	;IdlesDefeatUnbound[13]		- LAYING on Side, embroynal, holding stomach SLOW  HEELS OFF
	;IdlesDefeatUnbound[12]		- On All Fours, Holding Breasts (bleedout/exhaustion) SLOW HEELS OFF
	;IdlesDefeatUnbound[11]		- SITTING, kneeling, low, hands stemmed to ground, head hanging (Bleedout/Exhaustion) SLOW HEELS OFF
	;IdlesDefeatUnbound[10]		- CROUCHING on FEET, holding breasts and rubbing pussy, looking down.SLOW
	;IdlesDefeatUnbound[9]		- Standing low, bend over, holding arm, wiggling a bit (Defeaed Exhaustion) SLOW
	;IdlesDefeatUnbound[8]		- Sitting on ass, leaning backwards, stemmed hands to the ground, legs Spead, SLOW HEELS OFF
	;IdlesDefeatUnbound[7]		- Laying on Side, arm stemmed to the ground, other arm holding stommach, SLOW HEELS OFF
	;IdlesDefeatUnbound[6]		- Standing Upright, Holding pussy and breasts SLOW
	;IdlesDefeatUnbound[5]		- LAYING on Side, embroynal, holding stomach  (DOUBLE WITH 13?) STATIC 		HEELS OFF
	;IdlesDefeatUnbound[4]		- Sitting on Ass, flat, hanging arms (bleedout/exhaustion), SLOW 			HEELS OFF
	;IdlesDefeatUnbound[3]		- STanding upright, holding breasts and ass, STRUGGLE ----> CHANGE TO WIGGLE ANIMS
	;IdlesDefeatUnbound[2]		- CORUCHING;  holding breasts STRUGGLE ----> CHANGE TO WIGGLE ANIMS
	;IdlesDefeatUnbound[1]		- Standing, leaning back, peeing, holding breasts SLOW
	;IdlesDefeatUnbound[0]		- crouching, holding breasts, leaning on knees

	i -= 1
	IdleTemp = IdlesDefeatUnbound[i]
	Debug.Messagebox ("Naked Defeat: IdlesDefeatUnbound["+i+"]")
	PlayerRef.PlayIdle(IdleTemp)	
	Utility.Wait(6.0)
	calmqst.PlayPoseOnActor(PlayerRef, "stop", false)
	Utility.Wait(2.0)
		
	if PlayOnce
	i = 0
	endif 
	
endwhile 

EndFunction 
	;/
Debug.Notification ("Naked Defeat: IdlesDefeatPillory[0]")
PlayerRef.PlayIdle(IdlesDefeatPillory[0])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)
Debug.Notification ("Naked Defeat: IdlesDefeatPillory[1]")
PlayerRef.PlayIdle(IdlesDefeatPillory[1])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)
Debug.Notification ("Naked Defeat: IdlesDefeatPillory[2]")
PlayerRef.PlayIdle(IdlesDefeatPillory[2])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)
Debug.Notification ("Naked Defeat: IdlesDefeatPillory[3]")
PlayerRef.PlayIdle(IdlesDefeatPillory[3])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)
Debug.Notification ("Naked Defeat: IdlesDefeatPillory[4]")
PlayerRef.PlayIdle(IdlesDefeatPillory[4])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPillory[5]")
PlayerRef.PlayIdle(IdlesDefeatPillory[5])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPillory[6]")
PlayerRef.PlayIdle(IdlesDefeatPillory[6])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPillory[7]")
PlayerRef.PlayIdle(IdlesDefeatPillory[7])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)
Debug.Notification ("Naked Defeat: IdlesDefeatPillory[8]")
PlayerRef.PlayIdle(IdlesDefeatPillory[8])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPillory[9]")
PlayerRef.PlayIdle(IdlesDefeatPillory[9])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPillory[10]")
PlayerRef.PlayIdle(IdlesDefeatPillory[10])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPillory]")
PlayerRef.PlayIdle(IdlesDefeatPillory[11])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPillory[12]")
PlayerRef.PlayIdle(IdlesDefeatPillory[12])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPillory[13]")
PlayerRef.PlayIdle(IdlesDefeatPillory[13])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

;Debug.Notification ("Naked Defeat: IdlesDefeatPillory[14]")
;PlayerRef.PlayIdle(IdlesDefeatPillory[14])
;Utility.Wait(6.0)

; elseif posing == "IdlesDefeatPilloryStruggle"
Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[0]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[0])
Utility.Wait(6.0) 
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[1]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[1])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[2]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[2])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[3]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[3])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[4]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[4])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[5]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[5])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[6]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[6])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[7]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[7])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[8]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[8])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[9]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[9])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[10]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[10])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle11]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[11])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[12]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[12])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[13]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[13])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[14]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[14])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[15]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[15])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

Debug.Notification ("Naked Defeat: IdlesDefeatPilloryStruggle[16]")
PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[16])
Utility.Wait(6.0)
PlayerPosing("stop", false)
Utility.Wait(2.0)

;endif

;Idle[] Property IdlesDefeatYoke Auto	;15
;Idle[] Property IdlesDefeatYokeStruggle Auto	;17
EndFunction
	
/;
	
;BOOL Function IsInMenu() GLOBAL ; Xaz ;-)
;	RETURN (IsInMenuMode() || UI.IsMenuOpen("InventoryMenu") || UI.IsMenuOpen("ContainerMenu") || UI.IsMenuOpen("Console") || UI.IsMenuOpen("Loading Menu"))
;EndFunction

bool Chains0 = false
bool Chains1 = false
bool Chains2 = false

int Property TempIntBridge Auto
String Property ProstitutionScenario Auto

Function AddChains(string type = "none")

Debug.Trace("NAKED DEFEAT configquest: AddChains()")
	
		;>>>>>>>>>> add ItemsHRchains >>>>>>>>>>>>>>>>>>>>		;to do: add chain sounds instead of metal clicking
	if !VersionSE ;!SSEfix	;VR Fix ON disables Added Chains
	
	int x = 0	
		if type == "ball"
		x = Utility.RandomInt (0, 1)
		elseif type == "random"
		x = Utility.RandomInt (0, 2)
		elseif type == "collarchain"
		x = 2
		endif
		
		if x == 0
		PlayCuffsSoundMetal()
		PlayerRef.AddItem(ItemsHRchains[0], 1, true)				;ball	
		PlayerRef.EquipItem(ItemsHRchains[0], false, true)
		SendModEvent("Moan")	
		ChainsEqipped = 0
		elseif x == 1
		PlayCuffsSoundMetal()
		PlayerRef.AddItem(ItemsHRchains[1], 1, true)				;ball	
		PlayerRef.EquipItem(ItemsHRchains[1], false, true)
		SendModEvent("Moan")	
		ChainsEqipped = 1
		elseif x == 2
		PlayCuffsSoundMetal()
		PlayerRef.AddItem(ItemsHRchains[2], 1, true)				;collarchain
		PlayerRef.EquipItem(ItemsHRchains[2], false, true)
		SendModEvent("Moan")	
		ChainsEqipped = 2
		endif	
	endif	
		
EndFunction

Function Pee(actor akActor, bool Start)

	;Armor PeeMale = Game.GetFormFromFile(0x00026D5D , "ZazAnimationpack.esm") as armor 	;ZaZ F2 01ALeakyPussyDrops
	;Armor PeeMale = Game.GetFormFromFile(0x00026D5E , "ZazAnimationpack.esm") as armor 	;ZaZ F2 01BLeakyPussyDrops
	
	;Armor PeeMale = Game.GetFormFromFile(0x00026D61 , "ZazAnimationpack.esm") as armor 	;ZaZ F2 03ASquirtingPussy
	
	;Armor PeeMale = Game.GetFormFromFile(0x00026D68 , "ZazAnimationpack.esm") as armor 	;ZaZ F2 Pee I
	Armor PeeMale = Game.GetFormFromFile(0x00026D69 , "ZazAnimationpack.esm") as armor 	;ZaZ F2 Pee II
	
	
	if DefeatPeeProb > 0
			if Start
			akActor.AddItem(PeeMale, 1, true)
			akActor.EquipItem(PeeMale, true, true)		
	
			else
			akActor.RemoveItem(PeeMale, 1, true, None)	
			endif 
	endif
EndFunction

Function RemoveChains()

Debug.Trace("NAKED DEFEAT configquest: RemoveChains()")
	
	if ChainsEqipped == 0
	PlayerRef.RemoveItem(ItemsHRchains[0], 1, true, None)
	ChainsEqipped = 4
	elseif ChainsEqipped == 1
	PlayerRef.RemoveItem(ItemsHRchains[1], 1, true, None)
	ChainsEqipped = 4
	elseif ChainsEqipped == 2
	PlayerRef.RemoveItem(ItemsHRchains[2], 1, true, None)
	ChainsEqipped = 4
	endif
	
EndFunction

int  ChainsEqipped = 4

;#move
Function AddChainsFollower(actor akactor, string type = "none")
	
	Actor a = akActor as Actor
		;>>>>>>>>>> add ItemsHRchains >>>>>>>>>>>>>>>>>>>>		;to do: add chain sounds instead of metal clicking
	if !SSEfix	;VR Fix ON disables Added Chains
	
	int x = 0	
		if type == "ball"
		x = Utility.RandomInt (0, 1)
		elseif type == "random"
		x = Utility.RandomInt (0, 2)
		elseif type == "collarchain"
		x = 2
		endif
		
		if x == 0
		PlayCuffsSoundMetal()
		a.AddItem(ItemsHRchains[0], 1, true)				;ball	
		a.EquipItem(ItemsHRchains[0], false, true)
		SexLabMoan(a)	
		Chains0_f01 = true
		elseif x == 1
		PlayCuffsSoundMetal()
		a.AddItem(ItemsHRchains[1], 1, true)				;ball	
		a.EquipItem(ItemsHRchains[1], false, true)
		SexLabMoan(a)	
		Chains1_f01 = true
		elseif x == 2
		PlayCuffsSoundMetal()
		a.AddItem(ItemsHRchains[2], 1, true)				;collarchain
		a.EquipItem(ItemsHRchains[2], false, true)
		SexLabMoan(a)	
		Chains2_f01 = true
		endif	
	endif	
		
EndFunction

;move to followerquest or make property
bool Chains0_f01 = false
bool Chains1_f01 = false
bool Chains2_f01 = false

Function RemoveChainsFollower(actor akactor)

	Actor a = akActor as Actor
	
	if Chains0_f01
	a.RemoveItem(ItemsHRchains[0], 1, true, None)
	Chains0_f01 = false
	elseif Chains1_f01
	a.RemoveItem(ItemsHRchains[1], 1, true, None)
	Chains1_f01 = false
	elseif Chains2_f01
	a.RemoveItem(ItemsHRchains[2], 1, true, None)
	Chains2_f01 = false
	endif
EndFunction


;>>>>>>>>>>>>>> GET OUTFIT >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Function Get_JSON_Weapon(string Items)			;#jimmi  #Get_JSON_Weapon()
Debug.Trace("NAKED DEFEAT configquest: Get_JSON_Weapon()")
if !LootScriptRunning
LootScriptRunning = true
endif 
;we need to check for the type first
;then make a list with all weapons with the right type
;then select one of those at random

;This should return the name of an weapon with the suitable weapon type that is chosen at random from the saved weapons

string [] Weapon_Array
string TempweaponName
string weaponToGet = "none"
int SlotNum
int ArrayLength = 0
bool IsShield = false
bool SimpleSwap = false

;string GeneralWeaponType

;>>>>>>>>>>> SIMPLE WEAPON SWAP >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
if NymBeta  
	
	SimpleSwap = true
	;we process the exact weapon type (items = sword) to be a general type (items = OneHanded)

	if Items == "Sword" || Items == "WarAxe" || Items == "Mace" || Items == "Dagger"
	Items = "OneHanded"
	
	elseif Items == "BattleAxe" || Items == "Greatsword" || Items == "Warhammer" || Items == "Staff"
	Items = "TwoHanded"
	
	elseif Items == "Bow"
	Items = "Bow"
	
	else
	ScreenMessage("NAKED DEFEAT #ERROR: LOOT Weapon type unknown")
	Items == "None"
	endif
	
	Debug.Trace("NAKED DEFEAT configquest: Get_JSON_Weapon(): "+Items)
	
endif

	;this is the string list we fill with suitable weapon profiles (that are also saved with JSON!)
	
	weapon_Array = new string[11]					
	weapon_Array[0] = None
	weapon_Array[1] = None
	weapon_Array[2] = None
	weapon_Array[3] = None
	weapon_Array[4] = None
	weapon_Array[5] = None
	weapon_Array[6] = None
	weapon_Array[7] = None
	weapon_Array[8] = None
	weapon_Array[9] = None
	weapon_Array[10] = None

;Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: Type: "+Type)
;Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: weapon_Array.Length00: "+weapon_Array.Length)
	

	;----Start SIMPLE Swap ------------------------------------------------------------------------------------------------------------------------------
	
	
	;here we check the weapon profiles for item type
	;if SHORT we need to swap "Items" check with "weapon_JSON_01_generaltype == GeneralWeaponType "Bow" etc. INSTEAD
	
	;weapon_JSON_01_generaltype = "OneHanded", "TwoHanded" etc. saved in the JSON file
	;Items = the general weapon type weapon type we want ("OneHanded", "TwoHanded" etc.)
	
	if SimpleSwap
		
		;weapon_JSON_01_generaltypetype = general weapon type (OneHanded, TwoHanded etc.)
		if weapon_JSON_01_generaltype == Items
		ArrayLength +=1
		;Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: ArrayLength01: "+ArrayLength)
		weapon_Array[ArrayLength] = weapon_JSON_01_name
		;Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: weapon_Array.Length01: "+weapon_Array.Length)
		endif
		if weapon_JSON_02_generaltype == Items
		ArrayLength +=1
		;Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: ArrayLength02: "+ArrayLength)
		weapon_Array[ArrayLength] = weapon_JSON_02_name
		;Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: weapon_Array.Length02: "+weapon_Array.Length)
		endif
		if weapon_JSON_03_generaltype == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_03_name
		endif
		if weapon_JSON_04_generaltype == Items
		ArrayLength +=1
		weapon_Array[ArrayLength]= weapon_JSON_04_name 
		endif
		if weapon_JSON_05_generaltype == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_05_name
		endif
		if weapon_JSON_06_generaltype == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_06_name
		endif
		if weapon_JSON_07_generaltype == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_07_name
		endif
		if weapon_JSON_08_generaltype == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_08_name
		endif
		if weapon_JSON_09_generaltype == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_09_name
		endif
		if weapon_JSON_10_generaltype == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_10_name
		endif

	else
	
	;----Start EXACT Swap ------------------------------------------------------------------------------------------------------------------------------
	
		;weapon_JSON_01_type = exact weapon type (sword, axe etc.) saved in the JSON file
		;Items = the exact weapon we want to find
	
		if weapon_JSON_01_type == Items
		ArrayLength +=1
		;Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: ArrayLength01: "+ArrayLength)
		weapon_Array[ArrayLength] = weapon_JSON_01_name
		;Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: weapon_Array.Length01: "+weapon_Array.Length)
		endif
		if weapon_JSON_02_type == Items
		ArrayLength +=1
		;Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: ArrayLength02: "+ArrayLength)
		weapon_Array[ArrayLength] = weapon_JSON_02_name
		;Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: weapon_Array.Length02: "+weapon_Array.Length)
		endif
		if weapon_JSON_03_type == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_03_name
		endif
		if weapon_JSON_04_type == Items
		ArrayLength +=1
		weapon_Array[ArrayLength]= weapon_JSON_04_name 
		endif
		if weapon_JSON_05_type == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_05_name
		endif
		if weapon_JSON_06_type == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_06_name
		endif
		if weapon_JSON_07_type == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_07_name
		endif
		if weapon_JSON_08_type == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_08_name
		endif
		if weapon_JSON_09_type == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_09_name
		endif
		if weapon_JSON_10_type == Items
		ArrayLength +=1
		weapon_Array[ArrayLength] = weapon_JSON_10_name
		endif
		
	endif	

	
	;- END Exact Swap ---------------------------------------------------------------------------------------------------------------
	
		
		
	if ArrayLength > 0
	TempweaponName = weapon_Array[Utility.RandomInt(1, ArrayLength)]
	Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: TempweaponName: "+TempweaponName)
	else
	DebugMessage("#ERROR: no suitable weapon found (A)")
	endIf
	
	if TempweaponName == weapon_JSON_01_name
	weaponToGet = "01"
	elseif TempweaponName == weapon_JSON_02_name
	weaponToGet = "02"
	elseif TempweaponName == weapon_JSON_03_name
	weaponToGet = "03"
	elseif TempweaponName == weapon_JSON_04_name
	weaponToGet = "04"
	elseif TempweaponName == weapon_JSON_05_name
	weaponToGet = "05"
	elseif TempweaponName == weapon_JSON_06_name
	weaponToGet = "06"
	elseif TempweaponName == weapon_JSON_07_name
	weaponToGet = "07"
	elseif TempweaponName == weapon_JSON_08_name
	weaponToGet = "08"
	elseif TempweaponName == weapon_JSON_09_name
	weaponToGet = "09"
	elseif TempweaponName == weapon_JSON_10_name
	weaponToGet = "10"
	endIf
	
;	Debug.Trace("NAKED DEFEAT configquest Get_JSON_weapon: weaponToGet: "+weaponToGet)
;	InfoMessage("Get_JSON_weapon: TempweaponName: "+TempweaponName)

	if weaponToGet == "none"
	ScreenMessage("#ERROR LOOT: no suitable weapon found (B) -> fill your weapon profiles")
		if LootScriptRunning
		LootScriptRunning = false
		endif 
	else

	Load_JSON_Weapon(weaponToGet, false)	;weapon to get is string number "0X"

	endif

EndFunction

bool Property Allow_Collar_TOGGLE Auto
bool Property Allow_PunishmentItems_TOGGLE Auto
bool Property Allow_FuckBelts_TOGGLE Auto
bool Property Allow_FuckDildo_TOGGLE Auto

bool Property Loot_Handles_Weapons_TOGGLE Auto
int Property Strip_EnchantedArmor_VALUE Auto
int Property Strip_EnchantedWeapons_VALUE Auto

bool Property Forced_Bathing_TOGGLE Auto 

bool Property PublicPunishment_LOS_TOGGLE Auto
int Property Exposurefrom_NUDITY_VALUE Auto
int	Property Exposurefrom_DIRTINESS_VALUE Auto
int	Property Exposurefrom_CUMSOAKED_VALUE Auto
int	Property Exposurefrom_BAREFOOT_VALUE Auto
int	Property Exposurefrom_UNARMED_VALUE Auto
int	Property Exposurefrom_SNEAKING_VALUE Auto
int	Property Exposurefrom_RUNNING_VALUE Auto
int	Property Exposurefrom_SPRINTING_VALUE Auto

bool Property PublicPunishment_Sounds_TOGGLE Auto
int	Property PublicPunishment_DirtThreshold_VALUE Auto

Function Save_JSON_Ini()				;#Ini
NymTrace("Save_JSON_Ini()")

;DEFAULT VALUES SHOULD BE IN THE ESP 

;TO DO

;PoisonedPotions_Visuals_TOGGLE  - disables the visuals on potion Effect
;SexRoundsMin_VALUE
;SexRoundsMax_VALUE
;SexDrippingPussy_VALUE

;hmmmm, we dont have to do EVERYthing as an option
;EscapeGame_Sex_VALUE  --- leave in MCM?
;EscapeGame_Bukkake_VALUE --- leave in MCM?
;EscapeGame_GoldenShower_VALUE
;EscapeGame_Sold_VALUE
;EscapeGame_Tattoo_VALUE
;EscapeGame_Whip_VALUE --- leave in MCM?

;RobberyGoldThreshold_VALUE
;RobberyItemsThreshold_VALUE

;NymSpawn_ExtraRapersChance_VALUE
;NymSpawn_ExtraCreatureChance_VALUE


If PapyrusUtil.GetVersion() > 1
SetINTValue("../Naked Defeat/nadeConfig.json", "Allow_Collar_TOGGLE", Allow_Collar_TOGGLE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Allow_PunishmentItems_TOGGLE", Allow_PunishmentItems_TOGGLE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Allow_FuckBelts_TOGGLE", Allow_FuckBelts_TOGGLE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Allow_FuckDildo_TOGGLE", Allow_FuckDildo_TOGGLE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Loot_Handles_Weapons_TOGGLE", Loot_Handles_Weapons_TOGGLE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Strip_EnchantedArmor_VALUE", Strip_EnchantedArmor_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Strip_EnchantedWeapons_VALUE", Strip_EnchantedWeapons_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Forced_Bathing_TOGGLE", Forced_Bathing_TOGGLE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "PublicPunishment_LOS_TOGGLE", PublicPunishment_LOS_TOGGLE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_NUDITY_VALUE", Exposurefrom_NUDITY_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_DIRTINESS_VALUE", Exposurefrom_DIRTINESS_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_CUMSOAKED_VALUE", Exposurefrom_CUMSOAKED_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_BAREFOOT_VALUE", Exposurefrom_BAREFOOT_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_UNARMED_VALUE", Exposurefrom_UNARMED_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_SNEAKING_VALUE", Exposurefrom_SNEAKING_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_RUNNING_VALUE", Exposurefrom_RUNNING_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_SPRINTING_VALUE", Exposurefrom_SPRINTING_VALUE as int)

SetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_XCross_Weight_VALUE", Scenario_XCross_Weight_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Pillory_Weight_VALUE", Scenario_Pillory_Weight_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Wheel_Weight_VALUE", Scenario_Wheel_Weight_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Stockade_Weight_VALUE", Scenario_Stockade_Weight_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Armbinder_Weight_VALUE", Scenario_Armbinder_Weight_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Cuffs_Weight_VALUE", Scenario_Cuffs_Weight_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Rodeo_Weight_VALUE", Scenario_Rodeo_Weight_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_ChainRape_Weight_VALUE", Scenario_ChainRape_Weight_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_ForcedMasturbation_Weight_VALUE", Scenario_ForcedMasturbation_Weight_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Bukkake_Weight_VALUE", Scenario_Bukkake_Weight_VALUE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Girlfriend_Weight_VALUE", Scenario_Girlfriend_Weight_VALUE as int)

SetINTValue("../Naked Defeat/nadeConfig.json", "PublicPunishment_Sounds_TOGGLE", PublicPunishment_Sounds_TOGGLE as int)
SetINTValue("../Naked Defeat/nadeConfig.json", "PublicPunishment_DirtThreshold_VALUE", PublicPunishment_DirtThreshold_VALUE as int)





Save("../Naked Defeat/nadeConfig.json")

endif 




EndFunction 

Function Load_JSON_Ini()

	NymTrace("Load_JSON_Ini()")
	If PapyrusUtil.GetVersion() > 1

		If JsonExists("../Naked Defeat/nadeConfig")
		Allow_Collar_TOGGLE = GetINTValue("../Naked Defeat/nadeConfig.json", "Allow_Collar_TOGGLE")
		NymTrace("Allow_Collar_TOGGLE: "+Allow_Collar_TOGGLE)

		Allow_PunishmentItems_TOGGLE = GetINTValue("../Naked Defeat/nadeConfig.json", "Allow_PunishmentItems_TOGGLE")
		NymTrace("Allow_PunishmentItems_TOGGLE: "+Allow_PunishmentItems_TOGGLE)

		Allow_FuckBelts_TOGGLE = GetINTValue("../Naked Defeat/nadeConfig.json", "Allow_FuckBelts_TOGGLE")
		NymTrace("Allow_FuckBelts_TOGGLE: "+Allow_FuckBelts_TOGGLE)

		Allow_FuckDildo_TOGGLE = GetINTValue("../Naked Defeat/nadeConfig.json", "Allow_FuckDildo_TOGGLE")
		NymTrace("Allow_FuckDildo_TOGGLE: "+Allow_FuckDildo_TOGGLE)

		Loot_Handles_Weapons_TOGGLE = GetINTValue("../Naked Defeat/nadeConfig.json", "Loot_Handles_Weapons_TOGGLE")
		NymTrace("Loot_Handles_Weapons_TOGGLE: "+Loot_Handles_Weapons_TOGGLE)

		Strip_EnchantedArmor_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Strip_EnchantedArmor_VALUE")
		NymTrace("Strip_EnchantedArmor_VALUE: "+Strip_EnchantedArmor_VALUE)

		Strip_EnchantedWeapons_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Strip_EnchantedWeapons_VALUE")
		NymTrace("Strip_EnchantedWeapons_VALUE: "+Strip_EnchantedWeapons_VALUE)

		Forced_Bathing_TOGGLE = GetINTValue("../Naked Defeat/nadeConfig.json", "Forced_Bathing_TOGGLE")
		NymTrace("Forced_Bathing_TOGGLE: "+Forced_Bathing_TOGGLE)

		PublicPunishment_LOS_TOGGLE = GetINTValue("../Naked Defeat/nadeConfig.json", "PublicPunishment_LOS_TOGGLE")
		NymTrace("PublicPunishment_LOS_TOGGLE: "+PublicPunishment_LOS_TOGGLE)

		Exposurefrom_NUDITY_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_NUDITY_VALUE")
		NymTrace("Exposurefrom_NUDITY_VALUE: "+Exposurefrom_NUDITY_VALUE)

		Exposurefrom_DIRTINESS_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_DIRTINESS_VALUE")
		NymTrace("Exposurefrom_DIRTINESS_VALUE: "+Exposurefrom_DIRTINESS_VALUE)

		Exposurefrom_CUMSOAKED_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_CUMSOAKED_VALUE")
		NymTrace("Exposurefrom_CUMSOAKED_VALUE: "+Exposurefrom_CUMSOAKED_VALUE)

		Exposurefrom_BAREFOOT_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_BAREFOOT_VALUE")
		NymTrace("Exposurefrom_BAREFOOT_VALUE: "+Exposurefrom_BAREFOOT_VALUE)

		Exposurefrom_UNARMED_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_UNARMED_VALUE")
		NymTrace("Exposurefrom_UNARMED_VALUE: "+Exposurefrom_UNARMED_VALUE)

		Exposurefrom_SNEAKING_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_SNEAKING_VALUE")
		NymTrace("Exposurefrom_SNEAKING_VALUE: "+Exposurefrom_SNEAKING_VALUE)

		Exposurefrom_RUNNING_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_RUNNING_VALUE")
		NymTrace("Exposurefrom_RUNNING_VALUE: "+Exposurefrom_RUNNING_VALUE)

		Exposurefrom_SPRINTING_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Exposurefrom_SPRINTING_VALUE")	
		NymTrace("Exposurefrom_SPRINTING_VALUE: "+Exposurefrom_SPRINTING_VALUE)

		Scenario_XCross_Weight_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_XCross_Weight_VALUE")	
		NymTrace("Scenario_XCross_Weight_VALUE: "+Scenario_XCross_Weight_VALUE)

		Scenario_Pillory_Weight_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Pillory_Weight_VALUE")	
		NymTrace("Scenario_Pillory_Weight_VALUE: "+Scenario_Pillory_Weight_VALUE)

		Scenario_Wheel_Weight_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Wheel_Weight_VALUE")	
		NymTrace("Scenario_Wheel_Weight_VALUE: "+Scenario_Wheel_Weight_VALUE)

		Scenario_Stockade_Weight_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Stockade_Weight_VALUE")	
		NymTrace("Scenario_Stockade_Weight_VALUE: "+Scenario_Stockade_Weight_VALUE)

		Scenario_Armbinder_Weight_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Armbinder_Weight_VALUE")	
		NymTrace("Scenario_Armbinder_Weight_VALUE: "+Scenario_Armbinder_Weight_VALUE)

		Scenario_Cuffs_Weight_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Cuffs_Weight_VALUE")	
		NymTrace("Scenario_Cuffs_Weight_VALUE: "+Scenario_Cuffs_Weight_VALUE)

		Scenario_Rodeo_Weight_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Rodeo_Weight_VALUE")	
		NymTrace("Scenario_Rodeo_Weight_VALUE: "+Scenario_Rodeo_Weight_VALUE)

		Scenario_ChainRape_Weight_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_ChainRape_Weight_VALUE")	
		NymTrace("Scenario_ChainRape_Weight_VALUE: "+Scenario_ChainRape_Weight_VALUE)

		Scenario_ForcedMasturbation_Weight_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_ForcedMasturbation_Weight_VALUE")	
		NymTrace("Scenario_ForcedMasturbation_Weight_VALUE: "+Scenario_ForcedMasturbation_Weight_VALUE)

		Scenario_Bukkake_Weight_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Bukkake_Weight_VALUE")	
		NymTrace("Scenario_Bukkake_Weight_VALUE: "+Scenario_Bukkake_Weight_VALUE)

		Scenario_Girlfriend_Weight_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "Scenario_Girlfriend_Weight_VALUE")	
		NymTrace("Scenario_Girlfriend_Weight_VALUE: "+Scenario_Girlfriend_Weight_VALUE)
	
		PublicPunishment_Sounds_TOGGLE = GetINTValue("../Naked Defeat/nadeConfig.json", "PublicPunishment_Sounds_TOGGLE")	
		NymTrace("PublicPunishment_Sounds_TOGGLE: "+PublicPunishment_Sounds_TOGGLE)		
	
		PublicPunishment_DirtThreshold_VALUE = GetINTValue("../Naked Defeat/nadeConfig.json", "PublicPunishment_DirtThreshold_VALUE")	
		NymTrace("PublicPunishment_DirtThreshold_VALUE: "+PublicPunishment_DirtThreshold_VALUE)		

		endif
		
		
		if Nym()
			NymTrace("#BUG Load Outfit Names 01")
			If JsonExists("../Naked Defeat/outfit01")

				outfit_JSON_01_name = GetStringValue("../Naked Defeat/outfit01.json", "outfit_name")
				outfit_JSON_01_type = GetStringValue("../Naked Defeat/outfit01.json", "outfit_type")
				
				outfit_JSON_02_name = GetStringValue("../Naked Defeat/outfit02.json", "outfit_name")
				outfit_JSON_02_type = GetStringValue("../Naked Defeat/outfit02.json", "outfit_type")
				
				outfit_JSON_03_name = GetStringValue("../Naked Defeat/outfit03.json", "outfit_name")
				outfit_JSON_03_type = GetStringValue("../Naked Defeat/outfit03.json", "outfit_type")
			
				outfit_JSON_04_name = GetStringValue("../Naked Defeat/outfit04.json", "outfit_name")
				outfit_JSON_04_type = GetStringValue("../Naked Defeat/outfit04.json", "outfit_type")
				
				outfit_JSON_05_name = GetStringValue("../Naked Defeat/outfit05.json", "outfit_name")
				outfit_JSON_05_type = GetStringValue("../Naked Defeat/outfit05.json", "outfit_type")
				
				outfit_JSON_06_name = GetStringValue("../Naked Defeat/outfit06.json", "outfit_name")
				outfit_JSON_06_type = GetStringValue("../Naked Defeat/outfit06.json", "outfit_type")
				
				outfit_JSON_07_name = GetStringValue("../Naked Defeat/outfit07.json", "outfit_name")
				outfit_JSON_07_type = GetStringValue("../Naked Defeat/outfit07.json", "outfit_type")
				
				outfit_JSON_08_name = GetStringValue("../Naked Defeat/outfit08.json", "outfit_name")
				outfit_JSON_08_type = GetStringValue("../Naked Defeat/outfit08.json", "outfit_type")
				
				outfit_JSON_09_name = GetStringValue("../Naked Defeat/outfit09.json", "outfit_name")
				outfit_JSON_09_type = GetStringValue("../Naked Defeat/outfit09.json", "outfit_type")
				
				outfit_JSON_10_name = GetStringValue("../Naked Defeat/outfit10.json", "outfit_name")
				outfit_JSON_10_type = GetStringValue("../Naked Defeat/outfit10.json", "outfit_type")
				
				ForcePageReset()
			endif
		endif 
			
endif

	
EndFunction
	
;/
Function LOAD_CONFIG_EXTERNAL()			; ;NOT USED ANYMORE 


	SAVE_CONFIG_EXTERNAL()

int TesTValue = 404
float start = 404
float end = 404

String STRINGS1

If PapyrusUtil.GetVersion() > 1
bool Fuckoff = false
		
		if FUCKOFF
			If JsonExists("../Naked Defeat/CONFIG_EXTERNAL")
			NymTrace("JSON FOUND") 
			
			start = GetFloatValue("../Naked Defeat/CONFIG_EXTERNAL.json", "start")
			end = GetFloatValue("../Naked Defeat/CONFIG_EXTERNAL.json", "end")
			NymMessage("start: "+start)
			TesTValue = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "TesTValue")
			
			;FemalesAllowed = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "FemalesAllowed") as int
			
			NymMessage("TesTValue: "+TesTValue)	
	
			Allow_Collar_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_Collar_TOGGLE")
			Allow_PunishmentItems_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_PunishmentItems_TOGGLE")
			Allow_FuckBelts_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_FuckBelts_TOGGLE")
			Allow_FuckDildo_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_FuckDildo_TOGGLE")
		
			Loot_Handles_Weapons_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Loot_Handles_Weapons_TOGGLE")
			Strip_EnchantedArmor_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Loot_Handles_EnchantedArmor_VALUE")		
			Strip_EnchantedWeapons_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Loot_Handles_EnchantedWeapons_VALUE")
			Forced_Bathing_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Forced_Bathing_TOGGLE")

			PublicPunishment_LOS_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "PublicPunishment_LOS_TOGGLE")
			NymTrace("PublicPunishment_LOS_TOGGLE: "+PublicPunishment_LOS_TOGGLE)
			
			Exposurefrom_NUDITY_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_NUDITY_VALUE")
			NymTrace("PublicPunishment_Exposurefrom_NUDITY_VALUE: "+Exposurefrom_NUDITY_VALUE)
			
			Exposurefrom_DIRTINESS_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_DIRTINESS_VALUE")
			Exposurefrom_CUMSOAKED_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_CUMSOAKED_VALUE")
			Exposurefrom_BAREFOOT_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_BAREFOOT_VALUE")
			Exposurefrom_UNARMED_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_UNARMED_VALUE")
			Exposurefrom_SNEAKING_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_SNEAKING_VALUE")
			Exposurefrom_RUNNING_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_RUNNING_VALUE")
			Exposurefrom_SPRINTING_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_SPRINTING_VALUE")

		;	STRINGS1 = GetStringValue("../Naked Defeat/CONFIG_EXTERNAL.json", "STRINGS NOT USED AT THE MOMENT1")
		;	NymMessage("STRINGS1: "+STRINGS1)
		
		
			else 	
			Debug.MessageBox("JsonExists: FALSE") 	
			endif 
			
		endif 	
		
	
			
		endif 
endif 
		
EndFunction 




Function SAVE_CONFIG_EXTERNAL()	

If PapyrusUtil.GetVersion() > 1


		If JsonExists("../Naked Defeat/CONFIG_EXTERNAL")
		SetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_Collar_TOGGLE", Allow_Collar_TOGGLE as int) 
		SetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_PunishmentItems_TOGGLE", Allow_PunishmentItems_TOGGLE as int) 
		SetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_FuckBelts_TOGGLE", Allow_FuckBelts_TOGGLE as int) 
		SetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_FuckDildo_TOGGLE", Allow_FuckDildo_TOGGLE as int) 
		SetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Loot_Handles_Weapons_TOGGLE", Loot_Handles_Weapons_TOGGLE as int) 
	
		endif 


		Allow_Collar_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_Collar_TOGGLE")
		Allow_PunishmentItems_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_PunishmentItems_TOGGLE")
		Allow_FuckBelts_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_FuckBelts_TOGGLE")
		Allow_FuckDildo_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Allow_FuckDildo_TOGGLE")
	
		Loot_Handles_Weapons_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Loot_Handles_Weapons_TOGGLE")
		Strip_EnchantedArmor_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Loot_Handles_EnchantedArmor_VALUE")		
		Strip_EnchantedWeapons_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Loot_Handles_EnchantedWeapons_VALUE")
		Forced_Bathing_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Forced_Bathing_TOGGLE")

		PublicPunishment_LOS_TOGGLE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "PublicPunishment_LOS_TOGGLE")
		NymTrace("PublicPunishment_LOS_TOGGLE: "+PublicPunishment_LOS_TOGGLE)
		
		Exposurefrom_NUDITY_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_NUDITY_VALUE")
		NymTrace("PublicPunishment_Exposurefrom_NUDITY_VALUE: "+Exposurefrom_NUDITY_VALUE)
		
		Exposurefrom_DIRTINESS_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_DIRTINESS_VALUE")
		Exposurefrom_CUMSOAKED_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_CUMSOAKED_VALUE")
		Exposurefrom_BAREFOOT_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_BAREFOOT_VALUE")
		Exposurefrom_UNARMED_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_UNARMED_VALUE")
		Exposurefrom_SNEAKING_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_SNEAKING_VALUE")
		Exposurefrom_RUNNING_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_RUNNING_VALUE")
		Exposurefrom_SPRINTING_VALUE = GetINTValue("../Naked Defeat/CONFIG_EXTERNAL.json", "Exposurefrom_SPRINTING_VALUE")

	;	STRINGS1 = GetStringValue("../Naked Defeat/CONFIG_EXTERNAL.json", "STRINGS NOT USED AT THE MOMENT1")
	;	NymMessage("STRINGS1: "+STRINGS1)

endif 
		
EndFunction 


/;

;>>>>>>>>>>>>>> LOAD WEAPON/SHIELD >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

;Dwarven Harness FF00122E : BASE 44013391
;zbf Harness FF001235		BASE 0B007009 ZAZAnimationPack.esm
;Wolf Harness FF001233		BASE 44008662
;Dwarven Harness II FF00122F BASE 44013393 
;EBony Harness FF001230		BASE 4401496F

Function AddRandomHarness()		 ;#AddRandomHarness()	#Harness

	if IsPlayerNaked() && !PlayerRef.GetWornForm(0x00010000)
	AddItemFromFile("Wolf Harness", false)
	endif 

EndFunction 

Function AddItemFromFile(String sItem, Bool bAnimated)
NymTrace("AddItemFromFile")
	Form TempItem
	bool GetWeapon = false
	Weapon TempWeaponR
	Weapon TempWeaponL

	if Nym()	
		if sItem == "Wolf Harness"
		TempItem = (Game.GetFormFromFile(0x44008662, "The Amazing World of Bikini Armors REMASTERED.esp") As Form)
		elseif sItem == "Fists Divine"
		;TempItem = (Game.GetFormFromFile(0x0000084F, "Phenderix Arcane Brawler.esp") As Weapon) ;Blood
		;TempItem = (Game.GetFormFromFile(0x00000850, "Phenderix Arcane Brawler.esp") As Weapon) ;Earth
		;TempItem = (Game.GetFormFromFile(0x00000851, "Phenderix Arcane Brawler.esp") As Weapon) ;Water
		;TempItem = (Game.GetFormFromFile(0x00000852, "Phenderix Arcane Brawler.esp") As Weapon) ;Fire
		;TempItem = (Game.GetFormFromFile(0x00000853, "Phenderix Arcane Brawler.esp") As Weapon) ;Frost
		;TempItem = (Game.GetFormFromFile(0x00000854, "Phenderix Arcane Brawler.esp") As Weapon) ;Lightning
		;TempItem = (Game.GetFormFromFile(0x00000855, "Phenderix Arcane Brawler.esp") As Weapon) ;Poison
		;TempItem = (Game.GetFormFromFile(0x00000856, "Phenderix Arcane Brawler.esp") As Weapon) ;Wind
		;TempItem = (Game.GetFormFromFile(0x00000857, "Phenderix Arcane Brawler.esp") As Weapon) ;Darkness
		;TempItem = (Game.GetFormFromFile(0x00000858, "Phenderix Arcane Brawler.esp") As Form) ;DIVINE
		TempWeaponR = (Game.GetFormFromFile(0x0000858, "Phenderix Arcane Brawler.esp") As Weapon) ;DIVINE
		;TempWeaponL = (Game.GetFormFromFile(0x0000853, "Phenderix Arcane Brawler.esp") As Weapon) ;Frost
		TempWeaponL = (Game.GetFormFromFile(0x0000850, "Phenderix Arcane Brawler.esp") As Weapon) ;Earth
		GetWeapon = true
		endif 	

		IsCheat  = true
		if GetWeapon

			if TempWeaponR	;equip RIGHT hand
			PlayerRef.AddItem(TempWeaponR, 1, true)
			PlayerRef.EquipItemEx(TempWeaponR, 1, false, true)
			endif 
			if TempWeaponL ;equip LEFT hand
			PlayerRef.AddItem(TempWeaponL, 1, true)
			PlayerRef.EquipItemEx(TempWeaponL, 2, false, true)
			endif 
		else 
		PlayerRef.EquipItem(TempItem, false, true)
		endif 
		IsCheat  = false
	endif 
	
	
	
EndFunction 




Function Load_JSON_Weapon(string WeaponNum, bool EquipOnly)			;#OUTFIT #Load_JSON_Weapon #JSON
Debug.Trace("NAKED DEFEAT configquest: Load_JSON_Weapon()")
Debug.Trace("NAKED DEFEAT configquest: Load_JSON_Weapon - WeaponNum: "+WeaponNum)		;#BETA 4.93
Debug.Trace("NAKED DEFEAT configquest: Load_JSON_Weapon - EquipOnly: "+EquipOnly)		;#BETA 4.93

	if !LootScriptRunning										;#BETA 4.93
	LootScriptRunning = true
	else														;#BETA 4.93	
	InfoMessage("#ERROR - LootScriptRunning = false")			;#BETA 4.93
	endif														;#BETA 4.93	

;/ TODO

	When Save Profile I want an option to input a name. "empty" is the default name
	The name should appear on "Load Outfit" together with the type we determine internaly (light/heavy/clothes/naked)
/;

	;DebugMessage("Load_JSON_Weapon()")

	Weapon TempWeapon
	Armor TempShield
	Int iFormId      
	Int iModIndex    
	String sModName 
	Int GetHandSlot 
	int GetShield
	String TempWeaponName
	
	If PapyrusUtil.GetVersion() > 1

		If JsonExists("../Naked Defeat/outfit" +WeaponNum+ "")

			GetShield	= GetINTValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "IsShield")
			; -- GET SHIELD -- ;
			if GetShield == 1
				iFormId = GetINTValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "ID_weapon")	
				sModName = GetStringValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "STRING_weapon")		
				TempShield = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempShield ;check slot 31 (helmet)
				TempWeaponName = TempShield.GetName()
					if !EquipOnly
					PlayerRef.AddItem(TempShield, 1, true)
					endif 			
					PlayerRef.EquipItemEx(TempShield, 0, false, true)
					
					;PlayerRef.EquipItem(TempShield, false, true)
				endif
			
			; -- GET WEAPON -- ;
			else			
				iFormId = GetINTValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "ID_weapon")	
				sModName = GetStringValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "STRING_weapon")	
				GetHandSlot	= GetINTValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "HandSlot")
		
				TempWeapon = (Game.GetFormFromFile(iFormId, sModName) as Weapon)			
				if TempWeapon ;check slot 31 (helmet)
				TempWeaponName = TempWeapon.GetName()
				Debug.Trace("NAKED DEFEAT configquest: Load_JSON_Weapon - TempWeapon: "+TempWeaponName)
				NymTrace("Load_JSON_Weapon A")
				if !EquipOnly
				NymTrace("Load_JSON_Weapon B")
					PlayerRef.AddItem(TempWeapon, 1, true)
					endif 	
				NymTrace("Load_JSON_Weapon C")					
					;PlayerRef.EquipItem(TempWeapon, false, true)
					PlayerRef.EquipItemEx(TempWeapon, GetHandSlot, false, true)
				else
				NymTrace("Load_JSON_Weapon D")
				Debug.Trace("NAKED DEFEAT configquest: #ERROR Load_JSON_Weapon - TempWeapon FALSE")
				endif
				NymTrace("Load_JSON_Weapon E")
				;if IsNymrasGame() && Game.GetModByName("HDTPhysicsWeaponSling.esp") != 255
				;TempShield = (Game.GetFormFromFile(0x0100BFDC, "HDTPhysicsWeaponSling.esp") as armor)
				;	if !EquipOnly
				;	PlayerRef.AddItem(TempShield, 1, true)
				;	endif 			
				;	PlayerRef.EquipItemEx(TempShield, 0, false, true)
				;endif	
			endif
				NymTrace("Load_JSON_Weapon F")	
			if EquipOnly
			NymTrace("Load_JSON_Weapon G")
			ScreenMessage(TempWeaponName+" equiped.")
			else
			;Debug.MessageBox("Weapon "+WeaponNum+" loaded.")
			endif
			
			NymTrace("Load_JSON_Weapon H")	
			if IsCheat
			NymTrace("Load_JSON_Weapon I")
			;NymTrace("IsCheat AA = false")
			NymTrace("IsCheat = false (AA)")
			endif	
				NymTrace("Load_JSON_Weapon J")
			if LootScriptRunning
			LootScriptRunning = false
			endif 
			
			
		else
			Debug.MessageBox("OutfitX.Json does not exist.")
		endif
				
	else
		Debug.MessageBox("PapyrusUtil needs to be installed")
	endif
	
	if IsCheat
	NymTrace("IsCheat = false (BB)")
	IsCheat = false
	endif	
		
	if LootScriptRunning
	LootScriptRunning = false
	endif 
			
NymTrace("Load_JSON_Weapon END")
			
EndFunction

Function Import_JSON_Weapons()			;#OUTFIT #JSON #Import_JSON_Weapon
Debug.Trace("NAKED DEFEAT configquest: Import_JSON_Weapons()")
	;#BETA 4.93
;Debug.Trace("NAKED DEFEAT configquest: Import_JSON_Weapon - EquipOnly: "+EquipOnly)		;#BETA 4.93


String WeaponNum

	;-------- From SAVE WEAPON TO FORMLIST SCRIPT -------------------------------
	;Debug.Trace("Naked Defeat configquest: SaveWeapon(START) - WeaponNum: "+WeaponNum)
	
	int i = 10
	
	while i > 0
	
		;GET NUMBER
		if i < 10
		WeaponNum = "0"+i
		elseif i == 10
		WeaponNum = "10"
		endif
		Debug.Trace("NAKED DEFEAT configquest: Import_JSON_Weapons - WeaponNum: "+WeaponNum)	

		;GET FORMLIST
		Formlist akFormlist
		akFormlist = Weapon_JSON_FList[i]
		akFormlist.Revert()
		
		i -= 1
		;if WeaponType == 3 ;Shield)
		;akFormlist.AddForm(PlayerRef.GetEquippedShield())
		;elseif WeaponType == 2 ;Left Hand
		;akFormlist.AddForm(PlayerRef.GetEquippedWeapon(true))
		;elseif WeaponType == 1 ;Right Hand
		;akFormlist.AddForm(PlayerRef.GetEquippedWeapon(false))
		;endif
		;--------------------------------------------------------


		;DebugMessage("Import_JSON_Weapon()")

		Weapon TempWeapon
		Armor TempShield
		Int iFormId      
		Int iModIndex    
		String sModName 
		Int GetHandSlot 
		int GetShield
		
		If PapyrusUtil.GetVersion() > 1

			If JsonExists("../Naked Defeat/outfit" +WeaponNum+ "")

				GetShield	= GetINTValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "IsShield")
				; -- GET SHIELD -- ;
				if GetShield == 1
					iFormId = GetINTValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "ID_weapon")	
					sModName = GetStringValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "STRING_weapon")		
					TempShield = (Game.GetFormFromFile(iFormId, sModName) as armor)			
					if TempShield ;check slot 31 (helmet)
					akFormlist.AddForm(TempShield)	

					endif
				
				; -- GET WEAPON -- ;
				else			
					iFormId = GetINTValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "ID_weapon")	
					sModName = GetStringValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "STRING_weapon")	
					GetHandSlot	= GetINTValue("../Naked Defeat/weapon" +WeaponNum+ ".json", "HandSlot")
			
					TempWeapon = (Game.GetFormFromFile(iFormId, sModName) as Weapon)			
					if TempWeapon ;check slot 31 (helmet)
				
				
					akFormlist.AddForm(TempWeapon)

					else
					Debug.Trace("NAKED DEFEAT configquest: #ERROR Load_JSON_Weapon - TempWeapon FALSE")
					endif
					
				;	if IsNymrasGame() && Game.GetModByName("HDTPhysicsWeaponSling.esp") != 255
				;	TempShield = (Game.GetFormFromFile(0x0100BFDC, "HDTPhysicsWeaponSling.esp") as armor)
				;	akFormlist.AddForm(TempShield)
;
				;	endif	
				endif
					
			;	Debug.MessageBox("Weapon "+WeaponNum+" loaded.")
				
			else
				Debug.MessageBox("OutfitX.Json does not exist.")
			endif
					
		else
			Debug.MessageBox("PapyrusUtil needs to be installed")
		endif
		
	endwhile
		
EndFunction

String OutfitNumber

;/
string myName = "Drago Nborn"


event OnPageReset(string page)
	inputOID_I = AddInputOption("Character Name", myName)
endEvent


event OnOptionInputOpen(int option)
	if (option == inputOID_I)
		; Fill input box with current value
		SetInputDialogStartText(myName)
	endIf
endEvent


event OnOptionInputAccept(int option, string input)
	if (option == inputOID_I)
		myName= input
		SetInputOptionValue(inputOID_I, myName)
	endIf
endEvent
/;

;>>>>>>>>>>>>>> GET OUTFIT >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Function Get_JSON_Outfit(string Type, string Items)			;#jimmi  #Get_JSON_Outfit()

Debug.Trace("NAKED DEFEAT configquest: Get_JSON_Outfit()")

if !LootScriptRunning
LootScriptRunning = true
endif 
;we need to check for the type first
;then make a list with all outfits with the right type
;then select one of those at random

;This should return the name of an outfit with the suitable armor type that is chosen at random from the saved outfits

string [] Outfit_Array
string TempOutFitName
string OutFitToGet = "none"
string tempItems = Items
int SlotNum
int ArrayLength = 0

	Outfit_Array = new string[11]					
	Outfit_Array[0] = None
	Outfit_Array[1] = None
	Outfit_Array[2] = None
	Outfit_Array[3] = None
	Outfit_Array[4] = None
	Outfit_Array[5] = None
	Outfit_Array[6] = None
	Outfit_Array[7] = None
	Outfit_Array[8] = None
	Outfit_Array[9] = None
	Outfit_Array[10] = None

;Debug.Trace("NAKED DEFEAT configquest Get_JSON_Outfit: Type: "+Type)
;Debug.Trace("NAKED DEFEAT configquest Get_JSON_Outfit: Outfit_Array.Length00: "+Outfit_Array.Length)
	
	if outfit_JSON_01_type == type
	ArrayLength +=1
	;Debug.Trace("NAKED DEFEAT configquest Get_JSON_Outfit: ArrayLength01: "+ArrayLength)
	Outfit_Array[ArrayLength] = outfit_JSON_01_name
	;Debug.Trace("NAKED DEFEAT configquest Get_JSON_Outfit: Outfit_Array.Length01: "+Outfit_Array.Length)
	endif
	if outfit_JSON_02_type == type
	ArrayLength +=1
	;Debug.Trace("NAKED DEFEAT configquest Get_JSON_Outfit: ArrayLength02: "+ArrayLength)
	Outfit_Array[ArrayLength] = outfit_JSON_02_name
	;Debug.Trace("NAKED DEFEAT configquest Get_JSON_Outfit: Outfit_Array.Length02: "+Outfit_Array.Length)
	endif
	if outfit_JSON_03_type == type
	ArrayLength +=1
	Outfit_Array[ArrayLength] = outfit_JSON_03_name
	endif
	if outfit_JSON_04_type == type
	ArrayLength +=1
	Outfit_Array[ArrayLength]= outfit_JSON_04_name 
	endif
	if outfit_JSON_05_type == type
	ArrayLength +=1
	Outfit_Array[ArrayLength] = outfit_JSON_05_name
	endif
	if outfit_JSON_06_type == type
	ArrayLength +=1
	Outfit_Array[ArrayLength] = outfit_JSON_06_name
	endif
	if outfit_JSON_07_type == type
	ArrayLength +=1
	Outfit_Array[ArrayLength] = outfit_JSON_07_name
	endif
	if outfit_JSON_08_type == type
	ArrayLength +=1
	Outfit_Array[ArrayLength] = outfit_JSON_08_name
	endif
	if outfit_JSON_09_type == type
	ArrayLength +=1
	Outfit_Array[ArrayLength] = outfit_JSON_09_name
	endif
	if outfit_JSON_10_type == type
	ArrayLength +=1
	Outfit_Array[ArrayLength] = outfit_JSON_10_name
	endif
	
	if ArrayLength > 0
	TempOutFitName = Outfit_Array[Utility.RandomInt(1, ArrayLength)]
	Debug.Trace("NAKED DEFEAT configquest Get_JSON_Outfit: TempOutFitName: "+TempOutFitName)
	else
	DebugMessage("#ERROR: no suitable Outfit found (A)")
	endIf
	
	if TempOutFitName == outfit_JSON_01_name
	OutFitToGet = "01"
	elseif TempOutFitName == outfit_JSON_02_name
	OutFitToGet = "02"
	elseif TempOutFitName == outfit_JSON_03_name
	OutFitToGet = "03"
	elseif TempOutFitName == outfit_JSON_04_name
	OutFitToGet = "04"
	elseif TempOutFitName == outfit_JSON_05_name
	OutFitToGet = "05"
	elseif TempOutFitName == outfit_JSON_06_name
	OutFitToGet = "06"
	elseif TempOutFitName == outfit_JSON_07_name
	OutFitToGet = "07"
	elseif TempOutFitName == outfit_JSON_08_name
	OutFitToGet = "08"
	elseif TempOutFitName == outfit_JSON_09_name
	OutFitToGet = "09"
	elseif TempOutFitName == outfit_JSON_10_name
	OutFitToGet = "10"
	endIf
	
;	Debug.Trace("NAKED DEFEAT configquest Get_JSON_Outfit: OutFitToGet: "+OutFitToGet)
;	InfoMessage("Get_JSON_Outfit: TempOutFitName: "+TempOutFitName)
	
	if OutFitToGet == "none"
	ScreenMessage("#ERROR: no suitable outfit found (B)")
		if LootScriptRunning
		LootScriptRunning = false
		endif 
	else
	Load_JSON_Outfit(OutFitToGet, tempItems, false)
	endif
	
EndFunction



Bool Function IsPlayerPartiallyNaked()				;CHECKS FOR NUDITY FOR HARMLESS Quest
Form Helmet = PlayerRef.GetWornForm(0x00000002)	;hair
Form Circlet = PlayerRef.GetWornForm(0x00001000)	;circles
Form Body = PlayerRef.GetWornForm(0x00000004)	;32 BODY
Form Hands = PlayerRef.GetWornForm(0x00000008)	;33 - HANDS
Form Feet = PlayerRef.GetWornForm(0x00000080)	;37 - FEET
	bool Headwear = false
	if Helmet || Circlet
	Headwear = true
	endif
	
	if !Headwear || !Body || !Hands || !Feet
	return true
	else
	return false
	endif
EndFunction

;Brainstom "EQUIP RANDOM OUTFIT"	#hanna
;/
	;GetEquippedShield() ???
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000001)) 	;30 - head
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000002)) 	;31 - hair/HELMET
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000004))	;32 - BODY
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000008))	;33 - HANDS
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000010))	;34 - Forearms
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000020))	;35 - Amulet 	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000040))	;36 - Ring 			
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000080))	;37 - FEET
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000100))	;38 - Calves
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000200))	;39 - SHIELD
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000400))	;40 - TAIL
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000800))	;41 - Long Hair
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00001000))	;42 - Circlet
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00002000))	;43 - Ears 	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00004000))	;44 - Unnamed 		(DD Gag/Mouth, SexlabTongue)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00008000))	;45 - Unnamed 		(DD Collars)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00010000))	;46 - Unnamed 		(DD Armbinder/Yoke, Cloaks)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00020000))	;47 - Unnamed 		(DD -, Backpacks, Wings)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00040000))	;48 - Unnamed 		(DD plugs anal, Backpack left pouch)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00080000))	;49 - Unnamed 		(DD Body harness/Chastity belt)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00100000))	;50 - Decap. Head	(DD Piercings Vaginal, bracelets)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00200000))	;51 - Decapitate
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00400000))	;52 - Unnamed
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00800000))	;53 - Unnamed	(DD Cuffs Legs)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x01000000))	;54 - Unnamed	(DD Plugs vaginal)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x02000000))	;55 - Unnamed	(DD Blindfold)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x04000000))	;56 - Unnamed	(DD Chastity Bra)		
	akFormlist.AddForm(PlayerRef.GetWornForm(0x08000000))	;57 - Unnamed	(DD Vaginal Plugs)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x10000000))	;58 - Unnamed	(DD Body Harness/Corset
	akFormlist.AddForm(PlayerRef.GetWornForm(0x20000000))	;59 - Unnamed	(DD Cuffs Arms)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x40000000))	;60 - Unnamed
	akFormlist.AddForm(PlayerRef.GetWornForm(0x80000000))	;61 - Unnamed
	
/;	
Bool Function CheckArmorHead()
	armor CheckArmor31 = (PlayerRef.GetWornForm(0x00000002)) as armor 		;31 - hair/HELMET
	armor CheckArmor42 = (PlayerRef.GetWornForm(0x00001000)) as armor		;42 - Circlet
	if CheckArmor31 || CheckArmor42
	return true
	else
	return false
	endif
EndFunction

Bool Function CheckArmorBody()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00000004)) as armor	;32 - BODY
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction


Bool Function CheckArmorHands()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00000008)) as armor	;33 - HANDS
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction

Bool Function CheckArmorFeet()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00000080)) as armor	;37 - FEET
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction

;HEAD MISSING (30)

Bool Function CheckArmor34()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00000010)) as armor	;34 - Forearms
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction

Bool Function CheckArmor35()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00000020)) as armor	;35 - Amulet
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction

Bool Function CheckArmor36()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00000040)) as armor	;36 - Ring
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction


Bool Function CheckArmor37()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00000080)) as armor	;37 -FEET - is MAIN 
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction

		

Bool Function CheckArmor38()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00000100)) as armor	;38 - Calves
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction


		;39 is Shield
	
	
Bool Function CheckArmor40()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00000400)) as armor	;40 - Tail
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction
	
	
Bool Function CheckArmor41()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00000800)) as armor	;41 - LongHair
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction

Bool Function CheckArmor42()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00001000)) as armor	;41 - CIRCLET - is MAIN 
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction

Bool Function CheckArmor43()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00002000)) as armor	;43 - Ears
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor44()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00004000)) as armor	;44 - (DD Gag/Mouth, SexlabTongue)
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor45()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00008000)) as armor	;45 - (DD Collars)
	if CheckArmor
	NymTrace("CheckArmor45(TRUE)")
	return true
	else
	NymTrace("CheckArmor45(false)")
	return false
	endif
EndFunction	


Bool Function CheckArmor46()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00010000)) as armor	;46 Unnamed 		(DD Armbinder/Yoke, Cloaks)
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor47()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00020000)) as armor	;47 Unnamed 		(DD -, Backpacks, Wings)
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor48()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00040000)) as armor	;48 Unnamed 		(DD plugs anal, Backpack left pouch)
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor49()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00080000)) as armor	;49 Unnamed 		(DD Body harness/Chastity belt)
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor50()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00100000)) as armor	;50 Unnamed 		(DD Body harness/Chastity belt)
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor51()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00200000)) as armor	;51
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor52()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00400000)) as armor	;52
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor53()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00800000)) as armor	;53
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor54()
	armor CheckArmor = (PlayerRef.GetWornForm(0x01000000)) as armor	;54
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor55()
	armor CheckArmor = (PlayerRef.GetWornForm(0x02000000)) as armor	;55
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor56()
	armor CheckArmor = (PlayerRef.GetWornForm(0x04000000)) as armor	;56
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor57()
	armor CheckArmor = (PlayerRef.GetWornForm(0x08000000)) as armor	;57
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction
	
Bool Function CheckArmor58()
	armor CheckArmor = (PlayerRef.GetWornForm(0x10000000)) as armor	;58
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor59()
	armor CheckArmor = (PlayerRef.GetWornForm(0x20000000)) as armor	;59
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

Bool Function CheckArmor60()
	armor CheckArmor = (PlayerRef.GetWornForm(0x40000000)) as armor	;60
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	


Bool Function CheckArmor61()
	armor CheckArmor = (PlayerRef.GetWornForm(0x80000000)) as armor	;61
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction	

;/
akFormlist.AddForm(PlayerRef.GetWornForm(0x00002000))	;43 - Ears 	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00004000))	;44 - Unnamed 		(DD Gag/Mouth, SexlabTongue)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00008000))	;45 - Unnamed 		(DD Collars)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00010000))	;46 - Unnamed 		(DD Armbinder/Yoke, Cloaks)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00020000))	;47 - Unnamed 		(DD -, Backpacks, Wings)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00040000))	;48 - Unnamed 		(DD plugs anal, Backpack left pouch)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00080000))	;49 - Unnamed 		(DD Body harness/Chastity belt)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00100000))	;50 - Decap. Head	(DD Piercings Vaginal, bracelets)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00200000))	;51 - Decapitate
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00400000))	;52 - Unnamed
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00800000))	;53 - Unnamed	(DD Cuffs Legs)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x01000000))	;54 - Unnamed	(DD Plugs vaginal)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x02000000))	;55 - Unnamed	(DD Blindfold)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x04000000))	;56 - Unnamed	(DD Chastity Bra)		
	akFormlist.AddForm(PlayerRef.GetWornForm(0x08000000))	;57 - Unnamed	(DD Vaginal Plugs)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x10000000))	;58 - Unnamed	(DD Body Harness/Corset
	akFormlist.AddForm(PlayerRef.GetWornForm(0x20000000))	;59 - Unnamed	(DD Cuffs Arms)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x40000000))	;60 - Unnamed
	akFormlist.AddForm(PlayerRef.GetWornForm(0x80000000))	;61 - Unnamed
	/;
	
;SHIELD
Bool Function CheckWeaponShield()
	armor CheckArmor = (PlayerRef.GetWornForm(0x00000200)) as armor	;39 - SHIELD
	if CheckArmor
	return true
	else
	return false
	endif
EndFunction

Function EquipRandomOutfit()			;#EquipRandomOutfit()
;AT THE MOMENT WILL ONLY CHECK FOR LIGHT ARMOR AND CLOTHING AT THE MAIN SLOTS
	
	Formlist FormlistInventory = RobbedStuff ;TODO
	FormlistInventory.Revert()
	;PO3 Functions also worked, I was just stupid and did not have a FORMLIST!!! !
	
	
	;PO3_SKSEFunctions.AddAllItemsToList(PlayerRef, FormlistInventory, true, false, false)
			
	;Form[] Function AddItemsOfTypeToArray(ObjectReference akRef, int aiFormType, bool abNoEquipped = true, bool abNoFavorited = false, bool abNoQuestItem = false) global native
	
	;PO3_SKSEFunctions.AddItemsOfTypeToArray(TempArmor
	
	;int i = 10
	int i = 1
	String OutfitNum
	int iFormId
	string sModName 
	Armor TempArmor
	Form TempForm
	
	;int Fuckoff
	;Bool AnimatedEquip = True
		;loops as long as we do NOT wear armor on Slot OR we search all outfits
		
		
	PlayerRef.GetAllForms(FormlistInventory)	

	NymTrace("Formlist Length: "+FormlistInventory.GetSize())	
		
		NymTrace("Immobilize(true) for Random Outfit")
		Immobilize(true)
		IsCheat = true
		;currently searches from 10 to 1. I want it to search from 1 to 10...
		
		;MAIN--- HEAD -----------------------------------------------------------------------------------------------
		;while !CheckArmorHead() && (i > 0)
		
		IdleEquipHead()	
		
		while !CheckArmorHead() && (i < 11) ;search 10 outfits 
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			;i -= 1
			i += 1
			TempForm = none			
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot31")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot31")		
			if ((sModName != "empty") && (sModName != "")) && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			;i = 11
			else ;check slot 42 (circlet)
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot42")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot42")		
				TempForm = none
				if (sModName != "empty") && (sModName != "")
				TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
				endif 		

				if FormlistInventory.HasForm(TempForm) 
				TempArmor = TempForm as armor
					if TempArmor && IsItem("Armor Type Light", TempArmor)
					PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					i = 11
					endif
				endif 
			endif
		endwhile
		Utility.Wait(2.0)
		;i = 10
		i = 1
		
		;MAIN--- BODY -----------------------------------------------------------------------------------------------
	
		IdleEquipBody()
	
		while !CheckArmorBody() && (i < 11)
			
			NymTrace("EquipRandomOutFitLoops (Body): "+i)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			;i += 1
			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot32")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot32")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
			
		endwhile
		Utility.Wait(2.0)
		;i = 10
		i = 1
	
		;MAIN--- HANDS -----------------------------------------------------------------------------------------------
	
		while !CheckArmorHands() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none			
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot33")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot33")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
			
		endwhile	
		Utility.Wait(2.0)
		;i = 10
		i = 1
	
		;MAIN--- FEET -----------------------------------------------------------------------------------------------
	
	
		IdleEquipFeet()
	
		while !CheckArmorFeet() && (i < 11)
		
				
			NymTrace("EquipRandomOutFitLoops (Feet): "+i)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot37")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot37")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	
		
		Utility.Wait(2.0)
		;i = 10
		i = 1
		
		;secondary--- 34 -----------------------------------------------------------------------------------------------
	
		;LOOP IDLE FOR THE REST
		IdleEquipBody()

		while !CheckArmor34() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot34")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot34")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile		
						If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1
		
		;secondary--- 35 -----------------------------------------------------------------------------------------------
	
		while !CheckArmor35() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot35")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot35")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile		
						If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1
		
		;secondary--- 36 -----------------------------------------------------------------------------------------------
	
		while !CheckArmor36() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot36")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot36")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile		
						If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1

		;secondary--- 38 -----------------------------------------------------------------------------------------------
	
		while !CheckArmor38() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot38")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot38")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile		
						If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	
		
		;secondary--- 40 -----------------------------------------------------------------------------------------------

		while !CheckArmor40() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot40")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot40")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	
						If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	

		;secondary--- 41 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor41() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot41")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot41")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	

		;secondary--- 43 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor43() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot43")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot43")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	

		;secondary--- 44 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor44() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot44")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot44")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	

		;secondary--- 45 -----------------------------------------------------------------------------------------------
		;we loop until slot 45 is occupied
		while !CheckArmor45() && (i < 11) ;#OMG
		
			NymTrace("EquipRandomOutFitLoops (Collar 45): "+i)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
						TempForm = none
		;	OBJECTREFERENCE TempObject

			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot45")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot45")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 

;/
;LocHostile = (Game.GetFormFromFile(0x000EE357, "Skyrim.esm") As ObjectReference)

			NymTrace("TempForm: "+TempForm)
			
		;	TempObject = TempForm.GetBaseObject() ;as OBJECTREFERENCE
			
			TempForm = none 
			;Form Function FindFirstItemInList(ObjectReference akRef, FormList akList) global native
								
			TempForm = PO3_SKSEFunctions.FindFirstItemInList(TempObject, Outfit_JSON_FList[1])
			if !TempForm
			TempForm = PO3_SKSEFunctions.FindFirstItemInList(TempObject, Outfit_JSON_FList[2])
			endif 
			if !TempForm
			TempForm = PO3_SKSEFunctions.FindFirstItemInList(TempObject, Outfit_JSON_FList[3])
			endif 			
			if !TempForm
			TempForm = PO3_SKSEFunctions.FindFirstItemInList(TempObject, Outfit_JSON_FList[4])
			endif 	
			if !TempForm
			TempForm = PO3_SKSEFunctions.FindFirstItemInList(TempObject, Outfit_JSON_FList[5])
			endif 	
			if !TempForm
			TempForm = PO3_SKSEFunctions.FindFirstItemInList(TempObject, Outfit_JSON_FList[6])
			endif 			
			
			if TempForm
			/;
			;if TempArmor
			;Utility.Wait(1.0)
		;	PlayerRef.EquipItemEx(TempForm, 0, false, true)
		;	i = 11
		;	endif
		endwhile		
						If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1

		;secondary--- 46 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor46() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot46")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot46")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	

		;secondary--- 47 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor47() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot47")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot47")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	

		;secondary--- 48 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor48() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot48")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot48")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	

		;secondary--- 49 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor49() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot49")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot49")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile		
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1
		
		;secondary--- 50 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor50() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot50")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot50")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	
		
		;secondary--- 51 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor51() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot51")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot51")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	
		
		;secondary--- 52 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor52() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot52")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot52")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile			
						If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	
		
		;secondary--- 53 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor53() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot53")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot53")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	
						If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	
		
		;secondary--- 54 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor54() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot54")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot54")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile

				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1
		
		;secondary--- 55 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor55() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot55")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot55")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	
		
		;secondary--- 56 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor56() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot56")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot56")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;i = 10
		i = 1	
		
		;secondary--- 57 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor57() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot57")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot57")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	

		;i = 10
		i = 1
		
		;secondary--- 58 -----------------------------------------------------------------------------------------------
				If Nym()
		;Utility.Wait(1.2)
		endif 
		
		while !CheckArmor58() && (i < 11)
		
			NymTrace("EquipRandomOutFitLoops (Pauldron 58): "+i)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot58")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot58")		
			if (sModName != "empty") && (sModName != "")
			NymTrace("FUCK 58 A")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		
			
			if FormlistInventory.HasForm(TempForm) 
			NymTrace("FUCK 58 B")
			TempArmor = TempForm as armor
				if TempArmor ;&& IsItem("Armor Type Light", TempArmor)
				NymTrace("FUCK 58 C")
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile

		;i = 10
		i = 1
		
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;secondary--- 59 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor59() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot59")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot59")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	

		;i = 10
		i = 1	
		
				If Nym()
		;Utility.Wait(1.2)
		endif 
		;secondary--- 60 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor60() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot60")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot60")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile	

		If Nym()
		;Utility.Wait(1.2)
		endif 
		
		;secondary--- 61 -----------------------------------------------------------------------------------------------
		
		while !CheckArmor61() && (i < 11)
		
			if i < 10
			OutfitNum = "0"+i
			elseif i == 10
			OutfitNum = "10"
			endif

			i += 1
			TempForm = none
			iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot61")	
			sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot61")		
			if (sModName != "empty") && (sModName != "")
			TempForm = (Game.GetFormFromFile(iFormId, sModName) as Form)		
			endif 		

			if FormlistInventory.HasForm(TempForm) 
			TempArmor = TempForm as armor
				if TempArmor && IsItem("Armor Type Light", TempArmor)
				PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				i = 11
				endif
			endif 
		endwhile			

	
	NymTrace("IsCheat = false (C)")
	IdleEquipFinish()	
	Utility.Wait(2.0)	
	Immobilize(false)
	IsCheat = false
EndFunction		



;>>>>>>>>>>>>>> LOAD OUTFIT/ITEM >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

bool Property IsCheat Auto

Function Load_JSON_Outfit(string OutfitNum, string Items, bool EquipOnly)			;#OUTFIT #JSON #Load_JSON_Outfit
Debug.Trace("NAKED DEFEAT configquest: Load_JSON_Outfit()")
Debug.Trace("NAKED DEFEAT configquest: Load_JSON_Outfit - OutfitNum: "+OutfitNum)		;#BETA 4.93
Debug.Trace("NAKED DEFEAT configquest: Load_JSON_Outfit - Items: "+Items)				;#BETA 4.93
Debug.Trace("NAKED DEFEAT configquest: Load_JSON_Outfit - EquipOnly: "+EquipOnly)		;#BETA 4.93

	if !LootScriptRunning										;#BETA 4.93
	LootScriptRunning = true
	else														;#BETA 4.93	
	InfoMessage("#ERROR - LootScriptRunning = false")			;#BETA 4.93
	endif		;#BETA 4.93	
	
		
	if items == "All"
	;StripCompletely(0,0,0,0,0)
	endif
	

;/ TODO

	When Save Profile I want an option to input a name. "empty" is the default name
	The name should appear on "Load Outfit" together with the type we determine internaly (light/heavy/clothes/naked)
/;

	DebugMessage("Load_JSON_Outfit()")

	Armor TempArmor
	Int iFormId      
	Int iModIndex    
	String sModName 
	bool InventoryOpen = false
	
	If PapyrusUtil.GetVersion() > 1

		If JsonExists("../Naked Defeat/outfit" +OutfitNum+ "")
		
		
			if UI.IsMenuOpen("Main Menu") || UI.IsMenuOpen("InventoryMenu")
			InventoryOpen = true
			
			;	if IsNymrasGame()
				NymTrace("Immobilize(true) for Load_JSON_Outfit A")
				Immobilize(true)
				;UI.Invoke("ContainerMenu", "_root.Menu_mc.onExitMenuRectClick")
				Input.TapKey(15) ;guess I need ESC key not Tap... 
				Immobilize(false)
			endif 
			
			
			if UI.IsMenuOpen("Main Menu") || UI.IsMenuOpen("InventoryMenu")
			InventoryOpen = true
				
			Debug.MessageBox("Close Menu/Inventory to allow the animated equip sequence to start")
				
					while InventoryOpen && ModEnabled
					InventoryOpen = UI.IsMenuOpen("InventoryMenu")
					Utility.Wait(1.0)		;--- need WAITMENU 	
					endwhile
				
			endif
	

			; >>> EQUIP INDIVIDUAL SLOTS <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< ;
					
			;MAIN SLOTS:
			;31 - Hair / HELMET 
			;or 42 - Circlet
			;32 - BODY
			;33 - HANDS	
			;37 - FEET	
			NymTrace("Immobilize(true) for Load_JSON_Outfit B")
			Immobilize(true)
					
			if Items != "All"	
				;HELMET ONLY (slot 31 or 42) -------------------------------------------------------------------
				if Items == "Helmet"					
					
					if !IsCheat
					PlayerRef.PlayIdle(IdlesFixHair[1])
					Utility.Wait(1.0)
					endif
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot31")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot31")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					endif 		
					if TempArmor ;check slot 31 (helmet)
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					else ;check slot 42 (circlet)
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot42")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot42")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					endif 
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 	
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				
	
				;32 - BODY ONLY ------------------------------------------------------------------- ;NOT NEEDED?
				;elseif Items 
				;	iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot32")	
				;	sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot32")		
				;	TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				;	if TempArmor
				;		if !EquipOnly
				;		PlayerRef.AddItem(TempArmor, 1, true)
				;		endif 			
				;		PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				;	endif
				
				;"Gauntlets ONLY" -------------------------------------------------------------------
				elseif Items == "Gauntlets"
					if !IsCheat
					PlayerRef.PlayIdle(IdlesBathingStanding[2])
					Utility.Wait(1.0)
					endif
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot33")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot33")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					endif 		
					if TempArmor
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
					
				;"Boots ONLY" -------------------------------------------------------------------
				elseif Items == "Boots"			
					if !IsCheat
					PlayerRef.PlayIdle(IdlesBathingStanding[3])	
					Utility.Wait(1.0)
					endif
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot37")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot37")		
					
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					endif 
					if TempArmor
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif					
				endIf
				;SlotNum = 0
		
			; >>> EQUIP ALL ITEMS <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< ;
		
			elseif items == "All"
			
				if !IsCheat
				PlayerRef.PlayIdle(IdlesFixHair[1])	
				endif
				
				if !CheckArmorHead()
				;if we wear a head item we do not add or equip anything
					;30 - head -------------------------------------------------------------------
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot30")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot30")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
					Utility.Wait(1.0)	
					;31 - hair/HELMET -------------------------------------------------------------------
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot31")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot31")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 	
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
					if !IsCheat
					PlayerRef.PlayIdle(IdlesBathingStanding[6])	
					endif
				endif	
				;32 - BODY -------------------------------------------------------------------
				
				if !CheckArmorBody()

					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot32")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot32")
					;Debug.Trace("NAKED DEFEAT configquest: Load_JSON_Outfit - BODY iFormId: "+iFormId);#BETA 4.93
					;Debug.Trace("NAKED DEFEAT configquest: Load_JSON_Outfit - BODY iFormId: "+sModName);#BETA 4.93				
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 
					;Debug.Trace("NAKED DEFEAT configquest: Load_JSON_Outfit - BODY TempArmor: "+TempArmor);#BETA 4.93				
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
					if !IsCheat
					PlayerRef.PlayIdle(IdlesBathingStanding[2])	
					endif
				endif	
				
				;33 - HANDS -------------------------------------------------------------------
				if !CheckArmorHands()
				
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot33")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot33")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif	
				
				;34 - ??? -------------------------------------------------------------------
				if !CheckArmor34()
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot34")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot34")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif	
				
				;35 - ??? -------------------------------------------------------------------
				if !CheckArmor35()
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot35")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot35")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;36 - ??? -------------------------------------------------------------------
				if !CheckArmor36()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot36")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot36")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;37 - FEET -------------------------------------------------------------------
				if !CheckArmor37()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot37")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot37")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;38 - ??? -------------------------------------------------------------------
				if !CheckArmor38()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot38")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot38")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif  			
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;39 - SHIELD ------------------------------------------------------------------- ;NOT IN USE FOR NOW
					;/
				if !CheckArmor39()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot39")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot39")		
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				/;
				;40 - ??? -------------------------------------------------------------------
				if !CheckArmor40()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot40")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot40")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;41 - ??? -------------------------------------------------------------------
				if !CheckArmor41()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot41")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot41")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif  		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;42 - Circlet -------------------------------------------------------------------
				if !CheckArmor42()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot42")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot42")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;43 - ??? -------------------------------------------------------------------
				if !CheckArmor43()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot43")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot43")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;44 - ??? -------------------------------------------------------------------
				if !CheckArmor44()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot44")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot44")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif	
				endif	
				;45 - ??? -------------------------------------------------------------------
				if !CheckArmor45()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot45")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot45")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 	
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif	
				endif
				;46 - ??? -------------------------------------------------------------------
				if !CheckArmor46()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot46")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot46")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif  		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;47 - ??? -------------------------------------------------------------------
				if !CheckArmor47()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot47")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot47")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
							PlayerRef.AddItem(TempArmor, 1, true)
							endif 			
							PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;48 - ??? -------------------------------------------------------------------
				if !CheckArmor48()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot48")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot48")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif  		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;49 - ??? -------------------------------------------------------------------
				if !CheckArmor49()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot49")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot49")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif	
				endif
				;50 - ??? -------------------------------------------------------------------
				if !CheckArmor50()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot50")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot50")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif  		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;51 - ??? -------------------------------------------------------------------
				if !CheckArmor51()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot51")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot51")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;52 - ??? -------------------------------------------------------------------
				if !CheckArmor52()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot52")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot52")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif	
				endif
				;53 - ??? -------------------------------------------------------------------
				if !CheckArmor53()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot53")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot53")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;54 - ??? -------------------------------------------------------------------
				if !CheckArmor54()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot54")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot54")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 			
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;55 - ??? -------------------------------------------------------------------
				if !CheckArmor55()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot55")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot55")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;56 - ??? -------------------------------------------------------------------
				if !CheckArmor56()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot56")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot56")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif  		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;57 - ??? -------------------------------------------------------------------
				if !CheckArmor57()
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot57")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot57")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 			
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;58 - ??? -------------------------------------------------------------------
				if !CheckArmor58()									
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot58")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot58")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 			
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;59 - ??? -------------------------------------------------------------------
				if !CheckArmor59()									
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot59")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot59")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
				endif
				;60 - ??? -------------------------------------------------------------------
				if !CheckArmor60()				
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot60")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot60")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif	
				endif
				;61 - ??? -------------------------------------------------------------------
				if !CheckArmor61()	
					iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot61")	
					sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot61")		
					if (sModName != "empty") && (sModName != "")
					TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)
					else
					TempArmor = none
					endif 		
					if TempArmor
						if !IsCheat
						Utility.Wait(1.0)	
						endif	
						if !EquipOnly
						PlayerRef.AddItem(TempArmor, 1, true)
						endif 			
						PlayerRef.EquipItemEx(TempArmor, 0, false, false)
					endif
					
				;	if IsNymrasGame() && Game.GetModByName("HDTPhysicsWeaponSling.esp") != 255
				;	TempArmor = (Game.GetFormFromFile(0x0100BFDC, "HDTPhysicsWeaponSling.esp") as armor)
				;		;if !EquipOnly
				;		PlayerRef.AddItem(TempArmor, 1, true)
				;		;endif 			
				;		PlayerRef.EquipItemEx(TempArmor, 0, false, false)
				;	endif
					if !IsCheat
					PlayerRef.PlayIdle(IdlesFixHair[0]) ;RESET IDLE
					endif
					;Debug.MessageBox("Outfit loaded.")
				;	ApplySettings()		;needed for what???!!!
				endif
			endif
			
			Immobilize(false)
			
			if IsCheat
			NymTrace("IsCheat = false (A)")
			IsCheat = false
			endif	
				
			if LootScriptRunning
			LootScriptRunning = false
			endif 

		else
			Debug.MessageBox("OutfitX.Json does not exist.")
		endif
				
	else
		Debug.MessageBox("PapyrusUtil needs to be installed for Profiles to work properly.")
	endif
	
	if IsCheat
	NymTrace("IsCheat = false (B)")
	IsCheat = false
	endif	
		
	if LootScriptRunning
	LootScriptRunning = false
	endif 

EndFunction


Function Import_JSON_Outfits()			;#OUTFIT #JSON #Import_JSON_Outfits

Debug.Trace("NAKED DEFEAT configquest: Import_JSON_Outfits()")


	Armor TempArmor
	Int iFormId      
	Int iModIndex    
	String sModName 

	
	String OutfitNum

	;-------- From SAVE WEAPON TO FORMLIST SCRIPT -------------------------------
	;Debug.Trace("Naked Defeat configquest: SaveWeapon(START) - WeaponNum: "+WeaponNum)
	
	int i = 10
	
while i > 0

	;GET NUMBER
	if i < 10
	OutfitNum = "0"+i
	elseif i == 10
	OutfitNum = "10"
	endif
	Debug.Trace("NAKED DEFEAT configquest: Import_JSON_Outfits - OutfitNum: "+OutfitNum)	

	
	;GET Outfit FORMLIST
	Formlist akFormlist
	akFormlist = Outfit_JSON_FList[i]
	akFormlist.Revert()
	
	i -= 1

	
	If PapyrusUtil.GetVersion() > 1

		If JsonExists("../Naked Defeat/outfit" +OutfitNum+ "")
										
				;30 - head -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot30")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot30")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				Utility.Wait(1.0)	
				;31 - hair/HELMET -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot31")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot31")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				;32 - BODY -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot32")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot32")				
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)				
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;33 - HANDS -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot33")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot33")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;34 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot34")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot34")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;35 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot35")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot35")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;36 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot36")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot36")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;37 - FEET -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot37")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot37")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;38 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot38")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot38")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif

				;39 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot39")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot39")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;40 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot40")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot40")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;41 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot41")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot41")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;42 - Circlet -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot42")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot42")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;43 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot43")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot43")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
			
				;44 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot44")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot44")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif	
				
				;45 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot45")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot45")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif	
				
				;46 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot46")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot46")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;47 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot47")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot47")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;48 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot48")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot48")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;49 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot49")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot49")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif	
				
				;50 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot50")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot50")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;51 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot51")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot51")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;52 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot52")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot52")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif	
				
				;53 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot53")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot53")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;54 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot54")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot54")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;55 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot55")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot55")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;56 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot56")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot56")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;57 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot57")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot57")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;58 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot58")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot58")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
				;59 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot59")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot59")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
			
				;60 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot60")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot60")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif	
			
				;61 - ??? -------------------------------------------------------------------
				iFormId = GetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot61")	
				sModName = GetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot61")		
				TempArmor = (Game.GetFormFromFile(iFormId, sModName) as armor)			
				if TempArmor
				akFormlist.AddForm(TempArmor)
				endif
				
			;	if IsNymrasGame() && Game.GetModByName("HDTPhysicsWeaponSling.esp") != 255
			;	TempArmor = (Game.GetFormFromFile(0x0100BFDC, "HDTPhysicsWeaponSling.esp") as armor)
			;		if TempArmor
			;		akFormlist.AddForm(TempArmor)
			;		endif
			;	endif

		else
			Debug.MessageBox("OutfitX.Json does not exist.")
		endif
				
	else
		Debug.MessageBox("PapyrusUtil needs to be installed for Profiles to work properly.")
	endif
endwhile
	
EndFunction

string weapon_JSON_01_name = "empty"
string weapon_JSON_02_name = "empty"
string weapon_JSON_03_name = "empty"
string weapon_JSON_04_name = "empty"
string weapon_JSON_05_name = "empty"
string weapon_JSON_06_name = "empty"
string weapon_JSON_07_name = "empty"
string weapon_JSON_08_name = "empty"
string weapon_JSON_09_name = "empty"
string weapon_JSON_10_name = "empty"

string weapon_JSON_01_type = "empty"
string weapon_JSON_02_type = "empty"
string weapon_JSON_03_type = "empty"
string weapon_JSON_04_type = "empty"
string weapon_JSON_05_type = "empty"
string weapon_JSON_06_type = "empty"
string weapon_JSON_07_type = "empty"
string weapon_JSON_08_type = "empty"
string weapon_JSON_09_type = "empty"
string weapon_JSON_10_type = "empty"		;this gets deleted on New Game. From where is it saved? ---> should be loaded with profile load

string weapon_JSON_01_generaltype = "empty"
string weapon_JSON_02_generaltype = "empty"
string weapon_JSON_03_generaltype = "empty"
string weapon_JSON_04_generaltype = "empty"
string weapon_JSON_05_generaltype = "empty"
string weapon_JSON_06_generaltype = "empty"
string weapon_JSON_07_generaltype = "empty"
string weapon_JSON_08_generaltype = "empty"
string weapon_JSON_09_generaltype = "empty"
string weapon_JSON_10_generaltype = "empty"
;/

	Armor TempArmor
	Form TempForm
	int TempId
	Int iFormId = 0      
	Int iModIndex    
	String sModName = "empty"
	String TempType

If PapyrusUtil.GetVersion() > 1

	If JsonExists("../Naked Defeat/outfit" +OutfitNum+ "")
	
		bool TestVersion = true
		if TestVersion ;FOR SE 
		
		; --- SAVE OUTFIT to FORMLIST --- ;
		;!!!!!!!!!!!!!!!!!!!!!!important for internal use !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
	
		SaveOutfit(OutfitNum)	;save to Formlist
		
		
		; --- 30 ---- HEAD ----------------------------------------------------------- ;	
		TempForm = PlayerRef.GetWornForm(0x00000001) as Form 	;30 - head
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		NymMessage("sModName HEAD: "+sModName)		
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot30", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot30", sModName)
		

/;
Function Save_JSON_Weapon(string WeaponNum)			;#Save_JSON_Weapon #JSON
Debug.Trace("NAKED DEFEAT configquest: Save_JSON_Weapon("+WeaponNum+")")

;	if ShowInfoMessages
;	Debug.MessageBox("Only ONE weapon OR shield is saved (and if LEFT or RIGHT hand is wielding it. Unequip all but ONE weapons and shields!") 
;	endif
;this saves the equiped ARMOR parts to an external JSON file.
;IMPORTANT: if slots are left empty, this will also delete previously saved stuff in that slot with "none"

	Weapon TempWeaponL
	Weapon TempWeaponR
	Armor TempShield
	Form TempForm
	int TempId
	Int iFormId      
	Int iModIndex    
	String sModName 
	String TempType
	String TempGeneralType
	int EquipmentFound = 0
	bool AbortSaving = false
	int TempWeaponType
	
If PapyrusUtil.GetVersion() > 1

	If JsonExists("../Naked Defeat/weapon" +weaponNum+ "")
	
	; --- SAVE weapon to FORMLIST --- ;
	;important for internal use

		TempShield = PlayerRef.GetEquippedShield() as armor
		if TempShield
		Debug.Trace("NAKED DEFEAT configquest: Save_JSON_Weapon(TempShield Found)")
		EquipmentFound += 1
		endif		
		TempWeaponL =	PlayerRef.GetEquippedWeapon(true) as weapon
		if TempWeaponL
		Debug.Trace("NAKED DEFEAT configquest: Save_JSON_Weapon(TempWeaponL Found)")
		EquipmentFound += 1
		endif
		TempWeaponR =	PlayerRef.GetEquippedWeapon(false) as weapon
		if TempWeaponR
		Debug.Trace("NAKED DEFEAT configquest: Save_JSON_Weapon(TempWeaponR Found)")
		EquipmentFound += 1
		endif

		if EquipmentFound == 0
		Debug.MessageBox("#ERROR: no weapon or shield equiped")
		AbortSaving = true
		elseif EquipmentFound > 1
		Debug.MessageBox("#ERROR: Aborted. more than one weapon or shield equiped. Unequip all but ONE weapon OR shield.")
		AbortSaving = true
		elseif (EquipmentFound == 1) ;&& ShowInfoMessages
			if TempShield
			Debug.MessageBox("Shield found and saved")
			TempWeaponType = 3
			elseif TempWeaponL
			Debug.MessageBox("Weapon (Left hand) found and saved")
			TempWeaponType = 2
			elseif TempWeaponR
			Debug.MessageBox("Weapon (Right hand) found and saved")
			TempWeaponType = 1
			endIf		
		endIf

		SaveWeapon(WeaponNum, TempWeaponType)	;#SaveWeapon1
		
		if !AbortSaving
			; -- SHIELD -- ;
			if TempShield
			TempForm = TempWeaponR as Form	
			TempId       = TempShield.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			;iModIndex    = Math.RightShift(TempId, 24)                     
			;iModIndex    = Math.RightShift(TempId, 24)                     
			;sModName    = Game.GetModName(iModIndex) 
			sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)

			SetINTValue("../Naked Defeat/weapon" +weaponNum+ ".json", "ID_Shield", iFormId as int)	
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "STRING_Shield", sModName)
			SetINTValue("../Naked Defeat/weapon" +weaponNum+ ".json", "IsShield", 1 as int)

			weapon_JSON_01_type = "Shield"
			
			; -- LEFT hand weapon -- ; --> stupid, L and R are now identical. but not important.
			elseif TempWeaponL 	
			TempForm = TempWeaponR as Form	
			TempId       = TempWeaponL.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			;iModIndex    = Math.RightShift(TempId, 24)                     
			;sModName    = Game.GetModName(iModIndex) 
			sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
			SetINTValue("../Naked Defeat/weapon" +weaponNum+ ".json", "ID_Weapon", iFormId as int)	
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "STRING_Weapon", sModName)
			SetINTValue("../Naked Defeat/weapon" +weaponNum+ ".json", "IsShield", 0 as int)
			; -- RIGHT hand weapon -- ;
			elseif TempWeaponR 		
			TempForm = TempWeaponR as Form	
			TempId       = TempWeaponR.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			;iModIndex    = Math.RightShift(TempId, 24)                     
			;sModName    = Game.GetModName(iModIndex) 
			sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
			SetINTValue("../Naked Defeat/weapon" +weaponNum+ ".json", "ID_Weapon", iFormId as int)	
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "STRING_Weapon", sModName)
			SetINTValue("../Naked Defeat/weapon" +weaponNum+ ".json", "IsShield", 0 as int)
			endif

			; -- Save Weapon Type -- ;
			if TempWeaponL || TempWeaponR
			Weapon SaveThisWeapon
				if TempWeaponL
				SaveThisWeapon = TempWeaponL
				SetINTValue("../Naked Defeat/weapon" +weaponNum+ ".json", "HandSlot", 2 as int)
				elseif TempWeaponR
				SaveThisWeapon = TempWeaponR
				SetINTValue("../Naked Defeat/weapon" +weaponNum+ ".json", "HandSlot", 1 as int)
				endIf

				if SaveThisWeapon.IsSword()
				TempType = "Sword"
				TempGeneralType = "OneHanded"
				elseif SaveThisWeapon.IsWarAxe()
				TempType = "WarAxe"
				TempGeneralType = "OneHanded"
				elseif SaveThisWeapon.IsBattleAxe()
				TempType = "BattleAxe"
				TempGeneralType = "TwoHanded"
				elseif SaveThisWeapon.IsGreatsword()
				TempType = "Greatsword"
				TempGeneralType = "TwoHanded"
				elseif SaveThisWeapon.IsStaff()
				TempType = "Staff"
				TempGeneralType = "TwoHanded"
				elseif SaveThisWeapon.IsBow()
				TempType = "Bow"
				TempGeneralType = "Ranged"
				elseif SaveThisWeapon.IsDagger()
				TempType = "Dagger"
				TempGeneralType = "OneHanded"
				elseif SaveThisWeapon.IsMace()
				TempType = "Mace"
				TempGeneralType = "OneHanded"
				elseif SaveThisWeapon.IsWarhammer()
				TempType = "Warhammer"
				TempGeneralType = "TwoHanded"
				endif
			endif
	
			; -- Finalise Saving to WeaponProfile -- ;
			if weaponNum == "01"
			weapon_JSON_01_type = TempType	
			weapon_JSON_01_generaltype = TempGeneralType			
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_NAME", weapon_JSON_01_name)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_TYPE", weapon_JSON_01_type)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_GENERALTYPE", weapon_JSON_01_generaltype)
			elseif weaponNum == "02"
			weapon_JSON_02_type = TempType
			weapon_JSON_02_generaltype = TempGeneralType
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_NAME", weapon_JSON_02_name)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_TYPE", weapon_JSON_02_type)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_GENERALTYPE", weapon_JSON_02_generaltype)
			elseif weaponNum == "03"
			weapon_JSON_03_type = TempType
			weapon_JSON_03_generaltype = TempGeneralType
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_NAME", weapon_JSON_03_name)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_TYPE", weapon_JSON_03_type)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_GENERALTYPE", weapon_JSON_03_generaltype)
			elseif weaponNum == "04"
			weapon_JSON_04_type = TempType
			weapon_JSON_04_generaltype = TempGeneralType
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_NAME", weapon_JSON_04_name)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_TYPE", weapon_JSON_04_type)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_GENERALTYPE", weapon_JSON_04_generaltype)
			elseif weaponNum == "05"
			weapon_JSON_05_type = TempType
			weapon_JSON_05_generaltype = TempGeneralType
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_NAME", weapon_JSON_05_name)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_TYPE", weapon_JSON_05_type)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_GENERALTYPE", weapon_JSON_05_generaltype)			
			elseif weaponNum == "06"
			weapon_JSON_06_type = TempType
			weapon_JSON_06_generaltype = TempGeneralType
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_NAME", weapon_JSON_06_name)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_TYPE", weapon_JSON_06_type)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_GENERALTYPE", weapon_JSON_06_generaltype)
			elseif weaponNum == "07"
			weapon_JSON_07_type = TempType
			weapon_JSON_07_generaltype = TempGeneralType
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_NAME", weapon_JSON_07_name)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_TYPE", weapon_JSON_07_type)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_GENERALTYPE", weapon_JSON_07_generaltype)
			elseif weaponNum == "08"
			weapon_JSON_08_type = TempType
			weapon_JSON_08_generaltype = TempGeneralType
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_NAME", weapon_JSON_08_name)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_TYPE", weapon_JSON_08_type)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_GENERALTYPE", weapon_JSON_08_generaltype)
			elseif weaponNum == "09"
			weapon_JSON_09_type = TempType
			weapon_JSON_09_generaltype = TempGeneralType
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_NAME", weapon_JSON_09_name)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_TYPE", weapon_JSON_09_type)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_GENERALTYPE", weapon_JSON_09_generaltype)
			elseif weaponNum == "10"
			weapon_JSON_10_type = TempType
			weapon_JSON_10_generaltype = TempGeneralType
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_NAME", weapon_JSON_10_name)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_TYPE", weapon_JSON_10_type)
			SetStringValue("../Naked Defeat/weapon" +weaponNum+ ".json", "weapon_GENERALTYPE", weapon_JSON_10_generaltype)
			
			endif
			TempType = "empty"
		
			Save("../Naked Defeat/weapon" +weaponNum+ ".json")
			;Debug.MessageBox("weapon saved.")
		endif
	else
	Debug.MessageBox("weaponX.Json does not exist.")
	endif
else
	Debug.MessageBox("PapyrusUtil needs to be installed for this to work properly.")
endif

ForcePageReset()

EndFunction

;>>>>>>>>>>>>>> SAVE OUTFIT >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>		

string outfit_JSON_01_name = "empty"
string outfit_JSON_02_name = "empty"
string outfit_JSON_03_name = "empty"
string outfit_JSON_04_name = "empty"
string outfit_JSON_05_name = "empty"
string outfit_JSON_06_name = "empty"
string outfit_JSON_07_name = "empty"
string outfit_JSON_08_name = "empty"
string outfit_JSON_09_name = "empty"
string outfit_JSON_10_name = "empty"

string outfit_JSON_01_type = "empty"
string outfit_JSON_02_type = "empty"
string outfit_JSON_03_type = "empty"
string outfit_JSON_04_type = "empty"
string outfit_JSON_05_type = "empty"
string outfit_JSON_06_type = "empty"
string outfit_JSON_07_type = "empty"
string outfit_JSON_08_type = "empty"
string outfit_JSON_09_type = "empty"
string outfit_JSON_10_type = "empty"





Function Save_JSON_Outfit(string OutfitNum)			;#OUTFIT #Save_JSON_Outfit
DebugMessage("NAKED DEFEAT: Save_JSON_Outfit()")

;this saves the equiped ARMOR parts to an external JSON file.
;IMPORTANT: if slots are left empty, this will also delete previously saved stuff in that slot with "none"

	Armor TempArmor
	Form TempForm
	int TempId
	Int iFormId = 0      
	Int iModIndex    
	String sModName = "empty"
	String TempType

If PapyrusUtil.GetVersion() > 1

	If JsonExists("../Naked Defeat/outfit" +OutfitNum+ "")
	
		bool TestVersion = true
		if TestVersion ;FOR SE 
		
		; --- SAVE OUTFIT to FORMLIST --- ;
		;!!!!!!!!!!!!!!!!!!!!!!important for internal use !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
	
		SaveOutfit(OutfitNum)	;save to Formlist
		
		
		; --- 30 ---- HEAD ----------------------------------------------------------- ;	
		TempForm = PlayerRef.GetWornForm(0x00000001) as Form 	;30 - head
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		NymMessage("sModName HEAD: "+sModName)		
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot30", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot30", sModName)

		; --- 31 ---- HELMET/HAIR ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00000002) as Form 	;31 - hair/HELMET
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)	
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot31", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot31", sModName)

		; --- 32 ---- BODY ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00000004) as Form	;Body
		
		;set the Type of the Outfit here
		if IsItem("Armor Type Light", TempForm)
		TempType = "Light"
		elseif IsItem("Armor Type Heavy", TempForm)
		TempType = "Heavy"
		elseif IsItem("Armor Type Clothing", TempForm)
		TempType = "Clothes"
		else
		TempType = "Naked"
		endif
		
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)		
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		NymMessage("sModName BODY: "+sModName)		
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot32", iFormId as int)    
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot32", sModName)
		
		; --- 33 ---- HANDS ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00000008) as Form 	;33 - HANDS
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif		
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot33", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot33", sModName)

		; --- 34 ---- Forearms ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00000010) as Form 	;34 - Forearms
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot34", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot34", sModName)
	
		; --- 35 ---- Amulet ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00000020) as Form 	;35 - Amulet
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot35", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot35", sModName)
		
		; --- 36 ---- Ring ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00000040) as Form 	;36 - Ring
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot36", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot36", sModName)
		
		; --- 37 ---- FEET ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00000080) as Form 	;37 - FEET
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot37", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot37", sModName)

		; --- 38 ---- Calves ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00000100) as Form 	;38 - Calves
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot38", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot38", sModName)
		
		; --- 39 ---- SHIELD ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00000200) as Form 	;39 - SHIELD
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot39", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot39", sModName)

		; --- 40 ---- Tail ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00000400) as Form 	;40 - Tail
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot40", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot40", sModName)
		
		; --- 41 ---- Long Hair ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00000800) as Form 	;41 - Long Hair
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot41", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot41", sModName)
		
		; --- 42 ---- Circlet ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00001000) as Form 	;42 - Circlet
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot42", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot42", sModName)
		
		; --- 43 ---- Ears ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00002000) as Form 	;43 - Ears
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot43", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot43", sModName)
		
		; --- 44 ---- Unnamed (DD Gag/Mouth, SexlabTongue) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00004000) as Form 	;44 - Unnamed (DD Gag/Mouth, SexlabTongue)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot44", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot44", sModName)
		
		; --- 45 ---- Unnamed (DD Collars) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00008000) as Form 	;45 - Unnamed (DD Collars)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot45", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot45", sModName)
		
		; --- 46 ---- Unnamed (DD Armbinder/Yoke, Cloaks) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00010000) as Form 	;46 - Unnamed (DD Armbinder/Yoke, Cloaks)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot46", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot46", sModName)
		
		; --- 47 ---- Unnamed (DD - ???)) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00020000) as Form 	;47 - Unnamed (DD - ???)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot47", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot47", sModName)

		; --- 48 ---- Unnamed (DD - ???)) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00040000) as Form 	;48 - Unnamed (DD - ???))
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot48", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot48", sModName)

		; --- 49 ---- Unnamed (DD Body harness/Chastity belt) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00080000) as Form 	;49 - Unnamed (DD Body harness/Chastity belt)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot49", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot49", sModName)

		; --- 50 ---- Decap. Head	(DD Piercings Vaginal, bracelets) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00100000) as Form 	;50 - Decap. Head	(DD Piercings Vaginal, bracelets)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot50", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot50", sModName)
	
		; --- 51 ---- Decapitate ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00200000) as Form 	;51 - Decapitate
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot51", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot51", sModName)
			
		; --- 52 ---- Unnamed ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00400000) as Form 	;52 - Unnamed
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot52", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot52", sModName)
					
		; --- 53 ---- Unnamed (DD Cuffs Legs) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x00800000) as Form 	;53 - Unnamed (DD Cuffs Legs)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot53", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot53", sModName)
			
		; --- 54 ---- Unnamed (DD Plugs vaginal) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x01000000) as Form 	;54 - Unnamed (DD Plugs vaginal)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot54", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot54", sModName)
			
		; --- 55 ---- Unnamed (DD Blindfold) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x02000000) as Form 	;55 - Unnamed (DD Blindfold)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot55", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot55", sModName)

		; --- 56 ---- Unnamed (DD Chastity Bra) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x04000000) as Form 	;56 - Unnamed (DD Chastity Bra)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot56", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot56", sModName)

		; --- 57 ---- Unnamed (DD Vaginal Plugs) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x08000000) as Form 	;57 - Unnamed (DD Vaginal Plugs)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot57", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot57", sModName)

		; --- 57 ---- Unnamed (DD Vaginal Plugs) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x08000000) as Form 	;57 - Unnamed (DD Vaginal Plugs)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot57", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot57", sModName)

		; --- 58 ---- Unnamed (DD Body Harness/Corset) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x10000000) as Form 	;58 - Unnamed (DD Body Harness/Corset)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot58", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot58", sModName)

		; --- 59 ---- Unnamed (DD Cuffs Arms) ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x20000000) as Form 	;59 - Unnamed (DD Cuffs Arms)
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot59", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot59", sModName)

		; --- 60 ---- Unnamed ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x40000000) as Form 	;60 - Unnamed 
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot60", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot60", sModName)

		; --- 61 ---- Unnamed ----------------------------------------------------------- ;
		TempForm = PlayerRef.GetWornForm(0x80000000) as Form 	;61 - Unnamed 
		if TempForm
		TempId       = TempForm.GetFormID()
		iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
		sModName = PO3_SKSEFunctions.GetFormModName(TempForm, false)
		else
		sModName = "empty"
		iFormId = 0
		endif
		SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot61", iFormId as int)	
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot61", sModName)
		
	
		;LE VERSION 
		else
		; --- SAVE OUTFIT to FORMLIST --- ;
		;!!!!!!!!!!!!!!!!!!!!!!important for internal use !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
		
		SaveOutfit(OutfitNum)	;save to Formlist
		
		TempArmor =	(PlayerRef.GetWornForm(0x00000001)) as armor		;30 - head
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot30", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot30", sModName)
		;	endif
	;	DebugMessage("NAKED DEFEAT configquest: TempArmor30: "+TempArmor)	
	;	DebugMessage("NAKED DEFEAT configquest: iFormId30: "+iFormId)
	;	DebugMessage("NAKED DEFEAT configquest: sModName30: "+sModName)	
		
		TempArmor =	(PlayerRef.GetWornForm(0x00000002)) as armor		;31 - hair/HELMET
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex)  					
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot31", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot31", sModName)
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00000004)) as armor		;32 - BODY
		;	if TempArmor	
				if TempArmor.IsLightArmor()
				TempType = "Light"
				elseif TempArmor.IsHeavyArmor()
				TempType = "Heavy"
				elseif TempArmor.IsClothingBody()
				TempType = "Clothes"
				else
				TempType = "Naked"
				endif

				TempId       = TempArmor.GetFormID()
				iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
				iModIndex    = Math.RightShift(TempId, 24)                     
				sModName    = Game.GetModName(iModIndex)                             
				ScreenMessage("iFormId: "+iFormId)
				SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot32", iFormId as int)    
				SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot32", sModName)
				

		;	int iFormIdSHIFT    = Math.RightShift(iFormId, 18)
	;		int FUCKTHIS = Game.GetFormEx(iFormId)	
			;Form FuckThis = (PlayerRef.GetWornForm(0x00000004)) as Form		
		;	SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot32", FuckThis as int)		
		;	SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot32", iFormIdSHIFT as int)
		;	SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot32", sModName)
		;	endif
				
	;	DebugMessage("NAKED DEFEAT configquest: TempArmor32: "+TempArmor)	
	;	DebugMessage("NAKED DEFEAT configquest: iFormId32: "+iFormId)
	;	DebugMessage("NAKED DEFEAT configquest: sModName32: "+sModName)
		
		TempArmor =	(PlayerRef.GetWornForm(0x00000008)) as armor		;33 - HANDS
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot33", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot33", sModName)
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00000010)) as armor		;34 - Forearms
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot34", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot34", sModName)
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00000020)) as armor		;35 - Amulet
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot35", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot35", sModName)
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00000040)) as armor		;36 - Ring 
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex)  							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot36", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot36", sModName)
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00000080)) as armor		;37 - FEET
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot37", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot37", sModName)
		;	endif
		
		TempArmor =	(PlayerRef.GetWornForm(0x00000100)) as armor		;38 - Calves
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot38", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot38", sModName)
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00000200)) as armor		;39 - SHIELD
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot39", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot39", sModName)
		;	endif
		
		TempArmor =	(PlayerRef.GetWornForm(0x00000400)) as armor		;40 - Tail
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot40", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot40", sModName)
		;	endif
			
			
		TempArmor =	(PlayerRef.GetWornForm(0x00000800)) as armor		;41 - Long Hair
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot41", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot41", sModName)
		;	endif
				
		TempArmor =	(PlayerRef.GetWornForm(0x00001000)) as armor		;42 - Circlet
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot42", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot42", sModName)
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00002000)) as armor		;43 - Ears 
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot43", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot43", sModName)
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00002000)) as armor		;44 - Unnamed 		(DD Gag/Mouth, SexlabTongue)
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot44", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot44", sModName)
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00008000)) as armor		;45 - Unnamed 		(DD Collars)
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot45", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot45", sModName)		
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00010000)) as armor		;46 - Unnamed 		(DD Armbinder/Yoke, Cloaks)
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot46", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot46", sModName)		
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00020000)) as armor		;47 - Unnamed 		(DD -, Backpacks, Wings)
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot47", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot47", sModName)	
		;	endif
		
		TempArmor =	(PlayerRef.GetWornForm(0x00040000)) as armor		;48 - Unnamed 		(DD -, Backpacks, Wings)
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot48", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot48", sModName)	
		;	endif
		
		TempArmor =	(PlayerRef.GetWornForm(0x00080000)) as armor		;49 - Unnamed 		(DD Body harness/Chastity belt)
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot49", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot49", sModName)	
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00100000)) as armor		;50 - Decap. Head	(DD Piercings Vaginal, bracelets)
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex)  							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot50", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot50", sModName)	
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x00200000)) as armor		;51 - Decapitate
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot51", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot51", sModName)	
		;	endif
				
		TempArmor =	(PlayerRef.GetWornForm(0x00400000)) as armor		;52 - Unnamed
		;	if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot52", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot52", sModName)	
		;	endif
		
		TempArmor =	(PlayerRef.GetWornForm(0x00800000)) as armor		;53 - Unnamed	(DD Cuffs Legs)
			;if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot53", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot53", sModName)	
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x01000000)) as armor		;54 - Unnamed	(DD Plugs vaginal)
			;if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot54", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot54", sModName)	
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x02000000)) as armor		;55 - Unnamed	(DD Blindfold)
			;if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot55", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot55", sModName)	
		;	endif
		
		TempArmor =	(PlayerRef.GetWornForm(0x04000000)) as armor		;56 - Unnamed	(DD Chastity Bra)
			;if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot56", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot56", sModName)	
		;	endif
		
		TempArmor =	(PlayerRef.GetWornForm(0x08000000)) as armor		;57 - Unnamed	(DD Vaginal Plugs)
			;if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot57", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot57", sModName)	
		;	endif
			
		TempArmor =	(PlayerRef.GetWornForm(0x10000000)) as armor		;58 - Unnamed	(DD Body Harness/Corset
			;if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex)  							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot58", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot58", sModName)	
		;	endif
		
		TempArmor =	(PlayerRef.GetWornForm(0x20000000)) as armor		;59 - Unnamed	(DD Cuffs Arms)
			;if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot59", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot59", sModName)	
		;	endif
		
		TempArmor =	(PlayerRef.GetWornForm(0x40000000)) as armor		;60 - Unnamed
			;if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 						
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot60", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot60", sModName)	
		;	endif
		
		TempArmor =	(PlayerRef.GetWornForm(0x80000000)) as armor		;61 - Unnamed
			;if TempArmor
			TempId       = TempArmor.GetFormID()
			iFormId      = Math.RightShift(Math.LeftShift(TempId,8),8)
			iModIndex    = Math.RightShift(TempId, 24)                     
			sModName    = Game.GetModName(iModIndex) 							
			SetINTValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "ID_slot61", iFormId as int)	
			SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "STRING_slot61", sModName)	
			
		endif 
	;	endif
	;/
	DebugMessage("NAKED DEFEAT configquest: TempArmor: "+TempArmor)	
	DebugMessage("NAKED DEFEAT configquest: iFormId: "+iFormId)
	DebugMessage("NAKED DEFEAT configquest: sModName: "+sModName)	
		
		
	akFormlist.AddForm(PlayerRef.GetEquippedWeapon(false))
	akFormlist.AddForm(PlayerRef.GetEquippedWeapon(true))
	;GetEquippedShield() ???
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000001)) 	;30 - head
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000002)) 	;31 - hair/HELMET
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000004))	;32 - BODY
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000008))	;33 - HANDS
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000010))	;34 - Forearms
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000020))	;35 - Amulet 	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000040))	;36 - Ring 			
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000080))	;37 - FEET
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000100))	;38 - Calves
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000200))	;39 - SHIELD
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000400))	;40 - TAIL
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000800))	;41 - Long Hair
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00001000))	;42 - Circlet
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00002000))	;43 - Ears 	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00004000))	;44 - Unnamed 		(DD Gag/Mouth, SexlabTongue)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00008000))	;45 - Unnamed 		(DD Collars)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00010000))	;46 - Unnamed 		(DD Armbinder/Yoke, Cloaks)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00020000))	;47 - Unnamed 		(DD -, Backpacks, Wings)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00040000))	;48 - Unnamed 		(DD plugs anal, Backpack left pouch)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00080000))	;49 - Unnamed 		(DD Body harness/Chastity belt)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00100000))	;50 - Decap. Head	(DD Piercings Vaginal, bracelets)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00200000))	;51 - Decapitate
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00400000))	;52 - Unnamed
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00800000))	;53 - Unnamed	(DD Cuffs Legs)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x01000000))	;54 - Unnamed	(DD Plugs vaginal)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x02000000))	;55 - Unnamed	(DD Blindfold)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x04000000))	;56 - Unnamed	(DD Chastity Bra)		
	akFormlist.AddForm(PlayerRef.GetWornForm(0x08000000))	;57 - Unnamed	(DD Vaginal Plugs)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x10000000))	;58 - Unnamed	(DD Body Harness/Corset
	akFormlist.AddForm(PlayerRef.GetWornForm(0x20000000))	;59 - Unnamed	(DD Cuffs Arms)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x40000000))	;60 - Unnamed
	akFormlist.AddForm(PlayerRef.GetWornForm(0x80000000))	;61 - Unnamed
/;

		;#TODO need outfit names and types saved with the PROFILE?
		if OutfitNum == "01"
		outfit_JSON_01_type = TempType			
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_NAME", outfit_JSON_01_name)
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_TYPE", outfit_JSON_01_type)
		elseif OutfitNum == "02"
		outfit_JSON_02_type = TempType
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_NAME", outfit_JSON_02_name)
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_TYPE", outfit_JSON_02_type)
		elseif OutfitNum == "03"
		outfit_JSON_03_type = TempType
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_NAME", outfit_JSON_03_name)
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_TYPE", outfit_JSON_03_type)
		elseif OutfitNum == "04"
		outfit_JSON_04_type = TempType
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_NAME", outfit_JSON_04_name)
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_TYPE", outfit_JSON_04_type)
		elseif OutfitNum == "05"
		outfit_JSON_05_type = TempType
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_NAME", outfit_JSON_05_name)
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_TYPE", outfit_JSON_05_type)	
		elseif OutfitNum == "06"
		outfit_JSON_06_type = TempType
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_NAME", outfit_JSON_06_name)
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_TYPE", outfit_JSON_06_type)
		elseif OutfitNum == "07"
		outfit_JSON_07_type = TempType
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_NAME", outfit_JSON_07_name)
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_TYPE", outfit_JSON_07_type)
		elseif OutfitNum == "08"
		outfit_JSON_08_type = TempType
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_NAME", outfit_JSON_08_name)
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_TYPE", outfit_JSON_08_type)
		elseif OutfitNum == "09"
		outfit_JSON_09_type = TempType
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_NAME", outfit_JSON_09_name)
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_TYPE", outfit_JSON_09_type)
		elseif OutfitNum == "10"
		outfit_JSON_10_type = TempType
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_NAME", outfit_JSON_10_name)
		SetStringValue("../Naked Defeat/outfit" +OutfitNum+ ".json", "OutFit_TYPE", outfit_JSON_10_type)
		
		endif
		TempType = "empty"
		
		Save("../Naked Defeat/outfit" +OutfitNum+ ".json")
		Debug.MessageBox("Outfit saved.")
	else
	Debug.MessageBox("OutfitX.Json does not exist.")
	endif
else
	Debug.MessageBox("PapyrusUtil needs to be installed for Profiles to work properly.")
endif

ForcePageReset()

EndFunction


Function Load_JSON_OutFit_Names()


		weapon_JSON_01_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_name");
		weapon_JSON_01_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type");
		weapon_JSON_01_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_generaltype");

		weapon_JSON_02_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_name");
		weapon_JSON_02_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_type");
		weapon_JSON_02_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_generaltype");

		weapon_JSON_03_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_name");
		weapon_JSON_03_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_type");
		weapon_JSON_03_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_generaltype");

		weapon_JSON_04_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_name");
		weapon_JSON_04_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_type");
		weapon_JSON_04_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_generaltype");

		weapon_JSON_05_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_name");
		weapon_JSON_05_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_type");
		weapon_JSON_05_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_generaltype");

		weapon_JSON_06_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_name");
		weapon_JSON_06_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_type");
		weapon_JSON_06_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_generaltype");

		weapon_JSON_07_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_name");
		weapon_JSON_07_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_type");
		weapon_JSON_07_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_generaltype");

		weapon_JSON_08_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_name");
		weapon_JSON_08_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_type");
		weapon_JSON_08_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_generaltype");

		weapon_JSON_09_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_name");
		weapon_JSON_09_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_type");
		weapon_JSON_09_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_generaltype");

		weapon_JSON_10_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_name");
		weapon_JSON_10_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_type");
		weapon_JSON_10_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_generaltype");
	
		
		;Load_JSON_Outfits
		outfit_JSON_01_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_01_name")
		outfit_JSON_01_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_01_type")
	
		outfit_JSON_02_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_02_name")
		outfit_JSON_02_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_02_type")
		
		outfit_JSON_03_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_03_name")
		outfit_JSON_03_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_03_type")	

		outfit_JSON_04_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_04_name")
		outfit_JSON_04_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_04_type")

		outfit_JSON_05_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_05_name")
		outfit_JSON_05_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_05_type")	

		outfit_JSON_06_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_06_name")
		outfit_JSON_06_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_06_type")	

		outfit_JSON_07_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_07_name")
		outfit_JSON_07_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_07_type")	

		outfit_JSON_08_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_08_name")
		outfit_JSON_08_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_08_type")	

		outfit_JSON_09_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_09_name")
		outfit_JSON_09_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_09_type")	

		outfit_JSON_10_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_10_name")
		outfit_JSON_10_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_10_type")

EndFunction 


;----------------- #LOAD / #SAVE SETTINGS			##profile##

Function LoadSaveProfile(bool Load = True)			;#LoadSaveProfile
If PapyrusUtil.GetVersion() > 1
	
	
	;>>>>>> LOADING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
	If Load == True  
		If JsonExists("../Naked Defeat/profile" +Profile+ "")
	
		
		;aFLOAT = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "aFLOAT")
		;aINT = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "aINT")
		;aSTRING = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "aSTRING")
			
		;FORMLISTS	
			
			
		;INT (load)
		NymStripping = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NymStripping")
		VRfix = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "VRfix")
		SSEfix = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "SSEfix")
		NoCrawling = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NoCrawling")
		
		
		ShowDebugMessages = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "ShowDebugMessages")
		ShowNarrativeMessages = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "ShowNarrativeMessages")
		ShowInfoMessages = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "ShowInfoMessages")

		RemoveDDs = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "RemoveDDs")
		
		GodMode = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "GodMode")
		HealthBoost = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "HealthBoost")
		FindSpotTime = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "FindSpotTime")

		NoEssentialPlayer = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NoEssentialPlayer")
		PlayExpressions = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "PlayExpressions")
		NakedBlur = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedBlur")	
		LagFix = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "LagFix")
		
		FemalesAllowed = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "FemalesAllowed")
		AllowCreatures = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowCreatures")
		
		StageGoBack = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "StageGoBack")
		SkipSex = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "SkipSex")
		NakedCumming = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedCumming")
		

		ToggleDeleteDevice = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "ToggleDeleteDevice")
		SimpleSurrender = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "SimpleSurrender")
		WeaponOutSurrender = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "WeaponOutSurrender")
		
		
		Ragdoll = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "Ragdoll")
		MaleFollower = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "MaleFollower")
		FemaleFollower = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "FemaleFollower")
				
		WhipMarks = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "WhipMarks")
		DefeatBreakArmor = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatBreakArmor")
		NakedDrowning = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedDrowning")
		NakedTravel = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedTravel")

		NakedLoot = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedLoot")
		NakedLootHotkeys = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedLootHotkeys")
		SSHandling = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "SSHandling")
		DeviousPiercingEffects = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DeviousPiercingEffects")


		
		DropItem = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DropItem")
		Slippery = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "Slippery")
		StripAttack = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "StripAttack")
		
		NoExtra = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NoExtra")

		Indecency = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "Indecency")
		DefeatRobberyGold = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatRobberyGold")
		DefeatSceneProtectors = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatSceneProtectors")
		DefeatGetUp = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatGetUp")
		NymSpawning = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NymSpawning")
		HeelsFix = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "HeelsFix")
		
		
		NymBeta = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NymBeta")
	
		StripOptions = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "StripOptions")
		WiggleOptions = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "WiggleOptions")
		WiggleOptionsSS = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "WiggleOptionsSS")
		
		DefeatFindSpot = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatFindSpot")
		DefeatEscapeCrawl = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatEscapeCrawl")
		
		
		;>>>>>> LOADING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		;CREATURE TOGGLES -------------------------
		AllowArgonKajit = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowArgonKajit")
		AllowHumanoidBeasts = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowHumanoidBeasts")
		AllowInsects = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowInsects")
		AllowSkeevers = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowSkeevers")
		AllowSpiders = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowSpiders")
		
		AllowSabreCats = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowSabreCats")
		AllowBears = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowBears")
		AllowCanines = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowCanines")
		AllowMammoths = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowMammoths")
		AllowDragons = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowDragons")	
		
		;>>>>>> LOADING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		;AllowNetches = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowNetches")
		AllowDwarven = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowDwarven")
		AllowUndead = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowUndead")
		AllowRieklings = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowRieklings")
		AllowFalmers = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowFalmers")
		
		AllowSpriggans = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowSpriggans")
		AllowElementalsFemale = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowElementalsFemale")
		AllowElementalsMale = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowElementalsMale")
		AllowTentacleStuff = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowTentacleStuff")
		AllowChicken = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowChicken")
	
		AllowHorses = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowHorses")
		AllowCows = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowCows")
		AllowGoats = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowGoats")
		AllowDeers = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowDeers")
		AllowFoxes = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowFoxes")

		AllowRabbits = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowRabbits")
		AllowHorkers = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowHorkers")
		

		;>>>>>> LOADING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		;------ BODY SLOTS
		BlockSlot[0] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[0]")
		BlockSlot[1] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[1]")
		BlockSlot[2] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[2]")
		BlockSlot[3] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[3]")
		BlockSlot[4] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[4]")
		
		BlockSlot[5] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[5]")
		BlockSlot[6] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[6]")
		BlockSlot[7] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[7]")
		BlockSlot[8] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[8]")
		BlockSlot[9] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[9]")
		
		
		BlockSlot[10] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[10]")
		BlockSlot[11] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[11]")
		BlockSlot[12] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[12]")
		BlockSlot[13] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[13]")
		BlockSlot[14] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[14]")
		
		BlockSlot[15] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[15]")
		BlockSlot[16] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[16]")
		BlockSlot[17] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[17]")
		BlockSlot[18] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[18]")
		BlockSlot[19] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[19]")

				
		BlockSlot[20] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[20]")
		BlockSlot[21] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[21]")
		BlockSlot[22] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[22]")
		BlockSlot[23] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[23]")
		BlockSlot[24] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[24]")
		
		BlockSlot[25] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[25]")
		BlockSlot[26] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[26]")
		BlockSlot[27] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[27]")
		BlockSlot[28] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[28]")
		BlockSlot[29] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[29]")
		
		BlockSlot[30] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[30]")
		BlockSlot[31] = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[31]")
		
		;------------------------------------------------		
		;>>>>>> LOADING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		;KEYS (load)
		EscapeKey = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "EscapeKey")
		DefeatKey = GetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatKey")

		;FLOATS
		DebugPunishmentType = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DebugPunishmentType")
		BleedoutCounter = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "BleedoutCounter")
		DefeatPeeProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatPeeProb")
		Group5Pchance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Group5Pchance")
		Group4Pchance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Group4Pchance")
		
		Group3Pchance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Group3Pchance")
		ScenarioChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "ScenarioChance")
		DefeatChainProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatChainProb")
		DefeatForeplayChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatForeplayChance")	
		;>>>>>> LOADING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		
		
		SearchRadius = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "SearchRadius")
		SearchRadiusInterior = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "SearchRadiusInterior")

		DefeatCaptivityProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatCaptivityProb")
		CooperativeSurrenderChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "CooperativeSurrenderChance")
		
		
		DefeatEscapeDiff = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatEscapeDiff")
		DefeatDDeProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatDDeProb")
		
		PunishWhipChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "PunishWhipChance")
		PunishSexChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "PunishSexChance")
		PunishBukkakeChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "PunishBukkakeChance")
		
		
		
		DefeatDeathChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatDeathChance")
		
		DefeatWhipProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatWhipProb")	
		DefeatWhipTime = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatWhipTime")
		
		
		DefeatRobberyProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatRobberyProb")
		NakedDeathChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "NakedDeathChance")
		
		
		DefeatRescueProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatRescueProb")
		FemalesAsMales = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "FemalesAsMales")
		RemoveDDChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "RemoveDDChance")
		
		;>>>>>> LOADING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		
		
			
		DefeatSlaveryProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatSlaveryProb")
		
		DefeatSDweight = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatSDweight")
		DefeatEscTime = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatEscTime")
		
		
		DefeatSpeedMult = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatSpeedMult")
		
		RapeHandsProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "RapeHandsProb")
		WhipmarksDur = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "WhipmarksDur")
		DefeatBreakClothingProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatBreakClothingProb")
	
		PoisonDefeatChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "PoisonDefeatChance")

		DefeatBreakLightProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatBreakLightProb")
		DefeatBreakHeavyProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatBreakHeavyProb")
		CriticalDefeat = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "CriticalDefeat")
		
		NakedChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "NakedChance")
		
		
		
		MoanOnHitChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "MoanOnHitChance")
		BondageHaircutProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "BondageHaircutProb")
		DefeatDowntime = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatDowntime")	
		DefeatIdleTime = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatIdleTime")
		
		;civil rape sliders				
		ExposureChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "ExposureChance")
		PunishShortProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "PunishShortProb")
		DefeatArrestProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatArrestProb")
		
		
		LoopTime = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "LoopTime")
		Naked_Weight = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Naked_Weight")
		Barefoot_Weight = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Barefoot_Weight")
		Dirty_Weight = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Dirty_Weight")
		Sneaking_Weight = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Sneaking_Weight")
		Running_Weight = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Running_Weight")
		Sprinting_Weight = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Sprinting_Weight")
		Cum_Weight = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Cum_Weight")
		Unarmed_Weight = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Unarmed_Weight")
		FallingDamageTreshold = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "FallingDamageTreshold")
		KeyDDWiggleFreeChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "KeyDDWiggleFreeChance")
		KeyDDWiggleFreeFailChance = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "KeyDDWiggleFreeFailChance")

		DefeatShortProb = GetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatShortProb")		
		;>>>>>> LOADING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		;STRING (load)
		SavedHair_00 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_00")
		SavedHair_01 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_01")
		SavedHair_02 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_02")
		SavedHair_03 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_03")
		SavedHair_04 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_04")
		SavedHair_05 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_05")
		SavedHair_06 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_06")
		SavedHair_07 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_07")
		SavedHair_08 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_08")
		SavedHair_09 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_09")
		SavedHair_10 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_10")	
		
		SavedHair_11 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_11")
		SavedHair_12 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_12")
		SavedHair_13 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_13")
		SavedHair_14 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_14")
		SavedHair_15 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_15")
		SavedHair_16 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_16")
		SavedHair_17 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_17")
		SavedHair_18 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_18")
		SavedHair_19 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_19")
		SavedHair_20 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_20")

		
		
		SavedNames_01 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedNames_01")
		
		SavedTags_01 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedTags_01")
		SavedTags_02 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedTags_02")
		SavedTags_03 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedTags_03")
		SavedTags_04 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedTags_04")
		SavedTags_05 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedTags_05")

	;/
		SavedText_01 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_01")
		SavedText_02 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_02")
		SavedText_03 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_03")
		SavedText_04 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_04")
		SavedText_05 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_05")
		SavedText_06 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_06")
		SavedText_07 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_07")
		SavedText_08 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_08")
		SavedText_09 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_09")
		SavedText_10 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_10")
		
		;severe punishments
		SavedPunishment_01 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_01")
		SavedPunishment_02 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_02")
		SavedPunishment_03 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_03")
		SavedPunishment_04 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_04")
		SavedPunishment_05 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_05")
		SavedPunishment_06 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_06")
		SavedPunishment_07 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_07")
		SavedPunishment_08 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_08")
		SavedPunishment_09 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_09")
		SavedPunishment_10 = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_10")
		
		/;
		;>>>>>> LOADING >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		;Load_JSON_Weapons HUMAN CODE
		;/
		weapon_JSON_01_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_name")
		weapon_JSON_01_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type")

		
		weapon_JSON_02_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_name")
		weapon_JSON_02_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_type")
		
		weapon_JSON_03_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_name")
		weapon_JSON_03_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_type")	

		weapon_JSON_04_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_name")
		weapon_JSON_04_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_type")

		weapon_JSON_05_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_name")
		weapon_JSON_05_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_type")	

		weapon_JSON_06_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_name")
		weapon_JSON_06_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_type")	

		weapon_JSON_07_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_name")
		weapon_JSON_07_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_type")	

		weapon_JSON_08_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_name")
		weapon_JSON_08_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_type")	

		weapon_JSON_09_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_name")
		weapon_JSON_09_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_type")	

		weapon_JSON_10_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_name")
		weapon_JSON_10_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_type")
		weapon_JSON_10_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_generaltype")		
		/;
		
		weapon_JSON_01_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_name");
		weapon_JSON_01_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type");
		weapon_JSON_01_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_generaltype");

		weapon_JSON_02_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_name");
		weapon_JSON_02_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_type");
		weapon_JSON_02_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_generaltype");

		weapon_JSON_03_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_name");
		weapon_JSON_03_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_type");
		weapon_JSON_03_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_generaltype");

		weapon_JSON_04_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_name");
		weapon_JSON_04_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_type");
		weapon_JSON_04_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_generaltype");

		weapon_JSON_05_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_name");
		weapon_JSON_05_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_type");
		weapon_JSON_05_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_generaltype");

		weapon_JSON_06_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_name");
		weapon_JSON_06_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_type");
		weapon_JSON_06_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_generaltype");

		weapon_JSON_07_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_name");
		weapon_JSON_07_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_type");
		weapon_JSON_07_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_generaltype");

		weapon_JSON_08_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_name");
		weapon_JSON_08_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_type");
		weapon_JSON_08_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_generaltype");

		weapon_JSON_09_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_name");
		weapon_JSON_09_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_type");
		weapon_JSON_09_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_generaltype");

		weapon_JSON_10_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_name");
		weapon_JSON_10_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_type");
		weapon_JSON_10_generaltype = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_generaltype");
	
		
		;Load_JSON_Outfits
		outfit_JSON_01_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_01_name")
		outfit_JSON_01_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_01_type")
	
		outfit_JSON_02_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_02_name")
		outfit_JSON_02_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_02_type")
		
		outfit_JSON_03_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_03_name")
		outfit_JSON_03_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_03_type")	

		outfit_JSON_04_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_04_name")
		outfit_JSON_04_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_04_type")

		outfit_JSON_05_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_05_name")
		outfit_JSON_05_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_05_type")	

		outfit_JSON_06_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_06_name")
		outfit_JSON_06_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_06_type")	

		outfit_JSON_07_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_07_name")
		outfit_JSON_07_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_07_type")	

		outfit_JSON_08_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_08_name")
		outfit_JSON_08_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_08_type")	

		outfit_JSON_09_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_09_name")
		outfit_JSON_09_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_09_type")	

		outfit_JSON_10_name = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_10_name")
		outfit_JSON_10_type = GetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_10_type")	

		;Update LoadProfile Property Updates
		;#Linda
		if NakedLootHotkeys 
		RegisterForLootHotkeys()
		else
		UnRegisterForLootHotkeys()
		endif

		if NoEssentialPlayer
			;we do NOT want Essential Player
			if PlayerRef.GetActorBase().IsEssential()
			PlayerRef.GetActorBase().SetEssential(false)
			ScreenMessage("NAKED DEFEAT: Essential Player OFF") 
			elseif !PlayerRef.GetActorBase().IsEssential()
			ScreenMessage("NAKED DEFEAT: Player was NOT essential already (other mod interfering?).")
			endif 
			
		elseif !NoEssentialPlayer	
			;we DO want an Essential Player
			if PlayerRef.GetActorBase().IsEssential()
			ScreenMessage("NAKED DEFEAT: Player was already essential (other mod interfering?.")
			elseif !PlayerRef.GetActorBase().IsEssential()
			PlayerRef.GetActorBase().SetEssential(true)
			ScreenMessage("NAKED DEFEAT: Essential Player ON") 	
			endif
		endif
		
		if NymBeta
		Debug.MessageBox("You just enabled Nymra's BETA Features. They are explained in the PDF in the Mod Folder, but sometimes the info is outdated, sorry.")
		endif

		Debug.MessageBox("Profile loaded.")
		;	ApplySettings()		;needed for what???!!!
		Else
			Debug.MessageBox("Profile does not exist.")
		EndIf
		
	;<<<<<<<<<<<<<< SAVING <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<	
	Else	
		;SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "aFLOAT", aFLOAT)
		;SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "aINT", aINT)
		;SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "aSTRING", aSTRING)

		;FORMLISTS
		;FileFormListSet
		
		
		;INT (save)								
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NymStripping", NymStripping as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "VRfix", VRfix as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "SSEfix", SSEfix as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NoCrawling", NoCrawling as int)
		
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "ShowDebugMessages", ShowDebugMessages as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "ShowNarrativeMessages", ShowNarrativeMessages as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "ShowInfoMessages", ShowInfoMessages as int)
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "RemoveDDs", RemoveDDs as int)

		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "GodMode", GodMode as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "HealthBoost", HealthBoost as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "FindSpotTime", FindSpotTime as int)
		
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NoEssentialPlayer", NoEssentialPlayer as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "PlayExpressions", PlayExpressions as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedBlur", NakedBlur as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "LagFix", LagFix as int)
		
		;<<<<<<<<<<<<<< SAVING <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<	
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "FemalesAllowed", FemalesAllowed as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowCreatures", AllowCreatures as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatSpotAndEscape", DefeatSpotAndEscape as int)
		
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "StageGoBack", StageGoBack as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "SkipSex", SkipSex as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedCumming", NakedCumming as int)



		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "ToggleDeleteDevice", ToggleDeleteDevice as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "SimpleSurrender", SimpleSurrender as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "WeaponOutSurrender", WeaponOutSurrender as int)
		
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "Ragdoll", Ragdoll as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "MaleFollower", MaleFollower as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "FemaleFollower", FemaleFollower as int)
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "WhipMarks", WhipMarks as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatBreakArmor", DefeatBreakArmor as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedDrowning", NakedDrowning as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedTravel", NakedTravel as int)
		
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedLoot", NakedLoot as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NakedLootHotkeys", NakedLootHotkeys as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "SSHandling", SSHandling as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DeviousPiercingEffects", DeviousPiercingEffects as int)
		
		
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DropItem", DropItem as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "Slippery", Slippery as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "StripAttack", StripAttack as int)	
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NoExtra", NoExtra as int)
		
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "Indecency", Indecency as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatRobberyGold", DefeatRobberyGold as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatSceneProtectors", DefeatSceneProtectors as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatGetUp", DefeatGetUp as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NymSpawning", NymSpawning as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "NymBeta", NymBeta as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "HeelsFix", HeelsFix as int)
		
		
		;<<<<<<<<<<<<<< SAVING <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<	
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "StripOptions", StripOptions as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "WiggleOptions", WiggleOptions as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "WiggleOptionsSS", WiggleOptionsSS as int)
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatFindSpot", DefeatFindSpot as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatEscapeCrawl", DefeatEscapeCrawl as int)
		
		;CREATURE TOGGLES ---------------------
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowArgonKajit", AllowArgonKajit as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowHumanoidBeasts", AllowHumanoidBeasts as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowInsects", AllowInsects as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowSkeevers", AllowSkeevers as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowSpiders", AllowSpiders as int)	
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowSabreCats", AllowSabreCats as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowBears", AllowBears as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowCanines", AllowCanines as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowMammoths", AllowMammoths as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowDragons", AllowDragons as int)
		
		;SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowNetches", AllowNetches as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowDwarven", AllowDwarven as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowUndead", AllowUndead as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowRieklings", AllowRieklings as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowFalmers", AllowFalmers as int)	
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowSpriggans", AllowSpriggans as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowElementalsFemale", AllowElementalsFemale as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowElementalsMale", AllowElementalsMale as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowTentacleStuff", AllowTentacleStuff as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowChicken", AllowChicken as int)
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowHorses", AllowHorses as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowCows", AllowCows as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowGoats", AllowGoats as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowDeers", AllowDeers as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowFoxes", AllowFoxes as int)	
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowRabbits", AllowRabbits as int)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "AllowHorkers", AllowHorkers as int)
		;<<<<<<<<<<<<<< SAVING <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<	
		
		;BODY SLOTS
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[0]", BlockSlot[0] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[1]", BlockSlot[1] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[2]", BlockSlot[2] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[3]", BlockSlot[3] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[4]", BlockSlot[4] as int) 
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[5]", BlockSlot[5] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[6]", BlockSlot[6] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[7]", BlockSlot[7] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[8]", BlockSlot[8] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[9]", BlockSlot[9] as int) 
		
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[10]", BlockSlot[10] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[11]", BlockSlot[11] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[12]", BlockSlot[12] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[13]", BlockSlot[13] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[14]", BlockSlot[14] as int) 
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[15]", BlockSlot[15] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[16]", BlockSlot[16] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[17]", BlockSlot[17] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[18]", BlockSlot[18] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[19]", BlockSlot[19] as int) 
		
		;<<<<<<<<<<<<<< SAVING <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<	
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[20]", BlockSlot[20] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[21]", BlockSlot[21] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[22]", BlockSlot[22] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[23]", BlockSlot[23] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[24]", BlockSlot[24] as int) 
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[25]", BlockSlot[25] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[26]", BlockSlot[26] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[27]", BlockSlot[27] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[28]", BlockSlot[28] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[29]", BlockSlot[29] as int) 
		
		
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[30]", BlockSlot[30] as int) 
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "BlockSlot[31]", BlockSlot[31] as int) 

		;--------------------------------------
	
;<<<<<<<<<<<<<< SAVING <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<	
		;KEYS (save)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "EscapeKey", EscapeKey)
		SetINTValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatKey", DefeatKey)
		
		;FLOAT (save)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DebugPunishmentType", DebugPunishmentType)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "BleedoutCounter", BleedoutCounter)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatPeeProb", DefeatPeeProb)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Group5Pchance", Group5Pchance)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Group4Pchance", Group4Pchance)
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Group3Pchance", Group3Pchance)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "ScenarioChance", ScenarioChance)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatChainProb", DefeatChainProb)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatForeplayChance", DefeatForeplayChance)
		
		
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "SearchRadius", SearchRadius)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "SearchRadiusInterior", SearchRadiusInterior)
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatCaptivityProb", DefeatCaptivityProb)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "CooperativeSurrenderChance", CooperativeSurrenderChance)
		
		
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatEscapeDiff", DefeatEscapeDiff)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatDDeProb", DefeatDDeProb)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "PunishWhipChance", PunishWhipChance)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "PunishSexChance", PunishSexChance)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "PunishBukkakeChance", PunishBukkakeChance)
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatDeathChance", DefeatDeathChance)
		
		;<<<<<<<<<<<<<< SAVING <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<	
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatWhipProb", DefeatWhipProb)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatWhipTime", DefeatWhipTime)
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatRobberyProb", DefeatRobberyProb)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "NakedDeathChance", NakedDeathChance)
		
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatRescueProb", DefeatRescueProb)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "FemalesAsMales", FemalesAsMales)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "RemoveDDChance", RemoveDDChance)
		
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatIdleTime", DefeatIdleTime)
			
			
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatSlaveryProb", DefeatSlaveryProb)
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatSDweight", DefeatSDweight)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatEscTime", DefeatEscTime)	
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatSpeedMult", DefeatSpeedMult)	
		
		
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "RapeHandsProb", RapeHandsProb)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "WhipmarksDur", WhipmarksDur)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatBreakClothingProb", DefeatBreakClothingProb)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "PoisonDefeatChance", PoisonDefeatChance)
		
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatBreakLightProb", DefeatBreakLightProb)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatBreakHeavyProb", DefeatBreakHeavyProb)	
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "CriticalDefeat", CriticalDefeat)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "NakedChance", NakedChance)	
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "MoanOnHitChance", MoanOnHitChance)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "BondageHaircutProb", BondageHaircutProb)
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatDowntime", DefeatDowntime)
		
	;<<<<<<<<<<<<<< SAVING <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<	
		;civil rape sliders		

		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "ExposureChance", ExposureChance)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "PunishShortProb", PunishShortProb)

		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatArrestProb", DefeatArrestProb)
		
		
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "LoopTime", LoopTime)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Naked_Weight", Naked_Weight)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Barefoot_Weight", Barefoot_Weight)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Dirty_Weight", Dirty_Weight)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Sneaking_Weight", Sneaking_Weight)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Running_Weight", Running_Weight)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Sprinting_Weight", Sprinting_Weight)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Cum_Weight", Cum_Weight)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "Unarmed_Weight", Unarmed_Weight)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "FallingDamageTreshold", FallingDamageTreshold)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "KeyDDWiggleFreeChance", KeyDDWiggleFreeChance)
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "KeyDDWiggleFreeFailChance", KeyDDWiggleFreeFailChance)


	
		SetFloatValue("../Naked Defeat/profile" +Profile+ ".json", "DefeatShortProb", DefeatShortProb)
	;<<<<<<<<<<<<<< SAVING <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<	
		;STRING (save)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_00", SavedHair_00)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_01", SavedHair_01)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_02", SavedHair_02)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_03", SavedHair_03)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_04", SavedHair_04)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_05", SavedHair_05)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_06", SavedHair_06)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_07", SavedHair_07)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_08", SavedHair_08)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_09", SavedHair_09)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_10", SavedHair_10)
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_11", SavedHair_11)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_12", SavedHair_12)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_13", SavedHair_13)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_14", SavedHair_14)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_15", SavedHair_15)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_16", SavedHair_16)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_17", SavedHair_17)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_18", SavedHair_18)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_19", SavedHair_19)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedHair_20", SavedHair_20)

	;/
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_01", SavedText_01)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_02", SavedText_02)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_03", SavedText_03)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_04", SavedText_04)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_05", SavedText_05)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_06", SavedText_06)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_07", SavedText_07)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_08", SavedText_08)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_09", SavedText_09)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedText_10", SavedText_10)	
/;
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedNames_01", SavedNames_01)
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedTags_01", SavedTags_01)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedTags_02", SavedTags_02)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedTags_03", SavedTags_03)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedTags_04", SavedTags_04)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedTags_05", SavedTags_05)
;<<<<<<<<<<<<<< SAVING <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<	
		;severe punishments
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_01", SavedPunishment_01)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_02", SavedPunishment_02)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_03", SavedPunishment_03)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_04", SavedPunishment_04)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_05", SavedPunishment_05)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_06", SavedPunishment_06)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_07", SavedPunishment_07)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_08", SavedPunishment_08)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_09", SavedPunishment_09)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "SavedPunishment_10", SavedPunishment_10)
		
		;Load_JSON_Weapons
		;my code (delete after test, I let ChatGPT rewrite it lol)
		;/
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_name", weapon_JSON_01_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_type)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_generaltype)
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_name", weapon_JSON_02_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_type", weapon_JSON_02_type)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_generaltype
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_name", weapon_JSON_03_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_type", weapon_JSON_03_type)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_generaltype
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_name", weapon_JSON_04_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_type", weapon_JSON_04_type)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_generaltype
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_name", weapon_JSON_05_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_type", weapon_JSON_05_type)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_generaltype		
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_name", weapon_JSON_06_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_type", weapon_JSON_06_type)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_generaltype
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_name", weapon_JSON_07_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_type", weapon_JSON_07_type)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_generaltype
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_name", weapon_JSON_08_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_type", weapon_JSON_08_type)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_generaltype
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_name", weapon_JSON_09_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_type", weapon_JSON_09_type)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_generaltype

		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_name", weapon_JSON_10_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_type", weapon_JSON_10_type)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_generaltype
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_name", weapon_JSON_10_name);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_10_type", weapon_JSON_10_type);
/;

		;<<<<<<<<<<<<<< SAVING   WEAPON PROFILES (TYPE and GENERALTYPE) <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<	
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_name", weapon_JSON_01_name);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_type", weapon_JSON_01_type);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_01_generaltype", weapon_JSON_01_generaltype);

		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_name", weapon_JSON_02_name);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_type", weapon_JSON_02_type);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_02_generaltype", weapon_JSON_02_generaltype);

		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_name", weapon_JSON_03_name);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_type", weapon_JSON_03_type);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_03_generaltype", weapon_JSON_03_generaltype);

		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_name", weapon_JSON_04_name);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_type", weapon_JSON_04_type);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_04_generaltype", weapon_JSON_04_generaltype);

		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_name", weapon_JSON_05_name);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_type", weapon_JSON_05_type);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_05_generaltype", weapon_JSON_05_generaltype);

		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_name", weapon_JSON_06_name);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_type", weapon_JSON_06_type);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_06_generaltype", weapon_JSON_06_generaltype);

		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_name", weapon_JSON_07_name);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_type", weapon_JSON_07_type);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_07_generaltype", weapon_JSON_07_generaltype);

		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_name", weapon_JSON_08_name);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_type", weapon_JSON_08_type);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_08_generaltype", weapon_JSON_08_generaltype);

		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_name", weapon_JSON_09_name);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_type", weapon_JSON_09_type);
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "weapon_JSON_09_generaltype", weapon_JSON_09_generaltype);

		;
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_01_name", outfit_JSON_01_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_01_type", outfit_JSON_01_type)
	
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_02_name", outfit_JSON_02_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_02_type", outfit_JSON_02_type)
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_03_name", outfit_JSON_03_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_03_type", outfit_JSON_03_type)
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_04_name", outfit_JSON_04_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_04_type", outfit_JSON_04_type)
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_05_name", outfit_JSON_05_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_05_type", outfit_JSON_05_type)	
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_06_name", outfit_JSON_06_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_06_type", outfit_JSON_06_type)
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_07_name", outfit_JSON_07_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_07_type", outfit_JSON_07_type)
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_08_name", outfit_JSON_08_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_08_type", outfit_JSON_08_type)
		
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_09_name", outfit_JSON_09_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_09_type", outfit_JSON_09_type)

		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_10_name", outfit_JSON_10_name)
		SetStringValue("../Naked Defeat/profile" +Profile+ ".json", "outfit_JSON_10_type", outfit_JSON_10_type)

		Save("../Naked Defeat/profile" +Profile+ ".json")
		Debug.MessageBox("Profile saved.")
	EndIf
Else
	Debug.MessageBox("PapyrusUtil needs to be installed for Profiles to work properly.")
EndIf
EndFunction

;-------------------------------------------------------------------------------------------------------------------------------


Function SendModEvents(bool value)

if value 
		SendModEvent("dhlp-Suspend")
		SendModEvent("nade-Suspend")
		SendModEvent("SLTR-Suspend") 	;submissiveLolaSuspend
		SendModEvent("DF-Pause")
else
		SendModEvent("dhlp-Resume")
		SendModEvent("nade-Resume")
		SendModEvent("SLTR-Resume")
		SendModEvent("DF-Pause")
endif
EndFunction

Function ResetBools() 	;#ResetBools
Debug.Trace("NAKED DEFEAT configquest: ResetBools()")	
	
;	PlayerRef.RemoveItem(SlowDownItem, 1, true, None)
	
	ResetPlayer()
	
	DisableCollisionOnActor(PlayerRef, false)
	
	SlaveryHostile = false
	PlayerGender = "none"
	LocType = "none"
;	floorplaced = false ;for debug.,...)
;	ActorsSpawned = false
;	IsAcheronBridge = false
	HarderDefeat = false

	FirstStartUp = true
	DefeatStateChapter = "Free"
	DefeatStatePlayer = "Free" 
	CivilRapeRunning = false
	DefeatQuestRunning = false	
	RapeAgain = false
	DefeatViaSurrender = false
	DefeatViaSlavery = false
	DefeatEntranceVia = "empty"
	
	;if (DefeatTypeScenario != "Afterlife") && (DefeatTypeScenario != "Execution")		;BAD WORKAROUND
	DefeatType = "none"
	DefeatTypeGeneral = "none"
	DefeatTypeScenario = "none"
	;endif
	
		SendModEvents(false)	
		PlaceFloor("remove") ;#floor
		PlaceLight("remove")
	
	SuspendEventsSent = false  
	
	ResetEnemies()
	
	ShortPunishment = 0
	
;	Debug.SetGodMode(false)
	
EndFunction

Function GetKWDSexlabNoStrip()	;WHY??? WHAT IS THIS PURPOSE? 

 Form a = None
 
 a = PlayerRef.GetWornForm(0x00000004)	;32 - BODY
 
 if a.HasKeyword(SexLabNoStrip)
 HasKWDSexlabNoStrip = true
 else
 HasKWDSexlabNoStrip = false
 endif
 
EndFunction
 
Keyword DemonicCreature

;--------------- RaceKey from Faction ------------------------------------------------------------  
	
String Function GetRaceKeyFromFaction(Actor akActor)

	Actor a = akActor as Actor	

	Debug.trace("NAKED DEFEAT configquest: GetRaceKeyFromFaction(): actor: "+a.GetBaseObject().GetName())	
	
	;#todo: expand and refine
	
	if a.IsInFaction(FactionsHumanoid[0]) ;Daedra
	return "Draugrs"
	elseif a.IsInFaction(FactionsHumanoid[1]) ;Draugr
	return "Draugrs"
	elseif a.IsInFaction(FactionsHumanoid[2]) ;Falmer
	;Debug.trace("NAKED DEFEAT configquest: Falmers Found!")
	;Debug.Notification("NAKED DEFEAT: Falmers Found!")
	return "Falmers"
	elseif a.IsInFaction(FactionsHumanoid[4]) ;Spriggan
	return "Spriggans"
	elseif a.IsInFaction(FactionsHumanoid[5]) ;Riekling
	return "Rieklings"
	elseif a.IsInFaction(FactionsHumanoid[6]) ;Spriggan Predator
	return "Spriggans"
	elseif a.IsInFaction(FactionsHumanoid[12]) ;Skeleton
	return "Draugrs"
	elseif a.IsInFaction(FactionsHumanoid[13]) ;DwarvenAutomaton
	return "DwarvenCenturions"
	elseif a.IsInFaction(FactionsHumanoid[14]) ;Dremora
	return "Draugrs"
	else
	Debug.trace("NAKED DEFEAT configquest: no valid faction found")	
	return none
	endif
	
	
	
	;/
	;HUMANOID
	cfgqst.FactionsHumanoid[0]	;Daedra
	cfgqst.FactionsHumanoid[1]	;Draugr
	cfgqst.FactionsHumanoid[2]	;Falmer
	cfgqst.FactionsHumanoid[3]	;Giant
	cfgqst.FactionsHumanoid[4]	;Spriggan
	
	cfgqst.FactionsHumanoid[5]	;Riekling
	cfgqst.FactionsHumanoid[6]	;Spriggan Predator
	cfgqst.FactionsHumanoid[7]	;Troll
	cfgqst.FactionsHumanoid[8]	;Dragonpriest
	cfgqst.FactionsHumanoid[9]	;Dragonpriest
	
	cfgqst.FactionsHumanoid[10]	;Werewolf
	cfgqst.FactionsHumanoid[11]	;Hagraven
	cfgqst.FactionsHumanoid[12]	;Skeleton
	cfgqst.FactionsHumanoid[13]	;DwarvenAutomaton
	cfgqst.FactionsHumanoid[14]	;Dremora
	
	;PREDATORS
	cfgqst.FactionsPredators[0]	;PredatorFaction
	cfgqst.FactionsPredators[1]	;	Prey(notinuse)
	cfgqst.FactionsPredators[2]	;Spider
	cfgqst.FactionsPredators[3]	;Chaurus
	cfgqst.FactionsPredators[4]	;Skeever
	
	cfgqst.FactionsPredators[5]	;Dog
	cfgqst.FactionsPredators[6]	;Wolf
	cfgqst.FactionsPredators[7]	;SabreCat
	cfgqst.FactionsPredators[8]	;Bear
	cfgqst.FactionsPredators[9]	;Slaugtherfish
	
	cfgqst.FactionsPredators[10]	;Fox
	cfgqst.FactionsPredators[11]	;
	cfgqst.FactionsPredators[12]	;
	cfgqst.FactionsPredators[13]	;
	cfgqst.FactionsPredators[14]	;
	
	;PREY
	cfgqst.FactionsPrey[0]	;PreyFaction
	cfgqst.FactionsPrey[1]	;Hare
	cfgqst.FactionsPrey[2]	;Chicken
	cfgqst.FactionsPrey[3]	;Mammoth
	cfgqst.FactionsPrey[4]	;Goat
	
	cfgqst.FactionsPrey[5]	;
	cfgqst.FactionsPrey[6]	;
	cfgqst.FactionsPrey[7]	;
	cfgqst.FactionsPrey[8]	;
	cfgqst.FactionsPrey[9]	;
	
	cfgqst.FactionsPrey[10]	;
	cfgqst.FactionsPrey[11]	;
	cfgqst.FactionsPrey[12]	;
	cfgqst.FactionsPrey[13]	;
	cfgqst.FactionsPrey[14]	;
	/;
	
	
Endfunction

;------------------------------------------------------------------------------------------------------------

;	bool EnemyUsed_0 = false
;	bool EnemyUsed_1 = false
;	bool EnemyUsed_2 = false
;	bool EnemyUsed_3 = false
;	bool EnemyUsed_4 = false
;	bool EnemyUsed_5 = false
	bool AreBandits = false
	
	
bool Function IsItBandits()
if AreBandits
AreBandits = false
return true
else
return false
endif
EndFunction

bool Function IsHitterArmed()
if IsArmedHitter
IsArmedHitter = false
return true
else
return false
endif
EndFunction

String Function GetActorName(Actor akActor = None)
	
	String TempName

if akActor
	;NymTrace("Name 00: "+TempName)
;	if !TempName
	TempName = akActor.GetLeveledActorBase().GetName()
	;NymTrace("Name 01: "+TempName)
;	endif 
	if !TempName
	TempName = akActor.GetBaseObject().GetName()
	;NymTrace("Name 02: "+TempName)
	endif 
	if !TempName
	TempName = akActor.GetName()
	;NymTrace("Name 03: "+TempName)
	endif 
	if !TempName
	TempName = "NoName!"
	endif 
endif 
	
	return TempName
	
EndFunction	
	

bool IsArmedHitter = false
	
	
Function GetEnemyType(Actor Hitter)			;#GetEnemyType

;used by OnHit(Player) and by Acheron 
	
Debug.trace("NAKED DEFEAT configquest: GetEnemyType: "+GetActorName(Hitter))

	;GET LAST HITTER TYPE/RaceKey
	
		if DefeatViaSlavery
		Debug.trace("NAKED DEFEAT configquest: GetEnemyType: DefeatViaSlavery")
		;do Nothing --_> DefeatType is hard coded already
		endif 

		RaceKey = "none"

		bool IsDemonicCreature = false	
		bool IsAHuman = false
		AreBandits = false
		
		;>>>>>>> HUMANS >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		if IsHuman(Hitter) && !IsFollower(Hitter)
		IsAHuman = true
		
		;#todo: add factioncheck here too
			if Hitter.IsInFaction(BanditFaction) 
			AreBandits = true
			
			Racekey = "Humans"
			elseif IsGuard(Hitter)
			RaceKey = "Guards"
			elseif IsVampire(Hitter)
			RaceKey = "Vampires"
			elseif IsNecromancer(Hitter)
			RaceKey = "Necromancers"
			elseif IsMage(Hitter)
			RaceKey = "Mages"
			else
			;	RaceKey = GetRaceKeyFromFaction(Hitter)	;check for faction too....
			;	if !RaceKey
			Racekey = "Humans"
			;	endif 
			endif
			

			;#checkbandits
			
		;	IsArmedHitter = true ;currently not in Use
		
		;>>>>>>> CREATURES >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
		else	
			
			;if Demonic Creatures installed and NOT human, first check DemonicCreature Keyword and get RaceKey from Faction instead of regular Detection ->
			;this is important because Demonic Creatures can be for example RaceKey "SabreCats" but still belong to "FalmerFaction" and thus should leat to "DefeatTypeFalmers" instead of SabreCats
			if ModDEM && Hitter.HasKeyword(DemonicCreature) 
			IsDemonicCreature = true
			RaceKey = GetRaceKeyFromFaction(Hitter)
			Debug.trace("NAKED DEFEAT configquest: DemonicCreature RaceKeyFromFaction: "+RaceKey) 
			endif

			;check Racekey 
			;GUIDE: if we have no racekey from faction we check for the actual racekey (might not fit the factions for mod added NPC like Demonic Creatures)
			if RaceKey == "none" 					
			RaceKey = GetRaceKey(Hitter)
			endif
			
			;check Faction 
			;GUIDE: we check for vanilla factions and apply racekey as it fits 	
			;if we have Boars We also make an additional FactionCheck (Falmers and Rieklings can both have them)
			if RaceKey == "none" || RaceKey == "BoarsAny"				
			RaceKey = GetRaceKeyFromFaction(Hitter)
			endif
		endif
				
		;--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
		
		;currently not in Use
	;	if !IsArmedHitter
	;		if (RaceKey == "Draugr") || (RaceKey == "Rieklings") || (RaceKey == "BoarsMounted") || (RaceKey == "Falmers") ;|| (RaceKey == "Skelettons")
	;		IsArmedHitter = true
	;		;possible Hitters that do magic attacks. maybe differentiate in the future
	;		elseif (RaceKey == "Atronachs") || (RaceKey == "DragonPriests") || (RaceKey == "Seekers") || (RaceKey == "VampireLords")
	;		IsArmedHitter = true
	;		endif
	;	endif
		
		;treat tame trolls as humans (to start defeattypehumans) ;PROBLEMATIC 
		if RaceKey == ("Trolls")
			if (Hitter.GetBaseObject().GetName() == "Armored Troll") || (Hitter.GetBaseObject().GetName() == "Armored Frost Troll") || (Hitter.GetBaseObject().GetName() == "Tame Troll")
			RaceKey == "Humans"
			endif
		endif
		
		;---------------------------------------------------------------------------------------------------------
		bool NymraNewSystem = true 
		bool RaceKeyChange = false
		
		if NymraNewSystem
		;we save RaceKeys, up to 6 of them. We do not save a RaceKey more than once if it is already logged in (no need)
		;we can track the first hitter (Enemy[0] and in theory the last... 
		;Enemy[5] gets updated always and overwritten, the other 4 only later (WHEN??) 
		;-----> WE NEED TO TRACK END OF COMBAT if Naked Defeat is NOT involved...
		
			if !RaceKey
			Debug.Trace("NAKED DEFEAT configquest: #ERROR: RaceKey A (false)")
			RaceKey = "none"
			endif 
			;if we got a racekey and it is NOT already registered
			if RaceKey == "none"	
			Debug.Trace("NAKED DEFEAT configquest: #ERROR: RaceKey A (none)")	
			else
			Debug.trace("NAKED DEFEAT configquest: Enemies RaceKey: "+RaceKey)
				if !CheckEnemiesFor(RaceKey)
				
					;if Enemy[0] not logged in and if that racekey is NOT already logged in
					if Enemy[0] == "none" ;&& !CheckEnemiesFor(RaceKey)
					Enemy[0] = RaceKey
					RaceKeyChange = true
					Debug.trace("NAKED DEFEAT configquest: Enemy[0]: "+Enemy[0])
					
					elseif Enemy[1] == "none" ;&& !CheckEnemiesFor(RaceKey)
					Enemy[1] = RaceKey
					RaceKeyChange = true
					Debug.trace("NAKED DEFEAT configquest: Enemy[1]: "+Enemy[1])
					
					elseif Enemy[2] == "none" ;&& !CheckEnemiesFor(RaceKey)
					Enemy[2] = RaceKey
					RaceKeyChange = true
					Debug.trace("NAKED DEFEAT configquest: Enemy[2]: "+Enemy[2])
					
					elseif Enemy[3] == "none" ;&& !CheckEnemiesFor(RaceKey)
					Enemy[3] = RaceKey
					RaceKeyChange = true
					Debug.trace("NAKED DEFEAT configquest: Enemy[3]: "+Enemy[3])
					
					elseif Enemy[4] == "none" ;&& !CheckEnemiesFor(RaceKey)
					Enemy[4] = RaceKey
					RaceKeyChange = true
					Debug.trace("NAKED DEFEAT configquest: Enemy[4]: "+Enemy[4])
						
					;Enemy[5] always gets overwritten if not already logged in (we get updates on the combat enemies this way)
					;before we had this repeat the cycle which could mean that we lost previously registered enemies 
					else
					Enemy[5] = RaceKey
					RaceKeyChange = true
					Debug.trace("NAKED DEFEAT configquest: Enemy[5]: "+Enemy[5])
					
					endif 
					
					if RaceKeyChange	
				;	NymMessage("Enemies: [0] "+Enemy[0]+" [1] "+Enemy[1]+" [2] "+Enemy[2]+" [3] "+Enemy[3]+" [4] "+Enemy[4]+" [5] "+Enemy[5])
					endif 
					
					IsDemonicCreature = false
					IsAHuman = false
				else ;ALREADY LOGGED IN
				Debug.Trace("NAKED DEFEAT playeralias: RaceKey already registered: "+ RaceKey)
				endif 
		
			endif 			
				
		;--------OLD -------------------------------------------------------------------------------------------------	
		else ;OLD SYSTEM 
			;if we got a racekey and if that racekey is NOT already logged in
			;/
			if RaceKey && !CheckEnemiesFor(RaceKey)
			Enemy[0] = RaceKey
			Debug.trace("NAKED DEFEAT configquest: Enemy[0]: "+Enemy[0])
			endif
			
			if !EnemyUsed_1
			Enemy[1] = RaceKey
			EnemyUsed_1 = true
			Debug.trace("NAKED DEFEAT configquest: Enemy[1]: "+Enemy[1])
			elseif !EnemyUsed_2
			Enemy[2] = RaceKey
			EnemyUsed_2 = true
			Debug.trace("NAKED DEFEAT configquest: Enemy[2]: "+Enemy[2])
			elseif !EnemyUsed_3
			Enemy[3] = RaceKey
			EnemyUsed_3 = true
			Debug.trace("NAKED DEFEAT configquest: Enemy[3]: "+Enemy[3])
			elseif !EnemyUsed_4
			Enemy[4] = RaceKey
			EnemyUsed_4 = true
			Debug.trace("NAKED DEFEAT configquest: Enemy[4]: "+Enemy[4])
			elseif !EnemyUsed_5
			Enemy[5] = RaceKey
			EnemyUsed_5 = true
			Debug.trace("NAKED DEFEAT configquest: Enemy[5]: "+Enemy[5])
			else
			Enemy[1] = RaceKey
			Debug.trace("NAKED DEFEAT configquest: Enemy[1] (repeat Cycle): "+Enemy[1])	
			EnemyUsed_1 = false
			EnemyUsed_2 = false
			EnemyUsed_3 = false
			EnemyUsed_4 = false
			EnemyUsed_5 = false
			endif
			
			IsDemonicCreature = false
			IsAHuman = false
			/;
		endif 
		
		if RaceKey == "none"
		Debug.Trace("NAKED DEFEAT configquest: #ERROR: RaceKey B (none)")
		else
		Hitter.AddToFaction(EnemyFaction)
		endif
		;---------OLD --------------------------------------------------------------------------------------
		


EndFunction

;----- RACEKEY--------------------------------------------------------------------------



String Function GetRaceKey(Actor akActor = None)			;#racekey

string tempraceID = "empty"
string TheRaceKey = "empty"
tempraceID = MiscUtil.GetActorRaceEditorID(akActor)
TheRaceKey = sslCreatureAnimationSlots.GetRaceKeyByID(tempraceID)

;Debug.Trace("NAKED DEFEAT configquest: GetRaceKey(): "+tempraceID)
;Debug.Trace("NAKED DEFEAT configquest: GetRaceKey(): "+TheRaceKey)
;return sslCreatureAnimationSlots.GetRaceKeyByID(tempraceID)
return TheRaceKey

Endfunction

;---------------------------------------------------------------------------------------


;----------- PLAYER POSING ----------------------------------------------
;#pose #playpose 
						
;string LastTypePlayer = "none"	
;int LastPosePlayer = 0	

;NO RESTORE
;REMOVE THIS FINALLY 

;/
Function PlayerPosing(string Type = "none", bool restore)		;#pose		 #PlayerPosing()				
Debug.Trace("NAKED DEFEAT configquest: PlayerPosing()")			
Debug.Trace("NAKED DEFEAT configquest: PlayerPosing() - DefeatStateBindings: "+DefeatStateBindings)	
				
;TYPE should be "wiggle, wait, surrender". ---> determines the pose dynamic
;SCENARIO should be the DefeatTypeScenario String or a direct string ---> determines the furniture/bound options
;cfgqst.PlayerPosing("Struggle", cfgqst.DefeatTypeScenario, false)
	
	int NewPosePlayer	
	int DebugPose

	if DefeatTypeScenario == "FastTravel"
	type = "Offering"
	endif
	
	if IsDDScenario() ;no posing when DDs are worn "DD" and "DDeEvent"
	; do nothing!
	
	else
		;RANDOMIZE when (Type == "Random")
		if Type == "Random"
			if D100(50)
			Type = "Struggle"
			else
			Type = "Wait"
			endIf
		endif	
					
		;STOP IDLING -----> 				
		if Type == "Stop"			
			Debug.Trace("NAKED DEFEAT configquest: PlayerPosing (Stop)")		
			PlayerRef.PlayIdle(IdlesFixHair[0]) ;RESET IDLE
			Type = "none"
			LastTypePlayer = "none"
			
		;OFFERING -----> For Fast Travel and other Rituals				 	
		elseif Type == "Offering"
		Debug.Trace("NAKED DEFEAT configquest: PlayerPosing (offering)")	
			
			NewPosePlayer = Utility.RandomInt(1,4)

			if NewPosePlayer < 4
			PlayerRef.PlayIdle(IdlesHumanSurrender[NewPosePlayer])		;replace later, human surrender poses
			elseif NewPosePlayer == 4
			PlayerRef.PlayIdle(IdlesAnimalDefeat[0])					;on all fours
			endif	
				
					
		;ORGASM 				 	
		elseif Type == "Orgasm"
		Debug.Trace("NAKED DEFEAT configquest: PlayerPosing (offering)")	
			
			;ORGASM ----- ARMBINDER 
			if 	(DefeatStateBindings == "Armbinder")
			
				NewPosePlayer = Utility.RandomInt(1,3)
						
				string [] AnimArray	
				AnimArray = new string[16]	
				AnimArray[0] = "RESET"
				AnimArray[1] = "ZapArmbHorny01"		
				AnimArray[2] = "ZapArmbHorny02"
				AnimArray[3] = "ZapArmbHorny03"		
	
	
				Debug.SendAnimationEvent(PlayerRef, AnimArray[NewPosePlayer])
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (Orgasm Armbinder): "+NewPosePlayer)
			endif
		;PEE 				 	
		elseif Type == "Pee"
		Debug.Trace("NAKED DEFEAT configquest: PlayerPosing (offering)")	
			
			;PEE ----- ARMBINDER 
			if 	(DefeatStateBindings == "Armbinder")
				NewPosePlayer = 1
				if NewPosePlayer == 1 
				Debug.SendAnimationEvent(PlayerRef, "ZapArmbHorny03")
				endif
				
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (Orgasm Armbinder): "+NewPosePlayer)
			endif			
			
			
		;RECEIVING -----> For Golden Shower / Pee --> might be too specialized?			 	
		elseif Type == "Receiving"
		Debug.Trace("NAKED DEFEAT configquest: PlayerPosing (receiving)")	
		
			NewPosePlayer = Utility.RandomInt(1,3)

			if NewPosePlayer == 1	;set 1 - sitting
			Debug.Trace("NAKED DEFEAT configquest: PlayerPosing (Set 1 - sitting)")	
				int pose = Utility.RandomInt(1,3)
				if pose == 1
				PlayerRef.PlayIdle(IdlesDefeatCuffs[10])
				elseif pose == 2
				PlayerRef.PlayIdle(IdlesDefeatCuffs[11])
				elseif pose == 3
				PlayerRef.PlayIdle(IdlesDefeatCuffs[12])
				endif
			elseif NewPosePlayer == 2  ;set 2 - kneeling		
			Debug.Trace("NAKED DEFEAT configquest: PlayerPosing (Set 2 - kneeling)")
				int pose = Utility.RandomInt(1,5)
				if pose == 1
				PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[4])
				elseif pose == 2
				PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[5])
				elseif pose == 3
				PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[6])
				elseif pose == 4
				PlayerRef.PlayIdle(IdlesDefeatCuffs[16])
				elseif pose == 5
				PlayerRef.PlayIdle(IdlesDefeatCuffs[18])	
				endif
			elseif NewPosePlayer == 3 ;set 3 - standing
			Debug.Trace("NAKED DEFEAT configquest: PlayerPosing (Set 3 - standing)")
				int pose = Utility.RandomInt(1,3)
				if pose == 1
				PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[0])
				elseif pose == 2
				PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[1])
				elseif pose == 3
				PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[2])
				endif
				
			elseif NewPosePlayer == 4 ;set 4 - low standing
			Debug.Trace("NAKED DEFEAT configquest: PlayerPosing (Set 4 - low standing)")
				int pose = Utility.RandomInt(1,5)
				if pose == 1
				PlayerRef.PlayIdle(IdlesDefeatCuffs[19])
				elseif pose == 2
				PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[3])
				elseif pose == 3
				PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[2])
				elseif pose == 4
				PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[7])
				elseif pose == 5
				PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[8])
				endif			
				
			endif
					
		;SURRENDER						
		elseif Type == "surrender"																				
		Debug.Trace("NAKED DEFEAT configquest: PlayerPosing (surrender)")			
			
			;HUMAN SURRENDER
			if !CivilRapeRunning && ((DefeatTypeGeneral == "AreHumans") || (DefeatTypeGeneral == "AreHumanoids"))				
				
				NewPosePlayer = Utility.RandomInt(1,6)

				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (human/humanoid surrender): "+NewPosePlayer)

				if NewPosePlayer == 1
				PlayerRef.PlayIdle(IdlesHumanSurrender_01)
				elseif NewPosePlayer == 2
				PlayerRef.PlayIdle(IdlesHumanSurrender_02)
				elseif NewPosePlayer == 3
				PlayerRef.PlayIdle(IdlesHumanSurrender_03)	
				elseif NewPosePlayer == 4
				PlayerRef.PlayIdle(IdlesHumanSurrender_04)
				elseif NewPosePlayer == 5
				PlayerRef.PlayIdle(IdlesHumanSurrender_05)
				elseif NewPosePlayer == 6
				PlayerRef.PlayIdle(IdlesHumanSurrender_06)
				endif

			;PUBLIC  SURRENDER			
			elseif CivilRapeRunning && (ProxGuardDetected > 0)

				NewPosePlayer = Utility.RandomInt(1,3)

				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (public surrender): "+NewPosePlayer)
				if NewPosePlayer == 1
				PlayerRef.PlayIdle(IdlesHumanSurrender_01)
				elseif NewPosePlayer == 2
				PlayerRef.PlayIdle(IdlesHumanSurrender_02)
				elseif NewPosePlayer == 3
				PlayerRef.PlayIdle(IdlesHumanSurrender_03)
				endif
				
			;ANIMAL SURRENDER 	
			elseif (DefeatTypeGeneral == "AreAnimals")				
				NewPosePlayer = Utility.RandomInt(0,2)
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (animal surrender): "+NewPosePlayer)
				PlayerRef.PlayIdle(IdlesAnimalDefeat[NewPosePlayer])
			
			;INITIAL SURRENDER VIA HOTKEY (needs IMPROVING cause we dont have detected enemies yet... shit)	#TODO use Funciton GetClosestActor?
			else	
				NewPosePlayer = Utility.RandomInt(1,6)

				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (hotkey surrender): "+NewPosePlayer)

				if NewPosePlayer == 1
				PlayerRef.PlayIdle(IdlesHumanSurrender_01)
				elseif NewPosePlayer == 2
				PlayerRef.PlayIdle(IdlesHumanSurrender_02)
				elseif NewPosePlayer == 3
				PlayerRef.PlayIdle(IdlesHumanSurrender_03)	
				elseif NewPosePlayer == 4
				PlayerRef.PlayIdle(IdlesHumanSurrender_04)
				elseif NewPosePlayer == 5
				PlayerRef.PlayIdle(IdlesHumanSurrender_05)
				elseif NewPosePlayer == 6
				PlayerRef.PlayIdle(IdlesHumanSurrender_06)
				endif
			endif	
			
		;----- STRUGGLE ----------------------------------------------------------------------------------------------
		elseif Type == "struggle"															
		Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle)")
			
			;STRUGGLE ----- ARMBINDER 
			if 	(DefeatStateBindings == "Armbinder")
			
				NewPosePlayer = Utility.RandomInt(1,15)
					
				string [] AnimArray	
				AnimArray = new string[16]	
				AnimArray[0] = "RESET"
				AnimArray[1] = "ZapArmbStruggle01"		
				AnimArray[2] = "ZapArmbStruggle02"
				AnimArray[3] = "ZapArmbStruggle03"		
				AnimArray[4] = "ZapArmbStruggle04"
				AnimArray[5] = "ZapArmbStruggle05"		
				AnimArray[6] = "ZapArmbStruggle06"
				AnimArray[7] = "ZapArmbStruggle07"		
				AnimArray[8] = "ZapArmbStruggle08"
				AnimArray[9] = "ZapArmbStruggle09"
				AnimArray[10] = "ZapArmbStruggle10"
				AnimArray[11] = "ZapArmbStruggle11"
				AnimArray[12] = "ZapArmbStruggle12"
				AnimArray[13] = "ZapArmbStruggle13"
				AnimArray[14] = "ZapArmbStruggle14"
				AnimArray[15] = "ZapArmbStruggle15"	

				Debug.SendAnimationEvent(PlayerRef, AnimArray[NewPosePlayer])
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (Struggle Armbinder): "+NewPosePlayer)
	
			;STRUGGLE ----- XCROSS 	
			elseif 	(DefeatStateBindings == "XCross")
			
				NewPosePlayer = 1
				;only one struggle pose yet :(
				Debug.SendAnimationEvent(PlayerRef, "ZapXCrossStruggle01")
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (Struggle XCross): "+NewPosePlayer)
			

			
			;STRUGGLE ----- WHEEL 		
			elseif 	(DefeatStateBindings == "Wheel")
			
				NewPosePlayer = 1
				;test
				Debug.SendAnimationEvent(PlayerRef, "B_B_TiltWFF_A1_S1")
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (Struggle Wheel): "+NewPosePlayer)
	
			;STRUGGLE ----- STOCKADE 		
			elseif 	(DefeatStateBindings == "Stockade")
			
				NewPosePlayer = 1
				;no struggle pose :(
				Debug.SendAnimationEvent(PlayerRef, "Anubs_VS_A1_S1")
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (Struggle Stockade): "+NewPosePlayer)
		


		
			;STRUGGLE ----- PILLORY
			elseif (DefeatStateBindings == "Pillory")

				NewPosePlayer = Utility.RandomInt(0,16) ; <<----- CHECK

				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle pillory struggle): "+NewPosePlayer)					
				PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[NewPosePlayer])	;array lenght 17

			;STRUGGLE ----- YOKE
			elseif (DefeatStateBindings == "Yoke")
									
				NewPosePlayer = Utility.RandomInt(0,16)

				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle yokestruggle): "+NewPosePlayer)
				PlayerRef.PlayIdle(IdlesDefeatYokeStruggle[NewPosePlayer])	;array lenght 17

			;STRUGGLE ----- CUFFS															
			elseif (DefeatStateBindings == "Cuffs")  							
								

				NewPosePlayer = Utility.RandomInt(0,9)

				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle cuffsstruggle): "+NewPosePlayer)					
				PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[NewPosePlayer])	;array lenght 10
			
			;STRUGGLE ----- UNBOUND (Standardidles)						
			elseif (DefeatStateBindings == "Unbound")   

				NewPosePlayer = Utility.RandomInt(0,16)

				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle unbound): "+NewPosePlayer)					
				PlayerRef.PlayIdle(IdlesDefeatUnbound[NewPosePlayer])		;array lenght 17
						
			;STRUGGLE ----- UNBOUND FALLBACK				
			else 

				NewPosePlayer = Utility.RandomInt(0,16)

				Debug.Trace("NAKED DEFEAT configquest: #ERROR, needed Fallback) Pose struggle")					
				PlayerRef.PlayIdle(IdlesDefeatUnbound[NewPosePlayer])		;array lenght 17
			endif
		
		;----- WAIT ----------------------------------------------------------------------------------------------
		elseif Type == "wait"																	
		Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait)")	
			
			;WAIT ---- ARMBINDER 
			if (DefeatStateBindings == "Armbinder")
			
				NewPosePlayer = Utility.RandomInt(1,15)
					
				string [] AnimArray	
				AnimArray = new string[16]	
				AnimArray[0] = "RESET"
				AnimArray[1] = "ZapArmbPose01"		
				AnimArray[2] = "ZapArmbPose02"
				AnimArray[3] = "ZapArmbPose03"		
				AnimArray[4] = "ZapArmbPose04"
				AnimArray[5] = "ZapArmbPose05"		
				AnimArray[6] = "ZapArmbPose06"
				AnimArray[7] = "ZapArmbPose07"		;
				AnimArray[8] = "ZapArmbPose08"
				AnimArray[9] = "ZapArmbPose09"
				AnimArray[10] = "ZapArmbPose10"
				AnimArray[11] = "ZapArmbPose11"
				AnimArray[12] = "ZapArmbPose12"
				AnimArray[13] = "ZapArmbPose13"
				AnimArray[14] = "ZapArmbPose14"
				AnimArray[15] = "ZapArmbPose15"		
	
				Debug.SendAnimationEvent(PlayerRef, AnimArray[NewPosePlayer])
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait Armbinder): "+NewPosePlayer)
			
			
			
			;WAIT ----- WHEEL 		
			elseif 	(DefeatStateBindings == "Wheel")
			
				NewPosePlayer = 1
				;test
				Debug.SendAnimationEvent(PlayerRef, "ZazAPCAO263")
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (Wait Wheel): "+NewPosePlayer)
	
			;WAIT ----- STOCKADE 		
			elseif 	(DefeatStateBindings == "Stockade")
			
				NewPosePlayer = 1
				;no struggle pose :(
				Debug.SendAnimationEvent(PlayerRef, "B_Billyy_StockadeFuckMachine_A1_S1")
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (Wait Stockade): "+NewPosePlayer)
				
			;WAIT ---- XCROSS 
			elseif (DefeatStateBindings == "XCross")
			
				NewPosePlayer = Utility.RandomInt(1,3)
					
				string [] AnimArray	
				AnimArray = new string[4]	
				AnimArray[0] = "RESET"
				AnimArray[1] = "ZapXCrossPose01"		
				AnimArray[2] = "ZapXCrossPose01b"
				AnimArray[3] = "B_Billyy_XCrossFuck_A1_S1"		
	
	
				Debug.SendAnimationEvent(PlayerRef, AnimArray[NewPosePlayer])
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait XCross): "+NewPosePlayer)	

			;WAIT ---- PILLORY
			elseif (DefeatStateBindings == "Pillory")

				NewPosePlayer = Utility.RandomInt(0,12)
				
				
				;Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait pillory): "+NewPosePlayer)
				
				if PlayerRef.PlayIdle(IdlesDefeatPillory[NewPosePlayer])		;array lenght 13
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait pillory): "+NewPosePlayer)
				else
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait pillory) #ERROR: "+NewPosePlayer)
				endif
			;WAIT ---- YOKE
			elseif (DefeatStateBindings == "Yoke")
											

				NewPosePlayer = Utility.RandomInt(0,14)
			
				
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait yoke): "+NewPosePlayer)
				PlayerRef.PlayIdle(IdlesDefeatYoke[NewPosePlayer])			;array lenght 15
			
			;WAIT ---- CUFFS 				
			elseif (DefeatStateBindings == "Cuffs")	
				NewPosePlayer = Utility.RandomInt(0,19)
				
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle cuffs): "+NewPosePlayer)
				PlayerRef.PlayIdle(IdlesDefeatCuffs[NewPosePlayer])		;array lenght 20
					
			;WAIT ---- UNBOUND (Standardidles)	;CHECK FOR STRUGGLE AND WAIT VARIANTS					
			elseif (DefeatStateBindings == "Unbound")  	
				NewPosePlayer = Utility.RandomInt(0,16)
				
				Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle unbound): "+NewPosePlayer)					
				PlayerRef.PlayIdle(IdlesDefeatUnbound[NewPosePlayer])		;array lenght 17			
		
			;WAIT ---- FALLBACK (Standardidles)	;CHECK FOR STRUGGLE AND WAIT VARIANTS				
			else 
				NewPosePlayer = Utility.RandomInt(0,16)
				
				Debug.Trace("NAKED DEFEAT configquest: #ERROR, needed Fallback) Pose Wait")					
				PlayerRef.PlayIdle(IdlesDefeatUnbound[NewPosePlayer])		;array lenght 17			
			endif				
		endif	
	endif ;DD Stuff	

EndFunction


/;


;/				
Function OLDwithRESTOREPlayerPosing(string Type = "none", bool restore)		 		
Debug.Trace("NAKED DEFEAT configquest: PlayerPosing()")			
Debug.Trace("NAKED DEFEAT configquest: PlayerPosing() - DefeatStateBindings: "+DefeatStateBindings)	
				

;TYPE should be "wiggle, wait, surrender". ---> determines the pose dynamic
;SCENARIO should be the DefeatTypeScenario String or a direct string ---> determines the furniture/bound options
;cfgqst.PlayerPosing("Struggle", cfgqst.DefeatTypeScenario, false)
		
	int NewPosePlayer	
	string NewTypePlayer
	
	;RANDOMIZE when (Type == "Random")
	if Type == "Random"
		if D100(50)
		Type = "Struggle"
		else
		Type = "Wait"
		endIf
	endif	
	
	;repeat the last used POSE
	if restore
	NewTypePlayer = LastTypePlayer
	NewPosePlayer = LastPosePlayer
	;new Pose: wiggle / wait / stop / receiving
	else
	NewTypePlayer = Type
	LastTypePlayer = NewTypePlayer
	endif
					
	if NewTypePlayer == "Stop"		
	Debug.Trace("NAKED DEFEAT configquest: PlayPose (Stop)")		
	PlayerRef.PlayIdle(IdlesFixHair[0])
	NewTypePlayer = "none"
	LastTypePlayer = "none"
	
	;OFFERING -----> For Fast Travel and other Rituals				 	
	elseif NewTypePlayer == "Offering"
	Debug.Trace("NAKED DEFEAT configquest: PlayPose (offering)")	
		if !restore
		NewPosePlayer = Utility.RandomInt(1,4)
		endif
	if NewPosePlayer < 4
	PlayerRef.PlayIdle(IdlesHumanSurrender[NewPosePlayer])		;replace later, human surrender poses
	elseif NewPosePlayer == 4
	PlayerRef.PlayIdle(IdlesAnimalDefeat[0])					;on all fours
	endif	
		
	;RECEIVING -----> For Golden Shower / Pee --> might be too specialized?			 	
	elseif NewTypePlayer == "Receiving"
	Debug.Trace("NAKED DEFEAT configquest: PlayPose (receiving)")	
		if !restore
		NewPosePlayer = Utility.RandomInt(1,3)
		endif
		
		if NewPosePlayer == 1	;set 1 - sitting
		Debug.Trace("NAKED DEFEAT configquest: PlayPose (Set 1 - sitting)")	
			int pose = Utility.RandomInt(1,3)
			if pose == 1
			PlayerRef.PlayIdle(IdlesDefeatCuffs[10])
			elseif pose == 2
			PlayerRef.PlayIdle(IdlesDefeatCuffs[11])
			elseif pose == 3
			PlayerRef.PlayIdle(IdlesDefeatCuffs[12])
			endif
		elseif NewPosePlayer == 2  ;set 2 - kneeling		
		Debug.Trace("NAKED DEFEAT configquest: PlayPose (Set 2 - kneeling)")
			int pose = Utility.RandomInt(1,5)
			if pose == 1
			PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[4])
			elseif pose == 2
			PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[5])
			elseif pose == 3
			PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[6])
			elseif pose == 4
			PlayerRef.PlayIdle(IdlesDefeatCuffs[16])
			elseif pose == 5
			PlayerRef.PlayIdle(IdlesDefeatCuffs[18])	
			endif
		elseif NewPosePlayer == 3 ;set 3 - standing
		Debug.Trace("NAKED DEFEAT configquest: PlayPose (Set 3 - standing)")
			int pose = Utility.RandomInt(1,3)
			if pose == 1
			PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[0])
			elseif pose == 2
			PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[1])
			elseif pose == 3
			PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[2])
			endif
			
		elseif NewPosePlayer == 4 ;set 4 - low standing
		Debug.Trace("NAKED DEFEAT configquest: PlayPose (Set 4 - low standing)")
			int pose = Utility.RandomInt(1,5)
			if pose == 1
			PlayerRef.PlayIdle(IdlesDefeatCuffs[19])
			elseif pose == 2
			PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[3])
			elseif pose == 3
			PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[2])
			elseif pose == 4
			PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[7])
			elseif pose == 5
			PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[8])
			endif			
			
		endif
			
	;SURRENDER				
	elseif NewTypePlayer == "surrender"																				
	Debug.Trace("NAKED DEFEAT configquest: PlayPose (surrender)")			
		
		;HUMAN SURRENDER
		if !CivilRapeRunning && ((DefeatTypeGeneral == "AreHumans") || (DefeatTypeGeneral == "AreHumanoids"))				
			
			if restore
			NewPosePlayer = LastPosePlayer
			else
			NewPosePlayer = Utility.RandomInt(1,6)
			LastPosePlayer = NewPosePlayer
			endif
			
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (human/humanoid surrender): "+NewPosePlayer)

			if NewPosePlayer == 1
			PlayerRef.PlayIdle(IdlesHumanSurrender_01)
			elseif NewPosePlayer == 2
			PlayerRef.PlayIdle(IdlesHumanSurrender_02)
			elseif NewPosePlayer == 3
			PlayerRef.PlayIdle(IdlesHumanSurrender_03)	
			elseif NewPosePlayer == 4
			PlayerRef.PlayIdle(IdlesHumanSurrender_04)
			elseif NewPosePlayer == 5
			PlayerRef.PlayIdle(IdlesHumanSurrender_05)
			elseif NewPosePlayer == 6
			PlayerRef.PlayIdle(IdlesHumanSurrender_06)
			endif

		;PUBLIC  SURRENDER			
		elseif CivilRapeRunning && (ProxGuardDetected > 0)
		
			if restore
			NewPosePlayer = LastPosePlayer
			else
			NewPosePlayer = Utility.RandomInt(1,3)
			LastPosePlayer = NewPosePlayer
			endif
		
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (public surrender): "+NewPosePlayer)

			if NewPosePlayer == 1
			PlayerRef.PlayIdle(IdlesHumanSurrender_01)
			elseif NewPosePlayer == 2
			PlayerRef.PlayIdle(IdlesHumanSurrender_02)
			elseif NewPosePlayer == 3
			PlayerRef.PlayIdle(IdlesHumanSurrender_03)
			endif
			
		;ANIMAL SURRENDER 	
		else			
			if restore
			NewPosePlayer = LastPosePlayer
			else
			NewPosePlayer = Utility.RandomInt(0,2)
			LastPosePlayer = NewPosePlayer
			endif
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (animal surrender): "+NewPosePlayer)
			PlayerRef.PlayIdle(IdlesAnimalDefeat[NewPosePlayer])
		endif	
		
	;----- STRUGGLE ----------------------------------------------------------------------------------------------
	elseif NewTypePlayer == "struggle"															
	Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle)")
		
		;PILLORY Struggle
		if (DefeatStateBindings == "Pillory")
		
			if restore
			NewPosePlayer = LastPosePlayer
			else
			NewPosePlayer = Utility.RandomInt(0,16) ; <<----- CHECK
			LastPosePlayer = NewPosePlayer
			endif
			
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle pillory struggle): "+NewPosePlayer)					
			PlayerRef.PlayIdle(IdlesDefeatPilloryStruggle[NewPosePlayer])	;array lenght 17

		;YOKE Struggle
		elseif (DefeatStateBindings == "Yoke")
								
			if restore
			NewPosePlayer = LastPosePlayer
			else
			NewPosePlayer = Utility.RandomInt(0,16)
			LastPosePlayer = NewPosePlayer
			endif
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle yokestruggle): "+NewPosePlayer)
			PlayerRef.PlayIdle(IdlesDefeatYokeStruggle[NewPosePlayer])	;array lenght 17

		;CUFFS Struggle																
		elseif (DefeatStateBindings == "Cuffs")  							
							
			if restore
			NewPosePlayer = LastPosePlayer
			else
			NewPosePlayer = Utility.RandomInt(0,9)
			LastPosePlayer = NewPosePlayer
			endif
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle cuffsstruggle): "+NewPosePlayer)					
			PlayerRef.PlayIdle(IdlesDefeatCuffsStruggle[NewPosePlayer])	;array lenght 10
	
				
		;UNBOUND (Standardidles)					
		else 
			if restore
			NewPosePlayer = LastPosePlayer
			else
			NewPosePlayer = Utility.RandomInt(0,16)
			LastPosePlayer = NewPosePlayer
			endif
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle unbound): "+NewPosePlayer)					
			PlayerRef.PlayIdle(IdlesDefeatUnbound[NewPosePlayer])		;array lenght 17
		endif
		
	;----- WAIT ----------------------------------------------------------------------------------------------
	elseif NewTypePlayer == "wait"																	
	Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait)")	
		
		;PILLORY
		if (DefeatStateBindings == "Pillory")
			if restore
			NewPosePlayer = LastPosePlayer
			else
			NewPosePlayer = Utility.RandomInt(0,12)
			LastPosePlayer = NewPosePlayer
			endif
			;Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait pillory): "+NewPosePlayer)
			
			if PlayerRef.PlayIdle(IdlesDefeatPillory[NewPosePlayer])		;array lenght 13
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait pillory): "+NewPosePlayer)
			else
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait pillory) #ERROR: "+NewPosePlayer)
			endif
	;YOKE
		elseif (DefeatStateBindings == "Yoke")
										
			if restore
			NewPosePlayer = LastPosePlayer
			else
			NewPosePlayer = Utility.RandomInt(0,14)
			LastPosePlayer = NewPosePlayer
			endif
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (wait yoke): "+NewPosePlayer)
			PlayerRef.PlayIdle(IdlesDefeatYoke[NewPosePlayer])			;array lenght 15
	
		;CUFFS 				
		elseif (DefeatStateBindings == "Cuffs")	
		
			if restore
			NewPosePlayer = LastPosePlayer
			else
			NewPosePlayer = Utility.RandomInt(0,19)
			LastPosePlayer = NewPosePlayer
			endif
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle cuffs): "+NewPosePlayer)
			PlayerRef.PlayIdle(IdlesDefeatCuffs[NewPosePlayer])		;array lenght 20
		
		;UNBOUND (Standardidles)	;CHECK FOR STRUGGLE AND WAIT VARIANTS				
		else 
			if restore
			NewPosePlayer = LastPosePlayer
			else
			NewPosePlayer = Utility.RandomInt(0,16)
			LastPosePlayer = NewPosePlayer
			endif
			Debug.Trace("NAKED DEFEAT configquest: ForcePose Start (struggle unbound): "+NewPosePlayer)					
			PlayerRef.PlayIdle(IdlesDefeatUnbound[NewPosePlayer])		;array lenght 17	
			
		endif				
	endif	
	
	LastPosePlayer = NewPosePlayer 

EndFunction

/;

int DefeatCollarEquipped
			
Function AddDefeatCollar(string Type)		;#collar		;DISABLED FOR NOW BECAUSE ZAP BUGS

Debug.Trace("NAKED DEFEAT calmquest: AddDefeatCollar()")

	bool AddCollar = false

	if Allow_Collar_TOGGLE
	
		if DefeatTypeGeneral == "AreAnimals"
		AddCollar = false
		elseif (DefeatTypeScenario == "Cuffs") || DefeatViaSlavery		;when enslaved always get collar
		AddCollar = true
		elseif D100(66)
		AddCollar = true
		endif
		
		armor CheckCollar = (PlayerRef.GetWornForm(0x00008000)) as armor	;45 - (DD Collars)
		if CheckCollar && CheckCollar.HasKeyWord(SexLabNoStrip)
		AddCollar = false
		endif
		
		if AddCollar		;#TODO adjust collars so we dont get ROPE stuff when enslaved, only metal.
			if type == "Black Iron"
			DefeatCollarEquipped = 0
			elseif type == "Gold Iron"
			DefeatCollarEquipped = 1
			elseif type == "Rope Extreme"
			DefeatCollarEquipped = 2
			elseif type == "Black Leather"
			DefeatCollarEquipped = 3
			elseif type == "Brown Belt"
			DefeatCollarEquipped = 4
			elseif Type == "Random" 		
			DefeatCollarEquipped = (Utility.RandomInt(0,4))	
			endIf
			
			if DefeatViaSlavery && (DefeatCollarEquipped == 2)	;for slaves no rope collar
			DefeatCollarEquipped = Utility.RandomInt(0,1)
			endif
			
			if DefeatTypeScenario == "FastTravel"	;for fast travel, gold metal collar
			DefeatCollarEquipped = 1
			endif
			
			
			if DefeatCollarEquipped < 2
			PlayCuffsSoundMetal()
			else
			PlayCuffsSoundRope()
			endif 

			PlayerRef.AddItem(DefeatCollar[DefeatCollarEquipped], 1, true)			;metal
			PlayerRef.EquipItem(DefeatCollar[DefeatCollarEquipped], false, true)
			SendModEvent("Moan")	
		endif
	endif 
		
EndFunction

;bool NoActorsRestartSlavery = false

;Function NoActorsRestartSlavery()
;NoActorsRestartSlavery = true
;EndFunction

Bool Function CheckEnemiesFor(String EnemyType)			;#CheckEnemiesFor()
	
	if (Enemy[0] == EnemyType) || (Enemy[1] == EnemyType) || (Enemy[2] == EnemyType) || (Enemy[3] == EnemyType) || (Enemy[4] == EnemyType) || (Enemy[5] == EnemyType)
	return true  
	else
	return false 
	endif 
	
EndFunction 

;---- DefeatType -----------------------------------------------------------------------

Function GetDefeatType()	;#get	#type		#GetDefeatType()		##DEFEATTYPE##

Debug.Trace("NAKED DEFEAT configquest: GetDefeatType()")
Debug.Trace("NAKED DEFEAT configquest: GetDefeatType() Enemy[0]: "+Enemy[0])
Debug.Trace("NAKED DEFEAT configquest: GetDefeatType() Enemy[1]: "+Enemy[1])
Debug.Trace("NAKED DEFEAT configquest: GetDefeatType() Enemy[2]: "+Enemy[2])
Debug.Trace("NAKED DEFEAT configquest: GetDefeatType() Enemy[3]: "+Enemy[3])
Debug.Trace("NAKED DEFEAT configquest: GetDefeatType() Enemy[4]: "+Enemy[4])
Debug.Trace("NAKED DEFEAT configquest: GetDefeatType() Enemy[5]: "+Enemy[5])


	;WE NEED TO ACCOUNT FOR MIXED ENEMIES and WHICH TYPE GETS PRIORITY
	;or how we manage that? saved tags? 

	if DefeatViaSlavery
	;do Nothing --_> DefeatType is hard coded already
	else
		;GUARDS ----> do we need this?
		if CheckEnemiesFor("Guards") 	
		DefeatType = "Guards"
		DefeatTypeGeneral = "AreHumans"

		elseif AreBandits 
		DefeatType = "Bandits"
		DefeatTypeGeneral = "AreHumans"
		
		;HUMANS
		elseif CheckEnemiesFor("Humans") || CheckEnemiesFor("Mages") || CheckEnemiesFor("DremoraRace")	
		DefeatType = "Humans"
		DefeatTypeGeneral = "AreHumans"
						
			;if we are Human and there are Vampires		
			if CheckEnemiesFor("Vampires") 
			DefeatType = "Undead"

			;if we are Human and there are Necromancers
			elseif CheckEnemiesFor("Necromancers") 
			DefeatType = "Undead"
	
			;if we are Human and there are Draugrs but NO Vampires or Necromancers
			elseif CheckEnemiesFor("Draugrs") 
			DefeatType = "Undead"
			DefeatTypeGeneral = "AreHumanoids"
			endif

		;	if (Enemy[1] == "Guards") || (Enemy[2] == "Guards") || (Enemy[3] == "Guards") || (Enemy[4] == "Guards") || (Enemy[5] == "Guards")
		;	DefeatType = "Guards"

		;VAMPIRES/NECROMANCERS
	;	elseif (Enemy[0] == "Vampires") || (Enemy[0] == "Necromancers") 	
	;	DefeatType = "Undead"
	;	DefeatTypeGeneral = "AreHumans"	
		

		;UNDEAD
		elseif CheckEnemiesFor("Draugrs") || CheckEnemiesFor("WispMothers") || CheckEnemiesFor("Wisps") || CheckEnemiesFor("VampireLords") || CheckEnemiesFor("DragonPriests")  
		DefeatType = "Undead"
		DefeatTypeGeneral = "AreHumanoids"
				;if Enemy[1] == ("Draugrs") || Enemy[2] == ("Draugrs") || Enemy[3] == ("Draugrs") || Enemy[4] == ("Draugrs") || Enemy[5] == ("Draugrs")
			;	DefeatTypeGeneral = "AreHumanoids"
			;	elseif Enemy[1] == ("VampireLords") || Enemy[2] == ("VampireLords") || Enemy[3] == ("VampireLords") || Enemy[4] == ("VampireLords") || Enemy[5] == ("VampireLords")
			;	
			;	elseif Enemy[1] == ("DragonPriests") || Enemy[2] == ("DragonPriests") || Enemy[3] == ("DragonPriests") || Enemy[4] == ("DragonPriests") || Enemy[5] == ("DragonPriests")
			;	DefeatTypeGeneral = "AreHumanoids"
			;	else
			;	DefeatType = "Ghosts"		;will get their own furniture bondage
			;	endif
		
		;FALMERS
		elseif CheckEnemiesFor("Falmers") || CheckEnemiesFor("Chaurus") || CheckEnemiesFor("ChaurusHunters") || CheckEnemiesFor("ChaurusReapers") || CheckEnemiesFor("BoarsAny")
			
			if CheckEnemiesFor("Falmers") ;|| Enemy[2] == ("Falmers") || Enemy[3] == ("Falmers") || Enemy[4] == ("Falmers") || Enemy[5] == ("Falmers")
			DefeatType = "Falmers"
			DefeatTypeGeneral = "AreHumanoids"

			else
			DefeatType = "Chaurus"		;hmm only if they get their own bondage? But yes they get!!!!
			DefeatTypeGeneral = "AreAnimals"

			endif
				
		;HUMAN ANIMALS
		elseif CheckEnemiesFor("Dogs") || CheckEnemiesFor("Horses") ||  CheckEnemiesFor("Goats") || CheckEnemiesFor("Canines")
			
			if CheckEnemiesFor("Humans")
			DefeatTypeGeneral = "AreHumans"			
			DefeatType = "Humans"			
				if CheckEnemiesFor("Guards") 
				DefeatType = "Guards"
				endif	
			else
			DefeatTypeGeneral = "AreAnimals"
			endif
			
		;GIANTS
		elseif CheckEnemiesFor("Giants") ;|| Enemy[0] == ("Mammoths")
		DefeatType = "Giants"
		DefeatTypeGeneral = "AreHumanoids"
		
		elseif CheckEnemiesFor("Lurkers") ;|| Enemy[0] == ("Mammoths")
		DefeatType = "Lurkers"
		DefeatTypeGeneral = "AreHumanoids"
	
		;TROLLS
		elseif CheckEnemiesFor("Trolls")		
		DefeatType = "Trolls"
		DefeatTypeGeneral = "AreHumanoids"
		
		;WOLVES
		elseif CheckEnemiesFor("Wolves")
		DefeatType = "Wolves"
		DefeatTypeGeneral = "AreAnimals"
				
		;SKEEVERS		
		elseif CheckEnemiesFor("Skeevers")
		DefeatType = "Skeevers"
		DefeatTypeGeneral = "AreAnimals"	
		
		;SPIDERS
		elseif CheckEnemiesFor("Spiders") || CheckEnemiesFor("LargeSpiders") || CheckEnemiesFor("GiantSpiders") 
		DefeatType = "Spiders"	;will get their own furniture bondage
		DefeatTypeGeneral = "AreAnimals"

		;SABRECATS
		elseif CheckEnemiesFor("SabreCats")
		DefeatType = "SabreCats"
		DefeatTypeGeneral = "AreAnimals"
		
		;BEARS
		elseif CheckEnemiesFor("Bears")
		DefeatType = "Bears"
		DefeatTypeGeneral = "AreAnimals"
		
		;Mammoths
		elseif CheckEnemiesFor("Mammoths")
		DefeatType = "Mammoths"
		DefeatTypeGeneral = "AreAnimals"
		
		;DWARVEN
		elseif CheckEnemiesFor("DwarvenBallistas") || CheckEnemiesFor("DwarvenCenturions") || CheckEnemiesFor("DwarvenSpheres") || CheckEnemiesFor("DwarvenSpiders")
		DefeatType = "Dwemer"	;will get their own furniture bondage
		
		;RIEKLINGS
		elseif CheckEnemiesFor("Rieklings") || CheckEnemiesFor("Boars") || CheckEnemiesFor("BoarsAny") || CheckEnemiesFor("BoarsMounted")	
		
		DefeatType = "Rieklings"
		DefeatTypeGeneral = "AreHumanoids"
		
		;if Enemy[1] == ("Rieklings") || Enemy[2] == ("Rieklings") || Enemy[3] == ("Rieklings") || Enemy[4] == ("Rieklings") || Enemy[5] == ("Rieklings")
		;	DefeatType = "Rieklings"
		;	DefeatTypeGeneral = "AreHumanoids"
		;	elseif Enemy[1] == ("BoarsMounted") || Enemy[2] == ("BoarsMounted") || Enemy[3] == ("BoarsMounted") || Enemy[4] == ("BoarsMounted") || Enemy[5] == ("BoarsMounted")
		;	DefeatType = "Rieklings"
		;	DefeatTypeGeneral = "AreHumanoids"
		;	else
		;	DefeatTypeGeneral = "AreAnimals"
		;	endif

		;WEREWOLVES
		elseif CheckEnemiesFor("Werewolves")
		DefeatType = "Werewolves"
		DefeatTypeGeneral = "AreHumanoids"
		
		;SPRIGGANS
		elseif CheckEnemiesFor("Spriggans")
		DefeatType = "Spriggans"		;get their own bondage (trees)
		DefeatTypeGeneral = "AreHumanoids"

		;---> allow wildlife to participate option (deer, foxes etc.)
			
		;ICEWRAITH	
		elseif CheckEnemiesFor("IceWraiths")
		DefeatType = "Ghosts"			;will get their own bondage stuff		
		DefeatTypeGeneral = "AreAnimals"
		
		;DEMONIC CREATURES (handle with lowest priority, hopefully this helps)
		;/
		elseif ModDEM ;NOT WORKING or NOT REQUIRED AT THE MOMENT
			
			;Riekling Faction
			if Enemy[0] == ("DEM_Rieklings") || Enemy[1] == ("DEM_Rieklings") || Enemy[2] == ("DEM_Rieklings") || Enemy[3] == ("DEM_Rieklings") || Enemy[4] == ("DEM_Rieklings") || Enemy[5] == ("DEM_Rieklings")
				DefeatType = "Rieklings"
				DefeatTypeGeneral = "AreHumanoids"

			;Draugr Faction --> Undead
			elseif Enemy[0] == ("DEM_Draugrs") || Enemy[1] == ("DEM_Draugrs") || Enemy[2] == ("DEM_Draugrs") || Enemy[3] == ("DEM_Draugrs") || Enemy[4] == ("DEM_Draugrs") || Enemy[5] == ("DEM_Draugrs")
				DefeatType = "Undead"
				DefeatTypeGeneral = "AreHumanoids"

			;Spriggan Faction
			elseif Enemy[0] == ("DEM_Spriggans") || Enemy[1] == ("DEM_Spriggans") || Enemy[2] == ("DEM_Spriggans") || Enemy[3] == ("DEM_Spriggans") || Enemy[4] == ("DEM_Spriggans") || Enemy[5] == ("DEM_Spriggans")
				DefeatType = "Spriggans"
				DefeatTypeGeneral = "AreHumanoids"

			;Dwarven Faction
			elseif Enemy[0] == ("DEM_DwarvenCenturions") || Enemy[1] == ("DEM_DwarvenCenturions") || Enemy[2] == ("DEM_DwarvenCenturions") || Enemy[3] == ("DEM_DwarvenCenturions") || Enemy[4] == ("DEM_DwarvenCenturions") || Enemy[5] == ("DEM_DwarvenCenturions")
				DefeatType = "Dwemer"
				DefeatTypeGeneral = "AreHumanoids"

			;Falmer Faction
			elseif Enemy[0] == ("DEM_Falmers") || Enemy[1] == ("DEM_Falmers") || Enemy[2] == ("DEM_DwarvenCenturions") || Enemy[3] == ("DEM_DwarvenCenturions") || Enemy[4] == ("DEM_DwarvenCenturions") || Enemy[5] == ("DEM_DwarvenCenturions")
				DefeatType = "Falmers"
				DefeatTypeGeneral = "AreHumanoids"
			
			else
			DefeatType = "Funny"
			DefeatTypeGeneral = "AreFunny"		
			;endif
			endif
			
			;DEBUG TRACE
			Debug.Trace("NAKED DEFEAT configquest: DefeatTypeGeneral (DEM): "+DefeatTypeGeneral)		
			Debug.Trace("NAKED DEFEAT configquest: DefeatType (DEM): "+DefeatType)
		/;	
		else
		DefeatType = "Funny"
		DefeatTypeGeneral = "AreFunny"	
		;endif
			
		endif
	endif	
	;DEBUG TRACE		
	;Debug.Trace("NAKED DEFEAT configquest: DefeatTypeGeneral: "+DefeatTypeGeneral)		
	;Debug.Trace("NAKED DEFEAT configquest: DefeatType: "+DefeatType)
			
			
	;DEFEAT TYPE LAST CORRECTIONS 			
	if DefeatType == "Undead"
		if CheckEnemiesFor("Vampires") ;|| (Enemy[2] == "Vampires") || (Enemy[3] == "Vampires") || (Enemy[4] == "Vampires") || (Enemy[5] == "Vampires") 
		DefeatTypeGeneral = "AreHumans"
		elseif CheckEnemiesFor("Necromancers") ; || (Enemy[2] == "Necromancers") || (Enemy[3] == "Necromancers") || (Enemy[4] == "Necromancers") || (Enemy[5] == "Necromancers") 
		DefeatTypeGeneral = "AreHumans"
		else ; CheckEnemiesFor("Draugrs") ;|| (Enemy[2] == "Draugrs") || (Enemy[3] == "Draugrs") || (Enemy[4] == "Draugrs") || (Enemy[5] == "Draugrs") 
		DefeatTypeGeneral = "AreHumanoids"
		endif
	endif 	
			
;	Enemy[0] = "none"
;	Enemy[1] = "none"
;	Enemy[2] = "none"
;	Enemy[3] = "none"
;	Enemy[4] = "none"
;	Enemy[5] = "none"

	;GetDefeatTypeRunning = false

	RaceMessage()

EndFunction

;----------------------------------------------------------------------------------


;DefeatRaceMessage
Function RaceMessage()

	if DefeatType == "none"
	Debug.Trace("NAKED DEFEAT configquest: RaceMessage(): DefeatType(NONE) "+DefeatType)
	else
	Debug.Trace("NAKED DEFEAT configquest: RaceMessage(): "+DefeatType)
	endif
		
	;Humans	
					
	if DefeatType == ("FastTravelPartners")
	ScreenMessage("Fucked by FastTravelPartners")
	
	elseif DefeatType == "Humans"
	
		if AreBandits
		ScreenMessage("You were defeated by Bandits")
		else
		ScreenMessage("You were defeated by Humans")
		endif
	elseif DefeatType == "Dogs"
	ScreenMessage("You were defeated by Dogs")
	
	elseif DefeatType == "Guards"
	ScreenMessage("You were defeated by Guards")
	
	CheckCrimePunishment()	;#CrimeManagement
	;DebugCheckCurrentCrimeGold()
	
	elseif DefeatType == "Trolls"
	ScreenMessage("You were defeated by Trolls")

	elseif DefeatType == "Wolves"
	ScreenMessage("You were defeated by Wolves")

	elseif DefeatType == "Undead"
	ScreenMessage("You were defeated by the Undead")

	elseif DefeatType == "Falmers"
	ScreenMessage("You were defeated by Falmers")

	elseif DefeatType == "Chauruses"
	ScreenMessage("You were defeated by Chauruses")

	elseif DefeatType == "Skeevers"
	ScreenMessage("You were defeated by winking Skeevers")

	elseif DefeatType == "Spiders"
	ScreenMessage("You were defeated by Spiders")

	elseif DefeatType == "SabreCats"
	ScreenMessage("You were defeated by SabreCats")

	elseif DefeatType == "Bears"
	ScreenMessage("You were defeated by Bears")

	elseif DefeatType == "Dwemer"
	ScreenMessage("You were defeated by Dwemer Machines")

	elseif DefeatType == "Rieklings"
	ScreenMessage("You were defeated by Rieklings")

	elseif DefeatType == "Werewolves"
	ScreenMessage("You were defeated by Werewolves")

	elseif DefeatType == "Spriggans"
	ScreenMessage("You were defeated by Spriggans")

	elseif DefeatType == "Giants"
	ScreenMessage("You were defeated by Giants")

	elseif DefeatType == "Ghosts"
	ScreenMessage("You were defeated by Ghosts")

	elseif DefeatType == "Funny"
	ScreenMessage("You were defeated by Everybody (No Race detected)")

	elseif DefeatType == "none"
	ScreenMessage("You were defeated by NONE (#ERROR)")
	Debug.Trace("NAKED DEFEAT configquest: You were defeated by NONE (#ERROR)")
	endif
;	cfgqst.DefeatTypeHumanoids 
;	cfgqst.DefeatTypeAnimals 
	
EndFunction

;-----------------------------------------------------------------------------------------------------------------------------------------------------


Bool Function IsForbiddenActor(String HasRaceKey)
	
	;we sort out ALL forbidden racekeys first, then we can work better with the rest. 
	
	if ((HasRaceKey == ("Dogs")) || (HasRaceKey == ("Canines")) || (HasRaceKey == ("Wolves"))) && !AllowCanines  
	return true 
	elseif HasRaceKey == ("Skeevers") && !AllowSkeevers
	return true		
	;HUMANOID BEASTS 	
	elseif ((HasRaceKey == ("Trolls")) || (HasRaceKey == ("Trolls")) || (HasRaceKey == ("Werewolves")) || (HasRaceKey == ("Gargoyles")) || (HasRaceKey == ("Giants"))) && !AllowHumanoidBeasts
	return true
	;UNDEAD 	
	elseif ((HasRaceKey == ("Draugrs")) || (HasRaceKey == ("VampireLords")) || (HasRaceKey == ("DragonPriests")) || (HasRaceKey == ("Gargoyles"))) && !AllowUndead	
	return true
	;TENTACLES  	
	elseif ((HasRaceKey == ("Seekers")) || (HasRaceKey == ("Netches"))) && !AllowTentacleStuff
	return true
	;ELEMENTALS MALE 
	elseif HasRaceKey == ("StormAtronach") && !AllowElementalsMale
	return true
	elseif HasRaceKey == ("FrostAtronach")	&& !AllowElementalsMale
	return true
	elseif HasRaceKey == ("FlameAtronach")	&& !AllowElementalsFemale
	return true
	;ELEMENTALS FEMALE 
	elseif HasRaceKey == ("WispMothers") && !AllowElementalsFemale
	return true
	elseif HasRaceKey == ("Wisps") && !AllowElementalsMale
	return true

	;FALMERS 	
	elseif ((HasRaceKey == ("Falmers")) || (HasRaceKey == ("BoarsAny"))) && !AllowFalmers
	return true
	elseif ((HasRaceKey == ("Chaurus")) || (HasRaceKey == ("ChaurusHunters")) || (HasRaceKey == ("ChaurusReapers")) || (HasRaceKey == ("Ashhoppers"))) && !AllowInsects
	return true
	 	
	;SPIDERS
	elseif ((HasRaceKey == ("Spiders")) || (HasRaceKey == ("LargeSpiders")) || (HasRaceKey == ("GiantSpiders"))) && !AllowSpiders
	return true

	;ANIMALS 
	elseif HasRaceKey == ("Horses") && !AllowHorses
	return true
	elseif HasRaceKey == ("Goats") && !AllowGoats
	return true
	elseif HasRaceKey == ("Cows") && !AllowCows
	return true

	;SABRECATS			
	elseif HasRaceKey == ("SabreCats") && AllowSabrecats
	return true
	;BEARS	
	elseif HasRaceKey == ("Bears") && AllowBears
	return true
	elseif HasRaceKey == ("Mammoths") && AllowMammoths
	return true
	
	;DWARVEN
	elseif ((HasRaceKey == ("DwarvenBallistas")) || (HasRaceKey == ("DwarvenCenturions")) || (HasRaceKey == ("DwarvenSpheres")) || (HasRaceKey == ("DwarvenSpiders"))) && !AllowDwarven	
	return true	
	
	;RIEKLINGS  	 
	elseif (HasRaceKey == ("Rieklings")) || (HasRaceKey == ("Boars")) || (HasRaceKey == ("BoarsAny")) || (HasRaceKey == ("BoarsMounted")) && !AllowRieklings	
	return false
	endif 
	
EndFunction 


;Bool IsAcheronBridge = false



Bool Function AllowActor(actor akActor, int Type, String aName)		;is run in SortActors (quite early)		;#allowactor()

Actor a = akActor; as Actor
string HasRaceKey = GetRaceKey(a)
Float CheckDistance
Float TempDistance =  a.GetDistance(PlayerRef); > CheckDistance

Debug.Trace("NAKED DEFEAT configquest: AllowActor: " +aName+" Type:"+Type+" Distance:"+TempDistance+" Racekey:"+HasRaceKey)

;/
if ShowDebugMessages
Debug.Trace("NAKED DEFEAT configquest: AllowActor: " +GetActorInfo(a))
Debug.Trace("NAKED DEFEAT configquest: AllowActor: HasRaceKey: " +HasRaceKey)
else
Debug.Trace("NAKED DEFEAT configquest: AllowActor: " +a.GetBaseObject().GetName())
Debug.Trace("NAKED DEFEAT configquest: AllowActor: HasRaceKey: " +HasRaceKey)
endIf
/;
;sort out enemies, hopefully
		
	if !Sexlab.IsValidActor(akActor)
	Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> Sexlab: Is NOT a Valid Actor")
	return false
	endif 
		
	if DefeatViaSlavery && !SlaveryHostile && (a.IsHostileToActor(PlayerRef) || a.IsInFaction(BanditFaction))	;elaborate this?!?! 
	Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> IsHostile but we have Public Slavery")
	return false
	endif
	
	if a.IsInFaction(NakedGhostFaction)	;elaborate this?!?! 
	Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> IsSpawnedActor and already sorted")
	return false
	endif
			
	;Search Radius Setup 					
	if DefeatViaSlavery || (DefeatTypeScenario == "Afterlife") || CivilRapeRunning
	;Debug.Trace("NAKED DEFEAT calmquest: cfgqst.DefeatViaSlavery")
	CheckDistance = 10000
	elseif PlayerRef.IsInInterior()
	CheckDistance = SearchRadiusInterior
	else
	CheckDistance = SearchRadius
	endif
	;Debug.Trace("NAKED DEFEAT calmquest: SearchRadius: "+Distance)	
	
		
	bool NewSystem = true
				
;if IsNymrasGame() || Sexlab.IsValidActor(a) ;STILL NEEDED? Nymra tests without now....
if NewSystem
;GENERAL SORTING:

	;ENEMY FACTION CHEC 

	;attempt to sort out actors that are temporary (summoned etc.)
	if a.IsCommandedActor()
	Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> IsCommandedACtor")
	return false
	endif

	if IsDragon(a)
	Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> IsDragon")
	return false
	endif
	
		;checks if Creature is from Mod Demonic Creatures and always allows them (for now)
	if ModDEM 
	bool AllowDemCreature = false 
		if  a.HasKeyword(DemonicCreature)
		Debug.Trace("NAKED DEFEAT configquest: #Demonic Creature Name: "+a.GetActorBase().GetName()+" Racekey: "+HasRaceKey)
		AllowDemCreature = true 
	
			if (aName == "Mushroom") || (aName == "Red Squirrel")
			AllowDemCreature = false
			endif
			return AllowDemCreature
		endif
	endif
		
	;if ModDEM 
	;	Debug.Notification("NAKED DEFEAT: Demonic Creatures Installed")
	;	if a.HasKeyword(DemonicCreature)
	;	Debug.Notification("NAKED DEFEAT: Demonic Creature Found B: "+HasRaceKey)
	;	Debug.Trace("NAKED DEFEAT configquest: #Demonic Creature Found Racekey: "+HasRaceKey)
	;	Debug.Trace("NAKED DEFEAT configquest: #Demonic Creature Found Name: "+a.GetActorBase().GetName())
	;	return true
	;	endif
	;endif
	
	
	
	;IS A HITTER, ALWAYS ALLOWED (except dragons and commanded actors for now)
;	if a.IsInFaction(EnemyFaction)
	;Debug.Trace("NAKED DEFEAT configquest: IsCommandedActor: "+a.GetBaseObject().GetName())
;	Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") YES -> EnemyFaction")
;	return true
;	endif
		
	;THIS DOES NOT WORK - THEY ARE ALREADY CALMED!!!!
	;/
	if NewSystem
;	if IsNymrasGame() ;CHECK THIS BEFORE DISTANCE NOW. MOVE AFTER DISTANCE CHECK LATER 
		if calmqst.RapersA[0] 
			if (a.GetFactionReaction(calmqst.RapersA[0]) > 1) 
		;	NymMessage("Is Ally/Friend")
			NymTrace("Is Ally/Friend")
			return true 
			else
			NymTrace("Is NOT Ally/Friend")
			return false 
			endif 
		endif 
		if calmqst.CreaturesA[0]
			if (a.GetFactionReaction(calmqst.CreaturesA[0]) > 1) 
			NymTrace("Is Ally/Friend")
			return true 
			else
			return false
			NymTrace("Is NOT Ally/Friend")
			endif 	
		endif 	
	endif 
	/;

	if TempDistance > CheckDistance
	Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> Too Far Way ("+CheckDistance+") < ("+a.GetDistance(PlayerRef))
	return false
	endif
	

	
	;SORT OUT FEMALES IF NOT ALLOWED 	--- BETTER IN CALMQUEST
;	if (SexLab.GetGender(a) == 1) && !FemalesAllowed 
;	Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> IsFemale")
;	return false
;	endif 
		
	;ACHERON ACTOR SORTING <---- REMOVE !!! 
	;if IsAcheronBridge 
	;	if a.IsInFaction(AcheronEnemyFaction) || a.IsInFaction(AcheronEnemyFaction)
;		Debug.Trace("NAKED DEFEAT configquest: AcheronActor: "+a.GetBaseObject().GetName())
;		return true
;		else
;		return false
;		endif
;	endif
	
	;HUMANS
	if Type == 1 
				
		;NEW SYSTEM. EnemyFaction always allowed? At least for Humans? 
		if a.IsInFaction(EnemyFaction)		
				if IsBeastRace(a) && !AllowArgonKajit
				Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> Argonian/Kajjit not allowed 1")
				return false
				elseif CivilRapeRunning && IsGuard(a)
				Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> IsGuard")
				return false
				elseif IsFollower(a)
				Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> IsFollower")
				return false
				else
				Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") YES -> EnemyFaction")
				return true
				endif
		endif 
		
		;HUMANS - GENERAL SORTING: 
		;sort out the stupid invisible "dummy" actors used by certain mods
		if (a.GetBaseObject().GetName() == "FEC : Load Screen Detector")
		Debug.Trace("NAKED DEFEAT configquest: #ERROR, is FEC : Load Screen Detector")
		return false
		endif

		;sort out guards. in public punishment they are sorted elsewhere and in defeat they should technically not show up since its stopped before this point
		if CivilRapeRunning && IsGuard(a) 
		Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> IsGuard: "+a.GetBaseObject().GetName())	;IS THIS STILL GOOD? 
		return false
		endif
		
		;sort out slaves
		if a.IsInFaction(zbfSlaveFaction)
		Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> IsInFaction(zbfSlaveFaction)")
		return false
		endif
		
		;sort out creatures that are not registered correctly (wrong gender 0 instead of 2)
		if HasRaceKey
		Debug.Notification("NAKED DEFEAT: #ERROR Actor invalid (ask for support): has HasRaceKey: "+HasRaceKey)
		Debug.Trace("NAKED DEFEAT configquest:AllowActor("+aName+") #ERROR Actor invalid (ask for support): has HasRaceKey: "+HasRaceKey)
		return false
		endif

		;rules out Followers (not allowed as rapers) -> solve special scenarios differently -> follower rapes PC and vice versa #todo
		;if (FollowerCount > 0) && IsFollower(a)
		if IsFollower(a)
		Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> IsFollower")
		return false
		endif
		
		;DEFEAT TYPE RELATED SORTING: 	
		
		if (DefeatTypeGeneral == "AreHumans") || DefeatType == ("Humans") || DefeatType == ("Funny") || DefeatType == ("Guards")
		Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") Human Actor allowed (Humans or Funny)")
		;	if HasRaceKey == ("Humans")		
				;check for argonians & kajiits and sort out if necessary
				if IsBeastRace(a) && !AllowArgonKajit
				Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> Argonian/Kajjit not allowed")
				return false
				else
				Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") YES -> IsHuman")
				return true
				endif
				
				
		elseif DefeatType == ("Undead")
		;Debug.Trace("NAKED DEFEAT configquest: Human Actor allowed (Undead)")
		;	if HasRaceKey == ("Humans")		;need to check for vampire/necromancer, how? #todo
				;check for argonians & kajiits and sort out if necessary
			if IsVampire(a) || IsNecromancer(a)		
				if IsBeastRace(a) && !AllowArgonKajit
				Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> Argonian/Kajjit not allowed")
				return false
				else
				Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") YES -> IsNecromancer/Vampire")
				return true
				endif
			else
			Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> Undead but no Vampire or Necromancer") ;IMPROVE???
			return false
			endif
		else
			Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> whatever, just no?")
			return false
		endif

	;CREATURES
	elseif Type == 2
	
		if Nym() && !HasRaceKey
		Debug.Messagebox("NO RACEKEY")
		Debug.Trace("NAKED DEFEAT configquest: #ERROR NO RACEKEYNO RACEKEYNO RACEKEYNO RACEKEY ::::::::::::::::::::::::::::::::::::::: ")
		endif 

		;if creatures is spawned by Naked Defeat always return FALSE (we control these actors elsewhere)
		if a.IsInFaction(NakedGhostFaction)
		return false
		endif
		
				; --- SORT OUT FORBIDDEN ACTORS --- ; 
		if HasRaceKey && IsForbiddenActor(HasRaceKey)
		Debug.Trace("NAKED DEFEAT configquest: Forbidden Actor Type: "+HasRaceKey)
		return false 
		endif 

		;checks if Creature is from Mod Demonic Creatures and always allows them (for now)
		if ModDEM && a.GetActorBase().HasKeyword(DemonicCreature)
		Debug.Notification("NAKED DEFEAT: Demonic Creature Found A: "+HasRaceKey)
		Debug.Trace("NAKED DEFEAT configquest: #Demonic Creature Found Racekey: "+HasRaceKey)
		Debug.Trace("NAKED DEFEAT configquest: #Demonic Creature Found Name: "+a.GetActorBase().GetName())
		return true
		endif
		
		if ModDEM 
		;	Debug.Notification("NAKED DEFEAT: Demonic Creatures Installed")
			if a.HasKeyword(DemonicCreature)
			Debug.Notification("NAKED DEFEAT: Demonic Creature Found B: "+HasRaceKey)
			Debug.Trace("NAKED DEFEAT configquest: #Demonic Creature Found Racekey: "+HasRaceKey)
			Debug.Trace("NAKED DEFEAT configquest: #Demonic Creature Found Name: "+a.GetActorBase().GetName())
			return true
			endif
		endif
	
		;NEW SYSTEM. EnemyFaction always allowed?  Forbidden Actors already sorted out.
		if a.IsInFaction(EnemyFaction)
		return true 
		endif 
	
		;HUMAN creatures
		if DefeatType == ("Humans") || (DefeatTypeGeneral == "AreHumans")
		;the enemies are human, but they might have creature support, so we check here if that is the case. 
			if CheckEnemiesFor(HasRaceKey)		;<<<--- we check if there are any other types logged in and can skip further checks
			return true		;i.e.: if a Dog Fights with Humans it is allowed (if not forbidden earlier) 
			else
			return false
			endif
			;/
			if ((HasRaceKey == ("Dogs")) || (HasRaceKey == ("Canines"))) && AllowCanines 
			return true
			elseif HasRaceKey == ("Gargoyles") && AllowHumanoidBeasts
			return true
			elseif HasRaceKey == ("Draugr") && AllowUndead
			return true
			elseif HasRaceKey == ("WispMothers") && AllowElementalsFemale
			return true
			elseif HasRaceKey == ("Wisps") && AllowElementalsMale
			return true
			elseif HasRaceKey == ("VampireLords") && AllowUndead
			return true
			elseif HasRaceKey == ("DragonPriests") && AllowUndead
			return true
			elseif HasRaceKey == ("Horses") && AllowHorses
			return true
			elseif HasRaceKey == ("Goats") && AllowGoats
			return true
			elseif HasRaceKey == ("Skeevers") && AllowSkeevers
			return true
			elseif HasRaceKey == ("Cows") && AllowCows
			return true
			elseif HasRaceKey == ("StormAtronach") && AllowElementalsMale
			return true
			elseif HasRaceKey == ("FrostAtronach")	&& AllowElementalsMale
			return true
			elseif HasRaceKey == ("FlameAtronach")	&& AllowElementalsFemale
			return true
			elseif HasRaceKey == ("Humans")		
			return false ;what??! 
			elseif HasRaceKey == ("Netches") && AllowTentacleStuff
			return true
			elseif HasRaceKey == ("Seekers") && AllowTentacleStuff
			return true
		
			
			elseif HasRaceKey == ("Trolls") && AllowHumanoidBeasts	
			
				if (a.GetBaseObject().GetName() == "Armored Troll") || (a.GetBaseObject().GetName() == "Armored Frost Troll") || (a.GetBaseObject().GetName() == "Tame Troll") || (a.GetBaseObject().GetName() == "Tame Frost Troll")
				return true
				else
				return false
				endif
				
			else
			return false
			endif
			
			/;
			
		elseif DefeatType == ("Guards") 
			;Guards are picky, they only have guard animals (dogs, trolls) 
			
			if ((HasRaceKey == ("Dogs")) || (HasRaceKey == ("Canines"))) && AllowCanines 
			return true
			elseif HasRaceKey == ("Humans")		
			return false
			elseif HasRaceKey == ("Trolls") && AllowHumanoidBeasts
			return true
			 
			;&& AllowHumanoidBeasts	
			
			;	if (a.GetBaseObject().GetName() == "Armored Troll") || (a.GetBaseObject().GetName() == "Armored Frost Troll") || (a.GetBaseObject().GetName() == "Tame Troll") || (a.GetBaseObject().GetName() == "Tame Frost Troll")
			;	return true
			;	else
			;	return false
			;	endif
			else
			return false
			endif

		;HELL Creatures (Afterlife)
		;NO LONGER REQUIRED. WE CHECK THE ACTORS ON SPAWN IF ALLOWED 			
		;/		
		elseif DefeatType == ("Hell")
			if HasRaceKey == ("Trolls") && AllowHumanoidBeasts
			return true
			elseif HasRaceKey == ("Werewolves") && AllowHumanoidBeasts
			return true
			elseif HasRaceKey == ("Werewolves") && AllowHumanoidBeasts
			return true
			elseif HasRaceKey == ("StormAtronach") && AllowElementalsMale
			return true
			elseif HasRaceKey == ("FrostAtronach")	&& AllowElementalsMale
			return true
			elseif HasRaceKey == ("FlameAtronach")	&& AllowElementalsFemale
			return true
			elseif HasRaceKey == ("Wisps") && AllowElementalsMale
			return true
			elseif HasRaceKey == ("VampireLords") && AllowUndead
			return true
			elseif HasRaceKey == ("DragonPriests") && AllowUndead
			return true
			elseif HasRaceKey == ("Gargoyles") && AllowHumanoidBeasts
			return true	
			elseif HasRaceKey == ("Netches") && AllowTentacleStuff
			return true
			elseif HasRaceKey == ("Seekers") && AllowTentacleStuff
			return true	
			elseif HasRaceKey == ("Werewolves") && AllowHumanoidBeasts
			return true		
			elseif HasRaceKey == ("Draugrs") && AllowUndead	;skelettons?
			return true
			elseif HasRaceKey == ("Humans")		;ghosts?
			return true	
			
			else
			return false
			endif	
		/; 
		;TROLLS
		elseif DefeatType == ("Trolls")
		;trolls might have supprt 
			if HasRaceKey == ("Trolls") && AllowHumanoidBeasts
			return true
			;elseif CheckEnemiesFor(HasRaceKey)		;<<<--- we check if there are any other types logged in and can skip further checks
			;return true
			else
			return false
			endif
				
		;DOGS			
		elseif DefeatType == ("Dogs") || DefeatType == ("Canines")
		
			if HasRaceKey == ("Dogs") && AllowCanines
			return true
			elseif HasRaceKey == ("Werewolves") && AllowHumanoidBeasts
			return true
			elseif HasRaceKey == ("Canines") && AllowCanines
			return true
			else
			return false
			endif
			
		;WOLVES			
		elseif DefeatType == ("Wolves") || DefeatType == ("Canines")

			if HasRaceKey == ("Wolves") && AllowCanines
			return true
			elseif HasRaceKey == ("Werewolves") && AllowHumanoidBeasts
			return true
			elseif HasRaceKey == ("Canines") && AllowCanines
			return true
			else
			return false
			endif	
			
		;UNDEAD				
		elseif DefeatType == ("Undead")
			;add vampires and necromancers somehow?
			if HasRaceKey == ("Draugrs") && AllowUndead
			return true	
			elseif CheckEnemiesFor(HasRaceKey)
			return true
			endif 
			
		;FALMERS
		elseif DefeatType == ("Falmers")

			if HasRaceKey == ("Falmers") && AllowFalmers
			return true
			elseif HasRaceKey == ("Chaurus")&& AllowInsects
			return true
			elseif HasRaceKey == ("ChaurusHunters") && AllowInsects
			return true
			elseif HasRaceKey == ("ChaurusReapers") && AllowInsects
			return true
			elseif HasRaceKey == ("Chaurus") && AllowInsects
			return true
			elseif HasRaceKey == ("Netches") && AllowTentacleStuff
			return true
			elseif HasRaceKey == ("BoarsAny") && AllowTentacleStuff
			return true
			elseif CheckEnemiesFor(HasRaceKey)
			return true
			else
			return false
			endif
			
		;CHAURUS
		elseif DefeatType == ("Chaurus")

		;	if HasRaceKey == ("Falmers") && AllowFalmers
		;	return true
			if HasRaceKey == ("Chaurus") && AllowInsects
			return true
			elseif HasRaceKey == ("ChaurusHunters") && AllowInsects
			return true
			elseif HasRaceKey == ("ChaurusReapers") && AllowInsects
			return true
			elseif HasRaceKey == ("Chaurus") && AllowInsects
			return true
			elseif HasRaceKey == ("Netches") && AllowTentacleStuff
			return true
			elseif HasRaceKey == ("Seekers") && AllowTentacleStuff
			return true
			elseif HasRaceKey == ("Spiders") && AllowSpiders
			return true
			else
			return false
			endif		
		
		;SKEEVERS
		elseif DefeatType == ("Skeevers")

			if HasRaceKey == ("Skeevers") && AllowSkeevers
			return true
			else
			return false
			endif

		;SPIDERS
		elseif DefeatType == ("Spiders")

			if HasRaceKey == ("Spiders") && AllowSpiders
			return true
			elseif HasRaceKey == ("LargeSpiders") && AllowSpiders
			return true
			elseif HasRaceKey == ("GiantSpiders") && AllowSpiders
			return true
			else
			return false
			endif	
		
		;SABRECATS		
		elseif DefeatType == ("SabreCats")

			if HasRaceKey == ("SabreCats") && AllowSabrecats
			return true
			else
			return false
			endif
			
		;BEARS			
		elseif DefeatType == ("Bears")
			
			if HasRaceKey == ("Bears") && AllowBears
			return true
			else
			return false
			endif
			
		;GIANTS		
		elseif DefeatType == ("Giants")

			if HasRaceKey == ("Giants") && AllowHumanoidBeasts
			return true
			elseif HasRaceKey == ("Mammoths") && AllowMammoths
			return true
			else
			return false
			endif
			
		;LURKERS		
		elseif DefeatType == ("Lurkers")

			if HasRaceKey == ("Lurkers") && AllowHumanoidBeasts
			return true
			else
			return false
			endif
		
		;DWARVEN
		elseif DefeatType == ("Dwemer")

			if HasRaceKey == ("DwarvenBallistas") && AllowDwarven
			return true
			elseif HasRaceKey == ("DwarvenCenturions") && AllowDwarven
			return true
			elseif HasRaceKey == ("DwarvenSpheres") && AllowDwarven
			return true
			elseif HasRaceKey == ("DwarvenSpiders") && AllowDwarven
			return true
			elseif CheckEnemiesFor(HasRaceKey)
			return true
			else
			return false
			endif
		
		;RIEKLINGS  	 
		elseif DefeatType == ("Rieklings")

			if HasRaceKey == ("Rieklings") && AllowRieklings
			return true
			elseif HasRaceKey == ("Boars") && AllowRieklings
			return true
			elseif HasRaceKey == ("BoarsAny") && AllowRieklings
			return true
			elseif HasRaceKey == ("BoarsMounted") && AllowRieklings
			return true
			elseif HasRaceKey == ("Skeevers") && AllowSkeevers
			return true
			elseif CheckEnemiesFor(HasRaceKey)
			return true
			else
			return false
			endif
			
		;WEREWOLVES
		elseif DefeatType == ("Werewolves")

			if HasRaceKey == ("Werewolves") && AllowHumanoidBeasts
			return true
			elseif HasRaceKey == ("Canines") && AllowCanines
			return true
			elseif HasRaceKey == ("Wolves") && AllowCanines
			return true
			else
			return false
			endif	
			
		;SPRIGGANS
		elseif DefeatType == ("Spriggans")

			if HasRaceKey == ("Spriggans") && AllowSpriggans
			return true
			elseif HasRaceKey == ("Canines") && AllowCanines
			return true
			elseif HasRaceKey == ("Wolves") && AllowCanines
			return true
			elseif HasRaceKey == ("Deers") && AllowDeers
			return true
			elseif HasRaceKey == ("Foxes") && AllowFoxes
			return true
			elseif HasRaceKey == ("Rabbits") && AllowRabbits
			return true
			elseif HasRaceKey == ("Bears") && AllowBears
			return true
			elseif HasRaceKey == ("Sabrecats") && AllowSabrecats
			return true
			elseif CheckEnemiesFor(HasRaceKey)
			return true
			else
			return false
			endif	
			
		;GHOSTS
		elseif DefeatType == ("Ghosts")

			if CheckEnemiesFor(HasRaceKey)
			return true
			else
			return false
			endif	
			
		;ANIMALS (fallback) --- WIP --- requires change of actor selection in ESP first
	;	elseif (DefeatType == "funny") && (DefeatTypeGeneral == "AreAnimals")
		
		
		
	;		if CheckEnemiesFor(HasRaceKey)
	;		return true
	;		else
	;		return false
	;		endif 

			;if !note
			;note = true
			;Debug.Notification("#NOTE: No last Attacker identified: All the creaturs fuck you now!")
	;		Debug.trace("NAKED DEFEAT configquest: #NOTE: FUNNY, only animals!")
			;endif
	;	return true

		elseif (DefeatType == "funny") 
		Debug.trace("NAKED DEFEAT configquest: #NOTE: FUNNY Everything is allowed")
		;	if CheckEnemiesFor(HasRaceKey)
		return true
		;	else
		;	return false
		;	endif 
		;	if !note
		;	note = true
			;Debug.Notification("#NOTE: No last Attacker identified: You are fucked by everybody!")
			
		;	endif
		;return true
		
		else
		;	Debug.Notification("#ERROR: No DefeatType!")
			Debug.trace("NAKED DEFEAT configquest: #ERROR: No DefeatType!")
		return false
		endif
	else
	Debug.Trace("NAKED DEFEAT configquest: AllowActor("+aName+") NO -> #ERROR, No Type!")	
	return false	
	endif
else
Debug.trace("NAKED DEFEAT configquest: Not Valid Sexlab Actor")
return false
endif	
		;#TODO ASHHOPPERS DEFEAT?

;else ;CreaturesNotAllowed
;return false 	
;endif	
EndFunction

Function StartDefeat()				;#StartDefeat()
	
	Debug.trace ("NAKED DEFEAT configquest: StartDefeat()")
	bool WasRagdolling = false
	
	while Ragdolling		;#ragdoll
	WasRagdolling = true
	Debug.trace ("NAKED DEFEAT configquest: RAGDOLLING")
	Utility.Wait(1.0)
	endwhile
	
	if WasRagdolling
	Utility.Wait(4.0)
	endif 
	
	while Ragdolling		;#ragdoll
	WasRagdolling = true
	Debug.trace ("NAKED DEFEAT configquest: RAGDOLLING")
	Utility.Wait(1.0)
	endwhile

	if HealthBoost
	;	If IsNymrasGame()
	;	Debug.Messagebox("HealthBoost +100.000")
	;	endif
	PlayerRef.ModActorValue("health", 100000.0)
	endIf
	
	SendModEvent("Moan")
	
	;if DefeatViaSurrender

;	Debug.SetGodMode(true)
	
	int End = 5
	while (End > 0) && PlayerRef.IsWeaponDrawn() 
	PlayerRef.SheatheWeapon() 
	Utility.Wait(1.0)
	End -= 1
	endWhile
	
	;Utility.Wait(1.0)
	;>>>>>>>>>>>>>>>>>> First Surrender Pose >>>>>>>>>>>>>>>>>>
	;CENTRALIZE ALL in PLAYER POSING??? sigh
	
	NymTrace("Immobilize(true) for StartDefeat()")
	Immobilize(true)

	
	
	if IsDDScenario()
	;do nothing here
	else
		if DefeatViaSlavery
		;PlayerRef.PlayIdle(IdlesDefeatUnbound[Utility.RandomInt(10,11)])			;idles change direction... must not happen so we only use these 2
		calmqst.PlayPoseOnActor(PlayerRef, "Unbound", false)
	
		else	
		PlayerRef.PlayIdle(IdlesHumanSurrender[4])	;whats this pose?
		;PlayerPosing("Surrender", false)
		endif
	Utility.Wait(2.0)
	endif	
	;Game.DisablePlayerControls(1, 1, 0, 0, 1, 1, 1, 1, 1)
	;Game.SetPlayerAIDriven(true)
		
	;Utility.Wait(2.0)

	if FollowerCount > 0
	folidle01.StartFollowerIdleQuest_01("none")
	folidle01.StartDoingNothing_01(true)
		if FollowerCount > 1
		folidle01.StartDoingNothing_02(true)
		endif
		if FollowerCount > 2	
		folidle01.StartDoingNothing_03(true)
		endif
		if FollowerCount > 3
		folidle01.StartDoingNothing_04(true)
		endif						
	endif

	SendModEvents(true)

	;>>>>>>>>>>>>>>>>>> DAR compatibility >>>>>>>>>>>>>>>>>>
	if !PlayerRef.IsInFaction(nade_DefeatFaction)
	PlayerRef.AddToFaction(nade_DefeatFaction)
	endif
	;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
	
	SendModEvent("Moan")							
;	Debug.SetGodMode(false)
;	if GodMode
;	Debug.SetGodMode(true)
;	;Debug.trace ("NAKED DEFEAT Surrender: Godmode TRUE")
;	endif
	
	;if (CalmQuest.GetStage() == 1000) || (CalmQuest.GetStage() == 0)
	CalmQuest.Start()
	;else
	;Debug.Trace("NAKED DEFEAT #ERROR 14214. Calmquest already running")
	;endif
	
	
	
EndFunction

bool Property AlreadyImmobilized Auto

Function Immobilize(Bool disable = true)				; #immobilize
	
	;DISABLE CONTROLS
	if disable
	AlreadyImmobilized = true	
		;if IsNymrasGame() && IsImmobilized && Game.IsMovementControlsEnabled()
		;Debug.MessageBox("#ERROR cfgqst: IS Immobilized but PC can move!")
		;endif
		
		;ToggleFreeCamera()
		Debug.trace ("NAKED DEFEAT configquest: Immobilize(true)")
									
		if LagFix
		;"Activate" not disable	;  1  2  3  4  5  6  7  8  9
		Game.DisablePlayerControls(1, 1, 0, 0, 1, 1, 0, 1, 1)
		else					;  1  2  3  4  5  6  7  8  9
		Game.DisablePlayerControls(1, 1, 0, 0, 1, 1, 1, 1, 1)
		endif	


		Game.SetPlayerAIDriven(true)	
		
		
	;	enableplayercontrols [movement] [combat] [first person] [looking] [sneaking] [menu] [activate] [journal tabs] [perspective type]

	;	1	Movement			Optional. 1 to enable movement, 0 to disable.
	;	2	Combat				Optional. 1 to enable combat, 0 to disable.
	;	3	First Person		Optional. 1 to enable first person perspective, 0 to disable.
	;	4	Looking				Optional. 1 to enable looking, 0 to disable.
	;	5	Sneaking			Optional. 1 to enable sneaking, 0 to disable.
	;	6	Menu				Optional. 1 to enable the menu, 0 to disable.
	;	7	Activate			Optional. 1 to enable activate, 0 to disable.
	;	8	Journal Tabs		Optional. 1 to enable journal tabs, 0 to disable.
	;	9	Perspective Type	Optional. Either 0 or 1 - your desired POV type.
		
		
	;ENABLE CONTROLS
	else
		if IsNymrasGame() && AlreadyImmobilized && Game.IsMovementControlsEnabled()
		Debug.MessageBox("#ERROR cfgqst: WAS Immobilized but PC can move!")
		endif
	
		AlreadyImmobilized = false
		;ToggleFreeCamera()
		Debug.trace ("NAKED DEFEAT configquest: Immobilize(false)")
		PlayerRef.PlayIdle(IdlesFixHair[0])  ;RESET IDLE
		Game.EnablePlayerControls()
		Game.SetPlayerAIDriven(false)
	endif
EndFunction

Function ImmobilizeCrawl(Bool disable = true)				; #immobilize
	
	if disable
		;ToggleFreeCamera()
		Debug.trace ("NAKED DEFEAT configquest: ImmobilizeCrawl(true)")
									;  1  2  3  4  5  6  7  8  9							
		;Game.DisablePlayerControls(1, 1, 0, 0, 1, 1, 1, 1, 1) ;ORIG
		; ;LAG TEST (activate enabled)
		 ;ORIGINAL CRAWL AWAY
		;Game.SetPlayerAIDriven(true)
		Game.SetPlayerAIDriven(false)
		
		if LagFix
		;"Activate" not disabled;  1  2  3  4  5  6  7  8  9
		Game.DisablePlayerControls(0, 1, 0, 0, 1, 1, 0, 1, 0)
		else					;  1  2  3  4  5  6  7  8  9
		Game.DisablePlayerControls(0, 1, 0, 0, 1, 1, 1, 1, 0)
		endif
	else
		;ToggleFreeCamera()
		Debug.trace ("NAKED DEFEAT configquest: ImmobilizeCrawl(false)")
		PlayerRef.PlayIdle(IdlesFixHair[0])
		Game.EnablePlayerControls()
		Game.SetPlayerAIDriven(false)
	endif
EndFunction


function ToggleFreeCamera()
	if Game.GetCameraState() == 3
	MiscUtil.ToggleFreeCamera()
	endif

;	if Game.GetCameraState() != 3
;		MiscUtil.SetFreeCameraSpeed(5.0)
;	endIf
	
endFunction


;------------------------------------------------------------------------------------------

			;/enableplayercontrols [movement] [combat] [first person] [looking] [sneaking] [menu] [activate] [journal tabs] [perspective type]

			1	Movement			Optional. 1 to enable movement, 0 to disable.
			2	Combat				Optional. 1 to enable combat, 0 to disable.
			3	First Person		Optional. 1 to enable first person perspective, 0 to disable.
			4	Looking				Optional. 1 to enable looking, 0 to disable.
			5	Sneaking			Optional. 1 to enable sneaking, 0 to disable.
			6	Menu				Optional. 1 to enable the menu, 0 to disable.
			7	Activate			Optional. 1 to enable activate, 0 to disable.
			8	Journal Tabs		Optional. 1 to enable journal tabs, 0 to disable.
			9	Perspective Type	Optional. Either 0 or 1 - your desired POV type.

			/;


;-------------------------------------------------------------------------------------------------

bool Function FollowersInCombat(int iDistance)		;#combatscan #PartyInCombat()

if folqst.IsFollowerPresent()
	if folqst.IsWithUs_Follower(0) && folqst.NakedFollower[0].IsInCombat() && folqst.NakedFollower[0].GetDistance(PlayerRef) < iDistance
	NymTrace("FollowersInCombat(Follower[0] in Combat)")
	return true
	elseif folqst.IsWithUs_Follower(1) && folqst.NakedFollower[1].IsInCombat() && folqst.NakedFollower[1].GetDistance(PlayerRef) < iDistance
	return true	
	elseif folqst.IsWithUs_Follower(2) && folqst.NakedFollower[2].IsInCombat() && folqst.NakedFollower[2].GetDistance(PlayerRef) < iDistance
	return true
	elseif folqst.IsWithUs_Follower(3) && folqst.NakedFollower[3].IsInCombat() && folqst.NakedFollower[3].GetDistance(PlayerRef) < iDistance
	return true
	elseif folqst.IsWithUs_Follower(4) && folqst.NakedFollower[4].IsInCombat() && folqst.NakedFollower[4].GetDistance(PlayerRef) < iDistance
	return true	
	else
	NymTrace("FollowersInCombat(NO Follower in Combat)")
	return false
	endif
endif
EndFunction

Function DisableCollisionOnActor(actor akActor, bool bDisable)
;TOO MUCH FOR NOW; PLAY WITH THIS LATER  ---> Maybe Set Vehicle earlier and more flexible 

	;disable Collision
;	if bDisable
;		if !SPE_actor.IsActorFrozen(akActor)
;		SPE_actor.SetActorFrozen(akActor, true)
;		endif 
		
	;enable Collision
;	else 
;		if SPE_actor.IsActorFrozen(akActor)
;		SPE_actor.SetActorFrozen(akActor, false)
;		endif 
;	endif 

EndFunction

bool Function PartyInCombat()		;#combatscan #PartyInCombat()

if folqst.IsFollowerPresent()
	if PlayerRef.IsInCombat() ;|| folqst.PartyInCombatDuringDefeat()
	return true
	elseif folqst.IsWithUs_Follower(0) && folqst.NakedFollower[0].IsInCombat()
	return true
	elseif folqst.IsWithUs_Follower(1) && folqst.NakedFollower[1].IsInCombat()
	return true	
	elseif folqst.IsWithUs_Follower(2) && folqst.NakedFollower[2].IsInCombat()
	return true
	elseif folqst.IsWithUs_Follower(3) && folqst.NakedFollower[3].IsInCombat()
	return true
	elseif folqst.IsWithUs_Follower(4) && folqst.NakedFollower[4].IsInCombat()
	return true	
	else
	return false
	endif
else
	if PlayerRef.IsInCombat() 
	return true
	else
	return false
	endif
endif
EndFunction

;-------------------------------------------------------------------------------------------------

;------------- pchs immersive plugs soft dependency -------------------------------------------------

int BrutalPlugs = 0

Armor BrutalPlug_1 = none
Armor BrutalPlug_2 = none
Armor BrutalPlug_3 = none
Armor BrutalPlug_4 = none
Armor BrutalPlug_5 = none
Armor BrutalPlug_6 = none

Function AddBrutalPlugs(string type = "none")	;#plugs

Debug.Trace("NAKED DEFEAT configquest: AddBrutalPlugs()")
	
	if (Game.GetModByName("pchsImmersivePlugs.esp") != 255)

	int x	
	
		if type == "random"
		x = Utility.RandomInt (1, 5)
		elseif type == "carrot"
		x = 1
		elseif type == "soulgem"
		x = 2
		elseif type == "mead"
		x = 3
		endif
		
		if x == 1
		;CARROT
		BrutalPlug_1 = (Game.GetFormFromFile(0x00000D63, "pchsImmersivePlugs.esp") As Armor)		
		PlayerRef.AddItem(BrutalPlug_1, 1, true)					
		PlayerRef.EquipItem(BrutalPlug_1, false, true)
		SendModEvent("Moan")	
		BrutalPlugs = 1
		
		;COMMON SOULGEM
		elseif x == 2
		BrutalPlug_2 = (Game.GetFormFromFile(0x000048DD, "pchsImmersivePlugs.esp") As Armor)
		PlayerRef.AddItem(BrutalPlug_2, 1, true)					
		PlayerRef.EquipItem(BrutalPlug_2, false, true)
		SendModEvent("Moan")	
		BrutalPlugs = 2
		
		;MEAD
		elseif x == 3
		BrutalPlug_3 = (Game.GetFormFromFile(0x000012D0, "pchsImmersivePlugs.esp") As Armor)
		PlayerRef.AddItem(BrutalPlug_3, 1, true)				
		PlayerRef.EquipItem(BrutalPlug_3, false, true)
		SendModEvent("Moan")	
		BrutalPlugs = 3
		
		;HOOK
		elseif x == 4
		BrutalPlug_4 = (Game.GetFormFromFile(0x0000183E, "pchsImmersivePlugs.esp") As Armor)
		PlayerRef.AddItem(BrutalPlug_4, 1, true)				
		PlayerRef.EquipItem(BrutalPlug_4, false, true)
		SendModEvent("Moan")	
		BrutalPlugs = 4
		
		;BONE
		elseif x == 5
		BrutalPlug_5 = (Game.GetFormFromFile(0x00002315, "pchsImmersivePlugs.esp") As Armor)
		PlayerRef.AddItem(BrutalPlug_5, 1, true)				
		PlayerRef.EquipItem(BrutalPlug_5, false, true)
		SendModEvent("Moan")	
		BrutalPlugs = 5
		
		;BUCKET (NOT USED ATM)
		elseif x == 6
		BrutalPlug_6 = (Game.GetFormFromFile(0x00004374, "pchsImmersivePlugs.esp") As Armor)
		PlayerRef.AddItem(BrutalPlug_6, 1, true)				
		PlayerRef.EquipItem(BrutalPlug_6, false, true)
		SendModEvent("Moan")	
		BrutalPlugs = 6
		
		endif
	endif
		
EndFunction

Function RemoveBrutalPlugs()

Debug.Trace("NAKED DEFEAT configquest: RemoveBrutalPlugs()")
	
	if BrutalPlugs == 1
	PlayerRef.RemoveItem(BrutalPlug_1, 1, true, None)
	elseif BrutalPlugs == 2
	PlayerRef.RemoveItem(BrutalPlug_2, 1, true, None)
	elseif BrutalPlugs == 3
	PlayerRef.RemoveItem(BrutalPlug_3, 1, true, None)
	elseif BrutalPlugs == 4
	PlayerRef.RemoveItem(BrutalPlug_4, 1, true, None)
	elseif BrutalPlugs == 5
	PlayerRef.RemoveItem(BrutalPlug_5, 1, true, None)
	elseif BrutalPlugs == 6
	PlayerRef.RemoveItem(BrutalPlug_6, 1, true, None)
	endif
	
	BrutalPlugs = 0
	
EndFunction


;>>>>>>>>>>>>>>>>>>>>>>> FNIS REPLACE IDLE >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;
;bool IsCrawling = false

;Bool Function IsPlayerCrawling()
; if IsCrawling
 ;return true
 ;else
; return false
; endif
;EndFunction

;float CurrentSpeed
;float SpeedReduction
;float CrawlSpeed = 25.0


;/SAVE Speed
		
		CurrentSpeed = PlayerRef.GetActorValue("SpeedMult")
			SpeedReduction = (CurrentSpeed - CrawlSpeed)
			
			if ShowDebugMessages
			Debug.Trace("NAKED DEFEAT configquest: CurrentSpeed NORMAL Start: "+CurrentSpeed)
			Debug.Trace("NAKED DEFEAT configquest: SpeedReduction: "+SpeedReduction)
			endif
				
			if CurrentSpeed > 25.0	
			PlayerRef.ModActorValue("SpeedMult", -SpeedReduction)
			Utility.Wait(1.0)
			PlayerRef.ModActorValue("CarryWeight",0.1)
			Utility.Wait(1.0)
			PlayerRef.ModActorValue("CarryWeight",-0.1)		
			endif
			
						
			if ShowDebugMessages
			Debug.Trace("NAKED DEFEAT configquest: CurrentSpeedCRAWL: "+PlayerRef.GetActorValue("SpeedMult"))
			endif




		If (akactor == PlayerRef)
		PlayerRef.ModActorValue("SpeedMult", SpeedReduction)
		Utility.Wait(1.0)
		PlayerRef.ModActorValue("CarryWeight",0.1)
		Utility.Wait(1.0)
		PlayerRef.ModActorValue("CarryWeight",-0.1)
		endif

		if ShowDebugMessages
		Debug.Trace("NAKED DEFEAT configquest: CurrentSpeed NORMAL end: "+CurrentSpeed)
		endif
		
/;

;Float PlayerCarryWeightTemp = 0.0


Function SpeedMultMaintenance()	;#tidy MOVE TO CALMQUEST

	if Nym()
		Float MyPlayerSpeedMultCurrent = 0.0
		Float MyPlayerSpeedMultDebuff = 0.0	
		MyPlayerSpeedMultCurrent = PlayerRef.GetActorValue("SpeedMult")
		if MyPlayerSpeedMultCurrent < 40
		MyPlayerSpeedMultDebuff = 40 - MyPlayerSpeedMultCurrent
		PlayerRef.ModAV("SpeedMult", MyPlayerSpeedMultDebuff)
		PlayerRef.ModActorValue("CarryWeight", 2.0)
		PlayerRef.ModActorValue("CarryWeight", -2.0)
		endif 
	endif 
	
	
	
EndFunction


;FORCE KEYPRESS does not work

;/

	int iAlwaysRunToggle = Input.GetMappedKey("Toggle Always Run", 0xFF) 
		NymMessage("iAlwaysRunToggle: "+iAlwaysRunToggle)
		;int iWalkToggle = Input.GetMappedKey("Run", 0xFF) 
		
		Debug.Trace("NAKED DEFEAT configquest(Toggle Always Run Key: "+iAlwaysRunToggle)
		if sAction == "SlowDown"
		
		Input.TapKey(iAlwaysRunToggle)	
			
		elseif sAction == "Reset" 
		
		PlayerRef.RemoveItem(ArmorEmpty[2], 1, true, None)
		Input.TapKey(iAlwaysRunToggle)

/; 



Function SetSpeedMultTo(Float SetSpeedMult) 	;we want 100 	
			
		if !Nym()	;this should not happen outside of my game anymore
		Debug.Trace("Naked Defeat configquest: #WARNING, this should not trigger - SetSpeedMultTo: "+SetSpeedMult)
		endif 
		Float PlayerSpeedMultCurrent = 0.0
		;Float PlayerSpeedMultDEBUFF = 0.0
		PlayerSpeedMultCurrent = PlayerRef.GetActorValue("SpeedMult")
	
		PlayerSpeedMultBEFORE = PlayerSpeedMultCurrent
	
		if PlayerSpeedMultCurrent > SetSpeedMult		;current is 120 					
		PlayerSpeedMultDEBUFF = SetSpeedMult - PlayerSpeedMultCurrent  	; -20 = 100 - 120
		PlayerRef.ModAV("SpeedMult", PlayerSpeedMultDEBUFF)
		elseif PlayerSpeedMultCurrent < SetSpeedMult		;current is 90 						
		PlayerSpeedMultDEBUFF = SetSpeedMult - PlayerSpeedMultCurrent  	; 10 = 100 - 90
		PlayerRef.ModAV("SpeedMult", PlayerSpeedMultDEBUFF)
		endif 
		
		PlayerRef.ModActorValue("CarryWeight", 1.0)
		PlayerRef.ModActorValue("CarryWeight", -1.0)
		
		PlayerSpeedMultCurrent = PlayerRef.GetActorValue("SpeedMult")
		;NymTrace("Speedmult Current: "+PlayerSpeedMultCurrent)
		
EndFunction

;/
Function ResetSpeedMult()
;
		;	PlayerRef.ModAV("SpeedMult", -PlayerSpeedMultDEBUFF)	;if -60, now we add 60
		 float PlayerSpeedMultCurrent = PlayerRef.GetActorValue("SpeedMult") 		 		
			;InfoMessage("Player Speed RESET to: "+PlayerSpeedMultCurrent)
			PlayerRef.ModActorValue("CarryWeight", 2.0)
			PlayerRef.ModActorValue("CarryWeight", -2.0)

			
			
			int TempPlayerSpeedMultBEFORE = PlayerSpeedMultBEFORE as int
		;	int TempPlayerSpeedMultDEBUFF = PlayerSpeedMultDEBUFF as int
			int TempPlayerSpeedMultCurrent = PlayerSpeedMultCurrent as int
			
			PlayerSpeedMultDEBUFF = 0.0			
			
			InfoMessage("Player Starting Speed: "+TempPlayerSpeedMultBEFORE+" // Player Crawl Speed (current): "+TempPlayerSpeedMultCurrent+" // Debuff total: "+TempPlayerSpeedMultDEBUFF)
			NymMessage("Player Starting Speed: "+TempPlayerSpeedMultBEFORE+" // Player Crawl Speed (current): "+TempPlayerSpeedMultCurrent+" // Debuff total: "+TempPlayerSpeedMultDEBUFF)

EndFunction 
/;


Function PrecisionCollision(actor akActor, bool Enable)

;bool Function ToggleDisableActor(Actor akActor, bool abDisable) global native

;Enable = FALSE --> Disables Collision
;Enable = TRUE --> Enables Collision
if ModPrecision
Precision_Utility.ToggleDisableActor(akActor, Enable)
endif 

EndFunction 


Float Property PlayerSpeedMultBEFORE Auto	;SPEED CHANGE TOTAL FROM NAKED DEFEAT 
Float Property PlayerSpeedMultDEBUFF Auto	;SPEED CHANGE TOTAL FROM NAKED DEFEAT 	
	
MiscObject Property SlowDownItem Auto
	
Function SlowDownPlayer(String sAction)	;#tidy MOVE TO CALMQUEST  ;#SlowDownPlayer

	;Spell TestSpell

	NymTrace("SlowDownPlayer: "+sAction)		
;	Float PlayerSpeedMultBase = 0.0
;	Float PlayerSpeedMultCurrent = 0.0
	;Float PlayerSpeedMultDebuff = 0.0	;we want to give back the same Speed that we took
	
;	int TempPlayerSpeedMultBEFORE 
;	int TempPlayerSpeedMultDEBUFF 
;	int TempPlayerSpeedMultCurrent 
	
	;bool NewSlowDownSystem = true
	
	;if NewSlowDownSystem
	

	
		if sAction == "Start"

		;	if Nym()
		;	TestSpell = (Game.GetFormFromFile(0x00000804, "HeelsFix.esp") As Spell)
		;	TestSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)
		;	endif 
			if PlayerRef.IsOverEncumbered() || nade_DDInt.IsWearingDDs(PlayerRef, "Forced Walk")
			;do nothing, we are already too slow
			else
			PlayerRef.AddItem(SlowDownItem, 1, true)			;HANDS	
			endif 
			
			if folqst.IsWithUs_Follower(0)
			folqst.NakedFollower[0].AddItem(SlowDownItem, 1, true)			;HANDS	
			endif 
		
			if folqst.IsWithUs_Follower(1)
			folqst.NakedFollower[1].AddItem(SlowDownItem, 1, true)			;HANDS	
			endif 
			
		;PlayerRef.EquipItem(ArmorEmpty[2], false, true)
		
		elseif sAction == "End"  
		
		PlayerRef.RemoveItem(SlowDownItem, 1, true, None)
		
			if folqst.IsWithUs_Follower(0)
			folqst.NakedFollower[0].RemoveItem(SlowDownItem, 1, true, None)			;HANDS	
			endif 
		
			if folqst.IsWithUs_Follower(1)
			folqst.NakedFollower[1].RemoveItem(SlowDownItem, 1, true, None)			;HANDS	
			endif 
		
		endif 
		
	;/	
	else
	
		;SlowDown
	
			
			 
			PlayerSpeedMultCurrent = PlayerRef.GetActorValue("SpeedMult")
			PlayerSpeedMultBEFORE = PlayerSpeedMultCurrent
			TempPlayerSpeedMultBEFORE = PlayerSpeedMultBEFORE as int ;save Starting Speed
			
			;Debug.Trace("NAKED DEFEAT configquest: Player Speed BEFORE Defeat:"+PlayerSpeedMultBEFORE)
			
				if PlayerSpeedMultCurrent >= 40		;Startingspeed: 100
				PlayerSpeedMultDEBUFF = 40 - PlayerSpeedMultCurrent	;debuff = -60 (slow down)
			
				PlayerRef.ModAV("SpeedMult", PlayerSpeedMultDEBUFF)	;100 + - 60 = 40	
				PlayerRef.ModActorValue("CarryWeight", 2.0)
				PlayerRef.ModActorValue("CarryWeight", -2.0)
				elseif PlayerSpeedMultCurrent < 40		;Startingspeed: 20
				PlayerSpeedMultDEBUFF = 40 - PlayerSpeedMultCurrent	;debuff = 20 (speed up)
			
				PlayerRef.ModAV("SpeedMult", PlayerSpeedMultDEBUFF)	;20 + 20 = 40	
				PlayerRef.ModActorValue("CarryWeight", 2.0)
				PlayerRef.ModActorValue("CarryWeight", -2.0)
				endif 
			
			;CRAWLING SPEED final
			PlayerSpeedMultCurrent = PlayerRef.GetActorValue("SpeedMult")	
			;InfoMessage("Player Speed Slowed down to: "+PlayerSpeedMultCurrent)	
			
			;save INTs for INFO 						
			TempPlayerSpeedMultBEFORE = PlayerSpeedMultBEFORE as int
			TempPlayerSpeedMultDEBUFF = PlayerSpeedMultDEBUFF as int
			TempPlayerSpeedMultCurrent = PlayerSpeedMultCurrent as int
				
			
			InfoMessage("Player Starting Speed: "+TempPlayerSpeedMultBEFORE+" // Player Crawl Speed (current): "+TempPlayerSpeedMultCurrent+" // Debuff total: "+TempPlayerSpeedMultDEBUFF)
			NymMessage("Player Starting Speed: "+TempPlayerSpeedMultBEFORE+" // Player Crawl Speed (current): "+TempPlayerSpeedMultCurrent+" // Debuff total: "+TempPlayerSpeedMultDEBUFF)
			Debug.Trace("NAKED DEFEAT configquest (#SPEED (slow down): Player Starting Speed: "+TempPlayerSpeedMultBEFORE+" // Player Crawl Speed (current): "+TempPlayerSpeedMultCurrent+" // Debuff total: "+TempPlayerSpeedMultDEBUFF)
		;	endif 
		
		;Reset 	
		elseif sAction == "Reset" 
		NymTrace("SlowDownPlayer: "+sAction)
		;	if Nym()
		;	PlayerRef.EquipItem(ArmorEmpty[2], false, true)
		;	PlayerRef.RemoveItem(ArmorEmpty[2], 1, true, None)
		;	PlayerRef.ModActorValue("CarryWeight", 2.0)
		;	PlayerRef.ModActorValue("CarryWeight", -2.0)
		;	else 							
				;Add Debuff back 							
				PlayerRef.ModAV("SpeedMult", -PlayerSpeedMultDEBUFF)	;if -60, now we add 60
				PlayerSpeedMultCurrent = PlayerRef.GetActorValue("SpeedMult")				
				;InfoMessage("Player Speed RESET to: "+PlayerSpeedMultCurrent)
				PlayerRef.ModActorValue("CarryWeight", 2.0)
				PlayerRef.ModActorValue("CarryWeight", -2.0)
				

				
				PlayerSpeedMultDEBUFF = 0.0
				
							;save INTs for INFO 						
				TempPlayerSpeedMultBEFORE = PlayerSpeedMultBEFORE as int
				TempPlayerSpeedMultDEBUFF = PlayerSpeedMultDEBUFF as int
				TempPlayerSpeedMultCurrent = PlayerSpeedMultCurrent as int
				
				if (TempPlayerSpeedMultBEFORE > TempPlayerSpeedMultCurrent) || (TempPlayerSpeedMultBEFORE < TempPlayerSpeedMultCurrent)
				NymMessage("#ERROR - Speedmult different")			
				endif 
				
				InfoMessage("Player Current Speed: "+TempPlayerSpeedMultCurrent+" // Player Starting Speed (before): "+TempPlayerSpeedMultBEFORE+" // Debuff total: "+TempPlayerSpeedMultDEBUFF)
				NymMessage("Player Current Speed: "+TempPlayerSpeedMultCurrent+" // Player Starting Speed (before): "+TempPlayerSpeedMultBEFORE+" // Debuff total: "+TempPlayerSpeedMultDEBUFF)
				Debug.Trace("NAKED DEFEAT configquest (#SPEED (speed up): Player Current Speed: "+TempPlayerSpeedMultCurrent+" // Player Starting Speed (before): "+TempPlayerSpeedMultBEFORE+" // Debuff total: "+TempPlayerSpeedMultDEBUFF)
				
		;	endif 
		
		
		endif 
		
	endif 
	
	/;
	
EndFunction


Function Crawl(Actor akactor, bool start)			;#crawl

Debug.Trace("NAKED DEFEAT configquest: Crawl(ON)")
	
	;if Nym() && IsCrawling
	;IsCrawling = false
;	Debug.messagebox("Fuck it was this") 
	;endif 


	;CRAWL START
	if start ;&& !IsDDScenario()
	
	Debug.Trace("NAKED DEFEAT configquest: Crawl(ON) Start")
	;	string modname="NakedDefeat"
	
		akactor.AddToFaction(CrawlFaction)
		if PlayerRef.IsInFaction(DownedFaction)
		PlayerRef.RemoveFromFaction(DownedFaction)
		endif 

		If (akactor == PlayerRef)
		
		;SlowDownPlayer("SlowDown")
	;	Immobilize(false)
	;	ImmobilizeCrawl(true)

		EndIf
	;	IsCrawling = true
	
	;CRAWL END
	else			
	Debug.Trace("NAKED DEFEAT configquest: Crawl(OFF)")
	
		;SlowDownPlayer("Reset")
	;	ImmobilizeCrawl(false)
		akactor.RemoveFromFaction(CrawlFaction)
	;	IsCrawling = false	
	endif
	
EndFunction

bool NakedCurseActive = false

	
Function StripPlayer()
				;slot 53 (arm cuffs) slot 59 (leg cuffs) are NOT to be stripped --> SexlabNoStrip Keyword should solve this
				;slot 52 (fuck belt) also dont use
				Strip(37, PlayerRef)	;boots
				Strip(33, PlayerRef)	;gauntlets
				Strip(32, PlayerRef)	;body 
				
				Strip(57, PlayerRef) 	;pauldron
				Strip(53, PlayerRef)	;steel thigh armor	-> dont use (why not?)	--> SexlabNoStrip Keyword should solve this
				Strip(35, PlayerRef)	;amulett
				Strip(42, PlayerRef)	;circlet	
				Strip(46, PlayerRef)	;harness
				Strip(52, PlayerRef)	;bikini bottom	-> dont use (why not?) --> SexlabNoStrip Keyword should solve this
EndFunction

;>>>>>>>>>>>>>>>>>>>>>>>> CURSES >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

;NAKED CURSE
Function NakedCurse(bool activate)	;#curse1 #naked
	
	;applied in LootScript when drinking health potions (5% chance)
	;removed in "CheckDuration" when trying to dress. Not perfect but... well... improve PlayerMonitor please...
	
	if activate
	StripPlayer()
	;ScreenMessage("Your potion was cursed! You are forced be naked (for its duration)!")
	NakedCurseActive = true
	elseif NakedCurseActive
	ScreenMessage("The nakedness curse has worn off...")
	NakedCurseActive = false
	endif

EndFunction

;CRAWL CURSE (teehee)
;forced to crawl. cannot fight. will auto surrender.
;high public exposure
;only doggy positions
;can be removed by sex

;SURRENDER CURSE 
;chance to surrender in combat without player hotkey (fuck me please!)

;ORGASM CURSE 
;light, will randomly force orgasm, short duration. in combat slows down

;PARASITE CURSE?

;LACTATION CURSE?


;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


;>>>>>>>>>>>>>>>>>>>>>>>> AURAS >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

;CRITICAL DEFEAT AURA

;PROTECT STRIP AURA

;FOOD
;eating foot adds a magic effect that increases carryweight.
;can stack? 

;SlEEP 
;when slept for 6 hours you get a 12 hour bonus (small 5-10% protection from almost anything?)

;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


;--------------- initial stuff:

;/
int	Property mtbase auto	;=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._mt(),	modname,true)
int	Property mtxbase auto		;=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._mtx(),	modname,true)
int	Property mtidlebase auto	;=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._mtidle(),modname,true)
int	Property mtturnbase	auto;=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._mtturn(),modname,true)
	
int	Property sneakbase auto	;=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._sneakidle(),modname,true)
int	Property sneakmtbase auto	;=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._sneakmt(),modname,true)
int	Property h2hattackbase auto;=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._h2hatk(),modname,true)
int	Property h2hPowerAttackbase auto;=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._h2hatkpow(),modname,true)

int	Property _1hm_idle_Base auto; = FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._1hmidle(),modname,true)
int	Property _1hmatk_Base auto ;= FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._1hmatk(),modname,true)
int	Property _1hmmt_Base auto; = FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._1hmmt(),modname,true)

int Property FNIS_CRC auto


Function FNISstuff()
	
	Debug.Trace("NAKED DEFEAT configquest: FNISstuff()")
	int oldcrc = FNIS_CRC
	FNIS_CRC = FNIS_aa.GetInstallationCRC()

	if oldcrc == FNIS_CRC
		return
	endif

	;Trace("oninit update animation id")
	;nade
	;int fnismodid=FNIS_aa.GetAAModID("daf",modname,true)
	int fnismodid=FNIS_aa.GetAAModID("daf",modname,true)
	
	;string modname=dafsex.ModName()
	string modname="NakedDefeat"
	
	mtbase		=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._mt(),	modname,true)
	mtxbase		=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._mtx(),	modname,true)
	mtidlebase	=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._mtidle(),modname,true)
	mtturnbase	=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._mtturn(),modname,true)
	
	sneakbase	=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._sneakidle(),modname,true)
	sneakmtbase	=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._sneakmt(),modname,true)
	h2hattackbase=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._h2hatk(),modname,true)
	h2hPowerAttackbase=	FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._h2hatkpow(),modname,true)

	_1hm_idle_Base = FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._1hmidle(),modname,true)
	_1hmatk_Base = FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._1hmatk(),modname,true)
	_1hmmt_Base = FNIS_aa.GetGroupBaseValue(fnismodid,FNIS_aa._1hmmt(),modname,true)
	
EndFunction


/;


Function StartCrawlonActor(Actor akactor, Bool Start)			;#crawl		 ;OLD REMOVE
	Debug.Trace("NAKED DEFEAT configquest: StartCrawlonActor")	
			
			
	if !NoCrawling		
	string modname ="NakedDefeat"
	
		
		if Start
		akactor.AddToFaction(CrawlFaction)
;/			
			FNIS_aa.SetAnimGroup(akactor, "_mt",		mtbase , 0, modname,true)
			FNIS_aa.SetAnimGroup(akactor, "_mtx",		mtxbase , 0, modname,true)
			FNIS_aa.SetAnimGroup(akactor, "_mtidle",	mtidlebase , 0, modname,true)
			FNIS_aa.SetAnimGroup(akactor, "_mtturn",	mtturnbase, 0, modname,true)
			FNIS_aa.SetAnimGroup(akactor, "_1hmatk",	_1hmatk_Base, 0, modname,true)
			FNIS_aa.SetAnimGroup(akactor, "_1hmmt",	_1hmmt_Base, 0, modname,true)
			Debug.Trace("NAKED DEFEAT configquest: Crawl(ON) after FNIS")	
			

			akactor.SetActorValue("SpeedMult", 50)
/;
		
		else
		akactor.RemoveFromFaction(CrawlFaction)
				;/				
			string mn="NakedDefeat"

			FNIS_aa.SetAnimGroup(akactor, "_mt", 0, 0, mn,true)
			FNIS_aa.SetAnimGroup(akactor, "_mtx", 0, 0, mn,true)
			FNIS_aa.SetAnimGroup(akactor, "_mtidle", 0, 0, mn,true)
			FNIS_aa.SetAnimGroup(akactor, "_mtturn", 0, 0, mn,true)
			
			FNIS_aa.SetAnimGroup(akactor, "_1hmatk",	0, 0, mn,true)
			FNIS_aa.SetAnimGroup(akactor, "_1hmmt",	0, 0, mn,true)

			FNIS_aa.SetAnimGroup(akactor, "_h2hatkpow",	0, 0, mn,true)
			Debug.Trace("NAKED DEFEAT configquest: Crawl(OFF) after FNIS")

			akactor.SetActorValue("SpeedMult", 100)
			/;
		endif
	endif
	
EndFunction

;--------------------------------------------------------------------------------------


;UNEQUIP WEAPON -----------------------------------------------------------------



Function StripWeapons()	;#weapon

    ; Drop right or left hand at random, if using 2H, it will be dropped.
 ;   Int hand = 0
 ;   If Utility.RandomInt(0, 16383) < 8096
  ;      hand = 1


    
		DropHand(0, True)
		DropHand(1, False)
    ; This allows time for the 1H/2H magic swap to occur, then unequips again, if it has
    ; Made this fire repeatedly for three seconds, because sometimes the stealth re-equip is slow, but I also want the unequip responsive, not delayed for ages.
 ;   Utility.Wait(1.0)
 ;   DropHand(0, False)

  ;  Utility.Wait(1.0)
   ; DropHand(1, False)

    ;Utility.Wait(1.0)
    
    
EndFunction

bool Property UnequipWeaponsOnly Auto

Function UnequipWeapons()	;#weapon

    ; Drop right or left hand at random, if using 2H, it will be dropped.
 ;   Int hand = 0
 ;   If Utility.RandomInt(0, 16383) < 8096
  ;      hand = 1

    UnequipWeaponsOnly = true
	
    DropHand(0, True)
	DropHand(1, False)
	
	UnequipWeaponsOnly = false
    ; This allows time for the 1H/2H magic swap to occur, then unequips again, if it has
    ; Made this fire repeatedly for three seconds, because sometimes the stealth re-equip is slow, but I also want the unequip responsive, not delayed for ages.
 ;   Utility.Wait(1.0)
 ;   DropHand(0, False)

  ;  Utility.Wait(1.0)
   ; DropHand(1, False)

    ;Utility.Wait(1.0)
    
    
EndFunction

; Returns False if you shouldn't call this on the other hand, because a 2H was dropped.
Function DropHand(Int hand, Bool allowRealDrop)

    ; Returns true if you might need to drop the other hand.
    Bool dropAgain = True
    Int handType = PlayerRef.GetEquippedItemType(hand)
    If handType
        If 9 == handType ; Spell
            UnequipSpell(hand)
        ElseIf 10 == handType ; Shield
            DropOrUnequipShield()
        ElseIf (handType >= 5 && handType < 9) || 12 == handType ; 2H
            DropOrUnequip2H()
            dropAgain = False
        Else ; 1H
            DropOrUnequip1H(hand)
        EndIf
    EndIf
    
 ;   Return dropAgain
    
EndFunction

;--------------------------------------------------------------------------------------

Function UnequipSpell(Int hand)

    Spell equippedSpell = PlayerRef.GetEquippedSpell(hand)
    If equippedSpell
        PlayerRef.UnequipSpell(equippedSpell, hand)
        ShowDebugNotification("You lose focus on your " + equippedSpell.GetName() + " spell")
    EndIf
    
EndFunction

;--------------------------------------------------------------------------------------




; TODO - UnequipItem can destroy charges if game doesn't have the fix for it? Test this.
Function DropOrUnequipShield()


	int StripBehavior = StripOptions

    Armor equippedShield = PlayerRef.GetEquippedShield()
	
	if equippedShield.GetEnchantment() && Strip_EnchantedWeapons_VALUE < 4
	StripBehavior = Strip_EnchantedWeapons_VALUE
	endif 

    If equippedShield

		if UnequipWeaponsOnly || StripOptions == 0			;unequip
		;PlayerRef.UnequipItem(equippedShield, abPreventEquip = False, abSilent = True)
		PlayerRef.UnequipItem(equippedShield, false, true)							;NYMRA unequip not remove
		elseif StripOptions == 1		;drop
		PlayerRef.DropObject(equippedShield, 1)
		elseif StripOptions == 2		;destroy
		PlayerRef.RemoveItem(equippedShield, 1)
		endif
            
        ;EndIf
       
	    ShowDebugNotification("You lose grip on your shield")
    endif
    
EndFunction

;--------------------------------------------------------------------------------------

Function DropOrUnequip1H(Int hand)


	int StripBehavior = StripOptions

    Weapon equipped = PlayerRef.GetEquippedWeapon(0 == hand) ; true = left hand
	
	if equipped.GetEnchantment() && Strip_EnchantedWeapons_VALUE < 4
	StripBehavior = Strip_EnchantedWeapons_VALUE
	endif 

    If equipped

		if UnequipWeaponsOnly || StripOptions == 0			;unequip
		;PlayerRef.UnequipItem(equippedShield, abPreventEquip = False, abSilent = True)
		PlayerRef.UnequipItem(equipped, false, true)								;NYMRA unequip not remove
		elseif StripOptions == 1		;drop
		PlayerRef.DropObject(equipped, 1)
		elseif StripOptions == 2		;destroy
		PlayerRef.RemoveItem(equipped, 1)
		endif

        ShowDebugNotification("You let go of your weapon...")
    EndIf 
    
EndFunction

;--------------------------------------------------------------------------------------

Function DropOrUnequip2H()

	int StripBehavior = StripOptions

    Weapon equipped = PlayerRef.GetEquippedWeapon()
	
	if equipped.GetEnchantment() && Strip_EnchantedWeapons_VALUE < 4
	StripBehavior = Strip_EnchantedWeapons_VALUE
	endif 
	
    If equipped

		if UnequipWeaponsOnly || StripOptions == 0			;unequip
		;PlayerRef.UnequipItem(equippedShield, abPreventEquip = False, abSilent = True)
		PlayerRef.UnequipItem(equipped, false, true)								;NYMRA unequip not remove
		elseif StripOptions == 1		;drop
		PlayerRef.DropObject(equipped, 1)
		elseif StripOptions == 2		;destroy
		PlayerRef.RemoveItem(equipped, 1)
		endif
	
        ShowDebugNotification("Your weapon slips out of your hands")
    EndIf 
    
EndFunction

;--------------------------------------------------------------------------------------

Int[] intFormID
String[] stringFileName

;------------------------------------------------------------------------


Function SaveWeapon(string number, int WeaponType)		;#Weapon #SaveWeapon2()
;Saves Weapons to interal Formlist for internal use (Check saved Weapons for FORMs of equiped items (armor in this case)

	Debug.Trace("Naked Defeat configquest: SaveWeapon(START) - number: "+number+" WeaponType: "+WeaponType)
	
	
	
	Formlist akFormlist
	String akString
	if number == "01"
	akFormlist = Weapon_JSON_FList[1]
	elseif number == "02"
	akFormlist = Weapon_JSON_FList[2]
	elseif number == "03"
	akFormlist = Weapon_JSON_FList[3]
	elseif number == "04"
	akFormlist = Weapon_JSON_FList[4]
	elseif number == "05"
	akFormlist = Weapon_JSON_FList[5]
	elseif number == "06"
	akFormlist = Weapon_JSON_FList[6]
	elseif number == "07"
	akFormlist = Weapon_JSON_FList[7]
	elseif number == "08"
	akFormlist = Weapon_JSON_FList[8]
	elseif number == "09"
	akFormlist = Weapon_JSON_FList[9]
	elseif number == "10"
	akFormlist = Weapon_JSON_FList[10]
	endif	
	
	akFormlist.Revert()
	Debug.Trace("Naked Defeat configquest: SaveWeapon() akFormlist.GetSize(): "+akFormlist.GetSize())
	
	if WeaponType == 3 ;Shield)
	akFormlist.AddForm(PlayerRef.GetEquippedShield())
	Debug.Trace("Naked Defeat configquest: SaveWeapon(SHIELD) - number: "+number)
	elseif WeaponType == 2 ;Left Hand
	akFormlist.AddForm(PlayerRef.GetEquippedWeapon(true))
	Debug.Trace("Naked Defeat configquest: SaveWeapon(LEFT HAND) - number: "+number)
	Debug.Trace("Naked Defeat configquest: SaveWeapon PlayerRef.GetEquippedWeapon(true))1: "+PlayerRef.GetEquippedWeapon(true).GetName())
	;Debug.Trace("Naked Defeat configquest: SaveWeapon PlayerRef.GetEquippedWeapon(true))2: "+PlayerRef.GetEquippedWeapon(true).GetBaseObject().GetName())
	elseif WeaponType == 1 ;Right Hand
	akFormlist.AddForm(PlayerRef.GetEquippedWeapon(false))
	Debug.Trace("Naked Defeat configquest: SaveWeapon PlayerRef.GetEquippedWeapon(false))1: "+PlayerRef.GetEquippedWeapon(false).GetName())
	;Debug.Trace("Naked Defeat configquest: SaveWeapon PlayerRef.GetEquippedWeapon(false))2: "+PlayerRef.GetEquippedWeapon(false).GetBaseObject().GetName())
	Debug.Trace("Naked Defeat configquest: SaveWeapon(RIGHT HAND) - number: "+number)
	endif
		
	Debug.Trace("Naked Defeat configquest: SaveWeapon() akFormlist.GetSize(): "+akFormlist.GetSize())


EndFunction



;REMOVE THESE (OLD and not longer needed)
String Outfit_01_Type = "empty"
String Outfit_02_Type = "empty"
String Outfit_03_Type = "empty"
String Outfit_04_Type = "empty"
String Outfit_05_Type = "empty"

String PunishmentOutfit_01_Type = "empty"
String PunishmentOutfit_02_Type = "empty"
String PunishmentOutfit_03_Type = "empty"
String PunishmentOutfit_04_Type = "empty"
String PunishmentOutfit_05_Type = "empty"


Function SaveOutfit(string number)		;#outfit #SaveOutFit()	#FORMLIST
;Saves Outfits to interal Formlist for internal use (Check saved outfits for FORMs of equiped items (armor in this case)

	Debug.Trace("Naked Defeat configquest: SaveOutfit(START) - number: "+number)
	
	Formlist akFormlist
	String akString
	if number == "01"
	akFormlist = Outfit_JSON_FList[1]
	elseif number == "02"
	akFormlist = Outfit_JSON_FList[2]
	elseif number == "03"
	akFormlist = Outfit_JSON_FList[3]
	elseif number == "04"
	akFormlist = Outfit_JSON_FList[4]
	elseif number == "05"
	akFormlist = Outfit_JSON_FList[5]
	elseif number == "06"
	akFormlist = Outfit_JSON_FList[6]
	elseif number == "07"
	akFormlist = Outfit_JSON_FList[7]
	elseif number == "08"
	akFormlist = Outfit_JSON_FList[8]
	elseif number == "09"
	akFormlist = Outfit_JSON_FList[9]
	elseif number == "10"
	akFormlist = Outfit_JSON_FList[10]
	
	elseif number == "Follower Outfit 01"
	NymMessage("OutFit 01 Saving")
	akFormlist = Outfit_01	

	elseif number == "Follower Outfit 02"
	akFormlist = Outfit_02	
	
	
	elseif number == "Follower Outfit 03"
	akFormlist = Outfit_03
	
	
	elseif number == "Follower Outfit 04"
	akFormlist = Outfit_04
	
	
	elseif number == "Follower Outfit 05"
	akFormlist = Outfit_05	
	
		
	
	endif
	
	;/
	elseif number == 11
	DebugMessage("Outfit 11 selected")
	akFormlist = PunishmentOutfit_01	
		
		if PunishmentOutfit_01
		DebugMessage("Outfit 11 found")
		else
		DebugMessage("Outfit 11 NOT found")
		endif
		
	elseif number == 12
	akFormlist = PunishmentOutfit_02	
	elseif number == 13
	akFormlist = PunishmentOutfit_03	
	elseif number == 14
	akFormlist = PunishmentOutfit_04
	elseif number == 15
	akFormlist = PunishmentOutfit_05		
	endif
	/;
	
	akFormlist.Revert()
;	akFormlist.AddForm(PlayerRef.GetEquippedWeapon(false))		;WEAPONS ARE STORED ELSEWHERE!!
;	akFormlist.AddForm(PlayerRef.GetEquippedWeapon(true))
	;GetEquippedShield() ???
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000001)) 	;30 - head
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000002)) 	;31 - hair/HELMET
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000004))	;32 - BODY
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000008))	;33 - HANDS
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000010))	;34 - Forearms
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000020))	;35 - Amulet 	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000040))	;36 - Ring 			
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000080))	;37 - FEET
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000100))	;38 - Calves
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000200))	;39 - SHIELD
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000400))	;40 - TAIL
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00000800))	;41 - Long Hair
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00001000))	;42 - Circlet
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00002000))	;43 - Ears 	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00004000))	;44 - Unnamed 		(DD Gag/Mouth, SexlabTongue)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00008000))	;45 - Unnamed 		(DD Collars)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00010000))	;46 - Unnamed 		(DD Armbinder/Yoke, Cloaks)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00020000))	;47 - Unnamed 		(DD -, Backpacks, Wings)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00040000))	;48 - Unnamed 		(DD plugs anal, Backpack left pouch)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00080000))	;49 - Unnamed 		(DD Body harness/Chastity belt)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00100000))	;50 - Decap. Head	(DD Piercings Vaginal, bracelets)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00200000))	;51 - Decapitate
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00400000))	;52 - Unnamed
	akFormlist.AddForm(PlayerRef.GetWornForm(0x00800000))	;53 - Unnamed	(DD Cuffs Legs)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x01000000))	;54 - Unnamed	(DD Plugs vaginal)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x02000000))	;55 - Unnamed	(DD Blindfold)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x04000000))	;56 - Unnamed	(DD Chastity Bra)		
	akFormlist.AddForm(PlayerRef.GetWornForm(0x08000000))	;57 - Unnamed	(DD Vaginal Plugs)	
	akFormlist.AddForm(PlayerRef.GetWornForm(0x10000000))	;58 - Unnamed	(DD Body Harness/Corset
	akFormlist.AddForm(PlayerRef.GetWornForm(0x20000000))	;59 - Unnamed	(DD Cuffs Arms)
	akFormlist.AddForm(PlayerRef.GetWornForm(0x40000000))	;60 - Unnamed
	akFormlist.AddForm(PlayerRef.GetWornForm(0x80000000))	;61 - Unnamed


	NymMessage("akFormlist Lenght: "+akFormlist.GetSize())
	;NO LONGER REQUIRED
	;/
	;determines the OutfitType based on the bodyslot item	 		
	Form a = PlayerRef.GetWornForm(0x00000004) 
	
	;GET NAME INSTEAD?
	if (a as armor).IsLightArmor()
	akString = "Light Armor"
	elseif (a as armor).IsHeavyArmor()
	akString = "Heavy Armor"
	elseif (a as armor).IsClothing()
	akString = "Clothing"
	else 
	akString = "Naked"
	endif
	
	if 	akFormlist.GetSize() == 0
	akString = "empty"
	Debug.MessageBox("Saving Outfit FAILED - no items found.")
	else
	Debug.MessageBox("Saved Outfit: "+number+" Type: "+akString)
	endif

	if number == 1
	Outfit_01_Type = akString
	elseif number == 2
	Outfit_02_Type = akString
	elseif number == 3
	Outfit_03_Type = akString
	elseif number == 4
	Outfit_04_Type = akString
	elseif number == 5
	Outfit_05_Type = akString
	
	
	
	elseif number == 11
	PunishmentOutfit_01_Type = akString
	elseif number == 12
	PunishmentOutfit_02_Type = akString
	elseif number == 13
	PunishmentOutfit_03_Type = akString
	elseif number == 14
	PunishmentOutfit_04_Type = akString
	elseif number == 15
	PunishmentOutfit_05_Type = akString
	endif
	/;
	
EndFunction

;------------------------------------------------------------------------------------------------------------------------------------------ ;#outfits




;/
Function LoadOutfitCheat(int number)	;NO LONGER IN USE
Debug.Trace("Naked Defeat configquest: LoadOutfitCheat()")

		Formlist akFormlist

		if number == 1
		akFormlist = Outfit_01
		elseif number == 2
		akFormlist = Outfit_02
		elseif number == 3
		akFormlist = Outfit_03
		elseif number == 4
		akFormlist = Outfit_04
		elseif number == 5
		akFormlist = Outfit_05
		endif

		ScreenMessage("You magically equipped your saved Outfit: "+number)
	
		;int OutfitSize = (akFormlist.GetSize())
	
		EquipOutfitAnimated(number, true) 
		
		;while OutfitSize > 0 
		;OutfitSize -= 1	
		;PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
		;PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
		;endwhile		

EndFunction

/;

Function LoadOutfitPunishment(int number)
Debug.Trace("Naked Defeat configquest: LoadOutfitPunishment()")

		Formlist akFormlist

		if number == 1
		akFormlist = PunishmentOutfit_01
		elseif number == 2
		akFormlist = PunishmentOutfit_02
		elseif number == 3
		akFormlist = PunishmentOutfit_03
		elseif number == 4
		akFormlist = PunishmentOutfit_04
		elseif number == 5
		akFormlist = PunishmentOutfit_05
		endif

		int OutfitSize = (akFormlist.GetSize())
		
		if OutfitSize > 0
		ScreenMessage("They force some kinky stuff on you (punishment outfit No: "+number)
		endIf
		
		while OutfitSize > 0 
		OutfitSize -= 1	
		PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
		PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
		endwhile		

EndFunction

Bool Function Check_JSON_Outfits(Form akBaseObject)
;checks if the Formlist (which is created parallely when saving an Outfit to a JSON file) has the equiped item. 
;if the item is not found, will return false and the item cannot be equiped. if TRUE the item is allowed to equip.
	
	if Outfit_JSON_FList[1].HasForm(akBaseObject) 
	return true
	elseif Outfit_JSON_FList[2].HasForm(akBaseObject) 
	return true
	elseif Outfit_JSON_FList[3].HasForm(akBaseObject) 
	return true
	elseif Outfit_JSON_FList[4].HasForm(akBaseObject) 
	return true
	elseif Outfit_JSON_FList[5].HasForm(akBaseObject) 
	return true
	elseif Outfit_JSON_FList[6].HasForm(akBaseObject) 
	return true
	elseif Outfit_JSON_FList[7].HasForm(akBaseObject) 
	return true
	elseif Outfit_JSON_FList[8].HasForm(akBaseObject) 
	return true
	elseif Outfit_JSON_FList[9].HasForm(akBaseObject) 
	return true
	elseif Outfit_JSON_FList[10].HasForm(akBaseObject) 
	return true
	else
	return false
	endIf
	
EndFunction


Bool Function Check_JSON_Weapons(Form akBaseObject)
;checks if the Formlist (which is created parallely when saving an Outfit to a JSON file) has the equiped item. 
;if the item is not found, will return false and the item cannot be equiped. if TRUE the item is allowed to equip.
	
	if Weapon_JSON_FList[1].HasForm(akBaseObject) 
	return true
	elseif Weapon_JSON_FList[2].HasForm(akBaseObject) 
	return true
	elseif Weapon_JSON_FList[3].HasForm(akBaseObject) 
	return true
	elseif Weapon_JSON_FList[4].HasForm(akBaseObject) 
	return true
	elseif Weapon_JSON_FList[5].HasForm(akBaseObject) 
	return true
	elseif Weapon_JSON_FList[6].HasForm(akBaseObject) 
	return true
	elseif Weapon_JSON_FList[7].HasForm(akBaseObject) 
	return true
	elseif Weapon_JSON_FList[8].HasForm(akBaseObject) 
	return true
	elseif Weapon_JSON_FList[9].HasForm(akBaseObject) 
	return true
	elseif Weapon_JSON_FList[10].HasForm(akBaseObject) 
	return true
	else
	return false
	endIf
	
EndFunction
	
;Bool Function Check_JSON_Outfit(Form akBaseObject)	;#JSON #clara		;DOES NOT WORK

;	akBaseObject
	
	;JSON: bool function IntListHas(Form ObjKey, string KeyName, int value) global native

;	storageutil.IntListHas(akBaseObject, "outfit01",)
;		Json. 
	;get FormY
	;get JSON Form in SlotX
	;compare JSON form with FormY
	

;akBaseObject

; >>>>>>>>>>>>>>>>>>>>> ACHERON SCRIPTS >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> ;#acheron #scrab

Function DisableAcheron()

if VersionSE
	If Game.GetModByName("Acheron.esm") < 255
	  InfoMessage("NAKED DEFEAT: Acheron disabled")
	  ;Acheron.DisableConsequences(true) ; hinder Acheron to start other outcomes while yours is running
	  ; or
	  Acheron.DisableProcessing(true) ; disable Acheron in total - no defeating of actors anymore
	EndIf
endIf
EndFunction

Function EnableAcheron()
if VersionSE
	If Game.GetModByName("Acheron.esm") < 255
		;Acheron.DisableConsequences(false) ; enable Acheron again
		; or
		InfoMessage("NAKED DEFEAT: Acheron enabled")
		Acheron.DisableProcessing(false) ; enable

		Acheron.RescueActor(PlayerRef)
		Acheron.ReleaseActor(PlayerRef) ; needed so you don't soft-lock the player
	EndIf
endif
EndFunction

;WIP
;/
Function Looted_JSON_Outfit(string type, string items)	;#outfit #LoadOutfit #equip		;OLD REMOVE NO LONGER IN USE 
		
	Debug.Trace("Naked Defeat configquest: Looted_JSON_Outfit()")	
	bool test = false	
	int number = 0	

	if outfit_JSON_01_type == type
	
	
	;we get an outfit of the chosen type (light, heavy, clothing) and load it. so if we want to get something from a saved outfit the type has to be one of those three
		if D100(50)
			if Outfit_01_Type == type	
			number = 1
			elseif Outfit_02_Type == type
			number = 2
			elseif Outfit_03_Type == type
			number = 3
			elseif Outfit_04_Type == type
			number = 4
			elseif Outfit_05_Type == type
			number = 5
			else
			ScreenMessage("You have no suitable outfit saved")
			endif
		else	;change direction of check to increase variety of outfits. we still cannot have more than 2 outfits with 1 type tho...
			if Outfit_05_Type == type	
			number = 5	
			elseif Outfit_04_Type == type
			number = 4
			elseif Outfit_03_Type == type
			number = 3
			elseif Outfit_02_Type == type
			number = 2
			elseif Outfit_01_Type == type
			number = 1
			else
			ScreenMessage("You have no suitable outfit saved")
			endif
		endif
		
		Formlist akFormlist
		;String akString
		if number == 1
		akFormlist = Outfit_01
		;akString = Outfit_01_Type
		elseif number == 2
		akFormlist = Outfit_02
		;akString = Outfit_02_Type
		elseif number == 3
		akFormlist = Outfit_03
		;akString = Outfit_03_Type
		elseif number == 4
		akFormlist = Outfit_04
		;akString = Outfit_04_Type
		elseif number == 5
		akFormlist = Outfit_05
		;akString = Outfit_05_Type
		endif
		
		int OutfitSize = (akFormlist.GetSize()) 
		
		if items == "Boots"
		ScreenMessage("You found some new BOOTS like from outfit: "+number)
			bool bootsfound = false
			while (OutfitSize > 0) && !bootsfound
			OutfitSize -= 1	
				if (akFormlist.GetAt(OutfitSize) as armor).IsBoots() || (akFormlist.GetAt(OutfitSize) as armor).IsClothingFeet()
				PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
				PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
				bootsfound = true
				endIf
			endwhile	
			
		elseif items == "Gauntlets"
		ScreenMessage("You found some new GAUNTLETS like from outfit: "+number)
			bool gauntletsfound = false
			while (OutfitSize > 0) && !gauntletsfound
			OutfitSize -= 1	
				if (akFormlist.GetAt(OutfitSize) as armor).IsGauntlets() || (akFormlist.GetAt(OutfitSize) as armor).IsClothingHands()
				PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
				PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
				gauntletsfound = true
				endIf
			endwhile		
			
		elseif items == "Helmet"
		ScreenMessage("You found a new HELMET like from outfit: "+number)
			bool helmetfound = false
			while (OutfitSize > 0) && !helmetfound
			OutfitSize -= 1	
				if (akFormlist.GetAt(OutfitSize) as armor).IsHelmet() || (akFormlist.GetAt(OutfitSize) as armor).IsClothingHead()
				PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
				PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
				helmetfound = true
				endIf
			endwhile		
						
		elseif (items == "All") && !(type == "Clothes")
		
		;PlayerRef.UnequipAll()
		ScreenMessage("You found new equipment, similar to outfit: "+number)
		EquipOutfitAnimated(number, true)
		;ScreenMessage("CLOSE YOUR INVENTORY")
			
		elseif items == "Weapon"
		ScreenMessage("You found a new WEAPON like from outfit: "+number)
			bool weaponfound = false
			while (OutfitSize > 0) && !weaponfound
			OutfitSize -= 1	
				if (akFormlist.GetAt(OutfitSize) as weapon).IsBattleaxe() || (akFormlist.GetAt(OutfitSize) as weapon).IsGreatsword()
				PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
				PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
				weaponfound = true
				endIf
			endwhile			
			
		elseif type == "Clothes"	
				
			if items == "All"
				ScreenMessage("You found new CLOTHES, similar to outfit: "+number)
			;	ScreenMessage("CLOSE YOUR INVENTORY")
				
				
				EquipOutfitAnimated(number, true)
								
			elseif items == "Shoes"
			
				ScreenMessage("You found a new SHOES like from outfit: "+number)
				bool shoesfound = false
				while (OutfitSize > 0) && !shoesfound
				OutfitSize -= 1	
					if (akFormlist.GetAt(OutfitSize) as armor).IsClothingFeet() 
					PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
					PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
					shoesfound = true
					endIf
				endwhile
			elseif items == "Gloves"	
				ScreenMessage("You found a new GLOVES like from outfit: "+number)
				bool glovesfound = false
				while (OutfitSize > 0) && !glovesfound
				OutfitSize -= 1	
					if (akFormlist.GetAt(OutfitSize) as armor).IsClothingHands() 
					PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
					PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
					glovesfound = true
					endIf
				endwhile	
			elseif items == "Circlet"		
				ScreenMessage("You found a new CIRCLET like from outfit: "+number)
				bool circletfound = false
				while (OutfitSize > 0) && !circletfound
				OutfitSize -= 1	
					if (akFormlist.GetAt(OutfitSize) as armor).IsClothingHead() 
					PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
					PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
					circletfound = true
					endIf
				endwhile		
			endif		
		else
		ScreenMessage("#ERROR: Function had no suitable value")
		
		LootScriptRunning = false			
		
		endif
		
		;remove gold 
		;int MaterialPrice
		;if Type == "Heavy Armor"
		;MaterialPrice = 100
		;elseif Type == "Light Armor"
		;MaterialPrice = 50
		;elseif Type == "Clothing"
		;MaterialPrice = 25
		;endif
		
		;when full outfit equiped, additional gold cost & added cooldown
		LootScriptRunning = false
		if items == "All"
		;MaterialPrice*10
		;add cooldown	
		;SpellLootCooldown.RemoteCast(PlayerRef, PlayerRef, PlayerRef)
		endif
		
		;PlayerRef.RemoveItem(Gold001, MaterialPrice, false, none)
	endif
	
	LootScriptRunning = false
			
EndFunction
/;
;OLD????
;/
Function LoadOutfit(string type, string items)	;#outfit #LoadOutfit #equip	
		
	Debug.Trace("Naked Defeat configquest: LoadOutfit()")	
	bool test = false	
	int number = 0	
	;maybe not necessary to add a cooldown timer anyway. just balance via chances and money?
	if test ;PlayerRef.HasMagicEffectWithKeyword(KWDLootCooldownEffect)
	ScreenMessage("You are still exhausted from fitting the last armor set") 
	else
	;we get an outfit of the chosen type (light, heavy, clothing) and load it. so if we want to get something from a saved outfit the type has to be one of those three
		if D100(50)
			if Outfit_01_Type == type	
			number = 1
			elseif Outfit_02_Type == type
			number = 2
			elseif Outfit_03_Type == type
			number = 3
			elseif Outfit_04_Type == type
			number = 4
			elseif Outfit_05_Type == type
			number = 5
			else
			ScreenMessage("You have no suitable outfit saved")
			endif
		else	;change direction of check to increase variety of outfits. we still cannot have more than 2 outfits with 1 type tho...
			if Outfit_05_Type == type	
			number = 5	
			elseif Outfit_04_Type == type
			number = 4
			elseif Outfit_03_Type == type
			number = 3
			elseif Outfit_02_Type == type
			number = 2
			elseif Outfit_01_Type == type
			number = 1
			else
			ScreenMessage("You have no suitable outfit saved")
			endif
		endif
		
		Formlist akFormlist
		;String akString
		if number == 1
		akFormlist = Outfit_01
		;akString = Outfit_01_Type
		elseif number == 2
		akFormlist = Outfit_02
		;akString = Outfit_02_Type
		elseif number == 3
		akFormlist = Outfit_03
		;akString = Outfit_03_Type
		elseif number == 4
		akFormlist = Outfit_04
		;akString = Outfit_04_Type
		elseif number == 5
		akFormlist = Outfit_05
		;akString = Outfit_05_Type
		endif
		
		int OutfitSize = (akFormlist.GetSize()) 
		
		if items == "Boots"
		ScreenMessage("You found some new BOOTS like from outfit: "+number)
			bool bootsfound = false
			while (OutfitSize > 0) && !bootsfound
			OutfitSize -= 1	
				if (akFormlist.GetAt(OutfitSize) as armor).IsBoots() || (akFormlist.GetAt(OutfitSize) as armor).IsClothingFeet()
				PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
				PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
				bootsfound = true
				endIf
			endwhile	
			
		elseif items == "Gauntlets"
		ScreenMessage("You found some new GAUNTLETS like from outfit: "+number)
			bool gauntletsfound = false
			while (OutfitSize > 0) && !gauntletsfound
			OutfitSize -= 1	
				if (akFormlist.GetAt(OutfitSize) as armor).IsGauntlets() || (akFormlist.GetAt(OutfitSize) as armor).IsClothingHands()
				PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
				PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
				gauntletsfound = true
				endIf
			endwhile		
			
		elseif items == "Helmet"
		ScreenMessage("You found a new HELMET like from outfit: "+number)
			bool helmetfound = false
			while (OutfitSize > 0) && !helmetfound
			OutfitSize -= 1	
				if (akFormlist.GetAt(OutfitSize) as armor).IsHelmet() || (akFormlist.GetAt(OutfitSize) as armor).IsClothingHead()
				PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
				PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
				helmetfound = true
				endIf
			endwhile		
						
		elseif (items == "All") && !(type == "Clothes")
		
		;PlayerRef.UnequipAll()
		ScreenMessage("You found new equipment, similar to outfit: "+number)
		EquipOutfitAnimated(number, true)
		;ScreenMessage("CLOSE YOUR INVENTORY")

			
		elseif items == "Weapon"
		ScreenMessage("You found a new WEAPON like from outfit: "+number)
			bool weaponfound = false
			while (OutfitSize > 0) && !weaponfound
			OutfitSize -= 1	
				if (akFormlist.GetAt(OutfitSize) as weapon).IsBattleaxe() || (akFormlist.GetAt(OutfitSize) as weapon).IsGreatsword()
				PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
				PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)

				weaponfound = true
				endIf
			endwhile			
			
		elseif type == "Clothes"	
				
			if items == "All"
				ScreenMessage("You found new CLOTHES, similar to outfit: "+number)
			;	ScreenMessage("CLOSE YOUR INVENTORY")
				
				
				EquipOutfitAnimated(number, true)
				

			elseif items == "Shoes"
			
				ScreenMessage("You found a new SHOES like from outfit: "+number)
				bool shoesfound = false
				while (OutfitSize > 0) && !shoesfound
				OutfitSize -= 1	
					if (akFormlist.GetAt(OutfitSize) as armor).IsClothingFeet() 
					PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
					PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
					shoesfound = true
					endIf
				endwhile
			elseif items == "Gloves"	
				ScreenMessage("You found a new GLOVES like from outfit: "+number)
				bool glovesfound = false
				while (OutfitSize > 0) && !glovesfound
				OutfitSize -= 1	
					if (akFormlist.GetAt(OutfitSize) as armor).IsClothingHands() 
					PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
					PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
					glovesfound = true
					endIf
				endwhile	
			elseif items == "Circlet"		
				ScreenMessage("You found a new CIRCLET like from outfit: "+number)
				bool circletfound = false
				while (OutfitSize > 0) && !circletfound
				OutfitSize -= 1	
					if (akFormlist.GetAt(OutfitSize) as armor).IsClothingHead() 
					PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
					PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
					circletfound = true
					endIf
				endwhile		
			endif		
		else
		ScreenMessage("#ERROR: Function had no suitable value")
		
		LootScriptRunning = false			
		
		endif
		
		;remove gold 
		;int MaterialPrice
		;if Type == "Heavy Armor"
		;MaterialPrice = 100
		;elseif Type == "Light Armor"
		;MaterialPrice = 50
		;elseif Type == 

		;MaterialPrice = 25
		;endif
		
		;when full outfit equiped, additional gold cost & added cooldown
		LootScriptRunning = false
		if items == "All"
		;MaterialPrice*10
		;add cooldown	
		;SpellLootCooldown.RemoteCast(PlayerRef, PlayerRef, PlayerRef)
		endif
		
		;PlayerRef.RemoveItem(Gold001, MaterialPrice, false, none)
	endif
	
	LootScriptRunning = false
			
EndFunction

/;

;/
;EQUIP STUFF ANIMATION LOOP ----------- REDACTED OLD
Function EquipOutfitAnimated(Int number, Bool AddOutfit) ;#EquipOutfitAnimated #animated

	Debug.Trace("Naked Defeat configquest: EquipOutfitAnimated()")	
		;EquipOutfitAnimated(1, True) ---> equip Outfit 01, add the items before
		
		Formlist akFormlist

		PlayerRef.UnequipAll()
		
		if number == 1
		akFormlist = Outfit_01
		elseif number == 2
		akFormlist = Outfit_02
		elseif number == 3
		akFormlist = Outfit_03
		elseif number == 4
		akFormlist = Outfit_04
		elseif number == 5
		akFormlist = Outfit_05
		endif

		int OutfitSize = (akFormlist.GetSize()) 
		bool InventoryOpen = false
		int IdleCooldown = 0
		
		UI.CloseCustomMenu()
		

		if UI.IsMenuOpen("Main Menu") || UI.IsMenuOpen("InventoryMenu")
		InventoryOpen = true
		Debug.MessageBox("Please close Menu/Leave Inventory to allow the animated equip sequence to start")
		
			while InventoryOpen && ModEnabled
			InventoryOpen = UI.IsMenuOpen("InventoryMenu")
			Utility.Wait(1.0)				
			endwhile
		endif	

		
		Immobilize(true)
		
		while OutfitSize > 0 	
			
			if IdleCooldown == 0
			PlayerRef.PlayIdle(IdlesFixHair[1])
			elseif IdleCooldown == 2 
			PlayerRef.PlayIdle(IdlesBathingStanding[1])
			elseif IdleCooldown == 4 
			PlayerRef.PlayIdle(IdlesBathingStanding[2])
			elseif IdleCooldown == 6 
			PlayerRef.PlayIdle(IdlesBathingStanding[3])
			elseif IdleCooldown == 8 
			PlayerRef.PlayIdle(IdlesBathingStanding[6])
			elseif IdleCooldown == 10 
			PlayerRef.PlayIdle(IdlesBathingStanding[0])
			elseif IdleCooldown > 10 
			IdleCooldown = 0
			endif
			
			IdleCooldown +=1
			
		OutfitSize -= 1	
		
			if AddOutfit
			PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)		
			endif
		;Form TempForm = akFormlist.GetAt(OutfitSize)
		;int TempFormID = TempForm.GetFormID()	
			
		;PlayerRef.EquipItemById(TempForm, TempFormID, 0, false, false )		
			
		;PlayerRef.EquipItemById(akFormlist.GetAt(OutfitSize), akFormlist.GetAt(OutfitSize).GetFormID(), 0, false, false )		
		PlayerRef.EquipItemEx(akFormlist.GetAt(OutfitSize), 0, false, false )		
		
			
		;PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
		Utility.Wait(1.0)
		endwhile
		
		IdleCooldown = 0
		Immobilize(false)

EndFunction

/;



;#################################################################################################################################################################################
			; DEVIOUS DEVICES START ;			#DD  
;#################################################################################################################################################################################			
	
	
Bool Function IsDDScenario()
		if (DefeatTypeScenario == "DD") ;|| (DefeatTypeScenario == "DDeEvent")
		return true
		else
		return false
		endIf
EndFunction
	
;/	 <<<--- ALL OLD - DELETE 
Keyword HeavyBondageDD			
			

			
Bool Function IsWearingHeavyBondageDD(actor akactor)

	Form WornItem = None
	Bool HeavyBondageFound = false

	int Slot = 30	
	
	while (Slot < 62) && !HeavyBondageFound	
		
		if (Slot == 30)
		WornItem = akactor.GetWornForm(0x00000001) 	;30 - head				30, 31, 32, 33, 37, 39
		elseif (Slot == 31) 
		WornItem = akactor.GetWornForm(0x00000002) 	;31 - hair/HELMET
		elseif (Slot == 32) 
		WornItem = akactor.GetWornForm(0x00000004)	;32 - BODY
		elseif (Slot == 33)
		WornItem = akactor.GetWornForm(0x00000008)	;33 - HANDS
		elseif (Slot == 34)
		WornItem = akactor.GetWornForm(0x00000010)	;34 - Forearms
		elseif (Slot == 35) 
		WornItem = akactor.GetWornForm(0x00000020)	;35 - Amulet 		
		elseif (Slot == 36) 
		WornItem = akactor.GetWornForm(0x00000040)	;36 - Ring 
		elseif (Slot == 37)	 	
		WornItem = akactor.GetWornForm(0x00000080)	;37 - FEET
		elseif (Slot == 38) 
		WornItem = akactor.GetWornForm(0x00000100)	;38 - Calves
		elseif (Slot == 39) 
		WornItem = akactor.GetWornForm(0x00000200)	;39 - SHIELD
		elseif (Slot == 40) 
		WornItem = akactor.GetWornForm(0x00000400)	;40 - TAIL
		elseif (Slot == 41) 
		WornItem = akactor.GetWornForm(0x00000800)	;41 - Long Hair
		elseif (Slot == 42) 
		WornItem = akactor.GetWornForm(0x00001000)	;42 - Circlet
		elseif (Slot == 43)
		WornItem = akactor.GetWornForm(0x00002000)	;43 - Ears 	
		elseif (Slot == 44) 
		WornItem = akactor.GetWornForm(0x00004000)	;44 - Unnamed 		(DD Gag/Mouth, SexlabTongue)
		elseif (Slot == 45)	
		WornItem = akactor.GetWornForm(0x00008000)	;45 - Unnamed 		(DD Collars)
		elseif (Slot == 46) 
		WornItem = akactor.GetWornForm(0x00010000)	;46 - Unnamed 		(DD Armbinder/Yoke, Cloaks)
		elseif (Slot == 47) 
		WornItem = akactor.GetWornForm(0x00020000)	;47 - Unnamed 		(DD -, Backpacks, Wings)
		elseif (Slot == 48) 
		WornItem = akactor.GetWornForm(0x00040000)	;48 - Unnamed 		(DD plugs anal, Backpack left pouch)
		elseif (Slot == 49) 
		WornItem = akactor.GetWornForm(0x00080000)	;49 - Unnamed 		(DD Body harness/Chastity belt)
		elseif (Slot == 50) 
		WornItem = akactor.GetWornForm(0x00100000)	;50 - Decap. Head	(DD Piercings Vaginal, bracelets)
		elseif (Slot == 51) 	
		WornItem = akactor.GetWornForm(0x00200000)	;51 - Decapitate
		elseif (Slot == 52) 
		WornItem = akactor.GetWornForm(0x00400000)	;52 - Unnamed  ;BIKINI BOTTOMS 
		elseif (Slot == 53) 
		WornItem = akactor.GetWornForm(0x00800000)	;53 - Unnamed	(DD Cuffs Legs)
		elseif (Slot == 54) 
		WornItem = akactor.GetWornForm(0x01000000)	;54 - Unnamed	(DD Plugs vaginal)
		elseif (Slot == 55) 
		WornItem = akactor.GetWornForm(0x02000000)	;55 - Unnamed	(DD Blindfold)
		elseif (Slot == 56) 
		WornItem = akactor.GetWornForm(0x04000000)	;56 - Unnamed	(DD Chastity Bra)
		elseif (Slot == 57)
		WornItem = akactor.GetWornForm(0x08000000)	;57 - Unnamed	(DD Vaginal Plugs)
		elseif (Slot == 58)	
		WornItem = akactor.GetWornForm(0x10000000)	;58 - Unnamed	(DD Body Harness/Corset
		elseif (Slot == 59) 
		WornItem = akactor.GetWornForm(0x20000000)	;59 - Unnamed	(DD Cuffs Arms)
		elseif (Slot == 60)
		WornItem = akactor.GetWornForm(0x40000000)	;60 - Unnamed
		elseif (Slot == 61) 
		WornItem = akactor.GetWornForm(0x80000000)	;61 - Unnamed
		endif

		if WornItem	
			if WornItem.HasKeyWord(HeavyBondageDD)
			HeavyBondageFound = true
			endIf	
		endif
		
		Slot += 1

	endwhile
			
	if HeavyBondageFound
	HeavyBondageFound = false
		if NymBeta
		DebugMessage("Is wearing HeavyBondage")
		endif
	return true
	else
		if NymBeta
		DebugMessage("Is NOT wearing HeavyBondage")
		endif
	return false
	endif

EndFunction

/;



;/

	We need to check for keyword early

	Factions 
	(DD Integration)
	05029567	zadAnimatingFaction				Devious Devices Animating Faction
	05029568	zadVibratorFaction				Vibrator Effect Faction
	05030C3C	zadGagPanelFaction				Panel Gag Faction
	0504653B	zadDisableDialogueFaction		Dialogue Disable Faction
		

	HEAVY Items
	
	: -- DD Assets -- :	
	0302C531			zad_DeviousYoke
	0302AFA3			zad_DeviousSuit
	03017C43			zad_DeviousHarness
	0300CA3A			zad_DeviousArmbinder
	
	: -- DD Integration -- :
	0505226C			zad_DeviousHeavyBondage    <----- IMPORTANT! seems to have all the important references
	
	05062538			zad_DeviousYokeBB		
	
	BELTS
	03003330			zad_DeviousBelt
	
	GAGS
	0301F306			zad_DeviousGagPanel
	03007EB8			zad_DeviousGag
	
	
/;	

;#################################################################################################################################################################################
			; DEVIOUS DEVICES END ;		
;#################################################################################################################################################################################



Function ForceOutfit(string items)
			
	Debug.Trace("Naked Defeat configquest: ForceOutfit()")	
		
	int number 	
	
	Formlist akFormlist
	
		if D100(50)
			if Outfit_01_Type == "Heavy Armor"	
			number = 1	
			elseif Outfit_02_Type == "Heavy Armor"	
			number = 2
			elseif Outfit_03_Type == "Heavy Armor"	
			number = 3
			elseif Outfit_04_Type == "Heavy Armor"	
			number = 4
			elseif Outfit_05_Type == "Heavy Armor"	
			number = 5
			else
			ScreenMessage("Your captors cannot find a suitable outfit for you")
			endif
		else	;change direction of check to increase variety of outfits. we still cannot have more than 2 outfits with 1 type tho...
			if Outfit_05_Type == "Light Armor"	
			number = 5	
			elseif Outfit_04_Type == "Light Armor"
			number = 4
			elseif Outfit_03_Type == "Light Armor"
			number = 3
			elseif Outfit_02_Type == "Light Armor"
			number = 2
			elseif Outfit_01_Type == "Light Armor"
			number = 1
			else
			ScreenMessage("Your captors cannot find a suitable outfit for you")
			endif
		endif
	
	if number == 1
	akFormlist = Outfit_01
	elseif number == 2
	akFormlist = Outfit_02
	elseif number == 3
	akFormlist = Outfit_03
	elseif number == 4
	akFormlist = Outfit_04
	elseif number == 5
	akFormlist = Outfit_05
	endif
	
	if items == "random"
		int random = Utility.RandomInt(1,3)
		if random == 1
		items == "Boots"
		else
		items == "Cuirass"
		endif
	endif
	
	int OutfitSize = (akFormlist.GetSize()) 
	if items == "Boots"
	ScreenMessage("Your captors force some nice looking boots on you")
		bool bootsfound = false
		while (OutfitSize > 0) && !bootsfound
		OutfitSize -= 1	
			;if (akFormlist.GetAt(OutfitSize) as armor).IsBoots()
			If IsItem("Armor Boots", (akFormlist.GetAt(OutfitSize)))
			PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
			PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
			bootsfound = true
			endIf
		endwhile	
		
	elseif items == "Cuirass"
		ScreenMessage("Your captors force some nice stuff on you")
		bool cuirassfound = false
		while (OutfitSize > 0) && !cuirassfound
		OutfitSize -= 1	
			;if (akFormlist.GetAt(OutfitSize) as armor).IsCuirass()
			If IsItem("Armor Cuirass", (akFormlist.GetAt(OutfitSize)))
				PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
				PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
				cuirassfound = true
			endIf
		endwhile
	endif	
			
EndFunction




;NAKED LOOT ----------------



bool LootScriptRunning = false

Function LootScript(Form akBaseObject, Bool WeAreInStore = false)	;#LootScript		;#Loot1

	String sLootedItemName
	
	;if IsNymrasGame()
	sLootedItemName = akBaseObject.GetName()
	;endif
	
	string Type = "none"
	string Items = "none"
	bool ProcessLoot = true
	bool IsItArmor = false
	bool IsItWeapon = false
	bool PiercedNipples = false
	bool PiercedVagina = false
	bool BikiniBottom = false

	Debug.Trace("NAKED DEFEAT configquest: LootScript("+sLootedItemName+")")	
	LootScriptRunning = true
	
	;might need compatibility patches...
	
	; -- UNRELATED -- ; 	(allowed)
	;if (akBaseObject as armor).IsJewelry()
	
	; -------- PRE CHECKS ------------------------------------------------------------------------------ 
	;--- PRE - CHECK FOR PIERCING ----;

	
	;--- PRE - CHECK FOR ARMOR ----;
	if IsItem("Armor Cuirass", akBaseObject) || IsItem("Armor Helmet", akBaseObject) || IsItem("Armor Gauntlets", akBaseObject) || IsItem("Armor Boots", akBaseObject) || IsItem("Clothes Body", akBaseObject) || IsItem("Clothes Head", akBaseObject) || IsItem("Clothes Hands", akBaseObject) || IsItem("Clothes Feet", akBaseObject)
	NymTrace("LootScript: "+sLootedItemName+" is Armor") 
	IsItArmor = true 
	endif 
	
	if DeviousPiercingEffects && IsItArmor  
		if nade_DDInt.IsWearingDDs(PlayerRef, "Piercing Nipples")
			if IsItem("Armor Cuirass", akBaseObject) || IsItem("Clothes Body", akBaseObject)
			PiercedNipples = true
			endif 
		endif 
		if nade_DDInt.IsWearingDDs(PlayerRef, "Piercing Vaginal")
			if IsItem("Bikini Bottom", akBaseObject); || IsItem("Clothes Body", akBaseObject)
			PiercedVagina = true
			endif 
		endif 	
		
	endif 
	
	; -------- MAIN SCRIPT ------------------------------------------------------------------------------ 
	if IsItem("Jewelery", akBaseObject) 
	;LootScriptRunning = false
	ProcessLoot = false
	DebugMessage("#DEBUG: Jewellerey, allowed to equip")
	;END

	; -- PIERCED NIPPLES (DD)-- ; 	(NOT allowed wearing Body Armor)
	
	elseif PiercedNipples || PiercedVagina
	DebugMessage("DEBUG LOOT: Pierced Nipples, no Body armor allowed TRUE")
	
	if PiercedNipples && PiercedVagina
	ScreenMessage("The painful piercings prevent you from wearing body armor.")
	elseif PiercedNipples
	ScreenMessage("The painful nipple piercings prevent you from wearing body armor.")
	elseif PiercedVagina
	ScreenMessage("The painful vagina piercings prevent you from wearing body armor.")
	endif 
	
	PlayerRef.UnEquipItem(akBaseObject, false, true)	

	ProcessLoot = false

	; -- NAKED CURSE (from NAKED POTIONS) -- ; 	(NOT allowed)
	elseif NakedCurseActive && CheckDurationSpell("Health")
	DebugMessage("DEBUG LOOT: NakedCurseActive TRUE")
		;check if equiped item is armor

		bool allowed = false
		
		if IsItem("Armor Type Light", akBaseObject) || IsItem("Armor Type Heavy", akBaseObject) || IsItem("Armor Type Clothing", akBaseObject)
		allowed = false
		else 
		allowed = true
		endif 
		
		;/
		if (akBaseObject as weapon).IsSword()
		allowed = true
		elseif (akBaseObject as weapon).IsWarAxe()
		allowed = true
		elseif (akBaseObject as weapon).IsBattleAxe()
		allowed = true
		elseif (akBaseObject as weapon).IsGreatsword()
		allowed = true
		elseif (akBaseObject as weapon).IsStaff()
		allowed = true
		elseif (akBaseObject as weapon).IsBow()
		allowed = true
		elseif (akBaseObject as weapon).IsDagger()
		allowed = true
		elseif (akBaseObject as weapon).IsMace()
		allowed = true
		elseif (akBaseObject as weapon).IsWarhammer()
		allowed = true
		elseif (akBaseObject as armor).IsJewelry()
		allowed = true
		endif
		/;
	
		if allowed
		DebugMessage("#DEBUG: Allowed when naked")
		else
		ScreenMessage("The naked curse prevents you from wearing anything.")
		PlayerRef.UnEquipItem(akBaseObject, false, true)	
		endif	
		ProcessLoot = false
		
	; -- IN COMBAT -- ; 	(NOT allowed)
	elseif PartyInCombat()
	DebugMessage("DEBUG LOOT: PartyInCombat() TRUE")
		;check if equiped item is armor

		
		;HACK Allow in my game to use when sneaking ????
			
			;WHYHHHHHY WHY ?
			if IsItem("Armor Cuirass", akBaseObject) || IsItem("Armor Helmet", akBaseObject) || IsItem("Armor Gauntlets", akBaseObject) || IsItem("Armor Boots", akBaseObject)
			IsItArmor = true
			elseif IsItem("Clothes Body", akBaseObject) || IsItem("Clothes Head", akBaseObject) || IsItem("Clothes Hands", akBaseObject) || IsItem("Clothes Feet", akBaseObject)
			IsItArmor = true 
			;if (akBaseObject as armor).IsCuirass() 
			;elseif (akBaseObject as armor).IsBoots()
			;elseif (akBaseObject as armor).IsGauntlets()
			;elseif (akBaseObject as armor).IsHelmet()
			;elseif (akBaseObject as armor).IsClothingBody()
			;elseif (akBaseObject as armor).IsClothingFeet()
			;elseif (akBaseObject as armor).IsClothingHands()
			;elseif (akBaseObject as armor).IsClothingHead()
	
			else
			IsItArmor = false
			endif
			
			if IsNymrasGame() && PlayerRef.IsSneaking()
			IsItArmor = false
			endif
		
			if IsItArmor
			ScreenMessage("You do not have time to change wardrobe in a fight!")
			PlayerRef.UnEquipItem(akBaseObject, false, true)	
			else
			DebugMessage("#DEBUG: Not armor, allowed in combat")
			endif
			
			ProcessLoot = false
		;LootScriptRunning = false
	;END	
	
	; -- OUTFIT/WEAPON CHECK -- ;		(allowed)	
	;elseif Outfit_01.HasForm(akBaseObject) || Outfit_02.HasForm(akBaseObject) || Outfit_03.HasForm(akBaseObject) || Outfit_04.HasForm(akBaseObject) || Outfit_05.HasForm(akBaseObject)
	elseif Check_JSON_Outfits(akBaseObject) 
	Debug.Trace("NAKED DEFEAT configquest: Check_JSON_Outfits(TRUE) Allowed to Equip: "+sLootedItemName)
	ProcessLoot = false
	
	elseif Check_JSON_Weapons(akBaseObject)
	Debug.Trace("NAKED DEFEAT configquest: Check_JSON_Weapons(TRUE) Allowed to Equip: "+sLootedItemName)
	ProcessLoot = false
	
	;elseif Check_JSON_Outfit(akBaseObject)
	;LootScriptRunning = false
	;LootScriptRunning = false
		;/
		;#HELMET HAIR
		if IsNymrasGame()
			;Form a = None
		;a = PlayerRef.GetWornForm(0x00001000)	
				if akBaseObject.GetName() == "Dragonplate Crown"
				HeadPart tempHeadpart = HeadPart.GetHeadPart("_DINT_SG_hairsidebraidsHDT")	
				PlayerRef.ChangeHeadPart(tempHeadpart)
				InfoMessage("Your new Battle Hairstyle: _DINT_SG_hairsidebraidsHDT")
				elseif akBaseObject.GetName() == "Steel Sallet"									
				HeadPart tempHeadpart = HeadPart.GetHeadPart("_DINT_SG_hairsidebraidsHDT")
				PlayerRef.ChangeHeadPart(tempHeadpart)
				InfoMessage("Your new Battle Hairstyle: _DINT_SG_hairsidebraidsHDT")
				endif
				
		endif		
	/;
	
	
	;DebugMessage("#DEBUG Loot: Part of Outfit, Allowed to Equip")
	;Debug.Trace("NAKED DEFEAT configquest: LootScript: Part of Outfit, Allowed to Equip")	
	;END
	
	; -- NO MAIN ARMOR SLOT CHECK -- ;		(allowed)
	;we check for the items to be "main armor" and if not it is allowed to equip.
	
	;elseif !IsItem("Armor Cuirass", akBaseObject) && !IsItem("Armor Helmet", akBaseObject) && !IsItem("Armor Gauntlets", akBaseObject) && !IsItem("Armor Boots", akBaseObject) && !IsItem("Clothes Body", akBaseObject) && !IsItem("Clothes Head", akBaseObject) && !IsItem("Clothes Hands", akBaseObject) && !IsItem("Clothes Feet", akBaseObject)
	elseif !IsItArmor
	;elseif !(akBaseObject as armor).IsCuirass() && !(akBaseObject as armor).IsBoots() && !(akBaseObject as armor).IsGauntlets() && !(akBaseObject as armor).IsHelmet() && !(akBaseObject as armor).IsClothingBody() && !(akBaseObject as armor).IsClothingFeet() && !(akBaseObject as armor).IsClothingHands() && !(akBaseObject as armor).IsClothingHead()
		
			bool CheckThisWeapon = false
			Weapon wCheckObject ;= akBaseObject as weapon
			
			if akBaseObject
			NymTrace("Item"+sLootedItemName+" akBaseObject = true")
			wCheckObject = akBaseObject as weapon
			;CheckThisWeapon = true
			else
			NymTrace("#NOTE Item"+sLootedItemName+" akBaseObject = FALSE")
			endif 
					
			if wCheckObject
			NymTrace("#NOTE Item"+sLootedItemName+" wCheckObject = true")
			CheckThisWeapon = true
			else
			NymTrace("#NOTE Item"+sLootedItemName+" wCheckObject = FALSE")
			endif 
			
			if CheckThisWeapon 
				if (akBaseObject as weapon).IsSword()
				Items = "Sword"
				elseif (akBaseObject as weapon).IsWarAxe()
				Items = "WarAxe"
				elseif (akBaseObject as weapon).IsBattleAxe()
				Items = "BattleAxe"
				elseif (akBaseObject as weapon).IsGreatsword()
				Items = "Greatsword"
				elseif (akBaseObject as weapon).IsStaff()
				Items = "Staff"
				elseif (akBaseObject as weapon).IsBow()
				Items = "Bow"
				elseif (akBaseObject as weapon).IsDagger()
				Items = "Dagger"
				elseif (akBaseObject as weapon).IsMace()
				Items = "Mace"
				elseif (akBaseObject as weapon).IsWarhammer()
				Items = "Warhammer"
				endif
			endif 
			
			IsItWeapon = true  ;this stays true no matter what! If we process the weapon or not is up to "ProcessLoot" 

		if Items == "none"	;neither main armor slot nor wepaon, allowed to equip
		ProcessLoot = false
		Debug.Trace("NAKED DEFEAT configquest: LootScript: No Main Armor Slot - Allowed to Equip: "+sLootedItemName)
		else				;its a weapon, process loot
		ProcessLoot = true
		Type = "Weapon"
		Debug.Trace("NAKED DEFEAT configquest: LootScript: No Main Armor Slot - IS WEAPON: "+sLootedItemName)
		endif
		
			
		if IsItWeapon
			if !Loot_Handles_Weapons_TOGGLE
			ProcessLoot = false
			elseif (akBaseObject as weapon).GetEnchantment()  ;PROTECT QUEST ITEMS EVEN BETTER please
			ProcessLoot = false
			Debug.Trace("NAKED DEFEAT configquest: LootScript: Enchanted Weapons - Allowed to Equip: "+sLootedItemName)
			endif 
		endif 

	;END
	endif
	
	;we seperated this because of the weapon check beforehand...
	if !ProcessLoot
	NymTrace("ProcessLoot = FALSE") 
	
	elseif ProcessLoot ;in General we Process Weapons and Armors here if they are "valid" for Naked Loot 
	
	; -- PROCESS LOOT -- ; 		(CHECK if allowed)
		float LootChance = 0

		bool IsArmorEquiped = false
		
		if !IsItWeapon	 ;no weapon, must be main armor slot type
			if (akBaseObject as armor).IsShield()
			Type = "Weapon"
			Items = "Shield"
			LootChance = 75
			elseif (akBaseObject as armor).IsLightArmor() ;GetWeightClass() == 0
			;LootChance = 20				
			LootChance = DefeatBreakLightProb*5
			;make loot chance a multiple of the StripChance? 
			Type = "Light"
			elseif (akBaseObject as armor).IsHeavyArmor() 
			;LootChance = 10
			LootChance = DefeatBreakHeavyProb*5
			Type = "Heavy"
			elseif (akBaseObject as armor).IsClothing()	
			;LootChance = 40
			LootChance = DefeatBreakClothingProb*5
			Type = "Clothes"
				if (akBaseObject as armor).IsClothingBody()
				Items = "All"
				elseif (akBaseObject as armor).IsClothingFeet()
				Items = "Shoes"
				elseif (akBaseObject as armor).IsClothingHands()
				Items = "Gloves"
				elseif (akBaseObject as armor).IsClothingHead()
				Items = "Circlet"
				endif
				
			;elseif (akBaseObject as armor).IsJewelry()
			elseif IsItem("Jewelery", akBaseObject) 
			Type = "Unrelated"			;item is not important for us and is allowed to equip
			endif
		
			;if Armor is Found, we check what type of armor (items)
			if (Type == "Light") || (Type == "Heavy") ;|| (Type == "Clothes") 
				if (akBaseObject as armor).IsCuirass() 
				
					if Nym() && (sLootedItemName == "Wolf Harness")
					Type = "Unrelated"
					Items = "Unrelated"
					endif 
					
				Items = "All"
				elseif (akBaseObject as armor).IsBoots()
				Items = "Boots"
				LootChance = LootChance*2
				elseif (akBaseObject as armor).IsGauntlets()
				Items = "Gauntlets"
				LootChance = LootChance*2
				elseif (akBaseObject as armor).IsHelmet()
				Items = "Helmet"
				LootChance = LootChance*2
				else
				Items = "Unrelated"		;item is not important for us and is allowed to equip
				endif
			endif	
		endif	 
			
		;if (akBaseObject as weapon).IsBattleAxe() || (akBaseObject as weapon).IsGreatsword() || (akBaseObject as weapon).IsWarhammer()
		;/
		if Type == "none"
			if (akBaseObject as weapon).IsSword()
			Items = "Sword"
			elseif (akBaseObject as weapon).IsWarAxe()
			Items = "WarAxe"
			elseif (akBaseObject as weapon).IsBattleAxe()
			Items = "BattleAxe"
			elseif (akBaseObject as weapon).IsGreatsword()
			Items = "Greatsword"
			elseif (akBaseObject as weapon).IsStaff()
			Items = "Staff"
			elseif (akBaseObject as weapon).IsBow()
			Items = "Bow"
			elseif (akBaseObject as weapon).IsDagger()
			Items = "Dagger"
			elseif (akBaseObject as weapon).IsMace()
			Items = "Mace"
			elseif (akBaseObject as weapon).IsWarhammer()
			Items = "Warhammer"
			endif
			
			if Items == "none"
			Items = "Unrelated" ;item is not important for us and is allowed to equip
			else 
			Type = "Weapon"
			endif
		endif	
		/;	
		
		;------ LOOT - FINAL FUNCTION -----------------------------------------------------------------------------------------------
			
			if Type == "none"
			Type = "Unrelated"
			endif

		;	Type = "Light"
			if Type == "Weapon"
			;LootChance = 65
			LootChance = 100
			;Items = "Weapon"
			endif

			if WeAreInStore   ;100% chance to fit but costs gold  ---> check for smith nearby somehow
			DebugMessage("#DEBUG LOOT: We are In a Store")
			LootChance = 100
			endif
			
			Debug.Trace("Naked Defeat configquest: LootScript Loot Chance: "+LootChance)
			Debug.Trace("Naked Defeat configquest: LootScript Loot Type: "+Type)
			Debug.Trace("Naked Defeat configquest: LootScript Loot Items: "+Items)
				
			;DO NOTHING - we dont care about the stuff			
			if Type == "Unrelated" || Items == "Unrelated"	
			DebugMessage("#DEBUG LOOT: Unrelated Stuff, Allowed to Equip")
			;CHECK LOOTCHANCE
			elseif D100(LootChance)	
		
				;GetPrice >>>>>>>>>>>>>>>>>>>>>>>>>>>>
			
				float Gold = PlayerRef.GetGoldAmount()
					
				float Cost = 0
				
				if Type == "Heavy" 	
				;Cost = 200
				Cost = 1000/DefeatBreakHeavyProb
					if items == "All"
					;Cost = 2000
					Cost = LootFittingCostHeavy
					endif
				
				elseif Type == "Light"
				;Cost = 50
				125/DefeatBreakLightProb
					if items == "All"
					;Cost = 250
					Cost = LootFittingCostLight
					endif
					
				elseif Type == "Clothes"
				;Cost = 25
				Cost = 50/DefeatBreakClothingProb
					if items == "All"
					;Cost = 100
					Cost = LootFittingCostClothing
					endif

				elseif Type == "Weapon"
				;Cost = 100
				Cost = 0 ;WIP
				endif
				
			;	if items == "Boots" 
			;	Cost = 100
			;	endif
				
			;	if items == "Gauntlets"	 
			;	Cost = 75
			;	endif
			
			;remove 
					
				if WeAreInStore
				;do nothing here
				else
				Cost = 0		;<<<<<----- no gold cost out in the wild
				endIf
			
				if Cost > Gold
				ScreenMessage("You cannot afford to fit this stuff to you. Gold required: "+Cost)
				PlayerRef.UnEquipItem(akBaseObject, false, true)
				
				else
				int TempCost = Cost as int
				
				PlayerRef.RemoveItem(Gold001, TempCost, false, none)
				PlayerRef.RemoveItem(akBaseObject, 1, true, none)
				ScreenMessage("This stuff seems to fit quite nice!")		;#fits nice #fits quite nice
				;LoadOutfit(Type, Items) ;Old
				
					if Type == "Weapon"
					Get_JSON_Weapon(Items)
					AddRandomHarness()
					else
					Get_JSON_Outfit(Type, Items)
					
						if NymBeta
						FollowerLoadOutfit()		;#Lydia 		
						endif
					
					endif
					
		
					
				;Debug.Trace("NAKED DEFEAT configquest: after Get_JSON_Outfit")
				endif
			else	
			ScreenMessage("This stuff is wasted and wont fit...")		
			PlayerRef.RemoveItem(akBaseObject, 1, true, none)
			PlaySoundOnActor(PlayerRef, "Item does not fit", 1.0)
			;	if IsNymrasGame(); && D100(25)
			;	Get_JSON_Outfit("Naked", "All")
			;	endif
				
			endif	
		;endif	
	endif 
	
	LootScriptRunning = false
	Debug.Trace("NAKED DEFEAT configquest: LootScriptRunning = false")
	
EndFunction		


Float Property LootFittingCostHeavy Auto
Float Property LootFittingCostLight Auto 
Float Property LootFittingCostClothing Auto

int Property LootFittingCostHeavyInt Auto
int Property LootFittingCostLightInt Auto
int Property LootFittingCostClothingInt Auto


bool Function IsLootScriptRunning()	

 if LootScriptRunning	
 return true
 else
 return false
 endif
EndFunction
	
;OFFICIAL LATEST STRIPPING COMPLETE	
Function StripCompletely(int Exception1, int Exception2, int Exception3, int Exception4, int Override)		;#StripCompletely
		
		if Override < 3
		OverrideStripOptions = Override 		;0 unequip, 1 drop, 2 destroy
		endif
		
		
		
		int a = 30
		
		while a < 62
		
			if (a != Exception1) && (a != Exception2) && (a != Exception3) && (a != Exception4)
			Strip(a, PlayerRef)
			a += 1
			else
			a += 1
			endif
		
		endwhile
		
		OverrideStripOptions = 3	;return to normal state


EndFunction	

Function FollowerLoadOutfit()

		;FUCK THIS. Later Improve
		;/

		Formlist akFormlist = Outfit_JSON_FList[2]	;Bikini Armor 

		int OutfitSize = (akFormlist.GetSize()) 
		
		bool bootsfound = false
	
		if folqst.Actor_Follower01
			while (OutfitSize > 0) ;&& !bootsfound
				OutfitSize -= 1	
					;if (akFormlist.GetAt(OutfitSize) as armor).IsBoots() || (akFormlist.GetAt(OutfitSize) as armor).IsClothingFeet()
					;folqst.Actor_Follower01.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
					folqst.Actor_Follower01.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
					
			endwhile	

		folqst.Follower01_Helmet31 = 1
		folqst.Follower01_Body32 = 1			
		folqst.Follower01_Hands33 = 1			
		folqst.Follower01_Feet37 = 1	
		folqst.Follower01_Circlet42 = 1			
		folqst.Follower01_BikiniBottom52 = 1
		folqst.Follower01_BikiniThigh53 = 1
		endif 

		Debug.Trace("NAKED DEFEAT configquest: A folqst.Follower01_Helmet31:"+folqst.Follower01_Helmet31)
		Debug.Trace("NAKED DEFEAT configquest: A folqst.Follower01_Body32:"+folqst.Follower01_Body32)
		Debug.Trace("NAKED DEFEAT configquest: A folqst.Follower01_Hands33:"+folqst.Follower01_Hands33)
		Debug.Trace("NAKED DEFEAT configquest: A folqst.Follower01_Feet37:"+folqst.Follower01_Feet37)
		Debug.Trace("NAKED DEFEAT configquest: A folqst.Follower01_Circlet42:"+folqst.Follower01_Circlet42)
		Debug.Trace("NAKED DEFEAT configquest: A folqst.Follower01_BikiniBottom52:"+folqst.Follower01_BikiniBottom52)
		Debug.Trace("NAKED DEFEAT configquest: A folqst.Follower01_BikiniThigh53:"+folqst.Follower01_BikiniThigh53)

		if folqst.Actor_Follower02
			while (OutfitSize > 0) ;&& !bootsfound
				OutfitSize -= 1	

					;folqst.Actor_Follower02.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
					folqst.Actor_Follower02.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
					

			endwhile	
			
		folqst.Follower02_Helmet31 = 1
		folqst.Follower02_Body32 = 1			
		folqst.Follower02_Hands33 = 1			
		folqst.Follower02_Feet37 = 1		
		folqst.Follower02_Circlet42 = 1	
		folqst.Follower02_BikiniBottom52 = 1
		folqst.Follower02_BikiniThigh53 = 1	
		endif 		

		
			;BOOTS: 
			
	;	bool bootsfound = false
	;	while (OutfitSize > 0) && !bootsfound
	;		OutfitSize -= 1	
	;;			if (akFormlist.GetAt(OutfitSize) as armor).IsBoots() || (akFormlist.GetAt(OutfitSize) as armor).IsClothingFeet()
	;			PlayerRef.AddItem(akFormlist.GetAt(OutfitSize), 1, true)
;				PlayerRef.EquipItem(akFormlist.GetAt(OutfitSize), false, true)
;				bootsfound = true
;				endIf
;		endwhile	
		
		
		/;
EndFunction 	

Function FollowersRedress()
	
	Formlist akFormlist; = Outfit_JSON_FList[2]	;Bikini Armor 

		int OutfitSize ;= (akFormlist.GetSize()) 
			
		if folqst.IsWithUs_Follower(0)
		akFormlist.Revert()
		akFormlist = Outfit_01	;Bikini Armor 
		OutfitSize = (akFormlist.GetSize()) 
			while (OutfitSize > 0)
				OutfitSize -= 1	
				folqst.Actor_Follower01.EquipItem(akFormlist.GetAt(OutfitSize), true, true)		;follower gets the item ADDED only IF he does not have it in inventory
			endwhile	

		endif 
		
		if folqst.IsWithUs_Follower(1)
		akFormlist.Revert()
		akFormlist = Outfit_02	;Bikini Armor 
		OutfitSize = (akFormlist.GetSize()) 
			while (OutfitSize > 0)
				OutfitSize -= 1	
				folqst.Actor_Follower02.EquipItem(akFormlist.GetAt(OutfitSize), true, true)		;follower gets the item ADDED only IF he does not have it in inventory
					
			endwhile	

		endif 	

EndFunction 


Function FollowersStripWeapons()
	if folqst.Actor_Follower01
		if folqst.Actor_Follower01.GetEquippedWeapon()	
		folqst.Actor_Follower01.UnequipItem(folqst.Actor_Follower01.GetEquippedWeapon(), false, true)
		endif
	endif 
	if folqst.Actor_Follower02
		if folqst.Actor_Follower02.GetEquippedWeapon()	
		folqst.Actor_Follower02.UnequipItem(folqst.Actor_Follower02.GetEquippedWeapon(), false, true)
		endif
	endif 

EndFunction
		
Function FollowerStripCompletely()
		
if folqst.Actor_Follower01
Strip(31, folqst.Actor_Follower01) ;Helmet 
Strip(32, folqst.Actor_Follower01) ;BODY 
Strip(33, folqst.Actor_Follower01) ;BODY
Strip(37, folqst.Actor_Follower01) ;FEET
Strip(42, folqst.Actor_Follower01) ;Circlet
Strip(52, folqst.Actor_Follower01) ;BikiniBottom
Strip(53, folqst.Actor_Follower01) ;BikiniThigh

folqst.Follower01_Helmet31 = 0
folqst.Follower01_Body32 = 0			
folqst.Follower01_Hands33 = 0			
folqst.Follower01_Feet37 = 0	
folqst.Follower01_Circlet42 = 0			
folqst.Follower01_BikiniBottom52 = 0
folqst.Follower01_BikiniThigh53 = 0

endif 
	
if folqst.Actor_Follower02
Strip(31, folqst.Actor_Follower02) ;Helmet 
Strip(32, folqst.Actor_Follower02) ;BODY 
Strip(33, folqst.Actor_Follower02) ;BODY
Strip(37, folqst.Actor_Follower02) ;FEET
Strip(42, folqst.Actor_Follower02) ;Circlet
Strip(52, folqst.Actor_Follower02) ;BikiniBottom
Strip(53, folqst.Actor_Follower02) ;BikiniThigh

folqst.Follower02_Helmet31 = 0
folqst.Follower02_Body32 = 0			
folqst.Follower02_Hands33 = 0			
folqst.Follower02_Feet37 = 0	
folqst.Follower02_Circlet42 = 0			
folqst.Follower02_BikiniBottom52 = 0
folqst.Follower02_BikiniThigh53 = 0
endif 

FollowersStripWeapons()

EndFunction 

Function FollowerStripUpdate()
	
;checks if Follower is allowed to have Slot X equipped.
;if not, strips that slot 
		
if folqst.Actor_Follower01

		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower01_Helmet31:"+folqst.Follower01_Helmet31)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower01_Body32:"+folqst.Follower01_Body32)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower01_Hands33:"+folqst.Follower01_Hands33)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower01_Feet37:"+folqst.Follower01_Feet37)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower01_Circlet42:"+folqst.Follower01_Circlet42)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower01_BikiniBottom52:"+folqst.Follower01_BikiniBottom52)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower01_BikiniThigh53:"+folqst.Follower01_BikiniThigh53)


		if folqst.Follower01_Helmet31 == 0
		Strip(31, folqst.Actor_Follower01) 
		elseif folqst.Follower01_Body32 == 0
		Strip(32, folqst.Actor_Follower01) 
		elseif folqst.Follower01_Hands33 == 0
		Strip(33, folqst.Actor_Follower01) 		
		elseif folqst.Follower01_Feet37 == 0
		Strip(37, folqst.Actor_Follower01) 					
		elseif folqst.Follower01_Circlet42 == 0
		Strip(42, folqst.Actor_Follower01) 
		elseif folqst.Follower01_BikiniBottom52 == 0
		Strip(52, folqst.Actor_Follower01) 
		elseif folqst.Follower01_BikiniThigh53 == 0
		Strip(53, folqst.Actor_Follower01) 
		endif 
endif 

if folqst.Actor_Follower02

		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower02_Helmet31:"+folqst.Follower02_Helmet31)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower02_Body32:"+folqst.Follower02_Body32)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower02_Hands33:"+folqst.Follower02_Hands33)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower02_Feet37:"+folqst.Follower02_Feet37)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower02_Circlet42:"+folqst.Follower02_Circlet42)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower02_BikiniBottom52:"+folqst.Follower02_BikiniBottom52)
		Debug.Trace("NAKED DEFEAT configquest: folqst.Follower02_BikiniThigh53:"+folqst.Follower02_BikiniThigh53)

		if folqst.Follower02_Helmet31 == 0
		Strip(31, folqst.Actor_Follower02) 
		elseif folqst.Follower02_Body32 == 0
		Strip(32, folqst.Actor_Follower02) 
		elseif folqst.Follower02_Hands33 == 0
		Strip(33, folqst.Actor_Follower02) 		
		elseif folqst.Follower02_Feet37 == 0
		Strip(37, folqst.Actor_Follower02) 					
		elseif folqst.Follower02_Circlet42 == 0
		Strip(42, folqst.Actor_Follower02) 
		elseif folqst.Follower02_BikiniBottom52 == 0
		Strip(52, folqst.Actor_Follower02) 
		elseif folqst.Follower02_BikiniThigh53 == 0
		Strip(53, folqst.Actor_Follower02) 
		endif 
endif 

Endfunction

Function FollowerStripCombat()			;#Lydia 
Debug.Trace("NAKED DEFEAT configquest: FollowerStripCombat()")
int i

	if folqst.Actor_Follower01
	i = Utility.RandomInt(1,6) 			
		if i == 1 ;HEAD (CIrclet or Helmet)	
			if folqst.Actor_Follower01.GetWornForm(0x00000002) 	;31 - hair/HELMET
			Strip(31, folqst.Actor_Follower01) ;Helmet  
			elseif folqst.Actor_Follower01.GetWornForm(0x00001000)	;42 - Circlet	
			Strip(42, folqst.Actor_Follower01) ;Circlet 
			endif 	
		elseif (i == 2) || (i == 3) ;BODY 		
			if folqst.Actor_Follower01.GetWornForm(0x00000004) 	;32 -BODY 	
			Strip(32, folqst.Actor_Follower01) ;BODY 
			endif	
			if folqst.Actor_Follower01.GetWornForm(0x00400000) 	;52 -Bikini Bottom 
			Strip(52, folqst.Actor_Follower01)
			endif 
		elseif (i == 4) || (i == 5) ;Hands  

			if folqst.Actor_Follower01.GetWornForm(0x00000008) 	;33 - Hands
			Strip(33, folqst.Actor_Follower01) ;BODY 
			endif 
			
		elseif (i == 6) ;|| (i == 5) ;FEET   
		
			if folqst.Actor_Follower01.GetWornForm(0x00000080) 	;37 - FEET 
			Strip(37, folqst.Actor_Follower01) ;FEET 	
			endif 	

			if folqst.Actor_Follower01.GetWornForm(0x00800000) && D100(50) 	;53 - Bikini Thigh
			Strip(53, folqst.Actor_Follower01) ;FEET 
			endif 	
			
		endif 
	endif 
		
	if folqst.Actor_Follower02
	i = Utility.RandomInt(1,6) 			
		if i == 1 ;HEAD (CIrclet or Helmet)	
			if folqst.Actor_Follower02.GetWornForm(0x00000002) 	;31 - hair/HELMET
			Strip(31, folqst.Actor_Follower02) ;Helmet  
			elseif folqst.Actor_Follower02.GetWornForm(0x00001000)	;42 - Circlet	
			Strip(42, folqst.Actor_Follower02) ;Circlet 
			endif 	
		elseif (i == 2) || (i == 3) ;BODY 		
			if folqst.Actor_Follower02.GetWornForm(0x00000004) 	;32 -BODY 
			Strip(32, folqst.Actor_Follower02) ;BODY 
			endif 
		elseif (i == 4) || (i == 5) ;Hands  

			if folqst.Actor_Follower02.GetWornForm(0x00000008) 	;33 - Hands
			Strip(33, folqst.Actor_Follower02) ;BODY 
			endif 
			
		elseif (i == 6) ;|| (i == 5) ;FEET   
		
			if folqst.Actor_Follower02.GetWornForm(0x00000080) 	;37 - FEET 
			Strip(37, folqst.Actor_Follower02) ;FEET 
			endif 		
			if folqst.Actor_Follower02.GetWornForm(0x00800000) && D100(50) 	;53 - Bikini Thigh
			Strip(53, folqst.Actor_Follower02) ;FEET 
			endif 	
			
		endif
	endif 
	
	;MAIN SLOTS:
	;31 - Hair / HELMET or 
	;42 - Circlet
	;32 - BODY
	;33 - HANDS	
	;37 - FEET	
	;52	- Bikini Bottom
 
EndFunction

int OverrideStripOptions = 3		;does nothing??? no, needed....
	
;OFFICIAL LATEST STRIPPING	---> #baustelle #todo needs OVERRIDE OPTION
;#move
Function Strip(int slot, actor akactor)			;#strip

	bool AllowStripping = true
	

	
	if (akactor == PlayerRef) && !NymStripping
	AllowStripping = false
	else 
	AllowStripping = true
	endif

	Form a = None
		
	if AllowStripping
		if (Slot == 30)
		a = akactor.GetWornForm(0x00000001) 	;30 - head				30, 31, 32, 33, 37, 39
		elseif (Slot == 31) && !BlockSlot[1]
		a = akactor.GetWornForm(0x00000002) 	;31 - hair/HELMET
		elseif (Slot == 32) 
		a = akactor.GetWornForm(0x00000004)	;32 - BODY
		elseif (Slot == 33)
		a = akactor.GetWornForm(0x00000008)	;33 - HANDS
		elseif (Slot == 34)
		a = akactor.GetWornForm(0x00000010)	;34 - Forearms
		elseif (Slot == 35) && !BlockSlot[5]
		a = akactor.GetWornForm(0x00000020)	;35 - Amulet 	
		elseif (Slot == 36) && !BlockSlot[6]
		a = akactor.GetWornForm(0x00000040)	;36 - Ring 
		elseif (Slot == 37)	 	
		a = akactor.GetWornForm(0x00000080)	;37 - FEET
		elseif (Slot == 38) && !BlockSlot[8]
		a = akactor.GetWornForm(0x00000100)	;38 - Calves
		elseif (Slot == 39) && !BlockSlot[9]
		a = akactor.GetWornForm(0x00000200)	;39 - SHIELD
		elseif (Slot == 40) && !BlockSlot[10]
		a = akactor.GetWornForm(0x00000400)	;40 - TAIL
		elseif (Slot == 41) && !BlockSlot[11]
		a = akactor.GetWornForm(0x00000800)	;41 - Long Hair
		elseif (Slot == 42) && !BlockSlot[12]
		a = akactor.GetWornForm(0x00001000)	;42 - Circlet
		elseif (Slot == 43) && !BlockSlot[13]
		a = akactor.GetWornForm(0x00002000)	;43 - Ears 
		elseif (Slot == 44) && !BlockSlot[14]
		a = akactor.GetWornForm(0x00004000)	;44 - Unnamed 		(DD Gag/Mouth, SexlabTongue)
		elseif (Slot == 45)	&& !BlockSlot[15]
		a = akactor.GetWornForm(0x00008000)	;45 - Unnamed 		(DD Collars)
		elseif (Slot == 46) && !BlockSlot[16]
		a = akactor.GetWornForm(0x00010000)	;46 - Unnamed 		(DD Armbinder/Yoke, Cloaks)
		elseif (Slot == 47) && !BlockSlot[17]
		a = akactor.GetWornForm(0x00020000)	;47 - Unnamed 		(DD -, Backpacks, Wings)
		elseif (Slot == 48) && !BlockSlot[18]
		a = akactor.GetWornForm(0x00040000)	;48 - Unnamed 		(DD plugs anal, Backpack left pouch)
		elseif (Slot == 49) && !BlockSlot[19]
		a = akactor.GetWornForm(0x00080000)	;49 - Unnamed 		(DD Body harness/Chastity belt)
		elseif (Slot == 50) && !BlockSlot[20]
		a = akactor.GetWornForm(0x00100000)	;50 - Decap. Head	(DD Piercings Vaginal, bracelets)
		elseif (Slot == 51) && !BlockSlot[21]	
		a = akactor.GetWornForm(0x00200000)	;51 - Decapitate
		elseif (Slot == 52) && !BlockSlot[22]
		a = akactor.GetWornForm(0x00400000)	;52 - Unnamed
		elseif (Slot == 53) && !BlockSlot[23]
		a = akactor.GetWornForm(0x00800000)	;53 - Unnamed	(DD Cuffs Legs) , BIKINI THIGH
		elseif (Slot == 54) && !BlockSlot[24]
		a = akactor.GetWornForm(0x01000000)	;54 - Unnamed	(DD Plugs vaginal)
		elseif (Slot == 55) && !BlockSlot[25]
		a = akactor.GetWornForm(0x02000000)	;55 - Unnamed	(DD Blindfold)
		elseif (Slot == 56) && !BlockSlot[26]
		a = akactor.GetWornForm(0x04000000)	;56 - Unnamed	(DD Chastity Bra)
		elseif (Slot == 57)	&& !BlockSlot[27]
		a = akactor.GetWornForm(0x08000000)	;57 - Unnamed	(DD Vaginal Plugs)
		elseif (Slot == 58) && !BlockSlot[28]	
		a = akactor.GetWornForm(0x10000000)	;58 - Unnamed	(DD Body Harness/Corset
		elseif (Slot == 59) && !BlockSlot[29]
		a = akactor.GetWornForm(0x20000000)	;59 - Unnamed	(DD Cuffs Arms)
		elseif (Slot == 60) && !BlockSlot[30]
		a = akactor.GetWornForm(0x40000000)	;60 - Unnamed
		elseif (Slot == 61) && !BlockSlot[31]
		a = akactor.GetWornForm(0x80000000)	;61 - Unnamed
		endif

		;#GUIDE: Followers only unequip their items and do not respect the MCM settings (for now) 
		int StripBehaviour
		if akactor == PlayerRef 
		StripBehaviour = StripOptions
		
		elseif NymBeta && (akactor == folqst.Actor_Follower01) 	;#Lydia
		;Debug.Trace("NAKED DEFEAT configquest: LydiaA")
			if Slot == 31 && !IsNymrasGame() ;Nymra dont strip Helmets for now... 
			folqst.Follower01_Helmet31 = 0
			elseif Slot == 32 
			;Debug.Trace("NAKED DEFEAT configquest: LydiaB")
			folqst.Follower01_Body32 = 0
			elseif Slot == 42 
			folqst.Follower01_Circlet42 = 0
			elseif Slot == 33 
			folqst.Follower01_Hands33 = 0
			elseif Slot == 37 
			folqst.Follower01_Feet37 = 0
			elseif Slot == 52 
			folqst.Follower01_BikiniBottom52 = 0
			elseif Slot == 53 
			folqst.Follower01_BikiniThigh53 = 0
			endif 

		StripBehaviour = 0
		
		elseif NymBeta && (akactor == folqst.Actor_Follower02)

			if Slot == 31 && !IsNymrasGame()
			folqst.Follower02_Helmet31 = 0
			elseif Slot == 32 
			folqst.Follower02_Body32 = 0
			elseif Slot == 42 
			folqst.Follower02_Circlet42 = 0
			elseif Slot == 33 
			folqst.Follower02_Hands33 = 0
			elseif Slot == 37 
			folqst.Follower02_Feet37 = 0
			elseif Slot == 52 
			folqst.Follower02_BikiniBottom52 = 0
			elseif Slot == 53 
			folqst.Follower02_BikiniThigh53 = 0
			endif 
			
		StripBehaviour = 0
		
		else
		StripBehaviour = 0
		endif

		if OverrideStripOptions < 3 
		StripBehaviour = OverrideStripOptions
		endif
		
		
;Loot_Handles_Weapons_TOGGLE

		if a
			Weapon TempCheckForm = a as weapon
				;Enchanted Armor Override 
				if TempCheckForm && TempCheckForm.GetEnchantment() && Strip_EnchantedArmor_VALUE < 4
				StripBehaviour = Strip_EnchantedArmor_VALUE
				endif 

		;Debug.Trace("NAKED DEFEAT configquest: LydiaC")
			if !a.HasKeyWord(SexLabNoStrip)
			
				if Slot == 37 && Nym() 
				RestoreHeelsEffectOnActor(akactor)
				endif 
			
				if StripBehaviour == 0			;unequip
				;Debug.Trace("NAKED DEFEAT configquest: LydiaD")
				akactor.UnequipItem(a, false, true)								
				elseif StripBehaviour == 1		;drop
					if akactor == PlayerRef
					akactor.DropObject(a, 1)
					else
					akactor.UnequipItem(a, false, true)		;Followers dont drop, only unequip 
					endif 
				elseif StripBehaviour == 2		;destroy
					if CivilRapeRunning ;when Public Punishment and DESTROY, items will always only be unequiped
					akactor.UnequipItem(a, false, true)	
					else
					akactor.RemoveItem(a, 1, true, None)
					endif
				endif
			endif
		else 
		;Debug.Trace("NAKED DEFEAT configquest: LydiaFuckedUp")
		endif
	endif
EndFunction	





;>>>>>>>>>>>>> NAKED POTIONS >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> #potion
;Functions that belong to the Naked Potions option where drinking certain potions gives advantages against some events from the mod

;/
	#SHADER 1
	+EnchShockFXCloak - warum so geil und im dings net? muss ndern wie ich den shock applye oder zwei Verfahren parallel?
	+EnchRedFX intensiv aber auch cool				---> only use as duration effect
	-EnchArmorHealthFX zu schwach Armor Ench zu schwach allgemeiN?
	++AbsorbHealthFX 	SEHR COOL!				---> SHORT: intense red glow, no sound. hmmm
	++AbsorbBlueFX		SEHR COOL!
	++AbsorbGreenFX		SEHR COOL! gleiche effekte, nur andere farben. Wie sehen die aber "parallel" geschaltet aus?
	+AdrenalineRushFXS	hnlich Absorb aber in grnblau
	+AlchArmorFireFX	suptile goldene flammenbewegungen
	+BerserkerFXS		Bloodspills all over body. maybe for tortureeffects?/death?/Burn?
	???ChaurusPoisonShader							---> only use as duration effect - SHORT has only some nestling sound
	+/-DA02BoethiahFXS	FullBodyPurpleShimmer
	
	
	NightmareFXShader	tested only for SHORT: no sound, kind of windy effect
	
	/;


Function ApplyDurationSpell(string type, int strength)
Debug.Trace("NAKED DEFEAT POTIONS WE ARE HERE 1")
	if type == "Health"
	
		if CheckDurationSpell("Health") && (SpellDurationHealthStrenght == 0)
		RepairDurationSpell("Health")
		endif
		
		if CheckDurationSpell("Health")	;we dont want multiple effects active at the same time?
		InfoMessage("You already are high on healing potions")
		else
		ScreenMessage("The healing potion strenghtens you")
		InfoMessage("Health Effect can prevent the next critical hit (defeat), then fizzles out")
		PotionDurationHealth[strength].RemoteCast(PlayerRef, PlayerRef, PlayerRef)
		SpellDurationHealthStrenght = strength
		endif
		
	elseif type == "Magicka"	
		
		if CheckDurationSpell("Magicka")	;we dont want multiple effects active at the same time?
		InfoMessage("You already are high on magicka potions")
		else
		ScreenMessage("The stamina potion improves your reflexes.")
		InfoMessage("Stamina Effect can prevent the next armor stripping hit, then fizzles out")
		PotionDurationMagicka[strength].RemoteCast(PlayerRef, PlayerRef, PlayerRef)
		SpellDurationMagickaStrenght = strength
		endif	
	endif

EndFunction

int SpellDurationHealthStrenght
int SpellDurationMagickaStrenght

Function RemoveDurationSpell(string type)
	Debug.Trace("NAKED DEFEAT POTIONS WE ARE HERE 4")
	if type == "Health"
	;Debug.Trace("NAKED DEFEAT POTIONS WE ARE HERE 5 SpellDurationHealthStrenght: "+SpellDurationHealthStrenght)
	PlayerRef.DispelSpell(PotionDurationHealth[SpellDurationHealthStrenght])
		if SpellDurationHealthStrenght == 0
		RepairDurationSpell("Health")
		endif
	SpellDurationHealthStrenght = 0
	NakedCurse(false)
	elseif type == "Magicka"
	;Debug.Trace("NAKED DEFEAT POTIONS WE ARE HERE 5 SpellDurationHealthStrenght: "+SpellDurationHealthStrenght)
	PlayerRef.DispelSpell(PotionDurationMagicka[SpellDurationMagickaStrenght])
		if SpellDurationHealthStrenght == 0
		RepairDurationSpell("Health")
		endif
	SpellDurationMagickaStrenght = 0
	endif

EndFunction	

Bool Function CheckDurationSpell(string type)

	if type == "Health"
		if PlayerRef.HasMagicEffectWithKeyword(KWDPotionDurationHealthEffect)
		return true
		else
		return false	
		endif
	elseif type == "Magicka"
		if PlayerRef.HasMagicEffectWithKeyword(KWDPotionDurationMagickaEffect)
		return true
		else
		return false
		endif			
	endif	
		
EndFunction
	
;NOT NEEDED ANYMORE?
Function RepairDurationSpell(string type)
	Debug.Trace("NAKED DEFEAT configquest: RepairDurationSpell")
	if type == "Health"
	PlayerRef.DispelSpell(PotionDurationHealth[1])
	PlayerRef.DispelSpell(PotionDurationHealth[2])
	PlayerRef.DispelSpell(PotionDurationHealth[3])	
	SpellDurationHealthStrenght = 0
	endif
EndFunction		
	

;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


Function FastTravel(String Status, Bool AddCooldown)			;#FastTravel #Travel
Debug.Trace("NAKED DEFEAT configquest: FastTravel()")
	;if NymBETA 	
		if Status == "Disabled" ;&& Game.IsFastTravelEnabled()
		Game.EnableFastTravel(False)
		InfoMessage("FAST TRAVEL DISABLED")
			if IsNymrasGame()
			ScreenMessage("FAST TRAVEL DISABLED")
			endif
		elseif Status == "Enabled" ;&& !Game.IsFastTravelEnabled()
		Game.EnableFastTravel()
		InfoMessage("FAST TRAVEL ENABLED")
			if IsNymrasGame()
			ScreenMessage("FAST TRAVEL ENABLED")
			endif
		
			;we only Add Cooldown Effect when the PC used the Activation via Hotkey to activate fast travel
			if AddCooldown
			SpellLootCooldown.RemoteCast(PlayerRef, PlayerRef, PlayerRef)
			endif
			
		endif
	;endif
	
EndFunction

Function CheckFastTravel()
Debug.Trace("NAKED DEFEAT configquest: CheckFastTravel()")

if NakedTravel
	;as long as the player has the Magic Cooldown Effect (should be 60 seconds) Fast Travel is ENABLED!
	;Fast Travel will be DISABLED when the magic effect wears off.
	if PlayerRef.HasMagicEffectWithKeyword(KWDLootCooldownEffect)
	Debug.Trace("NAKED DEFEAT configquest: CheckFastTravel(KWDLootCooldownEffect TRUE) (FastTravel ENABLED)")
	SendModevent("Moan")
	ShockSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)
	SoundSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)
	FastTravel("Enabled", false)
	else
	Debug.Trace("NAKED DEFEAT configquest: CheckFastTravel(KWDLootCooldownEffect FALSE) (FastTravel DISABLED)")
	FastTravel("Disabled", false)
	endif
else
Debug.Trace("NAKED DEFEAT configquest: CheckFastTravel(FastTravel ENABLED)")
FastTravel("Enabled", false)
endif	
	
EndFunction

Function CheckEssentiality()
		
		;we want no essential player
		if NoEssentialPlayer && PlayerRef.GetActorBase().IsEssential()
			DebugMessage("NAKED DEFEAT configquest #ERROR: Player is Essential but should not be. We fix this now. Most likely another mod is interfering.")
			PlayerRef.GetActorBase().SetEssential(false)
		;we want an essential player
		elseif !NoEssentialPlayer && !PlayerRef.GetActorBase().IsEssential()	
			DebugMessage("NAKED DEFEATconfigquest #ERROR: Player is NOT Essential but should be. We fix this now. Most likely another mod is interfering.")
			PlayerRef.GetActorBase().SetEssential(true)
		endif

EndFunction

Function DebugTrace(String Text1)			;#DebugTrace
Debug.Trace("NAKED DEFEAT configquest: "+Text1)
EndFunction

Function ShowDebugNotification(String Text2)		;#ShowDebugNotification
	if ShowDebugMessages
	Debug.Notification(Text2)
	endif
EndFunction

Function ScreenMessage(String Text3)		;#ScreenMessage ;narrative Messages
	if ShowNarrativeMessages
	Debug.Notification("<font color='#ff0000'>"+Text3+"</font>")
	endif
	Debug.trace("NAKED DEFEAT configquest: (#msg) "+Text3)
EndFunction

Function InfoMessage(String Text2)		;#InfoMessage
	if ShowInfoMessages
	Debug.Notification("<font color='#ff7f00'>"+Text2+"</font>")
	endif
	Debug.trace("NAKED DEFEAT configquest: (#msg INFO) "+Text2)
	
EndFunction

Function DebugMessage(String Text2)		;#DebugMessage
	if ShowDebugMessages
	Debug.Notification("<font color='#00ffff'>"+Text2+"</font>")
	Debug.trace("NAKED DEFEAT configquest: (#msg DEBUG) "+Text2)
	endif
EndFunction
	
Function NymMessage(String Text2)		;#NymMessage
	if IsNymrasGame()
	Debug.Notification("<font color='#0048ba'>"+Text2+"</font>")
	Debug.trace("NAKED DEFEAT configquest: (#msg NYM) "+Text2)
	endif
EndFunction

Function NymTrace(String Text2)		;#NymTrace
	if IsNymrasGame()
	;Debug.Notification("<font color='#0048ba'>"+Text2+"</font>")
	Debug.trace("NAKED DEFEAT configquest: (#trace NYM) "+Text2)
	endif
EndFunction


Function RealWaiting(float WaitTime)

float ftimeStart = Utility.GetCurrentRealTime()
float ftimeCurrent = 0

;ScreenMessage("ftimeStart = "+ftimeStart)

while ModEnabled && (ftimeCurrent < (ftimeStart + WaitTime))
Utility.Wait(0.5)
ftimeCurrent = Utility.GetCurrentRealTime()
endwhile

;ScreenMessage("ftimeCurrent = "+ftimeCurrent)

EndFunction
	
Bool Function IsArrestedPOP()

if ModPOP 
	if StorageUtil.GetIntValue(PlayerRef, "xpoPCArrestStart") > 0 
	Debug.Trace("NAKED DEFEAT - PrisonerStatus.A")
	ShowDebugNotification("NAKED DEFEAT - arrest start")
	return true
	elseif StorageUtil.GetIntValue(PlayerRef, "xpoPCArrested") > 0 
	Debug.Trace("NAKED DEFEAT - PrisonerStatus.B")
	ShowDebugNotification("NAKED DEFEAT - arrested")
	return true
	elseif StorageUtil.GetIntValue(PlayerRef, "xpoPCinJail") > 0 
	Debug.Trace("NAKED DEFEAT - PrisonerStatus.C")
	ShowDebugNotification("NAKED DEFEAT - imprisoned")
	return true
	endif
else
return false
endif

EndFunction

int DefeatFuckBeltAdded
Armor[] Property DefeatFuckBelts Auto

int Property GracePeriod Auto

Function AddFuckBelt()			;#belt

	if Allow_FuckBelts_TOGGLE
		int x = Utility.RandomInt(1,4) 
		PlayCuffsSoundMetal()
		
		;add belt
		PlayerRef.AddItem(DefeatFuckBelts[x], 1, true) 			
		PlayerRef.EquipItem(DefeatFuckBelts[x], false, true)
		DefeatFuckBeltAdded = x
	endif 	

	if Allow_FuckDildo_TOGGLE
		;add dildo	
		SendModEvent("Moan")	
		PlayerRef.AddItem(DefeatFuckBelts[0], 1, true) 
		PlayerRef.EquipItem(DefeatFuckBelts[0], false, true)
		BoolCaptiveFuckBelt = true
	endif 
	
EndFunction

Function RemoveFuckBelt()

	;remove dildo
	SendModEvent("Moan")	
	PlayerRef.UnequipItem(DefeatFuckBelts[0], 0, 1)
	PlayerRef.RemoveItem(DefeatFuckBelts[0], 1, true, None)
	
	;remove belt
	PlayerRef.UnequipItem(DefeatFuckBelts[DefeatFuckBeltAdded], 0, 1)	
	PlayerRef.RemoveItem(DefeatFuckBelts[DefeatFuckBeltAdded], 1, true, None)
	DefeatFuckBeltAdded = 0

	BoolCaptiveFuckBelt = false

EndFunction




;--------------------------------------------------------------------------------

int DefeatClothingAdded = 0

Function AddDefeatClothing()

;	if NymBETA && (Game.GetModByName("TBD - NiseKardiaArmor.esp") != 255) && D100(25)
;		Armor KardiaArmor = (Game.GetFormFromFile(0x00000D64, "TBD - NiseKardiaArmor.esp") As Armor)
;		PlayerRef.AddItem(KardiaArmor, 1, true)			;rope
;		PlayerRef.EquipItem(KardiaArmor, false, true)
	
;	if D100(50)		;NOT WORKING YET
;	LoadOutfitPunishment(Utility.RandomInt(1,5))
;	else 		
	DefeatClothingAdded = Utility.RandomInt(0,3)
	PlayerRef.AddItem(DefeatClothingNew[DefeatClothingAdded], 1, true)			;rope
	PlayerRef.EquipItem(DefeatClothingNew[DefeatClothingAdded], false, true)
;	endif
	
EndFunction	

Function RemoveDefeatClothing()
PlayerRef.RemoveItem(DefeatClothingNew[DefeatClothingAdded], 1, true, None)
EndFunction

int DefeatGagAdded = 0
;DefeatGagAdded = 0: nade_GagMulti01Anim "nade_Gag Multi01 Anim" [ARMO:07005A69]
;DefeatGagAdded = 1: nade_GagRing01 "nade_Gag Ring" [ARMO:07005A6A]
;DefeatGagAdded = 2: nade_GagWoodBit "nade_Gag Wood Bit" [ARMO:07005A68]
;DefeatGagAdded = 3: nade_GagLogBit01 "nade_Gag Log Bit 01" [ARMO:07005A6E]
;DefeatGagAdded = 4: nade_GagHarnessPanel01 "nade_DD Gag Harness Panel 01" [ARMO:07005A6F]

	
Function AddDefeatGags()

	;DefeatGagAdded = Utility.RandomInt(0,4)
	DefeatGagAdded = 3
	Debug.Trace("Naked Defeat configquest: AddDefeatGags(): DefeatGagAdded: "+DefeatGagAdded)
	PlayerRef.AddItem(DefeatGagsNew[DefeatGagAdded], 1, true)			;rope
	PlayerRef.EquipItem(DefeatGagsNew[DefeatGagAdded], false, true)
	Gagged = true
EndFunction

Function RemoveDefeatGags()
PlayerRef.RemoveItem(DefeatGagsNew[DefeatGagAdded], 1, true, None)
Gagged = false
EndFunction

Keyword[] Property KeywordsArmorClothing Auto



Bool Function IsItem(String sKeyword, Form fForm )		;#IsItem()

NymTrace("IsItemStart: "+sKeyword)
Armor TempArmor
Form TempForm = fForm

if IsNymrasGame() && !KeywordsArmorClothing[0]

Debug.MessageBox("ERROR Keyword is NONE") 

endif 

	Form fWornItem = fForm 

	if sKeyword == "Armor Type Clothing"
		
			if fWornItem.HasKeyword(KeywordsArmorClothing[0])
			NymTrace("ItemIs Clothing")
			return true 
			else
			return false 
			endif 
	elseif sKeyword == "Armor Type Light"
	
	
		if fWornItem.HasKeyword(KeywordsArmorClothing[1])

		NymTrace("ItemIs Light Armor")
		return true 
		else
		return false 
		endif 

	elseif sKeyword == "Armor Type Heavy"
	
		if fWornItem.HasKeyword(KeywordsArmorClothing[2])
		NymTrace("ItemIs Heavy Armor")
		return true 
		else
		return false 
		endif 

	elseif 	sKeyword == "Armor Helmet"
		if fWornItem.HasKeyword(KeywordsArmorClothing[3])
		NymTrace("ItemIs Helmet")
		return true 
		else
		return false 
		endif 
	elseif 	sKeyword == "Armor Cuirass"
		if fWornItem.HasKeyword(KeywordsArmorClothing[4])
		NymTrace("ItemIs Cuirass")
		return true 
		else
		return false 
		endif 
	elseif 	sKeyword == "Armor Boots"
		if fWornItem.HasKeyword(KeywordsArmorClothing[5])
		NymTrace("ItemIs Boots")
		return true 
		else
		return false 
		endif 
	elseif 	sKeyword == "Armor Gauntlets"
		if fWornItem.HasKeyword(KeywordsArmorClothing[6])
		NymTrace("ItemIs Gauntlets")
		return true 
		else
		return false 
		endif 
	elseif 	sKeyword == "Jewelery"
		if fWornItem.HasKeyword(KeywordsArmorClothing[7])
		NymTrace("ItemIs Jewelry")
		return true 
		else
		return false 
		endif 
	elseif 	sKeyword == "Clothes Head"
		if fWornItem.HasKeyword(KeywordsArmorClothing[8])
		NymTrace("ItemIs Clothes Head")
		return true 
		endif 
	elseif 	sKeyword == "Clothes Body"
		if fWornItem.HasKeyword(KeywordsArmorClothing[9])
		NymTrace("ItemIs Clothes Body")
		return true 
		else
		return false 
		endif 
	elseif sKeyword == "Clothes Hands"
		if fWornItem.HasKeyword(KeywordsArmorClothing[10])
		NymTrace("ItemIs Clothes Hands")
		return true 
		else
		return false 
		endif  
	elseif sKeyword == "Clothes Feet"
		if fWornItem.HasKeyword(KeywordsArmorClothing[11])
		NymTrace("ItemIs Clothes Feet")
		return true 
		else
		return false 
		endif  
	elseif sKeyword == "Clothes Type Rich"
		if fWornItem.HasKeyword(KeywordsArmorClothing[12])
		NymTrace("ItemIs Rich Clothes")
		return true 
		else
		return false 
		endif 
	elseif sKeyword == "Clothes Type Poor"
		if fWornItem.HasKeyword(KeywordsArmorClothing[13])
		NymTrace("ItemIs Poor Clothes")
		return true 
		else
		return false 
		endif  
		
	elseif sKeyword == "Bikini Bottom"
	
		TempArmor = fWornItem as armor	
		
		if (TempArmor.GetSlotMask() == 4194304) && (PO3_SKSEFunctions.GetFormModName(fWornItem, false) == "The Amazing World of Bikini Armors REMASTERED.esp")
		NymTrace("ItemIs Bikini Bottom")
		return true 
		else
		return false 
		endif  	
		
	else 
		NymTrace("IsItem NOTHING")
		return false
	endif 

EndFunction






;/

ArmorClothing [KYWD:0006BBE8]		0
ArmorLight [KYWD:0006BBD3]			1
ArmorHeavy [KYWD:0006BBD2]			2

ArmorHelmet [KYWD:0006C0EE]			3
ArmorCuirass [KYWD:0006C0EC]		4
ArmorBoots [KYWD:0006C0ED]			5
ArmorGauntlets [KYWD:0006C0EF]		6


ArmorJewelry [KYWD:0006BBE9]		7

ClothingHead [KYWD:0010CD11]		8
ClothingBody [KYWD:000A8657]		9
ClothingHands [KYWD:0010CD13]		10
ClothingFeet [KYWD:0010CD12]		11

ClothingRich [KYWD:000A865D]  		12
ClothingPoor [KYWD:000A865C]		13

ArmorShield [KYWD:000965B2]

WeapTypeBattleaxe [KYWD:0006D932]
WeapTypeBow [KYWD:0001E715]
WeapTypeDagger [KYWD:0001E713]
WeapTypeGreatsword [KYWD:0006D931]
WeapTypeMace [KYWD:0001E714]
WeapTypeStaff [KYWD:0001E716]
WeapTypeSword [KYWD:0001E711]
WeapTypeWarAxe [KYWD:0001E712]
WeapTypeWarhammer [KYWD:0006D930]


/; 







;----------------------------------------------------------------------------------------

Bool Property DefeatViaSlavery Auto
string LocType = "none"
int Property Loc Auto
int Property LocH Auto
int LocH
bool Property SlaveryHostile Auto


;SLOWLY REPLACE THIS BY LOCATIONEVENT

Function StartSimpleSlaveryHostile()		;#SSh		#StartSimpleSlaveryHostile()
;This transfers the Player to a different location
;in this case also to the AFTERLIFE Location... maybe we should change this whole mechanice and order of function somewhat for future ease of use.

Debug.Trace("Naked Defeat configquest: StartSimpleSlaveryHostile()")
	string FloorType = "none"	
	
	NymTrace("Immobilize(true) for SS Hostile 0")
	Immobilize(true)
	ObjectReference LocHostile
	
	AddVictimsToCalmFactions(true)
	
	SlaveryHostile = true

	;avoid starting combat in the first place?
	if !PlayerRef.IsInFaction(nade_DefeatFaction)
	PlayerRef.AddToFaction(nade_DefeatFaction)
	endif
	
	bool EnableCreatureLocations = false
	
	;AFTERLIFE Locations >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
	if DefeatTypeScenario == "Afterlife"
		DebugTrace("Afterlife Location: HELL")
		
		SendWashPlayerEvent()
		if folqst.Actor_Follower01
		SendModEvent_BiS_WashActor(folqst.Actor_Follower01)
		endif 
		if folqst.Actor_Follower02
		SendModEvent_BiS_WashActor(folqst.Actor_Follower02)
		endif 
		; LocHostile = (Game.GetFormFromFile(0x00104304, "Skyrim.esm") As ObjectReference) BUGGED :(
		;PlayerRef.MoveTo(LocHostile)
		;RotatePC(80)		
		;PlayerRef.MoveTo(PlayerRef, -100.0 * Math.Sin(PlayerRef.GetAngleZ()), -100.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
		
		;SkyHavenTemple 	 ;#SE WORKS 		
		LocHostile = (Game.GetFormFromFile(0x000E6803, "Skyrim.esm") As ObjectReference)		; - X MARKER 
		PlayerRef.MoveTo(LocHostile)
		;was 270
		PlayerRef.MoveTo(PlayerRef, 235.0 * Math.Sin(PlayerRef.GetAngleZ()+90.0), 235.0 * Math.Cos(PlayerRef.GetAngleZ()+90.0), PlayerRef.GetHeight() +100.0, abMatchRotation = true) 
		RotatePC(105) ;initial angle 		
		RotatePC(85)	;facing to the RIGHT --- less is rotating left 
		
		FloorType = "none"
		LocType = "hell"
		
		
		;---------------------------------
		;/NEED NEW HELL LOCATION 
		
		Elsweyr - nice, fr scenario nutzen.  (Random closed off stone room; sometimes you may find M'aiq the Liar there).
		DLC2DremoraShop stupid NPC... but nice cave (Interior test cell, has Demora Merchant, Butler, and a chest).
		DLC2RRHoldingCell (Empty room, only contains a single unlocked empty safe). similar to Elsywer
		testGiant 	giant hall, quite nice actually		(Similar to above, contains a few items in middle of main room). 
		
		NICE >>>> has bandits.... E3demoBleakFallsBarrow (Same as real barrow, but all all zones are in a single cell).
		
		NICE FOR TESTIN TRAPS WarehouseTraps (Contains a large area with traps). #traps
		
		vampireDreamworld01 nice little room. maybe house slave quest
		
		COC SkyHavenTempleEntrance   .... best for now
		COC SkyHavenTemple ON THE TABLE NICE
		
		COC Twilight Sepulcher01 TEST --- not ideal but ...
		
		/;
		
			
		;if IsNymrasGame()
		;PlaceFloor("remove")
		;endif 
			
		;Dead = 0	;we are alive again <<--- no, keep until fade in.
		
		;if IsNymrasGame() 
		;Debug.Messagebox("#ERROR-666 we should still be dead - DefeatStatePlayer: "+DefeatStatePlayer) 
		;endif 
		
		;DefeatStatePlayer = "None" ;<<---- we are alive again 
	
	;CREATURE Locations >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
	elseif EnableCreatureLocations && AllowCreatures && D100(50)
		Debug.Trace("Naked Defeat configquest: StartSimpleSlaveryHostile() - Creatures: Location: "+loc)
		
		LocH = Utility.RandomInt(1,2)
			
	;	if NymBETA 
	;	LocH = 1 ;TESTING
	;	endif
		
		if LocH == 1	 ;Broken Fang Cave (Undead) #SE UPDATED (ALLOW FIND SPOT) 
		DebugTrace("SS Location: BROOD COVERN")
		LocHostile = (Game.GetFormFromFile(0x0002AE5A, "Skyrim.esm") As ObjectReference)
		PlayerRef.MoveTo(LocHostile)
		;PlayerRef.MoveTo(PlayerRef, -100.0 * Math.Sin(PlayerRef.GetAngleZ()), -100.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
		FloorType = "none"
		LocType = "monsters"

		elseif LocH == 2	 ;SIGHTLESS PIT (Falmer)	#SE UPDATED (WAS OK)					check position
		DebugTrace("SS Location: SIGHTLESS PIT")
		LocHostile = (Game.GetFormFromFile(0x000874AB, "Skyrim.esm") As ObjectReference)
		PlayerRef.MoveTo(LocHostile)
		PlayerRef.MoveTo(PlayerRef, 200.0 * Math.Sin(PlayerRef.GetAngleZ()), 200.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
		FloorType = "none"
		LocType = "falmers"

		endif

	;HUMAN Locations	>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
	else
	
		String LocationType = "none"
		
		int i = Utility.RandomInt(1,2)

		if IsNymrasGame() && DebugPunishmentType > 0
		i = 1
		endif		
		
		if i == 1
		LocationType = "Bandits"
		elseif i == 2
		LocationType = "Mix"
		endif
		
		
		
		if IsNymrasGame() && (DebugPunishmentType > 0)
		;Debug.Messagebox("DEBUG: Scenario selected: "+scenario)
		;Loc = DebugPunishmentType as int 
		;Debug.Messagebox("DEBUG: Hostile Human Location selected: "+DebugPunishmentType)	
		endif
		
		
		;if NymBETA && (DebugPunishmentType > 0)
		;LocH = DebugPunishmentType as int ;TESTING
		;endif
		
	;	if IsNymrasGame() ;&& DebugPunishmentType > 0
	;	LocationType = "Bandits" 
	;	endif 
		
	
		if LocationType == "Bandits"
	
			LocH = Utility.RandomInt(1,9)
		
			if LocH == 4	;LIARS RETREAT is problematic (issue with the fucking falmer showing up there, wtf
			LocH == 5
			endif 
			
			if IsNymrasGame() && DebugPunishmentType > 0
		
			LocH = DebugPunishmentType as int
			DebugPunishmentType = 0
			endif 
				
			Debug.Trace("Naked Defeat configquest: StartSimpleSlaveryHostile() - Human Bandits: Location: "+LocH)
					
	
			
			; --- BANDIT SLAVE LOCATIONS -----------------------------------------------------------------------
			if LocH == 1		 ;WHITE RIVER WATCH (bandits) 	#SE UPDATED (WAS OK)			
			DebugTrace("SS Location: WHITE RIVER WATCH")
			LocHostile = (Game.GetFormFromFile(0x0008132F, "Skyrim.esm") As ObjectReference)
			PlayerRef.MoveTo(LocHostile)
			;PlayerRef.MoveTo(PlayerRef, 100.0 * Math.Sin(PlayerRef.GetAngleZ()), 100.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			FloorType = "cobblestoneLARGE"
			LocType = "Bandits"
			elseif LocH == 2	 ;SWINDLERS DEN (bandits)	#SE UPDATED (WAS OK)			
			DebugTrace("SS Location: SWINDLERS DEN")
			LocHostile = (Game.GetFormFromFile(0x000435DA, "Skyrim.esm") As ObjectReference)
			PlayerRef.MoveTo(LocHostile)
			;PlayerRef.MoveTo(PlayerRef, -150.0 * Math.Sin(PlayerRef.GetAngleZ()), -150.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			RotatePC(30.0)
			FloorType = "dirt"
			LocType = "Bandits"
			elseif LocH == 3	 ;REDORANS RETREAT (bandits)	#SE UPDATED (WAS OK)			
			DebugTrace("SS Location: REDORANS RETREAT")
			LocHostile = (Game.GetFormFromFile(0x0002B02F, "Skyrim.esm") As ObjectReference)
			PlayerRef.MoveTo(LocHostile)
			;PlayerRef.MoveTo(PlayerRef, 60.0 * Math.Sin(PlayerRef.GetAngleZ()), 60.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			FloorType = "dirt"
			LocType = "Bandits"
		;	elseif LocH == 4	 ;LIARS RETREAT (bandits)		Falmer & Bandits wtf			
		;	DebugTrace("SS Location: LIARS RETREAT")
		;	LocHostile = (Game.GetFormFromFile(0x000AA4FF, "Skyrim.esm") As ObjectReference)
		;	PlayerRef.MoveTo(LocHostile)
		;	PlayerRef.MoveTo(PlayerRef, -200.0 * Math.Sin(PlayerRef.GetAngleZ()), -200.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
		;	FloorType = "none"
		;	LocType = "Bandits"
;
			elseif LocH == 4 || LocH == 5	 ;Bilegulch Mine  (bandits)		#SE UPDATED (WAS OK)				
			DebugTrace("SS Location: Bilegulch Mine")
			LocHostile = (Game.GetFormFromFile(0x000EF02C, "Skyrim.esm") As ObjectReference)
			PlayerRef.MoveTo(LocHostile)
			;PlayerRef.MoveTo(PlayerRef, -200.0 * Math.Sin(PlayerRef.GetAngleZ()), -200.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			FloorType = "dirt"
			LocType = "Bandits"
			
			elseif LocH == 6	;Four Skull Lookout  (bandits)		#SE UPDATED (WAS OK)		
			DebugTrace("SS Location: Four Skull Lookout")
			LocHostile = (Game.GetFormFromFile(0x000B23AB, "Skyrim.esm") As ObjectReference)
			PlayerRef.MoveTo(LocHostile)
			RotatePC(270.0)
			FloorType = "none"
			LocType = "Bandits"							 
				
			elseif LocH == 7	 ;Faldar's Tooth  (bandits)			#SE UPDATED (WAS OK)		
			DebugTrace("SS Location: Faldar's Tooth")
			LocHostile = (Game.GetFormFromFile(0x00043706, "Skyrim.esm") As ObjectReference)
			PlayerRef.MoveTo(LocHostile)
			RotatePC(180.0)
			FloorType = "none"
			LocType = "Bandits"

			elseif LocH == 8	 ;Cragslane Cavern  (bandits)		#SE UPDATED (WAS OK)			
			DebugTrace("SS Location: Cragslane Cavern")
			LocHostile = (Game.GetFormFromFile(0x000E160E, "Skyrim.esm") As ObjectReference)
			PlayerRef.MoveTo(LocHostile)
			;PlayerRef.MoveTo(PlayerRef, -85.0 * Math.Sin(PlayerRef.GetAngleZ()), -85.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			FloorType = "dirt"
			LocType = "Bandits"
			
			elseif LocH == 9	 ;Embershard Mine  (bandits)		#SE UPDATED (WAS BAD)				TEST ROTATION
			DebugTrace("SS Location: Embershard Mine")
			;LocHostile = (Game.GetFormFromFile(0x000B6FF5, "Skyrim.esm") As ObjectReference)
			LocHostile = (Game.GetFormFromFile(0x000B6FFC, "Skyrim.esm") As ObjectReference)
			PlayerRef.MoveTo(LocHostile)
			;RotatePC(180.0)
			;PlayerRef.MoveTo(PlayerRef, 40.0 * Math.Sin(PlayerRef.GetAngleZ()), 40.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			FloorType = "none"
			LocType = "Bandits"
			
			elseif LocH == 10	 ;Cracked Tusk Keep  (bandits)						!!! NOT WORKING !TEST ROTATION
			DebugTrace("SS Location: Cracked Tusk Keep")
			LocHostile = (Game.GetFormFromFile(0x000696ED, "Skyrim.esm") As ObjectReference)	;TEMP STATIC!!!!!
			PlayerRef.MoveTo(LocHostile)
			RotatePC(120.0)
			FloorType = "none"
			LocType = "Bandits"
					
			elseif LocH == 10	 ;Fort Fellhammer  (bandits)						!!! NOT WORKING!! ! TEST ROTATION and Movement
			DebugTrace("SS Location: Fort Fellhammer")
			LocHostile = (Game.GetFormFromFile(0x000E65DF, "Skyrim.esm") As ObjectReference)	;TEMP STATIC!!!!
			PlayerRef.MoveTo(LocHostile)
			RotatePC(45.0)
			;PlayerRef.MoveTo(PlayerRef, 100.0 * Math.Sin(PlayerRef.GetAngleZ()), 100.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			FloorType = "none"
			LocType = "Bandits"
							
			elseif LocH == 11	;Broken Helm Hollow  (bandits)							!!! NOT WORKING!! ! TEST ROTATION
			DebugTrace("SS Location: Broken Helm Hollow")
			LocHostile = (Game.GetFormFromFile(0x0002AE50, "Skyrim.esm") As ObjectReference) ;TEMP STATIC!!!!
			PlayerRef.MoveTo(LocHostile)
			RotatePC(180.0)
			FloorType = "none"
			LocType = "Bandits"
			
			elseif LocH == 12	 ;Frostmere Crypt	  (bandits)							!!! NOT WORKING!! !TEST ROTATION and Movement
			DebugTrace("SS Location: Frostmere Crypt")
			LocHostile = (Game.GetFormFromFile(0x000B2EEF, "Skyrim.esm") As ObjectReference)
			;PlayerRef.MoveTo(PlayerRef, 50.0 * Math.Sin(PlayerRef.GetAngleZ()), 50.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			RotatePC(300.0)
			FloorType = "none"
			LocType = "Bandits"

			endif	

		elseif LocationType == "Mix"
			
			LocH = Utility.RandomInt(5,13)
			Debug.Trace("Naked Defeat configquest: StartSimpleSlaveryHostile() - Human Mix: Location: "+loc)
		
				if LocH == 5	 ;HOBS FALL CAVE (Undead/Necro)		#SE UPDATED (WAS BAD)			
				DebugTrace("SS Location: HOBS FALL CAVE")
				;LocHostile = (Game.GetFormFromFile(0x0002E693, "Skyrim.esm") As ObjectReference)
				LocHostile = (Game.GetFormFromFile(0x000C4D98, "Skyrim.esm") As ObjectReference)	;PATROL IDLE MARKER
				PlayerRef.MoveTo(LocHostile)
				;PlayerRef.MoveTo(PlayerRef, -100.0 * Math.Sin(PlayerRef.GetAngleZ()), -100.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
				FloorType = "none"
				LocType = "Necromancers"
				
				elseif LocH == 6	 ;SUNDERSTONE GORGE (Undead/Necro)	#SE UPDATED (WAS OK)	
				DebugTrace("SS Location: SUNDERSTONE GORGE")
				LocHostile = (Game.GetFormFromFile(0x0008B9A1, "Skyrim.esm") As ObjectReference)
				PlayerRef.MoveTo(LocHostile)
				;PlayerRef.MoveTo(PlayerRef, 100.0 * Math.Sin(PlayerRef.GetAngleZ()), 100.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
				FloorType = "none"
				LocType = "Necromancers"
				
				elseif LocH == 7	 ;FELLGLOW KEEP (Undead/Necro)		#SE UPDATED (WAS OK)
				DebugTrace("SS Location: FELLGLOW KEEP")
				LocHostile = (Game.GetFormFromFile(0x000CAF8C, "Skyrim.esm") As ObjectReference) ;XMarker SE
				PlayerRef.MoveTo(LocHostile)
				;PlayerRef.MoveTo(PlayerRef, 140.0 * Math.Sin(PlayerRef.GetAngleZ()+35), 140.0 * Math.Cos(PlayerRef.GetAngleZ()+35), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
				FloorType = "none"
				LocType = "Necromancers" ;more like mages/dark brotherhood?
				
				elseif LocH == 404	 ;DARK BROTHERHOOD SANCTUARY (Humans)	#SE UPDATED (WAS OK)	;DO NOT USEEE! QUESTLOCATION
				DebugTrace("SS Location: DARK BROTHERHOOD SANCTUARY")
				LocHostile = (Game.GetFormFromFile(0x00015CE8, "Skyrim.esm") As ObjectReference)
				PlayerRef.MoveTo(LocHostile)
				RotatePC(90.0)
				;PlayerRef.MoveTo(PlayerRef, 180.0 * Math.Sin(PlayerRef.GetAngleZ()), 180.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
				FloorType = "none"
				LocType = "Necromancers"
				
				elseif LocH == 8 || LocH == 9 ;MORVARTS LAIR (Humans)	;VAMPIRES			#SE UPDATED (WAS OK)
				DebugTrace("SS Location: MORVARTS LAIR")
				LocHostile = (Game.GetFormFromFile(0x0001F503, "Skyrim.esm") As ObjectReference)
				PlayerRef.MoveTo(LocHostile)
				;PlayerRef.SetAngle(0.0, 0.0, 80.0)
				;PlayerRef.MoveTo(PlayerRef, -180.0 * Math.Sin(PlayerRef.GetAngleZ()), -180.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
				FloorType = "dirt"
				LocType = "Undead" ;VAMPIRES
				
				elseif LocH == 10 ;UTTERING HILLS CAVE (BANDITS)			#SE UPDATED (WAS BAD)
				DebugTrace("SS Location: UTTERING HILLS CAVE")
				;LocHostile = (Game.GetFormFromFile(0x000C5682, "Skyrim.esm") As ObjectReference)
				LocHostile = (Game.GetFormFromFile(0x000C567F, "Skyrim.esm") As ObjectReference)	;PATROL IDLE MARKER
				PlayerRef.MoveTo(LocHostile)
				;RotatePC(180.0)
				;PlayerRef.MoveTo(PlayerRef, 50.0 * Math.Sin(PlayerRef.GetAngleZ()), 50.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
				FloorType = "none"
				LocType = "Bandits"
					
				elseif LocH == 11 ;LOST KNIFE CAVE? Dunno (B)		#SE UPDATED (WAS OK)
				DebugTrace("SS Location: LOST KNIFE CAVE")
				LocHostile = (Game.GetFormFromFile(0x00034C8E, "Skyrim.esm") As ObjectReference)
				PlayerRef.MoveTo(LocHostile)
				;PlayerRef.MoveTo(PlayerRef, 150.0 * Math.Sin(PlayerRef.GetAngleZ()+30), 150.0 * Math.Cos(PlayerRef.GetAngleZ()+30), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
				;PlayerRef.MoveTo(PlayerRef, 80.0 * Math.Sin(PlayerRef.GetAngleZ()), 80.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
				;PlayerRef.SetAngle(0.0, 0.0, 30.0)
				FloorType = "none"
				LocType = "Bandits"
				
				elseif LocH == 12 ;KARTHSPIRE (Humans)			#SE UPDATED (WAS OK)
				DebugTrace("SS Location: KARTHSPIRE")
				LocHostile = (Game.GetFormFromFile(0x00093A32, "Skyrim.esm") As ObjectReference)
				PlayerRef.MoveTo(LocHostile)
				;RotatePC(180.0)		
				;PlayerRef.MoveTo(PlayerRef, 100.0 * Math.Sin(PlayerRef.GetAngleZ()), 100.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
				FloorType = "none"
				LocType = "Bandits"
				
				elseif LocH == 13 ;RED EAGLE REDOUBT (Humans/Forsworn)	#SE UPDATED (WAS OK)
				DebugTrace("SS Location: RED EAGLE REDOUBT")
				LocHostile = (Game.GetFormFromFile(0x000C2933, "Skyrim.esm") As ObjectReference)
				PlayerRef.MoveTo(LocHostile)
				PlayerRef.MoveTo(PlayerRef, -280.0 * Math.Sin(PlayerRef.GetAngleZ()), -280.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
				;PlayerRef.SetAngle(0.0, 0.0, 180.0)
				FloorType = "none"
				LocType = "Bandits"
				endif
			endif	
	endif
	NymTrace("Immobilize(true) for SS Hostile A")
	Immobilize(true)
	
	Utility.Wait(1.0)
	
	;move followers
	if folqst.Actor_Follower01
	folqst.Actor_Follower01.MoveTo(LocHostile, 95.0 * Math.Sin(folqst.Actor_Follower01.GetAngleZ()+90), 95.0 * Math.Cos(folqst.Actor_Follower01.GetAngleZ())+90, folqst.Actor_Follower01.GetHeight() - 125.0, abMatchRotation = true)
	endif
	
	if folqst.Actor_Follower02
	folqst.Actor_Follower02.MoveTo(LocHostile, -95.0 * Math.Sin(folqst.Actor_Follower02.GetAngleZ()+90), 95.0 * Math.Cos(folqst.Actor_Follower02.GetAngleZ())+90, folqst.Actor_Follower02.GetHeight() - 125.0, abMatchRotation = true)
	endif	
	
	if folqst.Actor_Follower01
	folqst.Actor_Follower01.DamageActorValue("Health", 100000.0)
	endif
	
	if folqst.Actor_Follower02
	;folqst.Actor_Follower02.AddToFaction(nade_DefeatFaction)
	folqst.Actor_Follower02.DamageActorValue("Health", 100000.0)
	endif
	NymTrace("Immobilize(true) for SS Hostile B")
	Immobilize(true)
	
	if FloorType == "none"
	;do nothing
	else
	TillTouchdown()
	PlaceFloor(FloorType)
	PlayerRef.Moveto(PlayerRef)
	TillTouchdown()
	;Utility.Wait(1.0)
	endif
	NymTrace("Immobilize(true) for SS Hostile C")
	Immobilize(true)
;	calmqst.Vehicle("Setup")
	DefeatQuestRunning = true				;#0 -- THIS ORDER HAS TO BE KEPT!!!!!
	DefeatViaSurrender = true				;#1 ;BUT WHY 
	DefeatViaSlavery = true
	;RapeAgain = true
	;HarderDefeat = true ;fix difficulty elsewhere  ;with Lenienacy changes all anyway
	FirstStartUp = true						;#2    									
	
	;TempSender = "Via SS Hostile"
	SendModEvent("StartAllegianceQuest") ;#3
	
	PlayerSheatheWeapon()
	
	;Crawl(PlayerRef, true)
	
	if LocType == "Bandits"
	ScreenMessage("You are a fucktoy for the bandits now.")
	elseif LocType == "Humans"	
	ScreenMessage("You are a sex slave now.")
	elseif LocType == "trolls"
	ScreenMessage("The trolls will pump you full until you explode.")
	elseif LocType == "falmers"
	ScreenMessage("Human stock for the falmers is all you are now. Until they decide to eat you...")
	elseif LocType == "Hell"
	ScreenMessage("Demons and foul creatures will torture you now!")
	;elseif LocType == "camp"
	;ScreenMessage("The soldiers will pass you around... as long as they want.")
	;elseif LocType == "mine"
	;ScreenMessage("The miners will love digging into your holes...")
	endif
	
	;change DefeatType manually here based on LocType
	if (LocType == "Humans") 
	DefeatType = "Humans"
	DefeatTypeGeneral = "AreHumans"
	AreBandits = false
	;SpawnRapers("random", false)
;	Utility.Wait(1.0)
	
	elseif (LocType == "Bandits") 
	DefeatType = "Bandits"
	DefeatTypeGeneral = "AreHumans"
	
	elseif (LocType == "Necromancers")
	AreBandits = false
	DefeatType = "Undead"
	DefeatTypeGeneral = "AreHumans"	
	elseif (LocType == "falmers")
	DefeatType = "Falmers"
	DefeatTypeGeneral = "AreHumanoids"
	elseif (LocType == "Hell")
	AreBandits = false
	DefeatType = "Hell"
	DefeatTypeGeneral = "AreHumanoids"
	DefeatTypeScenario = "Afterlife"
	endif
	;#todo
	NymTrace("Immobilize(true) for SS Hostile D")
	Immobilize(true)
	Utility.Wait(3.0)
	
	;need to check CrimeGold here or the GuardDialogue starts.
	;IMPORTANT: how do settings for this in MCM?
	;Option to Disable Crime Gold Managenemnt (at own risk?)
	ProcessCrimeGold()
	
	
	
	if DefeatTypeScenario == "Afterlife"
	StartScenarioAfterlife()
	else
		
		While (CalmQuest.GetStage() > 0) && (CalmQuest.GetStage() < 1000) && ModEnabled
		Debug.Trace("NAKED DEFEAT configquest: Waiting for Calmquest to End (Hostile)")
		Utility.Wait(1.5)
		EndWhile 
		Utility.Wait(1.0)
	
	DefeatEntranceVia = "Sold as Slave"	
	StartDefeat()
	endif
	
EndFunction


Function RotatePC(float angle)

	float PlayerAngleZ

	PlayerAngleZ = (PlayerRef.GetAngleZ())
	PlayerAngleZ += angle
	PlayerRef.SetAngle(0.0, 0.0, PlayerAngleZ)
EndFunction

Function RotateActor(actor akactor, float angle)
	;actors are always rotated somehow, so we need to get their starting rotation (like 93 from 0) to then rotate relative to that
	float akactorAngleZ

	akactorAngleZ = (akactor.GetAngleZ())
	akactorAngleZ += angle
	akactor.SetAngle(0.0, 0.0, akactorAngleZ)
EndFunction

Function RotateObject(ObjectReference akObject, float angle)
	;actors are always rotated somehow, so we need to get their starting rotation (like 93 from 0) to then rotate relative to that
	float akObjectAngleZ

	akObjectAngleZ = (akObject.GetAngleZ())
	akObjectAngleZ += angle
	akObject.SetAngle(0.0, 0.0, akObjectAngleZ)
EndFunction




Function PlayerBuffsMaintenance()  ;#PlayerBuffsMaintenance() #buffs
	
	;only for Nymra
	
	Float UnarmedDamageWANT = 10
	Float UnarmedDamageCurrent
	Bool NewBuffs = true
	if IsNymrasGame()
			
		if !IsDefeatRunning() && PlayerRef.IsInFaction(SexlabAnimatingFaction)	
		
			if !SexScene
			SendModEvent("StartNakedSexExpressions")		
			SexScene = true
			elseif SexScene
			SexScene = false
			endif 
		endif 
		UnarmedDamageCurrent = PlayerRef.GetAV("UnarmedDamage")
	;	NymTrace("UnarmedDamageCurrent: "+UnarmedDamageCurrent)
		
		;NEW SYSTEM
		if NewBuffs
		
			if UnarmedDamageCurrent != UnarmedDamageWANT
			 
				if IsPlayerNaked()
				UnarmedDamageWANT += 5
				endif 
				
				if IsPlayerCumsoaked()
				UnarmedDamageWANT += 5
				endif 
				
				if IsPlayerBarefoot()
				UnarmedDamageWANT += 5
				endif 
				
			PlayerRef.SetAV("UnarmedDamage", UnarmedDamageWANT)
			endif 
		
		;OLD SYSTEN 
		else 
			if IsPlayerNaked() ;&& !PlayerNaked
				if !PlayerNaked
				PlayerNaked = true
				UnarmedDamageWANT+=5
				endif 
			elseif PlayerNaked 
			PlayerNaked = false
			UnarmedDamageWANT-=5
			endif 
			
		;	if IsPlayerBarefoot()
		;	PlayerBarefoot
		;	RevengeValue+10
		;	endif 
			
		;	if IsPlayerCollared() && !PlayerCollared
		;	PlayerCollared = true
		;	RevengeValue+=5
		;	elseif PlayerCollared 
		;	PlayerCollared = false
		;	RevengeValue-=5
		;	endif 
			
			if IsPlayerCumsoaked() ;&& !PlayerCumsoaked
				if !PlayerCumsoaked
				PlayerCumsoaked = true
				UnarmedDamageWANT+=5
				endif 
			elseif PlayerCumsoaked 
			PlayerCumsoaked = false
			UnarmedDamageWANT-=5
			endif 
			
		PlayerRef.ModAV("UnarmedDamage", UnarmedDamageWANT)	
		endif 
		
		UnarmedDamageCurrent = PlayerRef.GetAV("UnarmedDamage")
		;NymTrace("#DAMAGE UnarmedDamageCurrent #DAMAGE: "+UnarmedDamageCurrent)
	endif 	


EndFunction


Bool Property PlayerBarefoot Auto
Bool Property PlayerNaked Auto
Bool Property PlayerCumsoaked Auto
Bool Property PlayerCollared Auto

Function PlayerSpeedMaintenance()		;#PlayerSpeedMaintenance()

	;if IsNymrasGame()	

	if PublicExposure == 0	;BAD place for this 
		;NymTrace("Heartbeat Stop - PlayerSpeedMaintenance")

		Sound.StopInstance(instanceID)
	endif 
;endif

	;--------- SPEED MAINTENANCE -------------------------------------------------	
	if IsNymrasGame() && !IsDefeatRunning() && !PlayerDownAlready
	;Debug.Trace("Naked Defeat configquest: WaitLoopPlayerMaintenance(SPEED MAINTENANCE)")
		
		
		Float PlayerSpeedMultCurrent = 0.0
		PlayerSpeedMultCurrent = PlayerRef.GetActorValue("SpeedMult")
		Float PlayerSpeedMultToSet = 100.0 
		
		;COMBAT SPEED 
		
		if PlayerInCombat()
		
			PlayerSpeedMultCurrent = PlayerSpeedMultToSet
				
			if PlayerBarefoot		
			;do nothing, we already applied the malus 
				if D100(5) ;barefoot trip chance

					Float f = 0.0
					if PlayerRef.IsRunning() 
					f = utility.RandomFloat(0.5, 2.0)
					PlayerRef.PushActorAway(PlayerRef, f)
					elseif PlayerRef.IsSprinting()
					f = utility.RandomFloat(2.0, 4.0)
					PlayerRef.PushActorAway(PlayerRef, f)
					endif 
				endif 
			
			elseif IsPlayerBarefoot() 
			;apply barefoot malus only once 
			PlayerBarefoot = true 
			PlayerSpeedMultToSet -= 20
			endif 			
		
		;NORMAL SPEED 		
				
		elseif IsDefeatRunning()
		
		;	PlayerSpeedMultToSet = 40.0
		else
				
			;barefoot slows down by 20 
			if IsPlayerBarefoot() 
			PlayerBarefoot = true
			PlayerSpeedMultToSet-=20.0
					
				if D100(5) ;barefoot trip chance

					Float f = 0.0
					if PlayerRef.IsRunning() 
					f = utility.RandomFloat(0.5, 2.0)
					PlayerRef.PushActorAway(PlayerRef, f)
					elseif PlayerRef.IsSprinting()
					f = utility.RandomFloat(2.0, 4.0)
					PlayerRef.PushActorAway(PlayerRef, f)
					endif 
				endif 
			else 
			PlayerBarefoot = false
			endif 
			
			;stamina potion speeds up by 10 
			if CheckDurationSpell("Magicka") 
			PlayerSpeedMultToSet+=10.0
			endif 
			
		endif 
		
		SetSpeedMultTo(PlayerSpeedMultToSet)
		
	endif 

EndFunction 

Bool JustLeftCombat = false 


Function ResetEnemies()
	Debug.Trace("Naked Defeat configquest: ResetEnemies(DefeatStatePlayer: "+DefeatStatePlayer+")")
	Enemy[0] = "none"
	Enemy[1] = "none"
	Enemy[2] = "none"
	Enemy[3] = "none"
	Enemy[4] = "none"
	Enemy[5] = "none"
;	NymMessage("Enemies: [0] "+Enemy[1]+" [1] "+Enemy[1]+" [2] "+Enemy[2]+" [3] "+Enemy[3]+" [4] "+Enemy[4]+" [5] "+Enemy[5]) 

EndFunction

Function WaitLoopPlayerMaintenance()		;#monitor 

		
	if IsNymrasGame()	
	PlayerSpeedMaintenance()
	PlayerBuffsMaintenance()
	endif 
	
	if PlayerRef.IsInCombat() 
		
	;	if JustLeftCombat
	;	JustLeftCombat = false 
	;	endif 
	
		if !PlayerIsInCombat
		;NymMessage("Entering Combat")	 
	;	NymMessage("Entering Combat: Enemies: [0] "+Enemy[1]+" [1] "+Enemy[1]+" [2] "+Enemy[2]+" [3] "+Enemy[3]+" [4] "+Enemy[4]+" [5] "+Enemy[5]) 
		
			if !PlayerBarefoot && IsPlayerBarefoot() 
			PlayerBarefoot = true 
			endif 

		DefeatStatePlayer == "Fighting"
		
		;	if IsNymrasGame()
		;	SendModEvent"StartProximityQuest")
		;scan enemies and stuff
		
		
		PlayerIsInCombat = true
		else
		PlayerIsInCombat = true
		endif 
	else 
	
		if PlayerIsInCombat
		PlayerIsInCombat = false 
		;	if !JustLeftCombat
			NymMessage("Leaving Combat") 
			;PlayerBarefoot = false 
		;	JustLeftCombat = true 
					
			if (DefeatStatePlayer == "Free") && !IsDefeatRunning()
			NymTrace(":::::::::::::::::::::::::::::::::: RESET ENEMIES (leaving Combat) ::::::::::::::::::::::::::::::::::")
			ResetEnemies()
			endif 
		endif 
	endif 

	if NakedTravel

		if !PlayerRef.HasMagicEffectWithKeyword(KWDLootCooldownEffect)
		Game.EnableFastTravel(False)
		elseif PlayerRef.HasMagicEffectWithKeyword(KWDLootCooldownEffect) 
		;Game.EnableFastTravel(False)
		SendModevent("Moan")
		ShockSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)
		SoundSpell.RemoteCast(PlayerRef, PlayerRef, PlayerRef)
		Game.EnableFastTravel()
		endif
	endif

EndFunction

String Function GetRandomLocation_Inn()

	String sLoc 
	int i = Utility.RandomInt(1,11)
	
	if i == 1
	sLoc = "Silverblood Inn"
	elseif i == 2
	sLoc = "Windpeak Inn"
	elseif i == 3
	sLoc = "Bees and Barbs"
	elseif i == 4
	sLoc = "Bannered Mare"
	elseif 	i == 5
	sLoc = "Drunken Huntsman"
	elseif i == 6
	sLoc = "Sleeping Giant Inn"
	elseif i == 7
	sLoc = "Candlehearth Hall"
	elseif i == 8
	sLoc = "Gnisis Corner Club"			
	elseif i == 9
	sLoc = "Dead Mans Drink"
	elseif i == 10
	sLoc = "Moorside Inn"
	elseif i == 11
	sLoc = "The Frozen Hearth"
	endIf
	
	Debug.Trace("Naked Defeat configquest: GetRandomLocation_Inn("+sLoc+")")
	return sLoc	
	
EndFunction

String Function GetRandomLocation_Bandits()

	String sLoc 
	int i = Utility.RandomInt(1,8)
	
	if i == 1
	sLoc = "White River Watch"
	elseif i == 2
	sLoc = "Swindler's Den"
	elseif i == 3
	sLoc = "Redoran's Retreat"
	elseif i == 4
	sLoc = "Bilegulch Mine"
	elseif 	i == 5
	sLoc = "Four Skull Lookout"
	elseif i == 6
	sLoc = "Cragslane Cavern"
	elseif i == 7
	sLoc = "Faldar's Tooth"
	elseif i == 8
	sLoc = "Embershard Mine"		
	endIf

	Debug.Trace("Naked Defeat configquest: GetRandomLocation_Bandits("+sLoc+")")
	return sLoc
	
EndFunction


String Function GetRandomLocation_Street()

	String sLoc 
	int i = Utility.RandomInt(1,13)
	
	if i == 1
	sLoc = "Street in Winterhold"
	elseif i == 2
	sLoc = "Street in Markarth"
	elseif i == 3
	sLoc = "Street in Morthal"
	elseif i == 4
	sLoc = "Street in Winterhold"
	elseif 	i == 5
	sLoc = "Street in Old Hroldan"
	elseif i == 6
	sLoc = "Street in Riften"
	elseif i == 7
	sLoc = "Street in Rorikstead"
	elseif i == 8
	sLoc = "Street in Whiterun"			
	elseif i == 9
	sLoc = "Street in DawnStar"
	elseif i == 10
	sLoc = "Street in Falkreath"
	elseif i == 11
	sLoc = "Street in Whiterun"
	elseif i == 12
	sLoc = "Street in Ivarstaed"
	elseif i == 13
	sLoc = "Street in Karthwasten"	
	endIf

	Debug.Trace("Naked Defeat configquest: GetRandomLocation_Street("+sLoc+")")
	return sLoc
	
EndFunction

String Function GetRandomLocation_Nobility()

	String sLoc 
	int i = Utility.RandomInt(1,6)
	
	if i == 1
	sLoc = "Castle Dour Solitude"
	elseif i == 2
	sLoc = "Palace of the Kings Windhelm"
	elseif i == 3
	sLoc = "Jarl Longhouse Winterhold" 
	elseif i == 4
	sLoc = "Blue Palace Solitude"
	elseif 	i == 5
	sLoc = "Jarl Longhouse Falkreath"
	elseif i == 6
	sLoc = "White Hall Dawnstar"
	endIf
	Debug.Trace("Naked Defeat configquest: GetRandomLocation_Nobility("+sLoc+")")
	return sLoc
	
EndFunction

String Function GetRandomLocation_Vampires()
	
	String sLoc 
	int i = Utility.RandomInt(1,5)
	
	if i == 1
	sLoc = "Broken Fang Cave"
	elseif i == 2
	sLoc = "Bloodlet Throne"
	elseif i == 3
	sLoc = "Movarths Lair" 
	elseif i == 4
	sLoc = "Pinemoon Cave"
	elseif 	i == 5
	sLoc = "RedWater Den"
	endIf
	Debug.Trace("Naked Defeat configquest: GetRandomLocation_Vampires("+sLoc+")")
	sLoc = sLoc
	
EndFunction


String Function GetRandomLocation_Wilderness()

	String sLoc 
	int i = Utility.RandomInt(1,19)
	
	if i == 1
	sLoc = "Clearspring Tarn"
	elseif i == 2
	sLoc = "Markarth Slope"
	elseif i == 3
	sLoc = "Clearpine Pond"
	elseif i == 4
	sLoc = "The Towerstone"
	elseif 	i == 5
	sLoc = "The Serpent Stone"
	elseif i == 6
	sLoc = "The Steed Stone"
	elseif i == 7
	sLoc = "Northern Beach"
	elseif i == 8
	sLoc = "Deep Folk Crossing"			
	elseif i == 9
	sLoc = "The Lover Stone"
	elseif i == 10
	sLoc = "Sky Haven Temple"
	elseif i == 11
	sLoc = "Reachwind Overlook"
	elseif i == 12
	sLoc = "Bards Leap Summit"
	elseif i == 13
	sLoc = "Evergreen Grove"
	elseif i == 14
	sLoc = "Random Mountain"
	elseif i == 15
	sLoc = "Ruins of Bthalft"
	elseif i == 16
	sLoc = "The Shadow Stone"
	elseif i == 17
	sLoc = "Giant's Grove"
	elseif i == 18
	sLoc = "The Atronach Stone"
	elseif i == 19
	sLoc = "Mara's Eye Pond"	
	endIf
	
	Debug.Trace("Naked Defeat configquest: GetRandomLocation_Wilderness("+sLoc+")")
	sLoc = sLoc
	
	
EndFunction


Function CreateModEvent(String sEventName, String sEventType)

    int handle = ModEvent.Create(sEventName)
    if (handle)
		ModEvent.PushForm(handle, self)
      ;  ModEvent.PushForm(handle, someOtherForm)
       ; ModEvent.PushInt(handle, 1000)
		ModEvent.PushString(handle, sEventName)
        ModEvent.PushString(handle, sEventType)
        ModEvent.Send(handle)
    endIf
EndFunction



Event OnNakedDefeatTransition(Form Sender, string sEventName, string sEventType)

;we use this to start other mods now while Naked Defeat shuts down in the background.
;THIS IS A CORE BRIDGE FUNCTION NOW; EVERYTHING HAS TO BE FUNNELED THROUGH HERE 
	
	NymTrace("OnNakedDefeatTransition(START)")
	NymTrace("sEventName "+sEventName)
	NymTrace("sEventType "+sEventType)
	;NymTrace("eventName" +eventName)
	while (CalmQuest.GetStage() > 0) && (CalmQuest.GetStage() < 1000) && ModEnabled		;WAIT FOR CALMQUEST TO FINISH ---> IMPORTANT
	Utility.Wait(1.0)
	endwhile 
	
	if sEventType == "Simple Slavery Entry"
	SendModEvent("SSLV Entry")	
	else 
	LocationEvent(sEventType)
	endif 
	
EndEvent 

Function LocationEvent(String sEventType)			;##LocationEvent
	NymTrace("LocationEvent(START)")		
	;this Function gets us a Location based on the Event. Sometimes we pick only 1 (Afterlife) or from dozens (Bandits)	
		
	;NEED Strike Anims when arriving
	int i 
	String sTempLoc
	bool bDoEnslave = false
	DefeatTypeGeneral = "empty"
	
	;Aftermath FastTravel   ---  teleport and we are naked but free (and surrounded by bandits)
	if sEventType == "Teleport Misshap"
	
	;StartRobberyAtLocation()
		
		i = Utility.RandomInt(1,4)
		if i == 1
		sTempLoc = GetRandomLocation_Vampires()
		elseif i > 1
		sTempLoc = GetRandomLocation_Bandits()
		endif 

	;Afterlife (Hell)
	elseif sEventType == "Afterlife"			
	;sTempLoc = (Game.GetFormFromFile(0x000E6803, "Skyrim.esm") As ObjectReference)		; - X-MARKER 
	NymTrace("LocationEvent(Afterlife)")	
	sTempLoc = "Afterlife"
	DefeatTypeScenario = "Afterlife"
	;:LocHostile = (Game.GetFormFromFile(0x000E6803, "Skyrim.esm") As ObjectReference)	
	
	;Aftermath Rescued 		---  teleport and we are free
	elseif sEventType == "Rescued"
	
		if D100(20)
		GetRandomLocation_Wilderness()
		else
			if calmqst.GetRegion() == "Region The Reach - Markarth"
			sTempLoc = "Silverblood Inn"
			elseif calmqst.GetRegion() == "Region The Pale - Dawnstar"
			sTempLoc = "Windpeak Inn"
			elseif calmqst.GetRegion() == "Region The Rift - Riften"
			sTempLoc = "Bees and Barbs"
			elseif calmqst.GetRegion() == "Region Whiterun"
				i = Utility.RandomInt(1,3)
				if i == 1
				sTempLoc = "Bannered Mare"
				elseif i == 2
				sTempLoc = "Drunken Huntsman"
				elseif i == 3
				sTempLoc = "Sleeping Giant Inn"				
				endif
			elseif calmqst.GetRegion() == "Region Eastmarch - Windhelm"
				i = Utility.RandomInt(1,2)
				if i == 1
				sTempLoc = "Candlehearth Hall"
				elseif i == 2
				sTempLoc = "Gnisis Corner Club"			
				endif
			elseif calmqst.GetRegion() == "Region Falkreath"
			sTempLoc = "Dead Mans Drink"
			elseif calmqst.GetRegion() == "Region Hjaalmarch - Morthal"
			sTempLoc = "Moorside Inn"
			elseif calmqst.GetRegion() == "Region Winterhold"
			sTempLoc = "The Frozen Hearth"
			elseif calmqst.GetRegion() == "Region Unknown"
			GetRandomLocation_Inn()
			endif 
		endif 
		
	;Aftermath Wake up In Wilderness	
	elseif sEventType == "Wake up in the Wilderness"	

		GetRandomLocation_Wilderness()

	;Slavery Public
	elseif sEventType == "Slavery Public"
		DefeatEntranceVia = "Sold as Public Slave"
		bDoEnslave = true
		i = Utility.RandomInt(1,2)
		if i == 1
		sTempLoc = GetRandomLocation_Inn()
		elseif i == 2
		sTempLoc = GetRandomLocation_Nobility()
		elseif i == 3
		sTempLoc = GetRandomLocation_Street()	
		endif 
		
	;Slavery Hostile
	elseif sEventType == "Slavery Hostile"
		DefeatEntranceVia = "Sold as Slave"
		bDoEnslave = true
		
		i = Utility.RandomInt(1,4)
		if i == 1
		sTempLoc = GetRandomLocation_Vampires()
		elseif i > 1
		sTempLoc = GetRandomLocation_Bandits()
		endif 		

	endif 

	; --- FINAL STEP --- ;
	
	MoveActorToLocation(PlayerRef, sTempLoc, bDoEnslave)
	if bDoEnslave && DefeatTypeGeneral == "empty"
	
	DefeatTypeGeneral = "AreHumans"
	endif 

EndFunction


Function ResetPlayer()

	if PlayerRef.IsInFaction(DownedFaction)
	PlayerRef.RemoveFromFaction(DownedFaction)
	endif
	
	if PlayerRef.IsInFaction(nade_DefeatFaction)
	PlayerRef.RemoveFromFaction(nade_DefeatFaction)
	endif 
	
	if SPE_Actor.IsActorCalmed(PlayerRef)
	SPE_Actor.SetActorCalmed(PlayerRef, false)
	endif 

EndFunction 

Function MoveActorToLocation(Actor akActor, String sLocation, bool bEnslave)	;#Location ;#Library
	;ALWAYS USE Ref Form!!!! NOT #BaseID
	Objectreference TempLoc
	String TempFloor
	int iRotation
	
	if sLocation == "Afterlife"
	TempLoc = (Game.GetFormFromFile(0x000E6803, "Skyrim.esm") As Objectreference)		;SkyHavenTemple XMarker 	;PC positioning is done in the end. Follower Positions are done in calmquest with vehicle
		
		bool WasRagdolling = false
		int t = 0
		while Ragdolling		;#ragdoll
		WasRagdolling = true
		Debug.trace ("NAKED DEFEAT configquest: RAGDOLLING A")
		Utility.Wait(1.0)
		t += 1
			if t == 5 
			("NAKED DEFEAT configquest: RAGDOLLING too long -> Fix")
			KeyFixBleedout()
			t = 0
			endif 
		endwhile
		
		if WasRagdolling
		Utility.Wait(4.0)
		endif 
		
		while Ragdolling		;#ragdoll
		;WasRagdolling = true
		Debug.trace ("NAKED DEFEAT configquest: RAGDOLLING B")
		Utility.Wait(1.0)
		t += 1
			if t == 5 
			KeyFixBleedout()
			t = 0
			endif 
		endwhile
	
	TempFloor = "empty"
	iRotation = 0	
	
	;>>>>>>>>>>>>> Roadside Travel Fun >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>	
	elseif sLocation == "Roadside Riften Bridge"
	TempLoc = (Game.GetFormFromFile(0x000A27A1, "Skyrim.esm") As Objectreference)		;XMarkerHeading
	TempFloor = "empty"
	iRotation = 0	
	
	elseif sLocation == "Roadside Riften Tower"
	TempLoc = (Game.GetFormFromFile(0x000CF376, "Skyrim.esm") As Objectreference)		;COCMarkerHeading
	TempFloor = "empty"
	iRotation = 0	
	
	;>>>>>>>>>>>>> Mix >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>	

	elseif sLocation == "Solitude Watch Tower"
	TempLoc = (Game.GetFormFromFile(0x0002009B, "Skyrim.esm") As Objectreference)		;Xmarker - works as is with 2 Followers - spawn "Friends"
	TempFloor = "empty"
	iRotation = 0	

	;>>>>>>>>>>>>> INNs >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
	
	;--- The Reach // Markarth // Silverblood Inn --------------------------------------------------------------------------------------	
	elseif sLocation == "Silverblood Inn"
	TempLoc = (Game.GetFormFromFile(0x0002B0DB, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	
	; --- The Pale // DawnStar // Windpeak Inn -------------------------------------------------------------
	elseif sLocation == "Windpeak Inn"
	TempLoc = (Game.GetFormFromFile(0x00052270, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	
	; --- The Rift // Riften // Bees and Barbs ----------------------------------------------------------
	elseif sLocation == "Bees and Barbs"
	TempLoc = (Game.GetFormFromFile(0x0005CE28, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	
	;--- Whiterun // Whiterun // Bannered Mare -- Drunken Huntsman -- Sleeping Giant Inn(Riverwood) -------------------------------------
	elseif sLocation == "Bannered Mare"
	TempLoc = (Game.GetFormFromFile(0x0001F88C, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Drunken Huntsman"
	TempLoc = (Game.GetFormFromFile(0x0009D5CD, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Sleeping Giant Inn"
	TempLoc = (Game.GetFormFromFile(0x0001DC0A, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	
	; --- Eastmarch // Windhelm // Candlehearth // GnisisCornerClub -----------------------------------------------------------------
	elseif sLocation == "Candlehearth Hall"
	TempLoc = (Game.GetFormFromFile(0x0010FC2A, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Gnisis Corner Club"
	TempLoc = (Game.GetFormFromFile(0x000209DA, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	
	
	;--- Falkreath // Falkreath // Dead Mans Drink -----------------------------------------------------------------	
	elseif sLocation == "Dead Mans Drink"
	TempLoc = (Game.GetFormFromFile(0x0007266A, "Skyrim.esm") As Objectreference)		;XMArker
	TempFloor = "empty"
	iRotation = 0	
	
	; --- Hjaalmarch // Morthal // Moorside Inn ------------------------------------------------------------------------	
	elseif sLocation == "Moorside Inn"
	TempLoc = (Game.GetFormFromFile(0x0001EB95, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	
	; --- Winterhold // Winterhold // The Frozen Hearth ---------------------------------------------------------------------------------
	elseif sLocation == "The Frozen Hearth"
	TempLoc = (Game.GetFormFromFile(0x0001EB7F, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	
	;------------- Inns END -------------;


	;>>>>>>>>>>>>> Vampires >>>>>>>>>>>>>>>;
	
	elseif sLocation == "Broken Fang Cave"
	TempLoc = (Game.GetFormFromFile(0x0002AE5A, "Skyrim.esm") As Objectreference)		;XMarkerHeading
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Bloodlet Throne"
	TempLoc = (Game.GetFormFromFile(0x0007C405, "Skyrim.esm") As Objectreference)		;PatrolIdleMarker
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Movarths Lair"
	TempLoc = (Game.GetFormFromFile(0x0002AFFE, "Skyrim.esm") As Objectreference)		;XMarkerHeading
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Pinemoon Cave"
	TempLoc = (Game.GetFormFromFile(0x0001F503, "Skyrim.esm") As Objectreference)		;XMarkerHeading
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "RedWater Den"
	TempLoc = (Game.GetFormFromFile(0x02014B03, "Skyrim.esm") As Objectreference)		;XMarkerHeading
	TempFloor = "empty"
	iRotation = 0		

	;>>>>>>>>>>>>> Bandits >>>>>>>>>>>>>>>;
	
	elseif sLocation == "White River Watch"
	TempLoc = (Game.GetFormFromFile(0x0008132F, "Skyrim.esm") As Objectreference)		;
	TempFloor = "cobblestoneLARGE"
	iRotation = 0	
	elseif sLocation == "Swindler's Den"
	TempLoc = (Game.GetFormFromFile(0x000435DA, "Skyrim.esm") As Objectreference)		;
	TempFloor = "dirt"
	iRotation = 0	
	elseif sLocation == "Redoran's Retreat"
	TempLoc = (Game.GetFormFromFile(0x0002B02F, "Skyrim.esm") As Objectreference)		;
	TempFloor = "dirt"
	iRotation = 0	
	elseif sLocation == "Bilegulch Mine"
	TempLoc = (Game.GetFormFromFile(0x000EF02C, "Skyrim.esm") As Objectreference)		;
	TempFloor = "dirt"
	iRotation = 0	
	elseif sLocation == "Four Skull Lookout"
	TempLoc = (Game.GetFormFromFile(0x000B23AB, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 270	
	elseif sLocation == "Cragslane Cavern"
	TempLoc = (Game.GetFormFromFile(0x000E160E, "Skyrim.esm") As Objectreference)		;
	TempFloor = "dirt"
	iRotation = 0	
	elseif sLocation == "Faldar's Tooth"
	TempLoc = (Game.GetFormFromFile(0x00043706, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0		
	elseif sLocation == "Embershard Mine"
	TempLoc = (Game.GetFormFromFile(0x000B6FFC, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0		
	
	;------------- Bandits END -------------;
	
	;>>>>>>>>>>>>> Wilderness >>>>>>>>>>>>>>>;
	
	elseif sLocation == "Clearspring Tarn"
	TempLoc = (Game.GetFormFromFile(0x000F3354, "Skyrim.esm") As Objectreference)		;XMARKER
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Markarth Slope"
	TempLoc = (Game.GetFormFromFile(0x000FB33C, "Skyrim.esm") As Objectreference)		;XMarkerHeading
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Clearpine Pond"
	TempLoc = (Game.GetFormFromFile(0x00016222, "Skyrim.esm") As Objectreference)		;Static
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "The Towerstone"
	TempLoc = (Game.GetFormFromFile(0x000E0ED5, "Skyrim.esm") As Objectreference)		;Static
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "The Serpent Stone"
	TempLoc = (Game.GetFormFromFile(0x000E0F69, "Skyrim.esm") As Objectreference)		;MapMarker (TEST)
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "The Steed Stone"
	TempLoc = (Game.GetFormFromFile(0x0001BAC7, "Skyrim.esm") As Objectreference)		;XMarkerHeading
	;TempLoc = (Game.GetFormFromFile(0x0001BAC0, "Skyrim.esm") As Objectreference)		;MAPMarker inside of the stone. Maybe forward 100?
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Northern Beach"
	TempLoc = (Game.GetFormFromFile(0x00075682, "Skyrim.esm") As Objectreference)		;XMarkerHeading, near sabretooth cave
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Deep Folk Crossing"
	TempLoc = (Game.GetFormFromFile(0x0200B62D, "Skyrim.esm") As Objectreference)		;XMarkerHeading (Dawnguard)
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "The Lover Stone"
	TempLoc = (Game.GetFormFromFile(0x0001BABB, "Skyrim.esm") As Objectreference)		;MapMarker
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Sky Haven Temple"
	TempLoc = (Game.GetFormFromFile(0x0004E861, "Skyrim.esm") As Objectreference)		;XMarker (floating above air) 
	TempFloor = "empty"
	iRotation = 0	 ;(rotate 90 left)
	elseif sLocation == "Reachwind Overlook"
	TempLoc = (Game.GetFormFromFile(0x000B23A4, "Skyrim.esm") As Objectreference)		;XMarkerHeading
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Bards Leap Summit"
	TempLoc = (Game.GetFormFromFile(0x00104B14, "Skyrim.esm") As Objectreference)		;XMarkerHeading dont fall!!
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Evergreen Grove"
	TempLoc = (Game.GetFormFromFile(0x000A7F18, "Skyrim.esm") As Objectreference)		;XMarkerHeading
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Random Mountain"
	TempLoc = (Game.GetFormFromFile(0x0008F64F, "Skyrim.esm") As Objectreference)		;XMarkerHeading ;near Helgen
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Ruins of Bthalft"
	TempLoc = (Game.GetFormFromFile(0x00090D84, "Skyrim.esm") As Objectreference)		;XMarkerHeading
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "The Shadow Stone"
	TempLoc = (Game.GetFormFromFile(0x000D1F1A, "Skyrim.esm") As Objectreference)		;IdleMarker () Ambush LOL -- COCMarker: 000D1EAC
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Giant's Grove"
	TempLoc = (Game.GetFormFromFile(0x000223F1, "Skyrim.esm") As Objectreference)		;XMarkerHeading
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "The Atronach Stone"
	TempLoc = (Game.GetFormFromFile(0x000E0F4C, "Skyrim.esm") As Objectreference)		;MapMarker		
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Mara's Eye Pond"
	TempLoc = (Game.GetFormFromFile(0x000DC4B8, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	
	;------------- Wilderness END -------------;
	
	
	;>>>>>>>>>>>>> Mines >>>>>>>>>>>>>>>;
	
	elseif sLocation == "Whistling Mine"
	TempLoc = (Game.GetFormFromFile(0x0002B0DB, "Skyrim.esm") As Objectreference)		;XMarker heading - untested
	TempFloor = "Cobblestone"
	iRotation = 0	
	
	; Street 
	; Steet 
	; Street 00029AAE

	; Street 
	; Street 00029DBB
	;Ivarstaed Street 
	; Stret 
	
	;>>>>>>>>>>>>> Street >>>>>>>>>>>>>>>;
	
	elseif sLocation == "Street in Winterhold"
	TempLoc = (Game.GetFormFromFile(0x0001C1B1, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Street in Markarth"
	TempLoc = (Game.GetFormFromFile(0x0001B38D, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Street in Morthal"
	TempLoc = (Game.GetFormFromFile(0x0001C1BA, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Street in Old Hroldan"
	TempLoc = (Game.GetFormFromFile(0x0002051C, "Skyrim.esm") As Objectreference)		;TEST
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Street in Riften"
	TempLoc = (Game.GetFormFromFile(0x0001CDD6, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Street in Rorikstead"
	TempLoc = (Game.GetFormFromFile(0x00029AAE, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Street in Whiterun"
	TempLoc = (Game.GetFormFromFile(0x00029AAF, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Street in DawnStar"
	TempLoc = (Game.GetFormFromFile(0x000284C5, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Street in Falkreath"
	TempLoc = (Game.GetFormFromFile(0x00029DBB, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Street in Ivarstaed"
	TempLoc = (Game.GetFormFromFile(0x0002A49D, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Street in Karthwasten"
	TempLoc = (Game.GetFormFromFile(0x0005CA54, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	
	;>>>>>>>>>>>>> Nobility >>>>>>>>>>>>>>>;
	
	elseif sLocation == "Castle Dour Solitude"
	TempLoc = (Game.GetFormFromFile(0x00020089, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Palace of the Kings Windhelm"
	TempLoc = (Game.GetFormFromFile(0x000209DC, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Jarl Longhouse Winterhold"
	TempLoc = (Game.GetFormFromFile(0x0001EB80, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Blue Palace Solitude"
	TempLoc = (Game.GetFormFromFile(0x00020085, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "Jarl Longhouse Falkreath"
	TempLoc = (Game.GetFormFromFile(0x000200C8, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "White Hall Dawnstar"
	TempLoc = (Game.GetFormFromFile(0x0002006D, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "XXXXXXXXX"
	;TempLoc = (Game.GetFormFromFile(0x000XXXXX, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "XXXXXXXXX"
	;TempLoc = (Game.GetFormFromFile(0x000XXXXX, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "XXXXXXXXX"
	;TempLoc = (Game.GetFormFromFile(0x000XXXXX, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "XXXXXXXXX"
	;TempLoc = (Game.GetFormFromFile(0x000XXXXX, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0	
	elseif sLocation == "XXXXXXXXX"
	;TempLoc = (Game.GetFormFromFile(0x000XXXXX, "Skyrim.esm") As Objectreference)		;
	TempFloor = "empty"
	iRotation = 0		
	
	;CAMPS ARE OUT FOR NOW 
	;Falkreath Imperial Camp 00052999		 ;DOES NOT EXIST 
	;Falkreath Sons Camp 00052914 		 ;OK 
	;Hjaalmarch IMPerial Cmap 00052985
	;THePale Imperial camp 000529AD
	;THe Pale Sons Camp 0005292C
	;The Rift Imperial Camp 000529D5
	;The RIft Sons Camp 0005295C
	;Whiterun Imperial Camp 000216AA
	;Wintrhold Imperial Camp 000529C1
	;Wintrhold Sons 00052944
	;Hjaalmarch Sons 000528FC
	
	;REWORK FARMS 
	;Battleborn Farm 000216AF		OK
	;Brandy Mug Farm 0005CAB2		OK
	;Pelagia Farm 000216B1				
	;Chillfurrow Farm 000216B0
	;Lorius Farm 000284C7
	;MerryFair Farm 0005CAB8
	;Salvius Farm 00020521
	;Sarethi Farm 0005CACC
	;SnowShodFarm 0005CAB4


	;Heljarchen ?? 000284C6
	;HighMoon Hall 001EB99

	;Kollskegr Mine 0002051E
	;LeftHand Mine 0002051A
	;Whistling Mine (already done... 0005CAAF)
	
	;ShorsStone 0002A49C ??
	
	;Solitude Sawmill 0005CA38
	;Half Moon Mill Stret 00029DBF
	;heartwood Mill Farm?STret? 0005CAC8
	;Angas Mill Street 000284C8
	
	;Mistveil Keep Jarl 00022647

	endif 	
	
	;>>>>>>>>>>>>>>>>>>>>>>>>>> MOVE >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>;
	
	if !TempLoc
	Debug.Messagebox("#ERROR Location["+sLocation+"	not found, please report to the forum. Using BackupLocation")
	TempLoc = (Game.GetFormFromFile(0x0001F88C, "Skyrim.esm") As Objectreference) ;backuplocation is Bannered Mare
	endif 
	
	bool Follower01found = false
	bool Follower02found = false
	bool Follower03found = false
	bool Follower04found = false
	bool Follower05found = false

	;check if followers are travelling with us first or we teleport away and this will all return false OR teleport followers from at home...
	if folqst.IsWithUs_Follower(0)
	Follower01found = true
	endif
	if folqst.IsWithUs_Follower(1)
	Follower02found = true
	endif
	if folqst.IsWithUs_Follower(2)
	Follower03found = true
	endif
	if folqst.IsWithUs_Follower(3)
	Follower04found = true
	endif
	if folqst.IsWithUs_Follower(4)
	Follower05found = true
	endif
	
	;/
		;SkyHavenTemple 	 ;#SE WORKS 		
		LocHostile = (Game.GetFormFromFile(0x000E6803, "Skyrim.esm") As ObjectReference)		; - X MARKER 
		PlayerRef.MoveTo(LocHostile)
		;was 270
		PlayerRef.MoveTo(PlayerRef, 235.0 * Math.Sin(PlayerRef.GetAngleZ()+90.0), 235.0 * Math.Cos(PlayerRef.GetAngleZ()+90.0), PlayerRef.GetHeight() +100.0, abMatchRotation = true) 
		RotatePC(105) ;initial angle 		
		RotatePC(85)	;facing to the RIGHT --- less is rotating left 
		
		FloorType = "none"
		LocType = "hell"
	/;
	
	PlayerRef.MoveTo(TempLoc)
	NymTrace("##AFterlife01")
	if DefeatTypeScenario == "Afterlife"		
	NymTrace("##AFterlife02")	
		SendWashPlayerEvent()
		if folqst.Actor_Follower01
		SendModEvent_BiS_WashActor(folqst.Actor_Follower01)
		endif 
		if folqst.Actor_Follower02
		SendModEvent_BiS_WashActor(folqst.Actor_Follower02)
		endif 
		NymTrace("##AFterlife03")
		Utility.Wait(0.5)
		PlayerRef.MoveTo(PlayerRef, 235.0 * Math.Sin(PlayerRef.GetAngleZ()+90.0), 235.0 * Math.Cos(PlayerRef.GetAngleZ()+90.0), PlayerRef.GetHeight() +100.0, abMatchRotation = true) 
		Utility.Wait(0.5)
		RotatePC(105) ;initial angle 	
		Utility.Wait(0.5)		
		RotatePC(85)	;facing to the RIGHT --- less is rotating left 
	endif 

	if Follower01found
	folqst.Actor_Follower01.MoveTo(PlayerRef, 95.0 * Math.Sin(PlayerRef.GetAngleZ()+90), 95.0 * Math.Cos(PlayerRef.GetAngleZ())+90, PlayerRef.GetHeight() - 125.0, abMatchRotation = true)
	folqst.Actor_Follower01.SetAngle(0.0, 0.0, 180.0)
	endif
	if Follower02found
	folqst.Actor_Follower02.MoveTo(PlayerRef, -95.0 * Math.Sin(PlayerRef.GetAngleZ()+90), 95.0 * Math.Cos(PlayerRef.GetAngleZ())+90, PlayerRef.GetHeight() - 125.0, abMatchRotation = true)
	folqst.Actor_Follower02.SetAngle(0.0, 0.0, 180.0)
	endif	
	if Follower03found
	folqst.Actor_Follower03.MoveTo(PlayerRef, 95.0 * Math.Sin(PlayerRef.GetAngleZ()+90), 95.0 * Math.Cos(PlayerRef.GetAngleZ())+90, PlayerRef.GetHeight() - 125.0, abMatchRotation = true)
	folqst.Actor_Follower03.SetAngle(0.0, 0.0, 180.0)
	endif
	if Follower04found
	folqst.Actor_Follower04.MoveTo(PlayerRef, -95.0 * Math.Sin(PlayerRef.GetAngleZ()+90), 95.0 * Math.Cos(PlayerRef.GetAngleZ())+90, PlayerRef.GetHeight() - 125.0, abMatchRotation = true)
	folqst.Actor_Follower04.SetAngle(0.0, 0.0, 180.0)
	endif
	if Follower05found
	folqst.Actor_Follower05.MoveTo(PlayerRef, -95.0 * Math.Sin(PlayerRef.GetAngleZ()+90), 95.0 * Math.Cos(PlayerRef.GetAngleZ())+90, PlayerRef.GetHeight() - 125.0, abMatchRotation = true)
	folqst.Actor_Follower05.SetAngle(0.0, 0.0, 180.0)
	endif

	
	;>>>>>>>>>>>>> Enslave >>>>>>>>>>>>>>>;
	if bEnslave
		
		if DefeatEntranceVia == "Sold as Public Slave"	
		CivilRapeRunning = true				;#0 -- THIS ORDER HAS TO BE KEPT!!!!!
		elseif DefeatEntranceVia == "Sold as Slave"
		DefeatQuestRunning = true
		endif 
		
		DefeatViaSurrender = true				;#1 ;why again?
		DefeatViaSlavery = true
		;HarderDefeat = true ;STILL NECESSARY? ;sets escape difficulty to 1/1 all the time I guess... lets try without
		FirstStartUp = true						;#2   WHY? 	
		;TempSender = "Via SS Public"
		SendModEvent("StartAllegianceQuest") 	;#3
		NymTrace("Immobilize(true) for111111")
		Immobilize(true)						;#0 -- THIS ORDER HAS TO BE KEPT!!!!!

		if TempFloor == "empty"
		;do nothing
		else
		TillTouchdown()
		PlaceFloor(TempFloor)
		PlayerRef.Moveto(PlayerRef)
		TillTouchdown()
		endif
		NymTrace("Immobilize(true) for111211")
		Immobilize(true)

	;	Crawl(PlayerRef, true)	

		ProcessCrimeGold()
		
		StartDefeat()
	elseif DefeatTypeScenario == "Afterlife"
	
	;	DefeatViaSurrender = true				;#1 ;why again?
	;	DefeatViaSlavery = true
		;HarderDefeat = true ;STILL NECESSARY? ;sets escape difficulty to 1/1 all the time I guess... lets try without
		DefeatQuestRunning = true
		FirstStartUp = true						;#2   WHY? 	
		;TempSender = "Via SS Public"
		SendModEvent("StartAllegianceQuest") 	;#3
		NymTrace("Immobilize(true) for1111221")
		Immobilize(true)						;#0 --
		StartDefeat()
	endif 
	
		
EndFunction

Function StartSimpleSlaveryPublic()			;#StartSimpleSlaveryPublic()		#slavery2
	
	bool NewLocationSystem = false
	
	
	if NewLocationSystem
		Debug.Trace("Naked Defeat configquest: StartSimpleSlaveryPublic(new)")
	
		String SlaveryLocationGeneral = "empty"
		String SlaveryLocation = "empty"
		int i 
		
		i = Utility.RandomInt(1,2)
		if i == 1
		SlaveryLocationGeneral = "Mine"
		elseif i == 2
		SlaveryLocationGeneral = "Citystreets"
		elseif i == 3
		SlaveryLocationGeneral = "Inn"
		elseif i == 4
		SlaveryLocationGeneral = "Farm"		
		elseif i == 5
		SlaveryLocationGeneral = "Noble"		
		elseif i == 6		
		SlaveryLocationGeneral = "Bed"	
		endif 

		if SlaveryLocationGeneral == "Mine"
		i = Utility.RandomInt(1,2)
		elseif i == 1
		SlaveryLocation = "Whistling Mine"
		endif 

	else 

		Debug.Trace("Naked Defeat configquest: StartSimpleSlaveryPublic(old)")
		
		string FloorType = "none"

			OBJECTREFERENCE LocTemp	
				
			;	if IsNymrasGame() && DebugPunishmentType > 0
			
			;	Loc = DebugPunishmentType as int
			;	DebugPunishmentType = 0
			;	endif 
		NymTrace("Immobilize(true) for Public Slavery 0")		
		Immobilize(true)
		
		;>>>>>>> TAVERN SLAVE LOCATIONS >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 				
		;25% chance for them to appear. Sort Locations more in the future and maybe add MCM toggles for groups of Locations
		if D100(25)
				
			;Loc = Utility.RandomInt(1,8) ;Silverblood Inn not working 
			Loc = Utility.RandomInt(2,8)	
			LocType = "public"		
		
			;the reach // markarth // Silverblood Inn
			if Loc == 1
			;--- The Reach // Markarth // Silverblood Inn --------------------------------------------------------------------------------------
			; --- Silverblood Inn --- ;
			;DONE / Idlemarker was not used 	
			LocTemp = (Game.GetFormFromFile(0x000F9943, "Skyrim.esm") As OBJECTREFERENCE)		;Xmarker in the side Tunnel for landing
			PlayerRef.MoveTo(LocTemp)	
			Utility.Wait(2.0)
			LocTemp = (Game.GetFormFromFile(0x000F9941, "Skyrim.esm") As OBJECTREFERENCE)		;IdleMarker on Rug	(NOT WORKING!!!) WTF <--- better use this tho 
			PlayerRef.MoveTo(LocTemp)
			RotatePC(90)
			
			elseif Loc == 2 
			; --- The Pale // DawnStar // Windpeak Inn -------------------------------------------------------------
			; --- Windpeak Inn --- ; 
			;DONE / FINE - supports 4 Followers easy		
			LocTemp = (Game.GetFormFromFile(0x00052270, "Skyrim.esm") As ObjectReference)	;XMARKER near entrance by the 2 chairs
			PlayerRef.MoveTo(LocTemp)
			PlayerRef.MoveTo(PlayerRef, 60.0 * Math.Sin(PlayerRef.GetAngleZ()), 60.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			Debug.Trace("NAKED DEFEAT: Windpeak: "+LocTemp)	
			
			elseif Loc == 3
			; --- The Rift // Riften // Bees and Barbs ----------------------------------------------------------
			; --- Bees and Barbs --- ; 	
			;DONE / Idlemarker was not used 	
			LocTemp = (Game.GetFormFromFile(0x0005CE28, "Skyrim.esm") As ObjectReference)	;XMARKER heading in the center
			PlayerRef.MoveTo(LocTemp)
			;LocTemp = (Game.GetFormFromFile(0x00046BA5, "Skyrim.esm") As ObjectReference)	;IDLE MARKER near Entrance
			PlayerRef.MoveTo(PlayerRef, 125.0 * Math.Sin(PlayerRef.GetAngleZ()), 125.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			RotatePC(180)
			Debug.Trace("NAKED DEFEAT: Bees and Barbs: "+LocTemp)
			
			elseif Loc == 4
			;--- Whiterun // Whiterun // Bannered Mare -- Drunken Huntsman -- Riverwood(name?) -------------------------------------
				if D100(33)
				;--- Bannered Mare ---;	
				;DONE / #TEST rotation			
				LocTemp = (Game.GetFormFromFile(0x0001F88C, "Skyrim.esm") As ObjectReference)	;XMARKER by the fire
				PlayerRef.MoveTo(LocTemp)
				RotatePC(180)	
				consoleutil.ExecuteCommand("player.moveto 000C8FD5")	;TempStatic "Rug" WORKED 
				Debug.Trace("NAKED DEFEAT: Bannered Mare: "+LocTemp)
				
				elseif D100(50)
				;--- Drunken Huntsman ---;		
				;DONE / #TEST rotation!!!! 
				LocTemp = (Game.GetFormFromFile(0x0009D5CD, "Skyrim.esm") As ObjectReference)	;XMARKER
				PlayerRef.MoveTo(LocTemp)
				RotatePC(180)
				Debug.Trace("NAKED DEFEAT: Drunken Huntsman: "+LocTemp)
			
				else
				;--- Sleeping Giant Inn --- Riverwood ---;	
				;DONE / FINE test rotation
				;LocTemp = (Game.GetFormFromFile(0x0006410F, "Skyrim.esm") As ObjectReference)	;IdleMarker in the corner, right of bar
				LocTemp = (Game.GetFormFromFile(0x0001DC0A, "Skyrim.esm") As ObjectReference)	;XMarker HEADING in the corner, right of bar USE THIS 
				PlayerRef.MoveTo(LocTemp)
				RotatePC(315)
				Debug.Trace("NAKED DEFEAT: Sleeping Giant Inn: "+LocTemp)
		
				endif
		
			elseif Loc == 5
			; --- Eastmarch // Windhelm // Candlehearth // GnisisCornerClub -----------------------------------------------------------------
				if D100(50)
				; --- Candleheart Hall --- ;
				;DONE / FINE a little narrow 
				LocTemp = (Game.GetFormFromFile(0x0010FC2A, "Skyrim.esm") As ObjectReference)	;XMARKER Heading (should work)
				PlayerRef.MoveTo(LocTemp)
				Debug.Trace("NAKED DEFEAT: Candlehearth Hall: "+LocTemp)
				else
				; --- Gnisis Corner Club --- ;	
				;DONE / FINE, test rotation 
				LocTemp = (Game.GetFormFromFile(0x000209DA, "Skyrim.esm") As ObjectReference)	;XMARKER center on Rug 
				PlayerRef.MoveTo(LocTemp)
				RotatePC(270)
				;LocTemp = (Game.GetFormFromFile(0x000E73C1, "Skyrim.esm") As ObjectReference)	;IDLE MARKER left from door  DID NOT WORK
				;PlayerRef.MoveTo(LocTemp)
				Debug.Trace("NAKED DEFEAT: GnisisCornerClub: "+LocTemp)
				endif
			
			elseif Loc == 6
			;--- Falkreath // Falkreath // Dead Mans Drink -----------------------------------------------------------------	
			; --- Dead Mans Drink --- ;
			;DONE / FINE  
			LocTemp = (Game.GetFormFromFile(0x0007266A, "Skyrim.esm") As ObjectReference)	;XMARKER 
			PlayerRef.MoveTo(LocTemp)
			RotatePC(180)
			Debug.Trace("NAKED DEFEAT: Dead Mans Drink: "+LocTemp)
			
			elseif Loc == 7		
			; --- Hjaalmarch // Morthal // Moorside Inn ------------------------------------------------------------------------	
			; --- Moorside Inn --- ; 
			;DONE / FINE  
			LocTemp = (Game.GetFormFromFile(0x0001EB95, "Skyrim.esm") As ObjectReference) ;PLACED XMARKER 
			PlayerRef.MoveTo(LocTemp)
			Debug.Trace("NAKED DEFEAT: Moorside Inn: "+LocTemp)

			elseif Loc == 8	
			; --- Winterhold // Winterhold // The Frozen Hearth ---------------------------------------------------------------------------------
			; --- The Frozen Hearth --- ; 
			;DONE / FINE 		
			LocTemp = (Game.GetFormFromFile(0x0001EB7F, "Skyrim.esm") As ObjectReference)	;XMARKER (Landing) 
			PlayerRef.MoveTo(LocTemp)	
		;	LocTemp = (Game.GetFormFromFile(0x000DD9E9, "Skyrim.esm") As ObjectReference)	;IDLE MARKER in corner  DID NOT WORK
		;	PlayerRef.MoveTo(LocTemp)	
			PlayerRef.MoveTo(PlayerRef, 125.0 * Math.Sin(PlayerRef.GetAngleZ()), 125.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)		
			RotatePC(270)
			Debug.Trace("NAKED DEFEAT: The Frozen Hearth: "+LocTemp)
			endif
			
			if !LocTemp
			Debug.Trace("NAKED DEFEAT configquest: #ERROR - Tavern Slave Location not found. Loc: "+Loc)
			Debug.Messagebox("Naked Defeat #ERROR - Tavern Slave Location not found. Loc: "+Loc) 
			endIf
			
			;SS++						Rescue Location		Tavern Slave
			;Winterhold FROZEN HEART 	0010FC3A			000DD9E9 forward 125 ca.
			;Morthal Moorside Inn		0001EB95			0001EB95
			;Witherun T Drunken Huntsman 0002884C			0009D5CD
			;Witherun TBannered Mare 	>					000C8FD5 rotate 270
			;Riverwood					0002135E			better 0006410F		00064111 rotate 180
			;Falkreath Dead Mans Drink	0009D118			0007266A rotate 180
			;Markarth Silverblood Inn	000C42D4			000C42D4 rotate 270	
			;Solitude Winking Skeevers	000D49AA			000D49AA
			;Windhelm_Candlehearth		000E77D0			0010FC2A
			;Windhelm Gnisis Corner		000209DA			000E73C1
			;Riften_BeesAndBarbs		000BEC41			00046BA6
			;Dawnstar_Windpeak			0010FCC8			0010FCC9
		
		else 
			;>>>>>>>>>>>>>>>>>>> LOCATION MIX >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
			Loc = Utility.RandomInt(1,28)
		
			if IsNymrasGame()
			Loc = Utility.RandomInt(1,17)
			endif
			
			if NymBeta && (DebugPunishmentType > 0)
			;Debug.Messagebox("DEBUG: Scenario selected: "+scenario)
			Loc = DebugPunishmentType as int 
			Debug.Messagebox("DEBUG: Location Public selected: "+DebugPunishmentType)	
			endif
			
			if (loc == 9) || (loc == 15)
			loc = 6
			endif
			
			
			;########### WE NEED TO SORT BETWEEN CREATURE AND HUMAN LOCATIONS (for MCM toggles!))
			;Public Locations (outdoor)
			if Loc == 1		 ;OK
			PlayerRef.Moveto(LocSlaveryCivil[1]) 	;OK		Angas Mill (on a street)
			PlayerRef.MoveTo(PlayerRef, -200.0 * Math.Sin(PlayerRef.GetAngleZ()), -200.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			FloorType = "cobblestone"
			LocType = "public"
			elseif Loc == 2	 ;OK
			PlayerRef.Moveto(LocSlaveryCivil[18])	;OK		Falkreath (Middle of The Street)
			;FloorType = "cobblestone"
			LocType = "public"
			elseif Loc == 3	 ;OK
			PlayerRef.Moveto(LocSlaveryCivil[23])	;OK 	Ivarstead (on Street)
			;FloorType = "cobblestone"
			LocType = "public"
			elseif Loc == 4	 ;OK	
			PlayerRef.Moveto(LocSlaveryCivil[24])	;OK		KarthWasten (public)
			;FloorType = "cobblestone"
			LocType = "public"
			elseif Loc == 5  ;OK - angles correct
			PlayerRef.Moveto(LocSlaveryCivil[31])	;OK		Morthal (public)
			LocType = "public"
			elseif Loc == 6 ;OK
			PlayerRef.Moveto(LocSlaveryCivil[44])	;OK		Whiterun Public
			LocType = "public"
			elseif Loc == 7 ;needs something on the floor (the leather thingies maybe)
			PlayerRef.Moveto(LocSlaveryCivil[46])	;OK		WInterhold Public
			;FloorType = "cobblestone"		;hmmm, could need some fur or a fire next to the spot...
			LocType = "public"
			elseif Loc == 8	;OK
			PlayerRef.Moveto(LocSlaveryCivil[26])	;NEEDS MOVING Left Hand Mine
			PlayerRef.MoveTo(PlayerRef, 500.0 * Math.Sin(PlayerRef.GetAngleZ()), 500.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			FloorType = "cobblestone"
			LocType = "mine"
			;elseif Loc == 9
			;PlayerRef.Moveto(LocSlaveryCivil[28])	;NEEDS MOVIN (Markarth Under Bridge)		SUX
			;FloorType = "stone"
			;LocType = "public"
			elseif Loc == 10	;OK - UPDATED SE 
			;PlayerRef.Moveto(LocSlaveryCivil[43])	;NEEDS PLATFROM (Whistling Mine) ; BROKEN 
			
			LocTemp = (Game.GetFormFromFile(0x0002B0DB, "Skyrim.esm") As ObjectReference)	;XMARKER (Landing) 
			PlayerRef.MoveTo(LocTemp)
	
			;PlayerRef.MoveTo(PlayerRef, 300.0 * Math.Sin(PlayerRef.GetAngleZ()), 300.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			;PlayerRef.MoveTo(PlayerRef, 150.0 * Math.Sin(PlayerRef.GetAngleZ()+90.0), 150.0 * Math.Cos(PlayerRef.GetAngleZ()+90.0), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			FloorType = "cobblestone"
			LocType = "mine"

			;Private Locations (Indoor)
			elseif Loc == 11 ;OK
			PlayerRef.Moveto(LocSlaveryCivil[0]) 	;OK		Falkreath Jarl Longhouse?
			PlayerRef.MoveTo(PlayerRef, 85.0 * Math.Sin(PlayerRef.GetAngleZ()), 85.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			LocType = "palace"
			elseif Loc == 12	;OK but maybe one day move up to the trhone
			PlayerRef.Moveto(LocSlaveryCivil[3]) 	;OK		Blue Palace
			LocType = "palace"
			elseif Loc == 13
			PlayerRef.Moveto(LocSlaveryCivil[17])	;OK 	The White Hall
			PlayerRef.MoveTo(PlayerRef, -25.0 * Math.Sin(PlayerRef.GetAngleZ()), -25.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			LocType = "palace"
			elseif Loc == 14
			PlayerRef.Moveto(LocSlaveryCivil[22])	;OK 	HighMoon Hall
			LocType = "palace"
			;elseif Loc == 15
			;PlayerRef.Moveto(LocSlaveryCivil[41])	;OK 	Castle Dour, EmperorsTower	;servants - NO ACTORS TJERE
			LocType = "palace"
			elseif Loc == 16
			PlayerRef.Moveto(LocSlaveryCivil[47])	;OK 	JARLS Longhouse
			LocType = "palace"
			elseif Loc == 17
			PlayerRef.Moveto(LocSlaveryCivil[45])	;NEEDS MOVING (Palace of Kings)
			PlayerRef.MoveTo(PlayerRef, 400.0 * Math.Sin(PlayerRef.GetAngleZ()), 400.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			LocType = "palace"
			;Military Camp (Outdoor)
			elseif Loc == 18
			PlayerRef.Moveto(LocSlaveryCivil[8]) 	;OK 	Pale Imperial Camp
			FloorType = "cobblestone"
			LocType = "camp"
			elseif Loc == 19
			PlayerRef.Moveto(LocSlaveryCivil[10]) 	;OK 	Rift Imperial Camp
			;FloorType = "cobblestone"
			LocType = "camp"
			elseif Loc == 20
			PlayerRef.Moveto(LocSlaveryCivil[30])	;OK		Hjaalmarch Stormcloak Camp
			FloorType = "cobblestone"
			LocType = "camp"
			elseif Loc == 21
			PlayerRef.Moveto(LocSlaveryCivil[6]) 	;NEEDS PLATFORM/Stone Falkreath Stormcloak Camp
			FloorType = "cobblestone"
			LocType = "camp"
			elseif Loc == 22
			PlayerRef.Moveto(LocSlaveryCivil[13]) 	;NEEDS MOVING 	Winterhold Imperial Camp
			FloorType = "cobblestone"
			LocType = "camp"
			;Farm
			elseif Loc == 23 
			PlayerRef.Moveto(LocSlaveryCivil[29])	;OK		MerryFair Farm
			FloorType = "cobblestone"
			LocType = "farm"
			elseif Loc == 24
			PlayerRef.Moveto(LocSlaveryCivil[40])	;OK 	Snow Shod Farm
			FloorType = "cobblestone"
			PlayerRef.MoveTo(PlayerRef, -150.0 * Math.Sin(PlayerRef.GetAngleZ()), -150.0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
			LocType = "farm"
			elseif Loc == 25
			PlayerRef.Moveto(LocSlaveryCivil[2]) 	;NEEDS PLATFORM	Battle-Born Farm
			FloorType = "cobblestone"
			LocType = "farm"
			elseif Loc == 26
			PlayerRef.Moveto(LocSlaveryCivil[33])	;NEEDS PLATFORM Pelagia Farm
			FloorType = "platform"
			LocType = "farm"
			elseif Loc == 27
			PlayerRef.Moveto(LocSlaveryCivil[37])	;NEEDS PLATFORM 	Salvius Farm
			FloorType = "cobblestone"
			LocType = "farm"
			elseif Loc == 28
			PlayerRef.Moveto(LocSlaveryCivil[38])	;NEEDS PLATFORM 	Sareti Farm
			FloorType = "cobblestone"
			LocType = "farm"
			endif
		endif
		;-------------------------------------------------------
		
		;----- moved block up because of earlier Allegianc Start please
		CivilRapeRunning = true				;#0 -- THIS ORDER HAS TO BE KEPT!!!!!
		DefeatViaSurrender = true				;#1 ;why again?
		DefeatViaSlavery = true
		HarderDefeat = true
		FirstStartUp = true						;#2    	
		;TempSender = "Via SS Public"
		SendModEvent("StartAllegianceQuest") 	;#3
		;---------------------------------------------------
		
		;move followers
		if folqst.Actor_Follower01
		folqst.Actor_Follower01.MoveTo(PlayerRef, 95.0 * Math.Sin(PlayerRef.GetAngleZ()+90), 95.0 * Math.Cos(PlayerRef.GetAngleZ())+90, PlayerRef.GetHeight() - 125.0, abMatchRotation = true)
		folqst.Actor_Follower01.SetAngle(0.0, 0.0, 180.0)
		endif
		if folqst.Actor_Follower02
		folqst.Actor_Follower02.MoveTo(PlayerRef, -95.0 * Math.Sin(PlayerRef.GetAngleZ()+90), 95.0 * Math.Cos(PlayerRef.GetAngleZ())+90, PlayerRef.GetHeight() - 125.0, abMatchRotation = true)
		folqst.Actor_Follower02.SetAngle(0.0, 0.0, 180.0)
		endif
		
		NymTrace("Immobilize(true) for Public Slavery A")
		Immobilize(true)
		
		if FloorType == "none"
		;do nothing
		else
		TillTouchdown()
		PlaceFloor(FloorType)
		PlayerRef.Moveto(PlayerRef)
		TillTouchdown()
		;Utility.Wait(1.0)
		endif
		
		;SpawnRapers("random", false) this is bad and somehow not working from here
		;THIS WAS THE ISSUE. WE SPAWNED RAPERS BEFORE WE SET VIA SLAVERY TRUE
		NymTrace("Immobilize(true) for Public Slavery B")
		Immobilize(true)
		
		if (LocType == "farm") || (LocType == "public") || (LocType == "palace") || (LocType == "camp") || (LocType == "mine")
		DefeatType = "Humans"
		DefeatTypeGeneral = "AreHumans"
		endif
	;	calmqst.Vehicle("Setup")
		
		;Crawl(PlayerRef, true)	

		if LocType == "farm"
		ScreenMessage("You are a better farm animal now...")
		elseif LocType == "public"
		ScreenMessage("You will serve the public until you are worn out...")
		elseif LocType == "palace"
		ScreenMessage("You've become a fucktoy for the nobles... until they get bored...")
		elseif LocType == "camp"
		ScreenMessage("The soldiers will pass you around... as long as they want.")
		elseif LocType == "mine"
		ScreenMessage("The miners will love digging into your holes...")
		endif
		
		ProcessCrimeGold()
		
		;change DefeatType manually here based on LocType

		While (CalmQuest.GetStage() > 0) && (CalmQuest.GetStage() < 1000) && ModEnabled
		Debug.Trace("NAKED DEFEAT configquest: Waiting for Calmquest to End")
		Utility.Wait(1.0)
		EndWhile 
		DefeatEntranceVia = "Sold as Public Slave"	
		StartDefeat()
	endif 

EndFunction

Function TillTouchdown()

		float cZ = 0.0	
		float second = 0.0 ;----> to prevent a delay of the pose for more than a second	
		While(cZ != PlayerRef.Z) && (second < 2.0)
		cZ = PlayerRef.Z
		Utility.Wait(0.1)
		second += 0.1
		EndWhile
EndFunction		



		

Function LocationTest()

EndFunction
	

ObjectReference Floor01 = none
ObjectReference Floor02 = none
ObjectReference Floor03 = none
ObjectReference Floor04a = none
ObjectReference Floor04b = none
ObjectReference Floor04c = none
ObjectReference Lantern = none

bool floorplaced = false


Function PlaceLight(string Type = "none")		;#PlaceLight


		if (type == "remove")
	;	NymMessage("Candles Removed")	
			if Lantern
				Lantern.DisableNoWait()
				Lantern.Delete()
			endif 	
	;	NymMessage("Candles Placed")	
		Lantern = none	
		else 
		;ObjectReference Candles01	
												
	;	Candles01 = PlayerRef.PlaceAtMe(Game.GetFormFromFile(0x000C841C, "Skyrim.esm") As objectreference)	;Candles on Plate
		Lantern = PlayerRef.PlaceAtMe(Game.GetFormFromFile(0x0002D847, "Skyrim.esm"), 1) 		;Lantern
		Lantern.Moveto(PlayerRef, 125 * Math.Sin(PlayerRef.GetAngleZ()), 125 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)
		Lantern.SetAngle(0.0, 0.0, 0.0)
		type = "none"
		endif 

EndFunction 

Function PlaceFloor(string Type = "none")		;#floor #PlaceFloor
Debug.Trace("NAKED DEFEAT configquest: PlaceFloor()")

	;REMOVE FLOOR
	if floorplaced && (type == "remove")
		if Floor01
		Floor01.DisableNoWait()
		Floor01.Delete()
		elseif Floor02
		Floor02.DisableNoWait()
		Floor02.Delete()	
		elseif Floor03
		Floor03.DisableNoWait()
		Floor03.Delete()	
		elseif Floor04a
		Floor04a.DisableNoWait()
		Floor04a.Delete()		
		endif
		floorplaced = false
	else
	;PLACE FLOOR	 

	
		if (type == "setup") && !floorplaced			;RANDOM (currently only cobblestone)
			Floor01 = PlayerRef.PlaceAtMe(TestFloor)	;COBBLESTONE
			Floor01.SetAngle(0.0, 0.0, 0.0)
			;Floor01.Moveto(PlayerRef, 0 * Math.Sin(PlayerRef.GetAngleZ()), 0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 100.0, abMatchRotation = false)	
		elseif (type == "dirt") && !floorplaced
			Floor04a = PlayerRef.PlaceAtMe(TestFloor04)	;COBBLESTONE??
			Floor04a.Moveto(PlayerRef, 0 * Math.Sin(PlayerRef.GetAngleZ()), 0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 135.0, abMatchRotation = false)	
		elseif (type == "cobblestone") && !floorplaced
			Floor01 = PlayerRef.PlaceAtMe(TestFloor)	;COBBLESTONE
			Floor01.Moveto(PlayerRef, 0 * Math.Sin(PlayerRef.GetAngleZ()), 0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 100.0, abMatchRotation = false)	
			if locH == 1
			Floor01.Moveto(PlayerRef, 0 * Math.Sin(PlayerRef.GetAngleZ()), 0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 85.0, abMatchRotation = false)
			endif	
		elseif (type == "platform") && !floorplaced
			Floor02 = PlayerRef.PlaceAtMe(TestFloor02)	;WOODEN PLATFORM
			
			if loc == 26
			Floor02.Moveto(PlayerRef, 0 * Math.Sin(PlayerRef.GetAngleZ()), 0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 80.0, abMatchRotation = false)
			Floor02.SetAngle(0.0, 0.0, 45.0)
			else
			Floor02.Moveto(PlayerRef, 0 * Math.Sin(PlayerRef.GetAngleZ()), 0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 110.0, abMatchRotation = false)
			Floor02.SetAngle(0.0, 0.0, 0.0)
			endif		
		elseif (type == "cobblestoneLARGE") && !floorplaced
			Floor03 = PlayerRef.PlaceAtMe(TestFloor03)	;COBBLESTONE LARGE FLOOR PIECE
			Floor03.Moveto(PlayerRef, 0 * Math.Sin(PlayerRef.GetAngleZ()), 0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)

	;	elseif (type == "whiteriverwatch") ;no longer required	
	;		Floor03 = PlayerRef.PlaceAtMe(TestFloor03)	;COBBLESTONE LARGE FLOOR PIECE
	;		Floor03.Moveto(PlayerRef, 0 * Math.Sin(PlayerRef.GetAngleZ()), 0 * Math.Cos(PlayerRef.GetAngleZ()), PlayerRef.GetHeight() - 125.0, abMatchRotation = false)		
		endif
		
		
		
	floorplaced = true	
	endif	
		
EndFunction

bool Function D100(float chance)	;#diceroll	;#d100

;if we roll equal or below the send "chance" it will return true (so D100(95)) is a 95% of "TRUE")

int i = Utility.RandomInt(1, 100)
int c = chance as int

NymTrace("Chance: "+c+" D100 "+i)

if i <= chance
return true
else
return false
endif
EndFunction

bool Function D500(float chance)	;#diceroll	;#d500

if Utility.RandomInt(1, 500) <= chance
return true
else
return false
endif
EndFunction

bool Function D1000(float chance)	;#diceroll	;#d1000

if Utility.RandomInt(1, 1000) <= chance
return true
else
return false
endif
EndFunction

int lastINT = 0

int Function Random()

int BaseInt = Utility.RandomInt(1, 100)
int ModInt = (Utility.RandomFloat(-1,-50) as int)

int FinalInt
if lastINT == 0
FinalInt = BaseInt
elseif BaseInt == lastINT
FinalInt = BaseInt + ModInt 
elseif Utility.RandomInt(1,30) > 15
FinalInt = BaseInt + ModInt
endif

if FinalInt > 100
FinalInt == 100 - ModInt
elseif FinalInt < 1
FinalInt == 51 - ModInt
endIf

InfoMessage("FinalInt: "+FinalInt)
return FinalInt

EndFunction

int Function RandomInt()
return  Utility.RandomInt(1, 100)
EndFunction



Function SetExpression(int type = 0)	;#expression #SetExpression
;NymTrace("SetExpression START")
	if PlayExpressions	;MCM Setting True/False 
			;NymTrace("SetExpression 1")	
		if !Gagged && !Orgasm 	;if NOT gagged
		;NymTrace("SetExpression 2")
			if type == 0 
			ResetExpressions()	
			elseif type == 1
			PlayerRef.SetExpressionOverride(1, 100)	;FEAR	
			elseif type == 2
			PlayerRef.SetExpressionOverride(16, 100) ;????
			elseif type == 3
			PlayerRef.SetExpressionOverride(9, 100)	;combat shout
			elseif type == 4
			PlayerRef.SetExpressionOverride(3, 100) ;SAD
			elseif type == 5
			PlayerRef.SetExpressionOverride(0, 100)	;ANGER
			elseif type == 6
			PlayerRef.SetExpressionOverride(6, 100)	;DISGUST
			endif
				
		;need dedicated Orgasm expression	
		elseif Gagged || Orgasm   
	;	NymTrace("SetExpression 3")
		MfgConsoleFunc.SetModifier(PlayerRef, 6, Utility.RandomInt(80,100))	;BrowUpL
		MfgConsoleFunc.SetModifier(PlayerRef, 7, Utility.RandomInt(80,100))	;BrowUpR

			if D100(50)
			MfgConsoleFunc.SetModifier(PlayerRef, 4, Utility.RandomInt(80,100))	;BrowInL
			MfgConsoleFunc.SetModifier(PlayerRef, 5, Utility.RandomInt(80,100))	;BrowInR
			endif

		MfgConsoleFunc.SetModifier(PlayerRef, 0, Utility.RandomInt(0,20))	;BlinkL

			if (DefeatGagAdded != 2) && (DefeatGagAdded != 3)
			MfgConsoleFunc.SetPhoneme(PlayerRef, 0, 100)		;AH
			endif
		;--- Nymra old ----
		;MfgConsoleFunc.SetPhoneme(PlayerRef, 1, 100)		;BIG AAAH
		;MfgConsoleFunc.SetPhoneme(PlayerRef, 11, 100)		;Oh
		;----------- 
		;MfgConsoleFunc.SetPhoneme(PlayerRef, 12, 100)		;OOooh
		;PlayerRef.SetExpressionOverride(9, 100)	;combat shout
		
		;---- Nymra from the SL Mod ---- 
		PlayerRef.SetExpressionOverride(16, 0)  ; Skyrim SE		;?????
			
		;/
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 1, 100)    ;	;BIG AAAH
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 2, 100)    ;	BMP?
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 11, 100)    ; Oh
		;MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 5, 100)    ; Eee
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 6, 100)    ; Eee
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 10, 100)    ; Oldrim 
		/;
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 0, 100)    ;
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 1, 100)    ;
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 5, 100)    
		MfgConsoleFunc.SetPhonemeModifier(PlayerRef, 0, 11, 100)    
		
		
		; ---------------------------
		
		endif
		
		;these always are applied
		
		
		;Stage 2: EYE MOVEMENT AND ADDITIONAL RANDOM AHH ------------------------------------
		if type > 0
		;NymTrace("SetExpression 4")
			;MOUTH OPENING
			;if Gagged || Orgasm
			;MfgConsoleFunc.SetPhoneme(PlayerRef, 1, 100)		;BIG AAAH
			;MfgConsoleFunc.SetPhoneme(PlayerRef, 12, (100)		;OOooh
			
			if !Gagged && !Orgasm
			;additional factors
			MfgConsoleFunc.SetPhoneme(PlayerRef, 1, (Utility.RandomInt(40,100)))	;BIG AAAH	
			endif
			
			;EYE MOVEMENT
			int i = Utility.RandomInt(1,6)
			
			;reset looking
			MfgConsoleFunc.SetModifier(PlayerRef, 8, 0)
			MfgConsoleFunc.SetModifier(PlayerRef, 11, 0)
			MfgConsoleFunc.SetModifier(PlayerRef, 9, 0)
			MfgConsoleFunc.SetModifier(PlayerRef, 10, 0)
			
			if  i == 1
			MfgConsoleFunc.SetModifier(PlayerRef, 8, 100)	;LOOK DOWN
			elseif i == 2
			MfgConsoleFunc.SetModifier(PlayerRef, 11, 100)	;LOOK UpdateCurrentInstanceGlobal
			elseif i == 3
			MfgConsoleFunc.SetModifier(PlayerRef, 9, 100)	;LOOK LEFT
			elseif i == 4
			MfgConsoleFunc.SetModifier(PlayerRef, 10, 100)	;LOOK RIGHT
			elseif i == 5
			MfgConsoleFunc.SetModifier(PlayerRef, 12, Utility.RandomInt(50,100))	;SquintL
			MfgConsoleFunc.SetModifier(PlayerRef, 13, Utility.RandomInt(50,100))	;SquintR
			else
			;nothing
			endif

		endif
	endif

EndFunction

int Extra = 0		;guardsandextra
Bool GuardsPresent = false

Bool Function IsGuardsPresent()
if GuardsPresent
return true
else
return false
EndIf
EndFunction

			;/
			CrimeFactionOrcs "Tribal Orcs" [FACT:00028713]
			CrimeFactionCidhnaMine [FACT:0010B1FC]
			dunPOIWitchAniseCrimeFaction "Crime Faction so crimes against created actors are registered" [FACT:00108232]
			WIGenericCrimeFaction "Crime Faction so crimes against created actors are registered" [FACT:000522B6]

			DBRecuringTarget1CrimeFaction "DB RecurringTarget 1 CrimeFaction" [FACT:000E7B9E] .. 
			DBRecuringTarget10CrimeFaction "DB RecurringTarget 10 CrimeFaction" [FACT:000E7B9D]

			DBRecuringContact1CrimeFaction [FACT:000EDDDE] .. 
			DBRecuringContact10CrimeFaction [FACT:000EDDDF]

			CrimeFactionSons "Stormcloaks" [FACT:00028849]
			CrimeFactionImperial "Imperial Legion" [FACT:00028848]

			CrimeFactionWinterhold "Winterhold" [FACT:0002816F]
			CrimeFactionRift "The Rift" [FACT:0002816B]
			CrimeFactionReach "The Reach" [FACT:0002816C]
			CrimeFactionPale "The Pale" [FACT:0002816E]
			CrimeFactionHjaalmarch "Hjaalmarch" [FACT:0002816D]
			CrimeFactionHaafingar "Haafingar" [FACT:00029DB0]
			CrimeFactionFalkreath "Falkreath" [FACT:00028170]
			CrimeFactionEastmarch "Eastmarch" [FACT:000267E3]
			CrimeFactionWhiterun "Whiterun" [FACT:000267EA]
			/;
			
					
	;/
	GetLocations()
	
														REGION (HoldLocation)
	00028170 Crime Faction Falkreath					FalkreathHoldLocation "Falkreath" [LCTN:0001676F]
	000267E3 Crime Faction Eastmarch (Windhelm)			EastmarchHoldLocation "Eastmarch" [LCTN:0001676A]
	00029DB0 Crime Faction Haafingar (Solitude)			HaafingarHoldLocation "Haafingar" [LCTN:00016770]
	0002816D Crime Faction Hjaalmarch (Morthal)			HjaalmarchHoldLocation "Hjaalmarch" [LCTN:0001676E]
	0002816e Crime Faction The Pale (Dawnstar)			PaleHoldLocation "the Pale" [LCTN:0001676D]	
	0002816C Crime Faction The Reach (Markarth)			ReachHoldLocation "the Reach" [LCTN:00016769]
	0002816B Crime Faction The Rift (Riften)			RiftHoldLocation "the Rift" [LCTN:0001676C]
	000267EA Crime Faction Whiterun						WhiterunHoldLocation "Whiterun" [LCTN:00016772]
	0002816F Crime Faction Winterhold					WinterholdHoldLocation "Winterhold" [LCTN:0001676B]
	/;			
	

	
	
;CHANGE IN TO ESP >>>>>>>>>>>>>>	
Location Falkreath
Location Eastmarch
Location Haafingar
Location Hjaalmarch
Location ThePale
Location TheReach
Location TheRift
Location Whiterun
Location Winterhold

Location CurrentHoldLocation

Faction Falkreath_Police
Faction Eastmarch_Police
Faction Haafingar_Police
Faction Hjaalmarch_Police
Faction ThePale_Police
Faction TheReach_Police
Faction TheRift_Police
Faction Whiterun_Police
Faction Winterhold_Police

Faction Orc_Police
Faction StormCloak_Police
Faction Imperial_Police

Faction CurrentHoldPolice

	int Property Falkreath_CrimeGold_Major_Internal Auto
	int Property Falkreath_CrimeGold_Minor_Internal Auto
	int Property Eastmarch_CrimeGold_Major_Internal Auto
	int Property Eastmarch_CrimeGold_Minor_Internal Auto
	int Property Haafingar_CrimeGold_Major_Internal Auto
	int Property Haafingar_CrimeGold_Minor_Internal Auto
	int Property Hjaalmarch_CrimeGold_Major_Internal Auto
	int Property Hjaalmarch_CrimeGold_Minor_Internal Auto
	int Property ThePale_CrimeGold_Major_Internal Auto
	int Property ThePale_CrimeGold_Minor_Internal Auto
	int Property TheReach_CrimeGold_Major_Internal Auto
	int Property TheReach_CrimeGold_Minor_Internal Auto
	int Property TheRift_CrimeGold_Major_Internal Auto
	int Property TheRift_CrimeGold_Minor_Internal Auto
	int Property Whiterun_CrimeGold_Major_Internal Auto
	int Property Whiterun_CrimeGold_Minor_Internal Auto
	int Property Winterhold_CrimeGold_Major_Internal Auto
	int Property Winterhold_CrimeGold_Minor_Internal Auto

bool Property PunishCrimeMinor Auto
bool Property PunishCrimeMajor Auto

Bool Function IsMinorCrime()
	if PunishCrimeMinor
	return true
	else
	return false
	endif
EndFunction

Bool Function IsMajorCrime()
	if PunishCrimeMajor
	return true
	else
	return false
	endif
EndFunction

Function ResetMajorCrime()
PunishCrimeMajor = false
EndFunction

Function ResetMinorCrime()
PunishCrimeMinor = false
EndFunction
	
;we need this function to determine if we are punished for crime in NAKED DEFEAT
Function CheckCrimePunishment()			;#crime1 ;#CheckCrimePunishment()

Debug.Trace("NAKED DEFEAT configquest: CheckCrimePunishment()")

String CurrentLocation = "empty" 
		
	if NymBeta
		if PlayerRef.IsInLocation(Falkreath)
		CurrentLocation = "Falkreath" 	
			if D1000(Falkreath_CrimeGold_Major_Internal) && D100(66)
			PunishCrimeMajor = true
			CrimeGoldToGet = Falkreath_CrimeGold_Major_Internal + Falkreath_CrimeGold_Minor_Internal
			Falkreath_CrimeGold_Major_Internal = 0
			Falkreath_CrimeGold_Minor_Internal = 0
			
			elseif D100(Falkreath_CrimeGold_Minor_Internal) && D100(33)
			PunishCrimeMinor = true
			CrimeGoldToGet = Falkreath_CrimeGold_Minor_Internal
			Falkreath_CrimeGold_Minor_Internal = 0
			endif
		
		elseif PlayerRef.IsInLocation(Eastmarch)
		CurrentLocation = "Eastmarch" 	
			if D1000(Eastmarch_CrimeGold_Major_Internal) && D100(66)
			PunishCrimeMajor = true
			CrimeGoldToGet = Eastmarch_CrimeGold_Major_Internal + Eastmarch_CrimeGold_Minor_Internal
			Eastmarch_CrimeGold_Major_Internal = 0
			Eastmarch_CrimeGold_Minor_Internal = 0
			elseif D100(Eastmarch_CrimeGold_Minor_Internal) && D100(33)
			PunishCrimeMinor = true
			CrimeGoldToGet = Eastmarch_CrimeGold_Minor_Internal
			Eastmarch_CrimeGold_Minor_Internal = 0
			endif
		
		elseif PlayerRef.IsInLocation(Haafingar)
		CurrentLocation = "Haafingar"	
			if D1000(Haafingar_CrimeGold_Major_Internal) && D100(66)
			PunishCrimeMajor = true
			CrimeGoldToGet = Haafingar_CrimeGold_Major_Internal + Haafingar_CrimeGold_Minor_Internal
			Haafingar_CrimeGold_Major_Internal = 0
			Haafingar_CrimeGold_Minor_Internal = 0
	
			elseif D100(Haafingar_CrimeGold_Minor_Internal) && D100(33)
			PunishCrimeMinor = true
			CrimeGoldToGet = Haafingar_CrimeGold_Minor_Internal
			Haafingar_CrimeGold_Minor_Internal = 0
		 
			endif
		
		elseif PlayerRef.IsInLocation(Hjaalmarch)
		CurrentLocation = "Hjaalmarch"	
			if D1000(Hjaalmarch_CrimeGold_Major_Internal) && D100(66)
			PunishCrimeMajor = true
			CrimeGoldToGet = Hjaalmarch_CrimeGold_Major_Internal + Hjaalmarch_CrimeGold_Minor_Internal
			Hjaalmarch_CrimeGold_Major_Internal = 0
			Hjaalmarch_CrimeGold_Minor_Internal = 0
			
			elseif D100(Hjaalmarch_CrimeGold_Minor_Internal) && D100(33)
			PunishCrimeMinor = true
			CrimeGoldToGet = Hjaalmarch_CrimeGold_Minor_Internal
			Hjaalmarch_CrimeGold_Minor_Internal = 0
			
			endif
		
		elseif PlayerRef.IsInLocation(ThePale)	
		CurrentLocation = "ThePale"	
			if D1000(ThePale_CrimeGold_Major_Internal) && D100(66)
			PunishCrimeMajor = true
			CrimeGoldToGet = ThePale_CrimeGold_Major_Internal + ThePale_CrimeGold_Minor_Internal
			ThePale_CrimeGold_Major_Internal = 0
			ThePale_CrimeGold_Minor_Internal = 0
		
			elseif D100(ThePale_CrimeGold_Minor_Internal) && D100(33)
			PunishCrimeMinor = true
			CrimeGoldToGet = ThePale_CrimeGold_Minor_Internal
			ThePale_CrimeGold_Minor_Internal = 0
			 
			endif
		
		elseif PlayerRef.IsInLocation(TheReach)
		CurrentLocation = "TheReach"		
			if D1000(TheReach_CrimeGold_Major_Internal) && D100(66)
			PunishCrimeMajor = true
			CrimeGoldToGet = TheReach_CrimeGold_Major_Internal + TheReach_CrimeGold_Minor_Internal
			TheReach_CrimeGold_Major_Internal = 0
			TheReach_CrimeGold_Minor_Internal = 0
			elseif D100(TheReach_CrimeGold_Minor_Internal) && D100(33)
			PunishCrimeMinor = true
			CrimeGoldToGet = TheReach_CrimeGold_Minor_Internal
			TheReach_CrimeGold_Minor_Internal = 0
			
			endif
			
		elseif PlayerRef.IsInLocation(TheRift)
		CurrentLocation = "TheRift"	
			if D1000(TheRift_CrimeGold_Major_Internal) && D100(66)
			PunishCrimeMajor = true
			CrimeGoldToGet = TheRift_CrimeGold_Major_Internal + TheRift_CrimeGold_Minor_Internal
			TheRift_CrimeGold_Major_Internal = 0
			TheRift_CrimeGold_Minor_Internal = 0
			elseif D100(TheRift_CrimeGold_Minor_Internal) && D100(33)
			PunishCrimeMinor = true
			CrimeGoldToGet = TheRift_CrimeGold_Minor_Internal
			TheRift_CrimeGold_Minor_Internal = 0
			endif
		
		elseif PlayerRef.IsInLocation(Whiterun)
		CurrentLocation = "Whiterun"	
			if D1000(Whiterun_CrimeGold_Major_Internal) && D100(66)
			PunishCrimeMajor = true
			CrimeGoldToGet = Whiterun_CrimeGold_Major_Internal + Whiterun_CrimeGold_Minor_Internal
			Whiterun_CrimeGold_Major_Internal = 0
			Whiterun_CrimeGold_Minor_Internal = 0
			elseif D100(Whiterun_CrimeGold_Minor_Internal) && D100(33)
			PunishCrimeMinor = true
			CrimeGoldToGet = Whiterun_CrimeGold_Minor_Internal
			Whiterun_CrimeGold_Minor_Internal = 0
			endif
		
		elseif PlayerRef.IsInLocation(Winterhold)
		CurrentLocation = "Winterhold"				
			if D1000(Winterhold_CrimeGold_Major_Internal) && D100(66)
			PunishCrimeMajor = true
			CrimeGoldToGet = Winterhold_CrimeGold_Major_Internal + Winterhold_CrimeGold_Minor_Internal
			Winterhold_CrimeGold_Major_Internal = 0
			Winterhold_CrimeGold_Minor_Internal = 0
			elseif D100(Winterhold_CrimeGold_Minor_Internal) && D100(33)
			PunishCrimeMinor = true
			CrimeGoldToGet = Winterhold_CrimeGold_Minor_Internal
			Winterhold_CrimeGold_Minor_Internal = 0
			endif
			
		endif
	endif 	
	
	

	
	;	if PunishCrimeMinor
	;	ScreenMessage("MINOR crimes comitted in "+CurrentLocation) 
	;	elseif PunishCrimeMajor
	;	ScreenMessage("MAJOR crimes comitted in "+CurrentLocation) 
	;	else
	;	ScreenMessage("Not punished for crimes in "+CurrentLocation) 
	;	endif 
		
EndFunction


Function RandomBounty()

;Reputation: 


int LevelCurrent = PlayerRef.GetLevel()

	if D100(LevelCurrent)
	;DoStuff
	;set a CrimeGold on the PC in a random Hold. 
	endif 


EndFunction



;THIS FUNCTION IS IMPORTANT, it takes the crimegold away from the PC so the crimefaction dialogue hopefully does not trigger
Function ProcessCrimeGold()		;#ProcessCrimeGold()
Debug.Trace("NAKED DEFEAT configquest: ProcessCrimeGold()")
		;This deletes crimegold and saves it locally to only use it internally

	
	if NymBeta && Indecency		
	;BETA feature right now. And only activate when public punishment is also ON, because this runs on the check scan
		
		;Fill Hold Locations and Crime (Police) Factions from File	
		if !Falkreath ;if this is true, all are...
		Falkreath = (Game.GetFormFromFile(0x0001676F, "Skyrim.esm") As Location)	
		Eastmarch = (Game.GetFormFromFile(0x0001676A, "Skyrim.esm") As Location)
		Haafingar = (Game.GetFormFromFile(0x00016770, "Skyrim.esm") As Location)
		Hjaalmarch = (Game.GetFormFromFile(0x0001676E, "Skyrim.esm") As Location)
		ThePale = (Game.GetFormFromFile(0x0001676D, "Skyrim.esm") As Location)
		TheReach = (Game.GetFormFromFile(0x00016769, "Skyrim.esm") As Location)
		TheRift = (Game.GetFormFromFile(0x0001676C, "Skyrim.esm") As Location)
		Whiterun = (Game.GetFormFromFile(0x00016772, "Skyrim.esm") As Location)
		Winterhold = (Game.GetFormFromFile(0x0001676B, "Skyrim.esm") As Location)	

		Falkreath_Police = (Game.GetFormFromFile(0x00028170, "Skyrim.esm") As Faction)
		Eastmarch_Police = (Game.GetFormFromFile(0x000267E3, "Skyrim.esm") As Faction)
		Haafingar_Police = (Game.GetFormFromFile(0x00029DB0, "Skyrim.esm") As Faction)
		Hjaalmarch_Police = (Game.GetFormFromFile(0x0002816D, "Skyrim.esm") As Faction)
		ThePale_Police = (Game.GetFormFromFile(0x0002816E, "Skyrim.esm") As Faction)
		TheReach_Police = (Game.GetFormFromFile(0x0002816C, "Skyrim.esm") As Faction)
		TheRift_Police = (Game.GetFormFromFile(0x0002816B, "Skyrim.esm") As Faction)
		Whiterun_Police = (Game.GetFormFromFile(0x000267EA, "Skyrim.esm") As Faction)
		Winterhold_Police = (Game.GetFormFromFile(0x0002816F, "Skyrim.esm") As Faction)
		
		Orc_Police = (Game.GetFormFromFile(0x00028713, "Skyrim.esm") As Faction)
		StormCloak_Police = (Game.GetFormFromFile(0x00028849, "Skyrim.esm") As Faction)
		Imperial_Police = (Game.GetFormFromFile(0x00028848, "Skyrim.esm") As Faction)
		endif
		
		;GET CURRENT LOCATION, CHECK COPY & DELETE CRIMEGOLD, 	
		
		;FALKREATH
		if  PlayerRef.IsInLocation(Falkreath)
		;if PlayerRef.GetCurrentLocation() == Falkreath
		CurrentHoldLocation = Falkreath
		CurrentHoldPolice = Falkreath_Police
		
		Falkreath_CrimeGold_Major_Internal += Falkreath_Police.GetCrimeGoldViolent()
		Falkreath_Police.SetCrimeGoldViolent(0)	
		Falkreath_CrimeGold_Minor_Internal += Falkreath_Police.GetCrimeGoldNonViolent()
		Falkreath_Police.SetCrimeGold(0)	
		
		if IsNymrasGame() && ((Falkreath_CrimeGold_Major_Internal > 0) || (Falkreath_CrimeGold_Minor_Internal > 0))
		InfoMessage("Current Falkreath Crimegold - Minor:"+Falkreath_CrimeGold_Minor_Internal+" Major: "+Falkreath_CrimeGold_Major_Internal) 
		endif 
		
		;EASTMARCH
		elseif  PlayerRef.IsInLocation(Eastmarch)
		;elseif PlayerRef.GetCurrentLocation() == Eastmarch
		CurrentHoldLocation = Eastmarch
		CurrentHoldPolice = Eastmarch_Police
		
		Eastmarch_CrimeGold_Major_Internal += Eastmarch_Police.GetCrimeGoldViolent()
		Eastmarch_Police.SetCrimeGoldViolent(0)	
		Eastmarch_CrimeGold_Minor_Internal += Eastmarch_Police.GetCrimeGoldNonViolent()
		Eastmarch_Police.SetCrimeGold(0)	
		
		if IsNymrasGame() && ((Eastmarch_CrimeGold_Major_Internal > 0) || (Eastmarch_CrimeGold_Minor_Internal > 0))
		InfoMessage("Current Eastmarch Crimegold - Minor:"+Eastmarch_CrimeGold_Minor_Internal+" Major: "+Eastmarch_CrimeGold_Major_Internal) 
		endif 
		
		;HAAFINGAR
		elseif  PlayerRef.IsInLocation(Haafingar)
		;elseif PlayerRef.GetCurrentLocation() == Haafingar
		CurrentHoldLocation = Haafingar	
		CurrentHoldPolice = Haafingar_Police
		
		Haafingar_CrimeGold_Major_Internal += Haafingar_Police.GetCrimeGoldViolent()
		Haafingar_Police.SetCrimeGoldViolent(0)	
		Haafingar_CrimeGold_Minor_Internal += Haafingar_Police.GetCrimeGoldNonViolent()
		Haafingar_Police.SetCrimeGold(0)	
		
		if IsNymrasGame() && ((Haafingar_CrimeGold_Major_Internal > 0) || (Haafingar_CrimeGold_Minor_Internal > 0))
		InfoMessage("Current Haafingar Crimegold - Minor:"+Haafingar_CrimeGold_Minor_Internal+" Major: "+Haafingar_CrimeGold_Major_Internal) 
		endif
			
		;HJAALMARCH
		elseif  PlayerRef.IsInLocation(Hjaalmarch)
		;elseif PlayerRef.GetCurrentLocation() == Hjaalmarch
		CurrentHoldLocation = Hjaalmarch
		CurrentHoldPolice = Falkreath_Police
		
		Hjaalmarch_CrimeGold_Major_Internal += Hjaalmarch_Police.GetCrimeGoldViolent()
		Hjaalmarch_Police.SetCrimeGoldViolent(0)	
		Hjaalmarch_CrimeGold_Minor_Internal += Hjaalmarch_Police.GetCrimeGoldNonViolent()
		Hjaalmarch_Police.SetCrimeGold(0)	
		
			if IsNymrasGame() && ((Hjaalmarch_CrimeGold_Major_Internal > 0) || (Hjaalmarch_CrimeGold_Minor_Internal > 0))
		InfoMessage("Current Hjaalmarch Crimegold - Minor:"+Hjaalmarch_CrimeGold_Minor_Internal+" Major: "+Hjaalmarch_CrimeGold_Major_Internal) 
		
					endif	
		;THE PALE
		elseif  PlayerRef.IsInLocation(ThePale)
		;elseif PlayerRef.GetCurrentLocation() == ThePale
		CurrentHoldLocation = ThePale
		CurrentHoldPolice = ThePale_Police
		
		ThePale_CrimeGold_Major_Internal += ThePale_Police.GetCrimeGoldViolent()
		ThePale_Police.SetCrimeGoldViolent(0)	
		ThePale_CrimeGold_Minor_Internal += ThePale_Police.GetCrimeGoldNonViolent()
		ThePale_Police.SetCrimeGold(0)	
		
			if IsNymrasGame() && ((ThePale_CrimeGold_Major_Internal > 0) || (ThePale_CrimeGold_Minor_Internal > 0))
		InfoMessage("Current The Pale Crimegold - Minor:"+ThePale_CrimeGold_Minor_Internal+" Major: "+ThePale_CrimeGold_Major_Internal) 
				endif		
		;THE REACH / MARKARTH
		elseif  PlayerRef.IsInLocation(TheReach)
;		Debug.Trace("NAKED DEFEAT configquest: ProcessCrimeGold() TheReach detected B")
		CurrentHoldLocation = TheReach
		CurrentHoldPolice = TheReach_Police
		
		TheReach_CrimeGold_Major_Internal += TheReach_Police.GetCrimeGoldViolent()
		TheReach_Police.SetCrimeGoldViolent(0)	
		TheReach_CrimeGold_Minor_Internal += TheReach_Police.GetCrimeGoldNonViolent()
		TheReach_Police.SetCrimeGold(0)	 
		
		if IsNymrasGame() && ((TheReach_CrimeGold_Major_Internal > 0) || (TheReach_CrimeGold_Minor_Internal > 0))
		InfoMessage("Current The Reach Crimegold - Minor:"+TheReach_CrimeGold_Minor_Internal+" Major: "+TheReach_CrimeGold_Major_Internal) 
		endif	
		 
		;THE RIFT / RIFTEN
		elseif  PlayerRef.IsInLocation(TheRift) 
		;elseif PlayerRef.GetCurrentLocation() == TheRift
		CurrentHoldLocation = TheRift
		CurrentHoldPolice = TheRift_Police

		TheRift_CrimeGold_Major_Internal += TheRift_Police.GetCrimeGoldViolent()
		TheRift_Police.SetCrimeGoldViolent(0)	
		TheRift_CrimeGold_Minor_Internal += TheRift_Police.GetCrimeGoldNonViolent()
		TheRift_Police.SetCrimeGold(0)	
		
			if IsNymrasGame() && ((TheRift_CrimeGold_Major_Internal > 0) || (TheRift_CrimeGold_Minor_Internal > 0))
		InfoMessage("Current The Rift Crimegold - Minor:"+TheRift_CrimeGold_Minor_Internal+" Major: "+TheRift_CrimeGold_Major_Internal) 
				endif
		;WHITERUN
		elseif  PlayerRef.IsInLocation(Whiterun)
		;elseif PlayerRef.GetCurrentLocation() == Whiterun
		CurrentHoldLocation = Whiterun
		CurrentHoldPolice = Whiterun_Police

		Whiterun_CrimeGold_Major_Internal += Whiterun_Police.GetCrimeGoldViolent()
		Whiterun_Police.SetCrimeGoldViolent(0)	
		Whiterun_CrimeGold_Minor_Internal += Whiterun_Police.GetCrimeGoldNonViolent()
		Whiterun_Police.SetCrimeGold(0)	
		
				if IsNymrasGame() && ((Whiterun_CrimeGold_Major_Internal > 0) || (Whiterun_CrimeGold_Minor_Internal > 0))
		InfoMessage("Current Whiterun Crimegold - Minor:"+Whiterun_CrimeGold_Minor_Internal+" Major: "+Whiterun_CrimeGold_Major_Internal) 
				endif
		
		elseif  PlayerRef.IsInLocation(Winterhold)
		;elseif PlayerRef.GetCurrentLocation() == Winterhold
		CurrentHoldLocation = Winterhold
		CurrentHoldPolice = Winterhold_Police
		
		Winterhold_CrimeGold_Major_Internal += Winterhold_Police.GetCrimeGoldViolent()
		Winterhold_Police.SetCrimeGoldViolent(0)	
		Winterhold_CrimeGold_Minor_Internal += Winterhold_Police.GetCrimeGoldNonViolent()
		Winterhold_Police.SetCrimeGold(0)
		
			if IsNymrasGame() && ((Winterhold_CrimeGold_Major_Internal > 0) || (Winterhold_CrimeGold_Minor_Internal > 0))
		InfoMessage("Current Winterhold Crimegold - Minor:"+Winterhold_CrimeGold_Minor_Internal+" Major: "+Winterhold_CrimeGold_Major_Internal) 
			endif 
		endif
		
	endif
	

EndFunction

Float Function GetDirtiness()

	float DirtinessValue
	
	if ModBiS
		GlobalVariable Dirtiness; = (Game.GetFormFromFile(0x00000DA8, "Bathing in Skyrim - Main.esp") As GlobalVariable)	
			
		;if (Game.GetModByName("Bathing in Skyrim - Main.esp") != 255)  
		Dirtiness = (Game.GetFormFromFile(0x00000DA8, "Bathing in Skyrim - Main.esp") As GlobalVariable)	
		;elseif (Game.GetModByName("Bathing in Skyrim.esp") != 255)
		;Dirtiness = (Game.GetFormFromFile(0x00000DA8, "Bathing in Skyrim.esp") As GlobalVariable)
		;endif 
		
		DirtinessValue = (Dirtiness.GetValue()*100)
		Debug.Trace("Naked Defeat calmquest (ModBiS: DirtinessValue: " +DirtinessValue)
		return DirtinessValue
		
	elseif ModBiS_R
		GlobalVariable Dirtiness; = (Game.GetFormFromFile(0x00000DA8, "Bathing in Skyrim - Main.esp") As GlobalVariable)	
			
	;	if (Game.GetModByName("Bathing in Skyrim - Main.esp") != 255)  
	;	Dirtiness = (Game.GetFormFromFile(0x00000DA8, "Bathing in Skyrim - Main.esp") As GlobalVariable)	
	;	elseif (Game.GetModByName("Bathing in Skyrim.esp") != 255)
		Dirtiness = (Game.GetFormFromFile(0x00000DA8, "Bathing in Skyrim.esp") As GlobalVariable)
	;	endif 
		
		DirtinessValue = (Dirtiness.GetValue()*100)
		Debug.Trace("Naked Defeat calmquest: ModBiS_R:DirtinessValue: " +DirtinessValue)
		return DirtinessValue

	else
	;InfoMessage("NAKED DEFEAT #ERROR: Bathing in Skyrim not installed")
	return 0.0
	endif

EndFunction	
		
		
		
Function ResetPublicExposure()

	PublicExposure = 0 
	Sound.StopInstance(instanceID)

EndFunction 		
		
int instanceID
int instanceID_02
		
		;THIS DOES NOT NEED TO BE HERE???
Function CalculatePublicExposure()			;#publicpunishment #civilrape

		;bool NobodyAround = false
		bool PlayerIsProstitute = false
		bool PlayerIsSlave = false
		bool PlayerIsPOP_Prisoner = false
		float DirtinessValue = 0
		int tempInt
		string tempInfomessage = "none"
		
		string tempInfomessageDirty = ""
		string tempInfomessageMovement = ""
		string tempInfomessageNaked = ""
		string tempInfomessageCum = ""
		string tempInfomessageWeapon = ""
		
	;if ModBiS
	;	GlobalVariable Dirtiness = (Game.GetFormFromFile(0x00000DA8, "Bathing in Skyrim - Main.esp") As GlobalVariable)	
	;	DirtinessValue = (Dirtiness.GetValue()*100)
		;Debug.Trace("Naked Defeat calmquest: DirtinessValue: " +DirtinessValue)
	;endif

	;DISBALE FOR TESTING #Baustelle
	;/
	if IsRadiantProstitute()
	PlayerIsProstitute = true
	endif
	/;
	
	if PublicExposure < 0
	PublicExposure = 0
	endif
	
	ProcessCrimeGold()
	
	if IsSlave(PlayerRef)
	PlayerIsSlave = true
	endif
	
	
	;if Busy()
	;PlayerIsBusy = true
	;endif
	
	if IsArrestedPOP()
	PlayerIsPOP_Prisoner = true
	endif
	
	
	int ExposureBefore = PublicExposure
	int ExposureAfter
	
	;>>>>>>>>> ACTOR is around <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
	; If no actors nearby, no increase and no punishment, but we can reduce exposure
		
	if ProxActorDetected > 0.0
	NobodyAroundTicks = 0
	
		if IsFucking(PlayerRef)
								
			;CHECK SEX --- SLAVES and PROSITUTES lower their exposure when fucking		
			if (PlayerIsProstitute || PlayerIsSlave) && PublicExposure > 0
			;Debug.Trace("NAKED DEFEAT CIVIL RAPE (PC is Fucking)"+DirtinessValue)
			tempInt = 1
			PublicExposure -= tempInt
				
			;NobodyAround = true
					
				tempInfomessage = "reduced by "+tempInt+": Prostitute/Slave having SEX"
				tempInt = 0	
			else
			;nothing here yet... more complicated
			;we need to check for sex partners so they do not count as Proximity Actors
			endif
			
			if Nym() && !SexScene
			PublicExposure += 2
			else
				if PublicExposure < 0
				PublicExposure = 0
				endif
			endif 
		else
				
			float DirtinessCurrent = GetDirtiness()	
		
			;DIRTY
			if DirtinessCurrent > PublicPunishment_DirtThreshold_VALUE 		;checks bathing mods inside function
			
				if (Utility.RandomFloat(0.0, ExposureChance)) < Dirty_Weight		
				PublicExposure +=Exposurefrom_DIRTINESS_VALUE
				tempInfomessageDirty = "Dirty"	
				endif
			endif 
			
			;MOVEMENT 01 - Sprinting - /!\ Check Sprinting then Running or we always run... /!\ 
			if PlayerRef.IsSprinting() && (Utility.RandomFloat(0.0, ExposureChance) < Sprinting_Weight)		;sprinting - 15.0

			PublicExposure +=Exposurefrom_SPRINTING_VALUE	
	
			tempInfomessageMovement = "Sprinting"
			
			;MOVEMENT 02 - Running
			elseif PlayerRef.IsRunning() && (Utility.RandomFloat(0.0, ExposureChance) < Running_Weight)		;running - 10.0
			PublicExposure +=Exposurefrom_RUNNING_VALUE

			tempInfomessageMovement = "Running"

			;MOVEMENT 03 - Sneaking	
			elseif PlayerRef.IsSneaking() && (Utility.RandomFloat(0.0, ExposureChance) < Sneaking_Weight)		;sneaking - 5.0
			PublicExposure +=Exposurefrom_SNEAKING_VALUE
			;Debug.Trace("NAKED DEFEAT CIVIL RAPE (PC is sneaking)")
				
			tempInfomessageMovement = "Sneaking"
			endif 
			
			;Prostitutes and Slaves can be Naked
		;	if PlayerIsProstitute || PlayerIsSlave			
		;		if !IsPlayerNaked() && (Utility.RandomFloat(0.0, ExposureChance) < Naked_Weight)				;naked - 15.0
		;		PublicExposure +=1
		;		Debug.Trace("NAKED DEFEAT CIVIL RAPE (PC is NOT naked)")
		;			if NymBETA
		;			tempInfomessageNaked = "(Prostitute/Slave) Not Naked"
		;			endif
		;		endif
		;	else
		
		
			if IsPlayerNaked() && (Utility.RandomFloat(0.0, ExposureChance) < Naked_Weight)				;naked - 15.0
			PublicExposure +=Exposurefrom_NUDITY_VALUE
			;Debug.Trace("NAKED DEFEAT CIVIL RAPE (PC is naked)")
		
				tempInfomessageNaked = "Naked"
		
			elseif IsPlayerBarefoot() && (Utility.RandomFloat(0.0, ExposureChance) < Barefoot_Weight)			;barefoot - 5.0
			PublicExposure +=Exposurefrom_BAREFOOT_VALUE
			;Debug.Trace("NAKED DEFEAT CIVIL RAPE (PC is barefoot)")
	
				tempInfomessageNaked = "Barefoot"
	
			endif
		;	endif	
						
			;Prostitutes/Slaves can be cumsoaked				
			if (!PlayerIsProstitute || !PlayerIsSlave) && IsPlayerCumsoaked() && (Utility.RandomFloat(0.0, ExposureChance) < Cum_Weight)			;cumsoaked - 15.0
			PublicExposure +=Exposurefrom_CUMSOAKED_VALUE
			;Debug.Trace("NAKED DEFEAT CIVIL RAPE (PC is cumsoaked)")

					tempInfomessageCum = "Cumsoaked"

			endif
					
			;Prostitutes and Slaves are not allowed to carry weapons
		;	if PlayerIsProstitute || PlayerIsSlave
		;		if !IsPlayerUnarmed() && (Utility.RandomFloat(0.0, ExposureChance) < Unarmed_Weight)			;unarmed - 5.0
		;		PublicExposure +=2
		;			if NymBETA
		;			tempInfomessageWeapon = "+2 (Prostitute/Slave): Armed"
		;			endif
		;		endif
		
		
			;FREE Women should carry weapons	
		;	else			
			if IsPlayerUnarmed() && (Utility.RandomFloat(0.0, ExposureChance) < Unarmed_Weight)			;unarmed - 5.0
			PublicExposure +=Exposurefrom_UNARMED_VALUE

				tempInfomessageWeapon = "Unarmed"
			endif
			

			;Breathing
			;THIS CHECKS THE CHANGE IN EXPOSURE before and After the Roll
			ExposureAfter = PublicExposure
			ExposureAfter -= ExposureBefore
			
			;DAFUQ IS THIS FOR, this caused the random breathing
		;	if IsNymrasGame()
		;		if (ProxActorDetected == 2) && D100(50)
		;		ExposureAfter = ExposureAfter+1	
		;		elseif (ProxActorDetected > 2) && D100(75)
		;		ExposureAfter = ExposureAfter+2
		;		endif 
		;	endif 
				
			;if exposure changed alot, play moaning
		;	if ExposureAfter > 4 ;NOT USED ATM
		;	PlayBreathingSound()
			;if exposure changed only a little, play breathing
			
			if ExposureAfter > 0
				if PublicPunishment_Sounds_TOGGLE
				PlayBreathingSound()
				endif 
			;if we behave, exposure can slowly decrease again, even with actors around
			elseif (ExposureAfter == 0) && D100(25) && PublicExposure > 0
			InfoMessage("EXPOSURE reduced by 1: For Behaving")
			PublicExposure -= 1
			endif
			
			if PublicExposure < 0
			PublicExposure = 0
			endif		
		endif	

	;>>>>>>>> NOBODY AROUND >>>>>>>>>>>>>>>>>>>>>>>>>>>>
	else
		
		;tempInt = Utility.RandomInt(1, 3)
			
		if PublicExposure > 0
		PublicExposure -= NobodyAroundTicks		;lower exposure when nobody nearby
			if D100(75)
			NobodyAroundTicks += 1
			endif 
		InfoMessage("EXPOSURE reduced by "+NobodyAroundTicks+": Nobody Around")
		tempInt = 0
		endif
		
		if PublicExposure < 0
		PublicExposure = 0
		endif
	
		;Debug.Notification("Nobody close by")
	endif

		Debug.Trace("NAKED DEFEAT PublicExposure: "+PublicExposure)
	
	;No Proximity Message for now. We want to see the Actual Value for now.
	if (PublicExposure > 0) && (ProxActorDetected > 0.0)
	;ProximityMessage()
	
		;add extra when we are too close to an actor
		if ProxActorDetected > 1.0
		Extra += 5	
		endif
	
	;add extra when we are too close to the guards (the more guards the worse it gets!)
		if ProxGuardDetected >= 5.0
		Extra += 15	
		elseif ProxGuardDetected >= 4.0
		Extra += 12	
		elseif ProxGuardDetected >= 3.0
		Extra += 9	
		elseif ProxGuardDetected >= 2.0
		Extra += 6	
		elseif ProxGuardDetected >= 1.0
		Extra += 3	
		endif
	elseif ProxGuardDetected >= 1.0		;even with no exposure at all there is a slight chance to be fucked over by the guards
	Extra = 1
	endif
	
	if ProxGuardDetected >= 1.0
	GuardsPresent = true
	else
	GuardsPresent = false
	endif
	
	;if NoExtra
	Extra = 0
	;endif
		
	;HEARTBEATSOUND 			
	if PublicPunishment_Sounds_TOGGLE	
	
		if PublicExposure > 0 
		NymTrace("Heartbeat Start")
		Sound mySFX	

		;mySFX = (Game.GetFormFromFile(0x0004DAB0, "Skyrim.esm") As Sound)
		mySFX = (Game.GetFormFromFile(0x0004DAAF, "Skyrim.esm") As Sound)
		
		Sound.StopInstance(instanceID)
		;(Game.GetFormFromFile(0x0081F780, "DemonicCreatures.esp") As Keyword)
		instanceID = mySFX.play(PlayerRef)          ; play mySFX sound from my self
					
		Float TempVolume = PublicExposure as Float
		TempVolume = TempVolume/10   
		NymTrace("Heartbeat Volume: "+TempVolume)
		Sound.SetInstanceVolume(instanceID, TempVolume)         ; play at half volume
		
		;UIHealthHeartbeatBLPSD [SNDR:0004DAAE]
		;UIHealthHeartbeatALPSD [SNDR:0004DAAD]
		
		;UIHealthHeartbeatBLP [SOUN:0004DAB0]
		;UIHealthHeartbeatALP [SOUN:0004DAAF]
		elseif PublicExposure == 0
		NymTrace("Heartbeat Stop")
	;	SetInstanceVolume(instanceID, 1.0)
		
		Sound.StopInstance(instanceID)
		endif 
	endif 
		
	
	if GuardsPresent 
	Debug.Trace("NAKED DEFEAT CalculatePublicExposure: GuardsPresent TRUE")
	CheckCrimePunishment()	
	endif

	InfoMessage("PublicExposure: "+PublicExposure+" --- Reason: "+tempInfomessageDirty+", "+tempInfomessageMovement+", "+tempInfomessageNaked+", "+tempInfomessageCum+", "+tempInfomessageWeapon)
	;DebugNotification("PublicExposure: "+PublicExposure+" Extra: +"+Extra)
	;endif
	
EndFunction

Function StartHeartBeat()

	NymTrace("Heartbeat Start")
	Sound mySFX	
	mySFX = (Game.GetFormFromFile(0x0004DAAF, "Skyrim.esm") As Sound)		
	Sound.StopInstance(instanceID)
	instanceID = mySFX.play(PlayerRef)         				
	Sound.SetInstanceVolume(instanceID, 1)         

EndFunction 


Function StopHeartBeat()
	Sound.StopInstance(instanceID)
EndFunction

int NobodyAroundTicks = 0

bool ViolentCrime

Int Function GetExtra()
return Extra
EndFunction

Function DisableGuardsPresent()
GuardsPresent = false
EndFunction

;/ NO LONGER IN USE - DELETE 
bool CooldownRunning = false

Bool Function IsCooldownRunning()
if CooldownRunning
return true
else 
return false
EndIf
EndFunction

Function DisableCooldownRunning()
CooldownRunning = false
EndFunction

Function ProximityMessage()


if !CooldownRunning
CooldownRunning = true
RegisterForSingleUpdate(1.0)
endif

EndFunction

/;

Function PlayerSheatheWeapon()
if PlayerRef.IsWeaponDrawn() 
PlayerRef.SheatheWeapon()
endif
EndFunction

Function FadeToBlack(bool FadeOut) ;#fade #fadeout #FadeToBlack
 
	if !NakedBlur
		if FadeOut
		NymTrace("............ooooooooooooooooOOOOOOOOOOOOO	FADE TO BLACK TRUE OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO")
	;	Debug.trace("NAKED DEFEAT configquest: FadeToBlack(true)")
		BlackFade8.ApplyCrossFade(1)  
		
		BlackFadeStatus = 1
		
		;   Game.FadeOutGame(false, true, 60.0, 0.0)
			
		;DEAD, No Fade in
		elseif Dead > 0
		NymTrace("............ooooooooooooooooOOOOOOOOOOOOO	FADE TO BLACK +++ DEAD +++ OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO")
		;do nothing 
		
		elseif DefeatStateChapter == "Ambush Start"
		;do nothing 
			
		;FADE IN 
		else 
		NymTrace("OOOOOOOOOOOOOoooooooooooooooo............	FADE TO BLACK false .....................................")
		ImageSpaceModifier.RemoveCrossFade(1)
		BlackFadeStatus = 0
		;  Game.FadeOutGame(false, true, 0.2, 3.0)
		endIf
	endif	
	
EndFunction